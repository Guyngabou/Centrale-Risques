<!DOCTYPE html>
<html lang="en" data-yd-content-ready="true"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# gumroad: http://ogp.me/ns/fb/gumroad#">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <link rel="dns-prefetch" href="https://assets.gumroad.com/">
    <link rel="dns-prefetch" href="https://static-2.gumroad.com/">
    <link rel="dns-prefetch" href="https://public-files.gumroad.com/">
  <meta name="action-cable-url" content="wss://cable.gumroad.com/cable">
  <link rel="stylesheet" crossorigin="anonymous" href="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/design-baf8b59f.css">
  
    <meta name="apple-itunes-app" content="app-id=916819108, app-argument=https://gumroad.com/d/e8b432408f3f826a1d66d84b01b03e6e">

  <title inertia="title">Hébergement N8N (PRO &amp; 100% GRATUIT)</title>
<meta name="csrf-param" content="authenticity_token" inertia="meta-name-csrf-param">
<meta name="csrf-token" content="ng4ZgU6LbFHIGPAaVmrc6duO4zqMINqQxfGziP1ubPp4VBkmqk9FCJ1cnFVwBAe9F3Px_-QkSWE6y0S_VCPEbg" inertia="meta-name-csrf-token">
<meta charset="utf-8" inertia="meta-charset">
<meta property="fb:app_id" value="149071038533330" inertia="meta-property-fb-app_id">
<meta property="fb:page_id" value="http://www.facebook.com/gumroad" inertia="meta-property-fb-page_id">
<meta property="gr:environment" value="production" inertia="meta-property-gr-environment">
<meta property="og:image" value="https://assets.gumroad.com/assets/opengraph_image-4110ebae42201eaa14606ecde6ca17e380f576b25224ba270116b0439775cd0a.png" inertia="meta-property-og-image">
<meta property="og:image:alt" value="Gumroad" inertia="meta-property-og-image-alt">
<meta property="og:title" value="Gumroad" inertia="meta-property-og-title">
<meta property="og:site_name" value="Gumroad" inertia="meta-property-og-site_name">
<meta name="viewport" content="initial-scale = 1.0, width = device-width" inertia="meta-name-viewport">
<meta property="stripe:pk" value="pk_live_Db80xIzLPWhKo1byPrnERmym" inertia="meta-property-stripe-pk">
<meta property="stripe:api_version" value="2023-10-16; risk_in_requirements_beta=v1; retrieve_tax_forms_beta=v1;" inertia="meta-property-stripe-api_version">
<meta property="twitter:site" value="@gumroad" inertia="meta-property-twitter-site">
<link rel="search" href="https://gumroad.com/opensearch.xml" title="Gumroad" type="application/opensearchdescription+xml" inertia="link-1644e96d">
<link rel="shortcut icon" href="https://assets.gumroad.com/assets/pink-icon-c5f5013768a1da41246e70403f02afc8b34ac89c20f3ba2dd0a01f3973027700.png" inertia="link-741cccba">
<meta property="gr:google_analytics:enabled" content="true" inertia="meta-property-gr-google_analytics-enabled">
<meta property="gr:fb_pixel:enabled" content="true" inertia="meta-property-gr-fb_pixel-enabled">
<meta property="gr:logged_in_user:id" content="" inertia="meta-property-gr-logged_in_user-id">
<meta property="gr:page:type" content="" inertia="meta-property-gr-page-type">
<meta property="gr:facebook_sdk:enabled" content="true" inertia="meta-property-gr-facebook_sdk-enabled">
<link rel="shortcut icon" href="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/lvcg72yemnz50q3bdyqx0rs3384c.webp" inertia="link-e24b5109">
<script type="text/javascript" async="" src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/js" nonce=""></script><script id="facebook-jssdk" async="" src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/sdk.js"></script><script async="" src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/js_002"></script><script>var injectscript=function(){"use strict";var M9=Object.defineProperty;var k9=(Vs,wn,Ea)=>wn in Vs?M9(Vs,wn,{enumerable:!0,configurable:!0,writable:!0,value:Ea}):Vs[wn]=Ea;var X=(Vs,wn,Ea)=>k9(Vs,typeof wn!="symbol"?wn+"":wn,Ea);function Vs(n){return n==null||typeof n=="function"?{main:n}:n}const wn=[EvalError,RangeError,ReferenceError,SyntaxError,TypeError,URIError,globalThis.DOMException,globalThis.AssertionError,globalThis.SystemError].filter(Boolean).map(n=>[n.name,n]),Ea=new Map(wn);class Lh extends Error{constructor(t){super(Lh._prepareSuperMessage(t));X(this,"name","NonError")}static _prepareSuperMessage(t){try{return JSON.stringify(t)}catch{return String(t)}}}const lw=[{property:"name",enumerable:!1},{property:"message",enumerable:!1},{property:"stack",enumerable:!1},{property:"code",enumerable:!0},{property:"cause",enumerable:!1}],_h=new WeakSet,uw=n=>{_h.add(n);const e=n.toJSON();return _h.delete(n),e},u0=n=>Ea.get(n)??Error,Mh=({from:n,seen:e,to:t,forceEnumerable:i,maxDepth:r,depth:s,useToJSON:a,serialize:o})=>{if(!t)if(Array.isArray(n))t=[];else if(!o&&c0(n)){const u=u0(n.name);t=new u}else t={};if(e.push(n),s>=r)return t;if(a&&typeof n.toJSON=="function"&&!_h.has(n))return uw(n);const l=u=>Mh({from:u,seen:[...e],forceEnumerable:i,maxDepth:r,depth:s,useToJSON:a,serialize:o});for(const[u,h]of Object.entries(n)){if(h&&h instanceof Uint8Array&&h.constructor.name==="Buffer"){t[u]="[object Buffer]";continue}if(h!==null&&typeof h=="object"&&typeof h.pipe=="function"){t[u]="[object Stream]";continue}if(typeof h!="function"){if(!h||typeof h!="object"){try{t[u]=h}catch{}continue}if(!e.includes(n[u])){s++,t[u]=l(n[u]);continue}t[u]="[Circular]"}}for(const{property:u,enumerable:h}of lw)typeof n[u]<"u"&&n[u]!==null&&Object.defineProperty(t,u,{value:c0(n[u])?l(n[u]):n[u],enumerable:i?!0:h,configurable:!0,writable:!0});return t};function cw(n,e={}){const{maxDepth:t=Number.POSITIVE_INFINITY,useToJSON:i=!0}=e;return typeof n=="object"&&n!==null?Mh({from:n,seen:[],forceEnumerable:!0,maxDepth:t,depth:0,useToJSON:i,serialize:!0}):typeof n=="function"?`[Function: ${n.name||"anonymous"}]`:n}function hw(n,e={}){const{maxDepth:t=Number.POSITIVE_INFINITY}=e;if(n instanceof Error)return n;if(dw(n)){const i=u0(n.name);return Mh({from:n,seen:[],to:new i,maxDepth:t,depth:0,serialize:!1})}return new Lh(n)}function c0(n){return!!n&&typeof n=="object"&&"name"in n&&"message"in n&&"stack"in n}function dw(n){return!!n&&typeof n=="object"&&"message"in n&&!Array.isArray(n)}var fw=Object.defineProperty,gw=Object.defineProperties,pw=Object.getOwnPropertyDescriptors,Jl=Object.getOwnPropertySymbols,h0=Object.prototype.hasOwnProperty,d0=Object.prototype.propertyIsEnumerable,f0=(n,e,t)=>e in n?fw(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,kh=(n,e)=>{for(var t in e||(e={}))h0.call(e,t)&&f0(n,t,e[t]);if(Jl)for(var t of Jl(e))d0.call(e,t)&&f0(n,t,e[t]);return n},Ph=(n,e)=>gw(n,pw(e)),mw=(n,e)=>{var t={};for(var i in n)h0.call(n,i)&&e.indexOf(i)<0&&(t[i]=n[i]);if(n!=null&&Jl)for(var i of Jl(n))e.indexOf(i)<0&&d0.call(n,i)&&(t[i]=n[i]);return t},g0=(n,e,t)=>new Promise((i,r)=>{var s=l=>{try{o(t.next(l))}catch(u){r(u)}},a=l=>{try{o(t.throw(l))}catch(u){r(u)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,a);o((t=t.apply(n,e)).next())});function yw(n){let e,t={};function i(){Object.entries(t).length===0&&(e==null||e(),e=void 0)}let r=Math.floor(Math.random()*1e4);function s(){return r++}return{sendMessage(a,o,...l){return g0(this,null,function*(){var u,h,d,p;const g={id:s(),type:a,data:o,timestamp:Date.now()},m=(h=yield(u=n.verifyMessageData)==null?void 0:u.call(n,g))!=null?h:g;(d=n.logger)==null||d.debug(`[messaging] sendMessage {id=${m.id}} ─ᐅ`,m,...l);const y=yield n.sendMessage(m,...l),{res:b,err:A}=y??{err:new Error("No response")};if((p=n.logger)==null||p.debug(`[messaging] sendMessage {id=${m.id}} ᐊ─`,{res:b,err:A}),A!=null)throw hw(A);return b})},onMessage(a,o){var l,u,h;if(e==null&&((l=n.logger)==null||l.debug(`[messaging] "${a}" initialized the message listener for this context`),e=n.addRootListener(d=>{var p,g;if(typeof d.type!="string"||typeof d.timestamp!="number"){if(n.breakError)return;const b=Error(`[messaging] Unknown message format, must include the 'type' & 'timestamp' fields, received: ${JSON.stringify(d)}`);throw(p=n.logger)==null||p.error(b),b}(g=n==null?void 0:n.logger)==null||g.debug("[messaging] Received message",d);const m=t[d.type];if(m==null)return;const y=m(d);return Promise.resolve(y).then(b=>{var A,w;return(w=(A=n.verifyMessageData)==null?void 0:A.call(n,b))!=null?w:b}).then(b=>{var A;return(A=n==null?void 0:n.logger)==null||A.debug(`[messaging] onMessage {id=${d.id}} ─ᐅ`,{res:b}),{res:b}}).catch(b=>{var A;return(A=n==null?void 0:n.logger)==null||A.debug(`[messaging] onMessage {id=${d.id}} ─ᐅ`,{err:b}),{err:cw(b)}})})),t[a]!=null){const d=Error(`[messaging] In this JS context, only one listener can be setup for ${a}`);throw(u=n.logger)==null||u.error(d),d}return t[a]=o,(h=n.logger)==null||h.log(`[messaging] Added listener for ${a}`),()=>{delete t[a],i()}},removeAllListeners(){Object.keys(t).forEach(a=>{delete t[a]}),i()}}}for(var Hs=256,p0=[],m0=256,Ql;Hs--;)p0[Hs]=(Hs+256).toString(16).substring(1);function vw(n){var e=0,t=11;if(!Ql||Hs+t>m0*2)for(Ql="",Hs=0;e<m0;e++)Ql+=p0[Math.random()*256|0];return Ql.substring(Hs,Hs+++t)}function y0(n,e={targetScope:window??void 0}){return typeof cloneInto<"u"?cloneInto(n,e.targetScope):n}var Oh="@webext-core/messaging/custom-events",Fh="@webext-core/messaging/custom-events/response";function bw(n){const e=n.namespace,t=vw(),i=[],r=a=>new Promise(o=>{const l=u=>{const{detail:h}=u;h.namespace===e&&h.instanceId!==t&&h.message.type===a.detail.message.type&&o(h.response)};i.push(()=>window.removeEventListener(Fh,l)),window.addEventListener(Fh,l),window.dispatchEvent(a)}),s=yw(Ph(kh({},n),{sendMessage(a){const o={message:a,namespace:e,instanceId:t},l=new CustomEvent(Oh,{detail:y0(o)});return r(l)},addRootListener(a){const o=l=>g0(this,null,function*(){const u=l,{detail:h}=u,d=mw(u,["detail"]);if(h.namespace!==e||h.instanceId===t)return;const p=Ph(kh({},h.message),{event:d}),m={response:yield a(p),message:p,instanceId:t,namespace:e},y=new CustomEvent(Fh,{detail:y0(m)});window.dispatchEvent(y)});return window.addEventListener(Oh,o),()=>window.removeEventListener(Oh,o)},verifyMessageData(a){return structuredClone(a)}}));return Ph(kh({},s),{removeAllListeners(){s.removeAllListeners(),i.forEach(a=>a())}})}const Ew="test";window.pageContentRpc||(window.pageContentRpc=bw({namespace:"kocjgbieikboloadkgcijaceaadcegnl"}));const Dn=Symbol.for("@ts-pattern/matcher"),Aw=Symbol.for("@ts-pattern/isVariadic"),Zl="@ts-pattern/anonymous-select-key",Bh=n=>!!(n&&typeof n=="object"),eu=n=>n&&!!n[Dn],Kr=(n,e,t)=>{if(eu(n)){const i=n[Dn](),{matched:r,selections:s}=i.match(e);return r&&s&&Object.keys(s).forEach(a=>t(a,s[a])),r}if(Bh(n)){if(!Bh(e))return!1;if(Array.isArray(n)){if(!Array.isArray(e))return!1;let i=[],r=[],s=[];for(const a of n.keys()){const o=n[a];eu(o)&&o[Aw]?s.push(o):s.length?r.push(o):i.push(o)}if(s.length){if(s.length>1)throw new Error("Pattern error: Using `...P.array(...)` several times in a single pattern is not allowed.");if(e.length<i.length+r.length)return!1;const a=e.slice(0,i.length),o=r.length===0?[]:e.slice(-r.length),l=e.slice(i.length,r.length===0?1/0:-r.length);return i.every((u,h)=>Kr(u,a[h],t))&&r.every((u,h)=>Kr(u,o[h],t))&&(s.length===0||Kr(s[0],l,t))}return n.length===e.length&&n.every((a,o)=>Kr(a,e[o],t))}return Reflect.ownKeys(n).every(i=>{const r=n[i];return(i in e||eu(s=r)&&s[Dn]().matcherType==="optional")&&Kr(r,e[i],t);var s})}return Object.is(e,n)},ss=n=>{var e,t,i;return Bh(n)?eu(n)?(e=(t=(i=n[Dn]()).getSelectionKeys)==null?void 0:t.call(i))!=null?e:[]:Array.isArray(n)?Fo(n,ss):Fo(Object.values(n),ss):[]},Fo=(n,e)=>n.reduce((t,i)=>t.concat(e(i)),[]);function br(n){return Object.assign(n,{optional:()=>Sw(n),and:e=>qt(n,e),or:e=>xw(n,e),select:e=>e===void 0?v0(n):v0(e,n)})}function Sw(n){return br({[Dn]:()=>({match:e=>{let t={};const i=(r,s)=>{t[r]=s};return e===void 0?(ss(n).forEach(r=>i(r,void 0)),{matched:!0,selections:t}):{matched:Kr(n,e,i),selections:t}},getSelectionKeys:()=>ss(n),matcherType:"optional"})})}function qt(...n){return br({[Dn]:()=>({match:e=>{let t={};const i=(r,s)=>{t[r]=s};return{matched:n.every(r=>Kr(r,e,i)),selections:t}},getSelectionKeys:()=>Fo(n,ss),matcherType:"and"})})}function xw(...n){return br({[Dn]:()=>({match:e=>{let t={};const i=(r,s)=>{t[r]=s};return Fo(n,ss).forEach(r=>i(r,void 0)),{matched:n.some(r=>Kr(r,e,i)),selections:t}},getSelectionKeys:()=>Fo(n,ss),matcherType:"or"})})}function At(n){return{[Dn]:()=>({match:e=>({matched:!!n(e)})})}}function v0(...n){const e=typeof n[0]=="string"?n[0]:void 0,t=n.length===2?n[1]:typeof n[0]=="string"?void 0:n[0];return br({[Dn]:()=>({match:i=>{let r={[e??Zl]:i};return{matched:t===void 0||Kr(t,i,(s,a)=>{r[s]=a}),selections:r}},getSelectionKeys:()=>[e??Zl].concat(t===void 0?[]:ss(t))})})}function Wr(n){return typeof n=="number"}function as(n){return typeof n=="string"}function os(n){return typeof n=="bigint"}br(At(function(n){return!0}));const ls=n=>Object.assign(br(n),{startsWith:e=>{return ls(qt(n,(t=e,At(i=>as(i)&&i.startsWith(t)))));var t},endsWith:e=>{return ls(qt(n,(t=e,At(i=>as(i)&&i.endsWith(t)))));var t},minLength:e=>ls(qt(n,(t=>At(i=>as(i)&&i.length>=t))(e))),length:e=>ls(qt(n,(t=>At(i=>as(i)&&i.length===t))(e))),maxLength:e=>ls(qt(n,(t=>At(i=>as(i)&&i.length<=t))(e))),includes:e=>{return ls(qt(n,(t=e,At(i=>as(i)&&i.includes(t)))));var t},regex:e=>{return ls(qt(n,(t=e,At(i=>as(i)&&!!i.match(t)))));var t}});ls(At(as));const Yr=n=>Object.assign(br(n),{between:(e,t)=>Yr(qt(n,((i,r)=>At(s=>Wr(s)&&i<=s&&r>=s))(e,t))),lt:e=>Yr(qt(n,(t=>At(i=>Wr(i)&&i<t))(e))),gt:e=>Yr(qt(n,(t=>At(i=>Wr(i)&&i>t))(e))),lte:e=>Yr(qt(n,(t=>At(i=>Wr(i)&&i<=t))(e))),gte:e=>Yr(qt(n,(t=>At(i=>Wr(i)&&i>=t))(e))),int:()=>Yr(qt(n,At(e=>Wr(e)&&Number.isInteger(e)))),finite:()=>Yr(qt(n,At(e=>Wr(e)&&Number.isFinite(e)))),positive:()=>Yr(qt(n,At(e=>Wr(e)&&e>0))),negative:()=>Yr(qt(n,At(e=>Wr(e)&&e<0)))});Yr(At(Wr));const us=n=>Object.assign(br(n),{between:(e,t)=>us(qt(n,((i,r)=>At(s=>os(s)&&i<=s&&r>=s))(e,t))),lt:e=>us(qt(n,(t=>At(i=>os(i)&&i<t))(e))),gt:e=>us(qt(n,(t=>At(i=>os(i)&&i>t))(e))),lte:e=>us(qt(n,(t=>At(i=>os(i)&&i<=t))(e))),gte:e=>us(qt(n,(t=>At(i=>os(i)&&i>=t))(e))),positive:()=>us(qt(n,At(e=>os(e)&&e>0))),negative:()=>us(qt(n,At(e=>os(e)&&e<0)))});us(At(os)),br(At(function(n){return typeof n=="boolean"})),br(At(function(n){return typeof n=="symbol"})),br(At(function(n){return n==null})),br(At(function(n){return n!=null}));let Tw=class extends Error{constructor(e){let t;try{t=JSON.stringify(e)}catch{t=e}super(`Pattern matching error: no pattern matches value ${t}`),this.input=void 0,this.input=e}};const Uh={matched:!1,value:void 0};function Bo(n){return new ww(n,Uh)}let ww=class o0{constructor(e,t){this.input=void 0,this.state=void 0,this.input=e,this.state=t}with(...e){if(this.state.matched)return this;const t=e[e.length-1],i=[e[0]];let r;e.length===3&&typeof e[1]=="function"?r=e[1]:e.length>2&&i.push(...e.slice(1,e.length-1));let s=!1,a={};const o=(u,h)=>{s=!0,a[u]=h},l=!i.some(u=>Kr(u,this.input,o))||r&&!r(this.input)?Uh:{matched:!0,value:t(s?Zl in a?a[Zl]:a:this.input,this.input)};return new o0(this.input,l)}when(e,t){if(this.state.matched)return this;const i=!!e(this.input);return new o0(this.input,i?{matched:!0,value:t(this.input,this.input)}:Uh)}otherwise(e){return this.state.matched?this.state.value:e(this.input)}exhaustive(e=Dw){return this.state.matched?this.state.value:e(this.input)}run(){return this.exhaustive()}returnType(){return this}};function Dw(n){throw new Tw(n)}var $h=function(n,e){return $h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])},$h(n,e)};function zr(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$h(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}function Rw(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})}function b0(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(u){return function(h){return l([u,h])}}function l(u){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(t=0)),t;)try{if(i=1,r&&(s=u[0]&2?r.return:u[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,u[1])).done)return s;switch(r=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return t.label++,{value:u[1],done:!1};case 5:t.label++,r=u[1],u=[0];continue;case 7:u=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){t=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){t.label=u[1];break}if(u[0]===6&&t.label<s[1]){t.label=s[1],s=u;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(u);break}s[2]&&t.ops.pop(),t.trys.pop();continue}u=e.call(n,t)}catch(h){u=[6,h],r=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Aa(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Sa(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var i=t.call(n),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(t=i.return)&&t.call(i)}finally{if(a)throw a.error}}return s}function Uo(n,e,t){if(t||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return n.concat(s||Array.prototype.slice.call(e))}function xa(n){return this instanceof xa?(this.v=n,this):new xa(n)}function Iw(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof xa?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Cw(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Aa=="function"?Aa(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}typeof SuppressedError=="function"&&SuppressedError;function Dt(n){return typeof n=="function"}function tu(n){var e=function(i){Error.call(i),i.stack=new Error().stack},t=n(e);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Gh=tu(function(n){return function(t){n(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function iu(n,e){if(n){var t=n.indexOf(e);0<=t&&n.splice(t,1)}}var $o=function(){function n(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return n.prototype.unsubscribe=function(){var e,t,i,r,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=Aa(a),l=o.next();!l.done;l=o.next()){var u=l.value;u.remove(this)}}catch(y){e={error:y}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else a.remove(this);var h=this.initialTeardown;if(Dt(h))try{h()}catch(y){s=y instanceof Gh?y.errors:[y]}var d=this._finalizers;if(d){this._finalizers=null;try{for(var p=Aa(d),g=p.next();!g.done;g=p.next()){var m=g.value;try{S0(m)}catch(y){s=s??[],y instanceof Gh?s=Uo(Uo([],Sa(s)),Sa(y.errors)):s.push(y)}}}catch(y){i={error:y}}finally{try{g&&!g.done&&(r=p.return)&&r.call(p)}finally{if(i)throw i.error}}}if(s)throw new Gh(s)}},n.prototype.add=function(e){var t;if(e&&e!==this)if(this.closed)S0(e);else{if(e instanceof n){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(e)}},n.prototype._hasParent=function(e){var t=this._parentage;return t===e||Array.isArray(t)&&t.includes(e)},n.prototype._addParent=function(e){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e},n.prototype._removeParent=function(e){var t=this._parentage;t===e?this._parentage=null:Array.isArray(t)&&iu(t,e)},n.prototype.remove=function(e){var t=this._finalizers;t&&iu(t,e),e instanceof n&&e._removeParent(this)},n.EMPTY=function(){var e=new n;return e.closed=!0,e}(),n}(),E0=$o.EMPTY;function A0(n){return n instanceof $o||n&&"closed"in n&&Dt(n.remove)&&Dt(n.add)&&Dt(n.unsubscribe)}function S0(n){Dt(n)?n():n.unsubscribe()}var Nw={Promise:void 0},Lw={setTimeout:function(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];return setTimeout.apply(void 0,Uo([n,e],Sa(t)))},clearTimeout:function(n){return clearTimeout(n)},delegate:void 0};function x0(n){Lw.setTimeout(function(){throw n})}function T0(){}function ru(n){n()}var qh=function(n){zr(e,n);function e(t){var i=n.call(this)||this;return i.isStopped=!1,t?(i.destination=t,A0(t)&&t.add(i)):i.destination=kw,i}return e.create=function(t,i,r){return new nu(t,i,r)},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,n.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}($o),_w=function(){function n(e){this.partialObserver=e}return n.prototype.next=function(e){var t=this.partialObserver;if(t.next)try{t.next(e)}catch(i){su(i)}},n.prototype.error=function(e){var t=this.partialObserver;if(t.error)try{t.error(e)}catch(i){su(i)}else su(e)},n.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(t){su(t)}},n}(),nu=function(n){zr(e,n);function e(t,i,r){var s=n.call(this)||this,a;return Dt(t)||!t?a={next:t??void 0,error:i??void 0,complete:r??void 0}:a=t,s.destination=new _w(a),s}return e}(qh);function su(n){x0(n)}function Mw(n){throw n}var kw={closed:!0,next:T0,error:Mw,complete:T0},Vh=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Go(n){return n}function Pw(n){return n.length===0?Go:n.length===1?n[0]:function(t){return n.reduce(function(i,r){return r(i)},t)}}var Ni=function(){function n(e){e&&(this._subscribe=e)}return n.prototype.lift=function(e){var t=new n;return t.source=this,t.operator=e,t},n.prototype.subscribe=function(e,t,i){var r=this,s=Fw(e)?e:new nu(e,t,i);return ru(function(){var a=r,o=a.operator,l=a.source;s.add(o?o.call(s,l):l?r._subscribe(s):r._trySubscribe(s))}),s},n.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(t){e.error(t)}},n.prototype.forEach=function(e,t){var i=this;return t=w0(t),new t(function(r,s){var a=new nu({next:function(o){try{e(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:r});i.subscribe(a)})},n.prototype._subscribe=function(e){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(e)},n.prototype[Vh]=function(){return this},n.prototype.pipe=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Pw(e)(this)},n.prototype.toPromise=function(e){var t=this;return e=w0(e),new e(function(i,r){var s;t.subscribe(function(a){return s=a},function(a){return r(a)},function(){return i(s)})})},n.create=function(e){return new n(e)},n}();function w0(n){var e;return(e=n??Nw.Promise)!==null&&e!==void 0?e:Promise}function Ow(n){return n&&Dt(n.next)&&Dt(n.error)&&Dt(n.complete)}function Fw(n){return n&&n instanceof qh||Ow(n)&&A0(n)}function Bw(n){return Dt(n==null?void 0:n.lift)}function Xi(n){return function(e){if(Bw(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Oi(n,e,t,i,r){return new Uw(n,e,t,i,r)}var Uw=function(n){zr(e,n);function e(t,i,r,s,a,o){var l=n.call(this,t)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=i?function(u){try{i(u)}catch(h){t.error(h)}}:n.prototype._next,l._error=s?function(u){try{s(u)}catch(h){t.error(h)}finally{this.unsubscribe()}}:n.prototype._error,l._complete=r?function(){try{r()}catch(u){t.error(u)}finally{this.unsubscribe()}}:n.prototype._complete,l}return e.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;n.prototype.unsubscribe.call(this),!i&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},e}(qh),$w=tu(function(n){return function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Hh=function(n){zr(e,n);function e(){var t=n.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return e.prototype.lift=function(t){var i=new D0(this,this);return i.operator=t,i},e.prototype._throwIfClosed=function(){if(this.closed)throw new $w},e.prototype.next=function(t){var i=this;ru(function(){var r,s;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var a=Aa(i.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(t)}}catch(u){r={error:u}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}}})},e.prototype.error=function(t){var i=this;ru(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=t;for(var r=i.observers;r.length;)r.shift().error(t)}})},e.prototype.complete=function(){var t=this;ru(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var i=t.observers;i.length;)i.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(t){return this._throwIfClosed(),n.prototype._trySubscribe.call(this,t)},e.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},e.prototype._innerSubscribe=function(t){var i=this,r=this,s=r.hasError,a=r.isStopped,o=r.observers;return s||a?E0:(this.currentObservers=null,o.push(t),new $o(function(){i.currentObservers=null,iu(o,t)}))},e.prototype._checkFinalizedStatuses=function(t){var i=this,r=i.hasError,s=i.thrownError,a=i.isStopped;r?t.error(s):a&&t.complete()},e.prototype.asObservable=function(){var t=new Ni;return t.source=this,t},e.create=function(t,i){return new D0(t,i)},e}(Ni),D0=function(n){zr(e,n);function e(t,i){var r=n.call(this)||this;return r.destination=t,r.source=i,r}return e.prototype.next=function(t){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.next)===null||r===void 0||r.call(i,t)},e.prototype.error=function(t){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.error)===null||r===void 0||r.call(i,t)},e.prototype.complete=function(){var t,i;(i=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||i===void 0||i.call(t)},e.prototype._subscribe=function(t){var i,r;return(r=(i=this.source)===null||i===void 0?void 0:i.subscribe(t))!==null&&r!==void 0?r:E0},e}(Hh),Gw=function(n){zr(e,n);function e(t){var i=n.call(this)||this;return i._value=t,i}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(t){var i=n.prototype._subscribe.call(this,t);return!i.closed&&t.next(this._value),i},e.prototype.getValue=function(){var t=this,i=t.hasError,r=t.thrownError,s=t._value;if(i)throw r;return this._throwIfClosed(),s},e.prototype.next=function(t){n.prototype.next.call(this,this._value=t)},e}(Hh),Kh={now:function(){return(Kh.delegate||Date).now()},delegate:void 0},qw=function(n){zr(e,n);function e(t,i,r){t===void 0&&(t=1/0),i===void 0&&(i=1/0),r===void 0&&(r=Kh);var s=n.call(this)||this;return s._bufferSize=t,s._windowTime=i,s._timestampProvider=r,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=i===1/0,s._bufferSize=Math.max(1,t),s._windowTime=Math.max(1,i),s}return e.prototype.next=function(t){var i=this,r=i.isStopped,s=i._buffer,a=i._infiniteTimeWindow,o=i._timestampProvider,l=i._windowTime;r||(s.push(t),!a&&s.push(o.now()+l)),this._trimBuffer(),n.prototype.next.call(this,t)},e.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var i=this._innerSubscribe(t),r=this,s=r._infiniteTimeWindow,a=r._buffer,o=a.slice(),l=0;l<o.length&&!t.closed;l+=s?1:2)t.next(o[l]);return this._checkFinalizedStatuses(t),i},e.prototype._trimBuffer=function(){var t=this,i=t._bufferSize,r=t._timestampProvider,s=t._buffer,a=t._infiniteTimeWindow,o=(a?1:2)*i;if(i<1/0&&o<s.length&&s.splice(0,s.length-o),!a){for(var l=r.now(),u=0,h=1;h<s.length&&s[h]<=l;h+=2)u=h;u&&s.splice(0,u+1)}},e}(Hh),Vw=function(n){zr(e,n);function e(t,i){return n.call(this)||this}return e.prototype.schedule=function(t,i){return this},e}($o),R0={setInterval:function(n,e){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];return setInterval.apply(void 0,Uo([n,e],Sa(t)))},clearInterval:function(n){return clearInterval(n)},delegate:void 0},Hw=function(n){zr(e,n);function e(t,i){var r=n.call(this,t,i)||this;return r.scheduler=t,r.work=i,r.pending=!1,r}return e.prototype.schedule=function(t,i){var r;if(i===void 0&&(i=0),this.closed)return this;this.state=t;var s=this.id,a=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(a,s,i)),this.pending=!0,this.delay=i,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(a,this.id,i),this},e.prototype.requestAsyncId=function(t,i,r){return r===void 0&&(r=0),R0.setInterval(t.flush.bind(t,this),r)},e.prototype.recycleAsyncId=function(t,i,r){if(r===void 0&&(r=0),r!=null&&this.delay===r&&this.pending===!1)return i;i!=null&&R0.clearInterval(i)},e.prototype.execute=function(t,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,i);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,i){var r=!1,s;try{this.work(t)}catch(a){r=!0,s=a||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var t=this,i=t.id,r=t.scheduler,s=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,iu(s,this),i!=null&&(this.id=this.recycleAsyncId(r,i,null)),this.delay=null,n.prototype.unsubscribe.call(this)}},e}(Vw),I0=function(){function n(e,t){t===void 0&&(t=n.now),this.schedulerActionCtor=e,this.now=t}return n.prototype.schedule=function(e,t,i){return t===void 0&&(t=0),new this.schedulerActionCtor(this,e).schedule(i,t)},n.now=Kh.now,n}(),Kw=function(n){zr(e,n);function e(t,i){i===void 0&&(i=I0.now);var r=n.call(this,t,i)||this;return r.actions=[],r._active=!1,r}return e.prototype.flush=function(t){var i=this.actions;if(this._active){i.push(t);return}var r;this._active=!0;do if(r=t.execute(t.state,t.delay))break;while(t=i.shift());if(this._active=!1,r){for(;t=i.shift();)t.unsubscribe();throw r}},e}(I0),Wh=new Kw(Hw),Ww=Wh,jr=new Ni(function(n){return n.complete()});function C0(n){return n&&Dt(n.schedule)}function Yw(n){return n[n.length-1]}function N0(n){return C0(Yw(n))?n.pop():void 0}var Yh=function(n){return n&&typeof n.length=="number"&&typeof n!="function"};function L0(n){return Dt(n==null?void 0:n.then)}function _0(n){return Dt(n[Vh])}function M0(n){return Symbol.asyncIterator&&Dt(n==null?void 0:n[Symbol.asyncIterator])}function k0(n){return new TypeError("You provided "+(n!==null&&typeof n=="object"?"an invalid object":"'"+n+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function zw(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var P0=zw();function O0(n){return Dt(n==null?void 0:n[P0])}function F0(n){return Iw(this,arguments,function(){var t,i,r,s;return b0(this,function(a){switch(a.label){case 0:t=n.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,xa(t.read())];case 3:return i=a.sent(),r=i.value,s=i.done,s?[4,xa(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,xa(r)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function B0(n){return Dt(n==null?void 0:n.getReader)}function Xr(n){if(n instanceof Ni)return n;if(n!=null){if(_0(n))return jw(n);if(Yh(n))return Xw(n);if(L0(n))return Jw(n);if(M0(n))return U0(n);if(O0(n))return Qw(n);if(B0(n))return Zw(n)}throw k0(n)}function jw(n){return new Ni(function(e){var t=n[Vh]();if(Dt(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Xw(n){return new Ni(function(e){for(var t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}function Jw(n){return new Ni(function(e){n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,x0)})}function Qw(n){return new Ni(function(e){var t,i;try{for(var r=Aa(n),s=r.next();!s.done;s=r.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){t={error:o}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(t)throw t.error}}e.complete()})}function U0(n){return new Ni(function(e){eD(n,e).catch(function(t){return e.error(t)})})}function Zw(n){return U0(F0(n))}function eD(n,e){var t,i,r,s;return Rw(this,void 0,void 0,function(){var a,o;return b0(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),t=Cw(n),l.label=1;case 1:return[4,t.next()];case 2:if(i=l.sent(),!!i.done)return[3,4];if(a=i.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),r={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(s=t.return)?[4,s.call(t)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function cs(n,e,t,i,r){i===void 0&&(i=0),r===void 0&&(r=!1);var s=e.schedule(function(){t(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(s),!r)return s}function $0(n,e){return e===void 0&&(e=0),Xi(function(t,i){t.subscribe(Oi(i,function(r){return cs(i,n,function(){return i.next(r)},e)},function(){return cs(i,n,function(){return i.complete()},e)},function(r){return cs(i,n,function(){return i.error(r)},e)}))})}function G0(n,e){return e===void 0&&(e=0),Xi(function(t,i){i.add(n.schedule(function(){return t.subscribe(i)},e))})}function tD(n,e){return Xr(n).pipe(G0(e),$0(e))}function iD(n,e){return Xr(n).pipe(G0(e),$0(e))}function rD(n,e){return new Ni(function(t){var i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}function nD(n,e){return new Ni(function(t){var i;return cs(t,e,function(){i=n[P0](),cs(t,e,function(){var r,s,a;try{r=i.next(),s=r.value,a=r.done}catch(o){t.error(o);return}a?t.complete():t.next(s)},0,!0)}),function(){return Dt(i==null?void 0:i.return)&&i.return()}})}function q0(n,e){if(!n)throw new Error("Iterable cannot be null");return new Ni(function(t){cs(t,e,function(){var i=n[Symbol.asyncIterator]();cs(t,e,function(){i.next().then(function(r){r.done?t.complete():t.next(r.value)})},0,!0)})})}function sD(n,e){return q0(F0(n),e)}function aD(n,e){if(n!=null){if(_0(n))return tD(n,e);if(Yh(n))return rD(n,e);if(L0(n))return iD(n,e);if(M0(n))return q0(n,e);if(O0(n))return nD(n,e);if(B0(n))return sD(n,e)}throw k0(n)}function Xt(n,e){return e?aD(n,e):Xr(n)}function Vt(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=N0(n);return Xt(n,t)}function au(n,e){var t=Dt(n)?n:function(){return n},i=function(r){return r.error(t())};return new Ni(i)}var oD=tu(function(n){return function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}});function qo(n,e){return new Promise(function(t,i){var r=new nu({next:function(s){t(s),r.unsubscribe()},error:i,complete:function(){i(new oD)}});n.subscribe(r)})}function V0(n){return n instanceof Date&&!isNaN(n)}var zh=tu(function(n){return function(t){t===void 0&&(t=null),n(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=t}});function ou(n,e){var t=V0(n)?{first:n}:typeof n=="number"?{each:n}:n,i=t.first,r=t.each,s=t.with,a=s===void 0?lD:s,o=t.scheduler,l=o===void 0?Wh:o,u=t.meta,h=u===void 0?null:u;if(i==null&&r==null)throw new TypeError("No timeout provided.");return Xi(function(d,p){var g,m,y=null,b=0,A=function(w){m=cs(p,l,function(){try{g.unsubscribe(),Xr(a({meta:h,lastValue:y,seen:b})).subscribe(p)}catch(x){p.error(x)}},w)};g=d.subscribe(Oi(p,function(w){m==null||m.unsubscribe(),b++,p.next(y=w),r>0&&A(r)},void 0,void 0,function(){m!=null&&m.closed||m==null||m.unsubscribe(),y=null})),!b&&A(i!=null?typeof i=="number"?i:+i-l.now():r)})}function lD(n){throw new zh(n)}function Ht(n,e){return Xi(function(t,i){var r=0;t.subscribe(Oi(i,function(s){i.next(n.call(e,s,r++))}))})}var uD=Array.isArray;function cD(n,e){return uD(e)?n.apply(void 0,Uo([],Sa(e))):n(e)}function hD(n){return Ht(function(e){return cD(n,e)})}function dD(n,e,t,i,r,s,a,o){var l=[],u=0,h=0,d=!1,p=function(){d&&!l.length&&!u&&e.complete()},g=function(y){return u<i?m(y):l.push(y)},m=function(y){u++;var b=!1;Xr(t(y,h++)).subscribe(Oi(e,function(A){e.next(A)},function(){b=!0},void 0,function(){if(b)try{u--;for(var A=function(){var w=l.shift();a||m(w)};l.length&&u<i;)A();p()}catch(w){e.error(w)}}))};return n.subscribe(Oi(e,g,function(){d=!0,p()})),function(){}}function jh(n,e,t){return t===void 0&&(t=1/0),Dt(e)?jh(function(i,r){return Ht(function(s,a){return e(i,s,r,a)})(Xr(n(i,r)))},t):(typeof e=="number"&&(t=e),Xi(function(i,r){return dD(i,r,n,t)}))}function fD(n){return jh(Go,n)}function gD(){return fD(1)}function pD(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return gD()(Xt(n,N0(n)))}var mD=["addListener","removeListener"],yD=["addEventListener","removeEventListener"],vD=["on","off"];function Xh(n,e,t,i){if(Dt(t)&&(i=t,t=void 0),i)return Xh(n,e,t).pipe(hD(i));var r=Sa(AD(n)?yD.map(function(o){return function(l){return n[o](e,l,t)}}):bD(n)?mD.map(H0(n,e)):ED(n)?vD.map(H0(n,e)):[],2),s=r[0],a=r[1];if(!s&&Yh(n))return jh(function(o){return Xh(o,e,t)})(Xr(n));if(!s)throw new TypeError("Invalid event target");return new Ni(function(o){var l=function(){for(var u=[],h=0;h<arguments.length;h++)u[h]=arguments[h];return o.next(1<u.length?u:u[0])};return s(l),function(){return a(l)}})}function H0(n,e){return function(t){return function(i){return n[t](e,i)}}}function bD(n){return Dt(n.addListener)&&Dt(n.removeListener)}function ED(n){return Dt(n.on)&&Dt(n.off)}function AD(n){return Dt(n.addEventListener)&&Dt(n.removeEventListener)}function SD(n,e,t){return new Ni(function(i){var r=function(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];return i.next(a.length===1?a[0]:a)},s=n(r);return Dt(e)?function(){return e(r,s)}:void 0})}function lu(n,e,t){n===void 0&&(n=0),t===void 0&&(t=Ww);var i=-1;return e!=null&&(C0(e)?t=e:i=e),new Ni(function(r){var s=V0(n)?+n-t.now():n;s<0&&(s=0);var a=0;return t.schedule(function(){r.closed||(r.next(a++),0<=i?this.schedule(void 0,i):r.complete())},s)})}function Jr(n,e){return n===void 0&&(n=0),e===void 0&&(e=Wh),n<0&&(n=0),lu(n,n,e)}function Zt(n,e){return Xi(function(t,i){var r=0;t.subscribe(Oi(i,function(s){return n.call(e,s,r++)&&i.next(s)}))})}function Ks(n){return Xi(function(e,t){var i=null,r=!1,s;i=e.subscribe(Oi(t,void 0,void 0,function(a){s=Xr(n(a,Ks(n)(e))),i?(i.unsubscribe(),i=null,s.subscribe(t)):r=!0})),r&&(i.unsubscribe(),i=null,s.subscribe(t))})}function K0(n){return Xi(function(e,t){var i=!1;e.subscribe(Oi(t,function(r){i=!0,t.next(r)},function(){i||t.next(n),t.complete()}))})}function Rn(n){return n<=0?function(){return jr}:Xi(function(e,t){var i=0;e.subscribe(Oi(t,function(r){++i<=n&&(t.next(r),n<=i&&t.complete())}))})}function W0(n,e){return e===void 0&&(e=Go),n=n??xD,Xi(function(t,i){var r,s=!0;t.subscribe(Oi(i,function(a){var o=e(a);(s||!n(r,o))&&(s=!1,r=o,i.next(a))}))})}function xD(n,e){return n===e}function Y0(n){return Xi(function(e,t){try{e.subscribe(t)}finally{t.add(n)}})}function z0(n){n===void 0&&(n=1/0);var e;n&&typeof n=="object"?e=n:e={count:n};var t=e.count,i=t===void 0?1/0:t,r=e.delay,s=e.resetOnSuccess,a=s===void 0?!1:s;return i<=0?Go:Xi(function(o,l){var u=0,h,d=function(){var p=!1;h=o.subscribe(Oi(l,function(g){a&&(u=0),l.next(g)},void 0,function(g){if(u++<i){var m=function(){h?(h.unsubscribe(),h=null,d()):p=!0};if(r!=null){var y=typeof r=="number"?lu(r):Xr(r(g,u)),b=Oi(l,function(){b.unsubscribe(),m()},function(){l.complete()});y.subscribe(b)}else m()}else l.error(g)})),p&&(h.unsubscribe(),h=null,d())};d()})}function vt(n,e){return Xi(function(t,i){var r=null,s=0,a=!1,o=function(){return a&&!r&&i.complete()};t.subscribe(Oi(i,function(l){r==null||r.unsubscribe();var u=0,h=s++;Xr(n(l,h)).subscribe(r=Oi(i,function(d){return i.next(e?e(l,d,h,u++):d)},function(){r=null,o()}))},function(){a=!0,o()}))})}function Ws(n,e,t){var i=Dt(n)||e||t?{next:n,error:e,complete:t}:n;return i?Xi(function(r,s){var a;(a=i.subscribe)===null||a===void 0||a.call(i);var o=!0;r.subscribe(Oi(s,function(l){var u;(u=i.next)===null||u===void 0||u.call(i,l),s.next(l)},function(){var l;o=!1,(l=i.complete)===null||l===void 0||l.call(i),s.complete()},function(l){var u;o=!1,(u=i.error)===null||u===void 0||u.call(i,l),s.error(l)},function(){var l,u;o&&((l=i.unsubscribe)===null||l===void 0||l.call(i)),(u=i.finalize)===null||u===void 0||u.call(i)}))}):Go}class si{constructor(e,t,i){X(this,"matchResult");X(this,"parsedQs");X(this,"map",new Map);this.media=e,this.tabTitle=t,this.data=i}computeUrlMatchResultIfAbsent(e){return this.matchResult??(this.matchResult=e())}computeParsedQsIfAbsent(e){return this.parsedQs??(this.parsedQs=e())}setParam(e,t){this.map.set(e,t)}getParam(e){return this.map.get(e)}}class ei extends Error{}class hs extends Error{}var Ys=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})},Qr=function(n){return this instanceof Qr?(this.v=n,this):new Qr(n)},j0=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof Qr?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},mi;(function(n){n[n.SHORTEST=0]="SHORTEST",n[n.LONGEST=1]="LONGEST",n[n.STRICT_EQUAL=2]="STRICT_EQUAL"})(mi||(mi={}));function*Ta(n,e,...t){if(t.length===0)return;const i=[];for(const r of t)i.push(vy(r));e:for(;;){const r=hd.map(i,l=>l.next()),s=[];let a=!0,o=!1;for(const l of r){let u;l.done?(a=!1,u=e):(o=!0,u=l.value),s.push(u)}if(!a&&o)switch(n){case mi.SHORTEST:break e;case mi.STRICT_EQUAL:throw new hs("Iterators must have equal lengths")}if(!o)break;yield s}}function wa(n,e,...t){return j0(this,arguments,function*(){if(t.length===0)return yield Qr(void 0);const r=[];for(const s of t)r.push(by(s));e:for(;;){const s=[];for(const u of r){const h=yield Qr(u.next());s.push(h)}const a=[];let o=!0,l=!1;for(const u of s){let h;u.done?(o=!1,h=e):(l=!0,h=u.value),a.push(h)}if(!o&&l)switch(n){case mi.SHORTEST:break e;case mi.STRICT_EQUAL:throw new hs("Iterators must have equal lengths")}if(!l)break;yield yield Qr(a)}})}class uu{constructor(){this.addedMap=new Map,this.deletedMap=new Map}addUsage(e,t){this.addedMap.has(e)||this.addedMap.set(e,new Map);const i=this.addedMap.get(e);i.has(t)||i.set(t,0),i.set(t,i.get(t)+1)}deleteUsage(e){this.deletedMap.has(e)?this.deletedMap.set(e,this.deletedMap.get(e)+1):this.deletedMap.set(e,1)}getOwnersCount(e){var t,i;const r=(t=this.deletedMap.get(e))!==null&&t!==void 0?t:0;return sr.of((i=this.addedMap.get(e))!==null&&i!==void 0?i:new Map).map(s=>s[1]).filter(s=>s>r).toValue(s=>s+1,0)}getUsagesCount(e,t=1){var i,r;const s=(i=this.deletedMap.get(e))!==null&&i!==void 0?i:0;let a=sr.of((r=this.addedMap.get(e))!==null&&r!==void 0?r:new Map).map(o=>o[1]).map(o=>o-s).filter(o=>o>0).toArray();for(;a.length>t;){const o=rv.toMin(a);a=sr.of(a).map(l=>l-o).filter(l=>l>0).toArray()}return rv.toSum(a)}}class Li{}class TD{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.iterator=e;for(let i=0;i<t;++i)this.related.push(new wD(this,i)),this.positions.push(0);this.cacheNextValue()}current(e){const t=this.getPosition(e);return this.cache.get(t)}next(e){const[t,i,r]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===r&&this.cacheNextValue(),this.positions[e.getId()]++,i<Math.min(...this.positions)&&this.cache.delete(i)}valid(e){return this.getPosition(e)<this.lastCacheIndex||this.isValid}getRelatedIterables(){return this.related}cacheNextValue(){const e=this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isValid=!e.done}getPosition(e){return this.positions[e.getId()]}}class wD{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return this.parent.valid(this)}next(){const e={value:this.current(),done:!this.valid()};return e.done||this.parent.next(this),e}current(){return this.parent.valid(this)?this.parent.current(this):void 0}*[Symbol.iterator](){for(;this.parent.valid(this);)yield this.parent.current(this),this.parent.next(this)}}class DD{constructor(e,t){this.related=[],this.positions=[],this.cache=new Map,this.lastCacheIndex=0,this.isValid=!0,this.isFirstIteration=!0,this.iterator=e;for(let i=0;i<t;++i)this.related.push(new RD(this,i)),this.positions.push(0)}current(e){return Ys(this,void 0,void 0,function*(){this.isFirstIteration&&(yield this.cacheNextValue());const t=this.getPosition(e);return this.cache.get(t)})}next(e){return Ys(this,void 0,void 0,function*(){const[t,i,r]=[this.getPosition(e),Math.min(...this.positions),Math.max(...this.positions)];t===r&&(yield this.cacheNextValue()),this.positions[e.getId()]++,i<Math.min(...this.positions)&&this.cache.delete(i)})}valid(e){return Ys(this,void 0,void 0,function*(){return this.isFirstIteration&&(yield this.cacheNextValue()),this.getPosition(e)<this.lastCacheIndex||this.isValid})}getRelatedIterables(){return this.related}cacheNextValue(){return Ys(this,void 0,void 0,function*(){const e=yield this.iterator.next();e.done||this.cache.set(this.lastCacheIndex++,e.value),this.isFirstIteration=!1,this.isValid=!e.done})}getPosition(e){return this.positions[e.getId()]}}class RD{constructor(e,t){this.parent=e,this.id=t}getId(){return this.id}valid(){return Ys(this,void 0,void 0,function*(){return yield this.parent.valid(this)})}next(){return Ys(this,void 0,void 0,function*(){const e={value:yield this.current(),done:!(yield this.valid())};return e.done||(yield this.parent.next(this)),e})}current(){return Ys(this,void 0,void 0,function*(){return(yield this.parent.valid(this))?yield this.parent.current(this):void 0})}[Symbol.asyncIterator](){return j0(this,arguments,function*(){for(;yield Qr(this.parent.valid(this));)yield yield Qr(yield Qr(this.parent.current(this))),yield Qr(this.parent.next(this))})}}var Vo=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},yi=function(n){return this instanceof yi?(this.v=n,this):new yi(n)},Ho=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof yi?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*X0(...n){for(const e of Ta(mi.SHORTEST,void 0,...n))yield e}function J0(...n){return Ho(this,arguments,function*(){var t,i,r,s;try{for(var a=!0,o=Vo(wa(mi.SHORTEST,void 0,...n)),l;l=yield yi(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield yi(s)}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield yi(r.call(o)))}finally{if(i)throw i.error}}})}function*ID(n,...e){for(const t of Ta(mi.LONGEST,n,...e))yield t}function CD(n,...e){return Ho(this,arguments,function*(){var i,r,s,a;try{for(var o=!0,l=Vo(wa(mi.LONGEST,n,...e)),u;u=yield yi(l.next()),i=u.done,!i;o=!0)a=u.value,o=!1,yield yield yi(a)}catch(h){r={error:h}}finally{try{!o&&!i&&(s=l.return)&&(yield yi(s.call(l)))}finally{if(r)throw r.error}}})}function*ND(...n){for(const e of Ta(mi.LONGEST,void 0,...n))yield e}function LD(...n){return Ho(this,arguments,function*(){var t,i,r,s;try{for(var a=!0,o=Vo(wa(mi.LONGEST,void 0,...n)),l;l=yield yi(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield yi(s)}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield yi(r.call(o)))}finally{if(i)throw i.error}}})}function*Q0(...n){for(const e of Ta(mi.STRICT_EQUAL,void 0,...n))yield e}function Z0(...n){return Ho(this,arguments,function*(){var t,i,r,s;try{for(var a=!0,o=Vo(wa(mi.STRICT_EQUAL,void 0,...n)),l;l=yield yi(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield yi(s)}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield yi(r.call(o)))}finally{if(i)throw i.error}}})}function*_D(...n){for(const e of n)for(const t of it(e))yield t}function MD(...n){return Ho(this,arguments,function*(){var t,i,r,s;for(const u of n)try{for(var a=!0,o=(i=void 0,Vo(Xe(u))),l;l=yield yi(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield yi(s)}catch(h){i={error:h}}finally{try{!a&&!t&&(r=o.return)&&(yield yi(r.call(o)))}finally{if(i)throw i.error}}})}var Fi=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})},cu=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}};function kr(n,e,t){let i=t;for(const r of it(n))i=e(i,r);return i}function Pr(n,e,t){return Fi(this,void 0,void 0,function*(){var i,r,s,a;let o=t;try{for(var l=!0,u=cu(Xe(n)),h;h=yield u.next(),i=h.done,!i;l=!0)a=h.value,l=!1,o=yield e(o,a)}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield s.call(u))}finally{if(r)throw r.error}}return o})}function ey(n){const[e,t]=kr(n,(i,r)=>{const[s,a]=i;return[s+1,a+Number(r)]},[0,0]);return e?t/e:void 0}function ty(n){return Fi(this,void 0,void 0,function*(){const[e,t]=yield Pr(n,(i,r)=>{const[s,a]=i;return[s+1,a+Number(r)]},[0,0]);return e?t/e:void 0})}function iy(n,e){return e!==void 0?kr(n,(t,i)=>e(i)>e(t??i)?i:t??i):kr(n,(t,i)=>{const r=t??i,s=i;return r>=s?r:s})}function ry(n,e){return Fi(this,void 0,void 0,function*(){return e!==void 0?yield Pr(n,(t,i)=>Fi(this,void 0,void 0,function*(){return(yield e(i))>(yield e(t??i))?i:t??i})):yield Pr(n,(t,i)=>{const r=t??i,s=i;return r>=s?r:s})})}function ny(n,e){return e!==void 0?kr(n,(t,i)=>e(i)<e(t??i)?i:t??i):kr(n,(t,i)=>{const r=t??i,s=i;return r<=s?r:s})}function sy(n,e){return Fi(this,void 0,void 0,function*(){return e!==void 0?yield Pr(n,(t,i)=>Fi(this,void 0,void 0,function*(){return(yield e(i))<(yield e(t??i))?i:t??i})):yield Pr(n,(t,i)=>{const r=t??i,s=i;return r<=s?r:s})})}function Jh(n,e){const t=e!==void 0?e:i=>i;return kr(n,(i,r)=>{var s,a,o,l;return i=i,[t(r)<=t((s=i[0])!==null&&s!==void 0?s:r)?r:(a=i[0])!==null&&a!==void 0?a:r,t(r)>=t((o=i[1])!==null&&o!==void 0?o:r)?r:(l=i[1])!==null&&l!==void 0?l:r]},[void 0,void 0])}function Qh(n,e){return Fi(this,void 0,void 0,function*(){const t=e!==void 0?e:i=>i;return yield Pr(n,(i,r)=>Fi(this,void 0,void 0,function*(){var s,a,o,l;return i=i,[(yield t(r))<=(yield t((s=i[0])!==null&&s!==void 0?s:r))?r:(a=i[0])!==null&&a!==void 0?a:r,(yield t(r))>=(yield t((o=i[1])!==null&&o!==void 0?o:r))?r:(l=i[1])!==null&&l!==void 0?l:r]}),[void 0,void 0])})}function ay(n){const[e,t]=Jh(fu(n,i=>Number(i)));return(t??0)-(e??0)}function oy(n){return Fi(this,void 0,void 0,function*(){const[e,t]=yield Qh(zo(n,i=>Number(i)));return(t??0)-(e??0)})}function ly(n){return kr(n,(e,t)=>e+Number(t),0)}function uy(n){return Fi(this,void 0,void 0,function*(){return yield Pr(n,(e,t)=>e+Number(t),0)})}function cy(n){return kr(n,(e,t)=>(e??1)*t)}function hy(n){return Fi(this,void 0,void 0,function*(){return yield Pr(n,(e,t)=>(e??1)*t)})}function hu(n){switch(!0){case n instanceof Array:return n.length;case Da(n):return n.length;case n instanceof Set:return n.size;case n instanceof Map:return n.size}return kr(n,e=>e+1,0)}function Zh(n){return Fi(this,void 0,void 0,function*(){switch(!0){case n instanceof Array:case Da(n):case n instanceof Set:case n instanceof Map:return hu(n)}return yield Pr(n,e=>e+1,0)})}function dy(n){for(const e of it(n))return e;throw new hs("Collection is empty")}function fy(n){return Fi(this,void 0,void 0,function*(){var e,t,i,r;try{for(var s=!0,a=cu(Xe(n)),o;o=yield a.next(),e=o.done,!e;s=!0)return r=o.value,s=!1,r}catch(l){t={error:l}}finally{try{!s&&!e&&(i=a.return)&&(yield i.call(a))}finally{if(t)throw t.error}}throw new hs("Collection is empty")})}function gy(n){let e=!0,t;for(const i of it(n))t=i,e=!1;if(e)throw new hs("Collection is empty");return t}function py(n){return Fi(this,void 0,void 0,function*(){var e,t,i,r;let s=!0,a;try{for(var o=!0,l=cu(Xe(n)),u;u=yield l.next(),e=u.done,!e;o=!0)r=u.value,o=!1,a=r,s=!1}catch(h){t={error:h}}finally{try{!o&&!e&&(i=l.return)&&(yield i.call(l))}finally{if(t)throw t.error}}if(s)throw new hs("Collection is empty");return a})}function my(n){let e=Li,t=Li;for(const i of it(n))e===Li&&(e=i),t=i;if(e===Li)throw new hs("Collection is empty");return[e,t]}function yy(n){return Fi(this,void 0,void 0,function*(){var e,t,i,r;let s=Li,a=Li;try{for(var o=!0,l=cu(Xe(n)),u;u=yield l.next(),e=u.done,!e;o=!0){r=u.value,o=!1;const h=r;s===Li&&(s=h),a=h}}catch(h){t={error:h}}finally{try{!o&&!e&&(i=l.return)&&(yield i.call(l))}finally{if(t)throw t.error}}if(s===Li)throw new hs("Collection is empty");return[s,a]})}var Zr=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})},ds=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}};function kD(n,e){for(const t of it(n))if(!e(t))return!1;return!0}function PD(n,e){return Zr(this,void 0,void 0,function*(){var t,i,r,s;try{for(var a=!0,o=ds(Xe(n)),l;l=yield o.next(),t=l.done,!t;a=!0)if(s=l.value,a=!1,!(yield e(s)))return!1}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(i)throw i.error}}return!0})}function OD(n){const e=new Set;for(const t of it(n)){if(e.has(t))return!1;e.add(t)}return!0}function FD(n){return Zr(this,void 0,void 0,function*(){var e,t,i,r;const s=new Set;try{for(var a=!0,o=ds(Xe(n)),l;l=yield o.next(),e=l.done,!e;a=!0){r=l.value,a=!1;const u=r;if(s.has(u))return!1;s.add(u)}}catch(u){t={error:u}}finally{try{!a&&!e&&(i=o.return)&&(yield i.call(o))}finally{if(t)throw t.error}}return!0})}function BD(n,e){for(const t of it(n))if(e(t))return!0;return!1}function UD(n,e){return Zr(this,void 0,void 0,function*(){var t,i,r,s;try{for(var a=!0,o=ds(Xe(n)),l;l=yield o.next(),t=l.done,!t;a=!0)if(s=l.value,a=!1,yield e(s))return!0}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(i)throw i.error}}return!1})}function $D(n,e,t){if(e<0)return!1;t===void 0&&(t=r=>!!r);let i=0;for(const r of it(n))if(t(r)&&(i++,i>e))return!1;return i===e}function GD(n,e,t){return Zr(this,void 0,void 0,function*(){var i,r,s,a;if(e<0)return!1;t===void 0&&(t=d=>!!d);let o=0;try{for(var l=!0,u=ds(Xe(n)),h;h=yield u.next(),i=h.done,!i;l=!0)if(a=h.value,l=!1,(yield t(a))&&(o++,o>e))return!1}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield s.call(u))}finally{if(r)throw r.error}}return o===e})}function en(n){return n==null?!1:typeof n[Symbol.iterator]=="function"}function Ko(n){return n==null?!1:typeof n[Symbol.asyncIterator]=="function"}function fs(n){return n==null?!1:n.next!==void 0&&typeof n.next=="function"}function qD(n){for(const[e,t]of Ia(it(n)))if(e<t)return!1;return!0}function VD(n){return Zr(this,void 0,void 0,function*(){var e,t,i,r;try{for(var s=!0,a=ds(mu(Xe(n))),o;o=yield a.next(),e=o.done,!e;s=!0){r=o.value,s=!1;const[l,u]=r;if(l<u)return!1}}catch(l){t={error:l}}finally{try{!s&&!e&&(i=a.return)&&(yield i.call(a))}finally{if(t)throw t.error}}return!0})}function HD(n){for(const[e,t]of Ia(it(n)))if(e>t)return!1;return!0}function KD(n){return Zr(this,void 0,void 0,function*(){var e,t,i,r;try{for(var s=!0,a=ds(mu(Xe(n))),o;o=yield a.next(),e=o.done,!e;s=!0){r=o.value,s=!1;const[l,u]=r;if(l>u)return!1}}catch(l){t={error:l}}finally{try{!s&&!e&&(i=a.return)&&(yield i.call(a))}finally{if(t)throw t.error}}return!0})}function Da(n){return typeof n=="string"||n instanceof String}function WD(n,e){for(const t of it(n))if(e(t))return!1;return!0}function YD(n,e){return Zr(this,void 0,void 0,function*(){var t,i,r,s;try{for(var a=!0,o=ds(Xe(n)),l;l=yield o.next(),t=l.done,!t;a=!0)if(s=l.value,a=!1,yield e(s))return!1}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(i)throw i.error}}return!0})}function zD(...n){try{for(const e of Q0(...n))for(const[t,i]of Ia(e))if(t!==i)return!1}catch{return!1}return!0}function jD(...n){return Zr(this,void 0,void 0,function*(){var e,t,i,r;try{try{for(var s=!0,a=ds(Z0(...n)),o;o=yield a.next(),e=o.done,!e;s=!0){r=o.value,s=!1;const l=r;for(const[u,h]of Ia(l))if(u!==h)return!1}}catch(l){t={error:l}}finally{try{!s&&!e&&(i=a.return)&&(yield i.call(a))}finally{if(t)throw t.error}}}catch{return!1}return!0})}function XD(...n){if(n.length<=1)return!0;const e=n.map(t=>hu(t));return new Set(e).size===1}function JD(...n){return Zr(this,void 0,void 0,function*(){if(n.length<=1)return!0;const e=yield zo(n,t=>Zr(this,void 0,void 0,function*(){return yield Zh(t)}));return new Set(yield zs(e)).size===1})}var ed=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})},tn=function(n){return this instanceof tn?(this.v=n,this):new tn(n)},td=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof tn?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},du=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}};function it(n){if(en(n))return n;if(fs(n))return{[Symbol.iterator](){return n}};if(typeof n=="object"&&n!==null)return function*(){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&(yield[e,n[e]])}();throw new ei("Given collection is not iterable or iterator.")}function Xe(n){if(Ko(n))return n;if(fs(n))return{[Symbol.asyncIterator](){return td(this,arguments,function*(){for(;;){const t=yield tn(n.next());if(t.done)return yield tn(void 0);yield yield tn(t.value)}})}};if(typeof n=="object"&&n!==null&&(n=it(n)),en(n))return{[Symbol.asyncIterator](){return td(this,arguments,function*(){for(const t of n)yield yield tn(t)})}};throw new ei("Given collection is not async iterable or iterator.")}function vy(n){if(fs(n))return n;if(en(n))return function*(){for(const e of n)yield e}();throw new ei("Given collection is not iterable or iterator.")}function by(n){if((fs(n)||en(n))&&(n=Xe(n)),Ko(n))return function(){return td(this,arguments,function*(){var e,t,i,r;try{for(var s=!0,a=du(n),o;o=yield tn(a.next()),e=o.done,!e;s=!0)r=o.value,s=!1,yield yield tn(r)}catch(l){t={error:l}}finally{try{!s&&!e&&(i=a.return)&&(yield tn(i.call(a)))}finally{if(t)throw t.error}}})}();throw new ei("Given collection is not iterable or iterator.")}function Ra(n){if(Array.isArray(n))return n;const e=[];for(const t of it(n))e.push(t);return e}function zs(n){return ed(this,void 0,void 0,function*(){var e,t,i,r;if(Array.isArray(n))return n;const s=[];try{for(var a=!0,o=du(Xe(n)),l;l=yield o.next(),e=l.done,!e;a=!0){r=l.value,a=!1;const u=r;s.push(u)}}catch(u){t={error:u}}finally{try{!a&&!e&&(i=o.return)&&(yield i.call(o))}finally{if(t)throw t.error}}return s})}function QD(n){const e=new Map;for(const[t,i]of it(n))e.set(t,i);return e}function ZD(n){return ed(this,void 0,void 0,function*(){var e,t,i,r;const s=new Map;try{for(var a=!0,o=du(Xe(n)),l;l=yield o.next(),e=l.done,!e;a=!0){r=l.value,a=!1;const[u,h]=r;s.set(u,h)}}catch(u){t={error:u}}finally{try{!a&&!e&&(i=o.return)&&(yield i.call(o))}finally{if(t)throw t.error}}return s})}function eR(n){const e=new Set;for(const t of it(n))e.add(t);return e}function tR(n){return ed(this,void 0,void 0,function*(){var e,t,i,r;const s=new Set;try{for(var a=!0,o=du(Xe(n)),l;l=yield o.next(),e=l.done,!e;a=!0){r=l.value,a=!1;const u=r;s.add(u)}}catch(u){t={error:u}}finally{try{!a&&!e&&(i=o.return)&&(yield i.call(o))}finally{if(t)throw t.error}}return s})}function id(n,e){return new TD(vy(n),e).getRelatedIterables()}function rd(n,e){return new DD(by(n),e).getRelatedIterables()}var Ti=function(n){return this instanceof Ti?(this.v=n,this):new Ti(n)},Wo=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Yo=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof Ti?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},Ey=function(n){var e,t;return e={},i("next"),i("throw",function(r){throw r}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(r,s){e[r]=n[r]?function(a){return(t=!t)?{value:Ti(n[r](a)),done:!1}:s?s(a):a}:s}};function*nd(n,e){const t=new Set;if(n instanceof Map){e===void 0&&(e=i=>i[1]);for(const i of n){const r=e(i);t.has(r)||(yield i,t.add(r))}}else{e===void 0&&(e=i=>i);for(const i of it(n)){const r=e(i);t.has(r)||(yield i,t.add(r))}}}function Ay(n,e){return Yo(this,arguments,function*(){var i,r,s,a;const o=new Set;if(n instanceof Map)for(const d of nd(n,e))yield yield Ti(yield Ti(d));else{e===void 0&&(e=d=>d);try{for(var l=!0,u=Wo(Xe(n)),h;h=yield Ti(u.next()),i=h.done,!i;l=!0){a=h.value,l=!1;const d=a,p=e(d);o.has(p)||(yield yield Ti(d),o.add(p))}}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ti(s.call(u)))}finally{if(r)throw r.error}}}})}function*iR(...n){yield*sd(n.length,...n)}function rR(...n){return Yo(this,arguments,function*(){yield Ti(yield*Ey(Wo(ad(n.length,...n))))})}function*sd(n,...e){const t=new uu,i=Ta(mi.LONGEST,Li,...e);for(const r of i)for(const[s,a]of Ca(r))a!==Li&&(t.addUsage(a,`${s}`),t.getOwnersCount(a)===n&&(yield a,t.deleteUsage(a)))}function ad(n,...e){return Yo(this,arguments,function*(){var i,r,s,a;const o=new uu,l=wa(mi.LONGEST,Li,...e);try{for(var u=!0,h=Wo(l),d;d=yield Ti(h.next()),i=d.done,!i;u=!0){a=d.value,u=!1;const p=a;for(const[g,m]of Ca(p))m!==Li&&(o.addUsage(m,`${g}`),o.getOwnersCount(m)===n&&(yield yield Ti(m),o.deleteUsage(m)))}}catch(p){r={error:p}}finally{try{!u&&!i&&(s=h.return)&&(yield Ti(s.call(h)))}finally{if(r)throw r.error}}})}function*nR(...n){const e=new uu,t=new Set,i=Ta(mi.LONGEST,Li,...n);for(const r of i)for(const[s,a]of Ca(r))a!==Li&&(e.addUsage(a,`${s}`),t.add(a),e.getOwnersCount(a)===n.length&&e.deleteUsage(a));for(const r of t)for(const s of hd.repeat(r,e.getUsagesCount(r)))yield s}function sR(...n){return Yo(this,arguments,function*(){var t,i,r,s;const a=new uu,o=new Set,l=wa(mi.LONGEST,Li,...n);try{for(var u=!0,h=Wo(l),d;d=yield Ti(h.next()),t=d.done,!t;u=!0){s=d.value,u=!1;const p=s;for(const[g,m]of Ca(p))m!==Li&&(a.addUsage(m,`${g}`),o.add(m),a.getOwnersCount(m)===n.length&&a.deleteUsage(m))}}catch(p){i={error:p}}finally{try{!u&&!t&&(r=h.return)&&(yield Ti(r.call(h)))}finally{if(i)throw i.error}}for(const p of o)for(const g of hd.repeat(p,a.getUsagesCount(p)))yield yield Ti(g)})}function*aR(...n){yield*sd(1,...n)}function oR(...n){return Yo(this,arguments,function*(){yield Ti(yield*Ey(Wo(ad(1,...n))))})}var ai=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},we=function(n){return this instanceof we?(this.v=n,this):new we(n)},ui=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof we?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*fu(n,e){for(const t of it(n))yield e(t)}function zo(n,e){return ui(this,arguments,function*(){var i,r,s,a;try{for(var o=!0,l=ai(Xe(n)),u;u=yield we(l.next()),i=u.done,!i;o=!0)a=u.value,o=!1,yield yield we(yield we(e(a)))}catch(h){r={error:h}}finally{try{!o&&!i&&(s=l.return)&&(yield we(s.call(l)))}finally{if(r)throw r.error}}})}function*Sy(n,e){for(const[t,i]of X0(n,e))i&&(yield t)}function xy(n,e){return ui(this,arguments,function*(){var i,r,s,a;try{for(var o=!0,l=ai(J0(n,e)),u;u=yield we(l.next()),i=u.done,!i;o=!0){a=u.value,o=!1;const[h,d]=a;d&&(yield yield we(h))}}catch(h){r={error:h}}finally{try{!o&&!i&&(s=l.return)&&(yield we(s.call(l)))}finally{if(r)throw r.error}}})}function*Ty(n,e){let t=!0;for(const i of it(n)){if(t){if(!e(i)){t=!1,yield i;continue}continue}yield i}}function wy(n,e){return ui(this,arguments,function*(){var i,r,s,a;let o=!0;try{for(var l=!0,u=ai(Xe(n)),h;h=yield we(u.next()),i=h.done,!i;l=!0){a=h.value,l=!1;const d=a;if(o){if(!(yield we(e(d)))){o=!1,yield yield we(d);continue}continue}yield yield we(d)}}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield we(s.call(u)))}finally{if(r)throw r.error}}})}function*Dy(n,e){for(const t of it(n))if(e(t))yield t;else break}function Ry(n,e){return ui(this,arguments,function*(){var i,r,s,a;try{for(var o=!0,l=ai(Xe(n)),u;u=yield we(l.next()),i=u.done,!i;o=!0){a=u.value,o=!1;const h=a;if(yield we(e(h)))yield yield we(h);else break}}catch(h){r={error:h}}finally{try{!o&&!i&&(s=l.return)&&(yield we(s.call(l)))}finally{if(r)throw r.error}}})}function*lR(n,e){if(e<0)throw new ei(`Number of repetitions cannot be negative: ${e}`);for(let t=e;t>0;--t)yield n}function uR(n,e){return ui(this,arguments,function*(){if(e<0)throw new ei(`Number of repetitions cannot be negative: ${e}`);const i=yield we(n);for(let r=e;r>0;--r)yield yield we(i)})}function*Iy(n,e){for(const t of it(n)){const i=e(t,e);if(en(i))for(const r of it(i))yield r;else yield i}}function Cy(n,e){return ui(this,arguments,function*(){var i,r,s,a,o,l,u,h;try{for(var d=!0,p=ai(Xe(n)),g;g=yield we(p.next()),i=g.done,!i;d=!0){a=g.value,d=!1;const w=yield we(e(a,e));if(en(w)||Ko(w))try{for(var m=!0,y=(l=void 0,ai(Xe(w))),b;b=yield we(y.next()),o=b.done,!o;m=!0)h=b.value,m=!1,yield yield we(h)}catch(x){l={error:x}}finally{try{!m&&!o&&(u=y.return)&&(yield we(u.call(y)))}finally{if(l)throw l.error}}else yield yield we(w)}}catch(A){r={error:A}}finally{try{!d&&!i&&(s=p.return)&&(yield we(s.call(p)))}finally{if(r)throw r.error}}})}function*od(n,e=1/0){if(e<1){for(let t of it(n))n instanceof Map&&(t=t[1]),yield t;return}for(let t of it(n))if(n instanceof Map&&(t=t[1]),(en(t)||fs(t))&&!Da(t))for(const i of od(t,e-1))yield i;else yield t}function ld(n){return ui(this,arguments,function*(t,i=1/0){var r,s,a,o,l,u,h,d,p,g,m,y;if(i<1){try{for(var b=!0,A=ai(Xe(t)),w;w=yield we(A.next()),r=w.done,!r;b=!0){o=w.value,b=!1;let _=o;t instanceof Map&&(_=_[1]),yield yield we(_)}}catch(_){s={error:_}}finally{try{!b&&!r&&(a=A.return)&&(yield we(a.call(A)))}finally{if(s)throw s.error}}return yield we(void 0)}try{for(var x=!0,N=ai(Xe(t)),F;F=yield we(N.next()),l=F.done,!l;x=!0){d=F.value,x=!1;let _=d;if(t instanceof Map&&(_=_[1]),(Ko(_)||en(_)||fs(_))&&!Da(_))try{for(var L=!0,C=(g=void 0,ai(ld(_,i-1))),M;M=yield we(C.next()),p=M.done,!p;L=!0)y=M.value,L=!1,yield yield we(y)}catch(R){g={error:R}}finally{try{!L&&!p&&(m=C.return)&&(yield we(m.call(C)))}finally{if(g)throw g.error}}else yield yield we(_)}}catch(_){u={error:_}}finally{try{!x&&!l&&(h=N.return)&&(yield we(h.call(N)))}finally{if(u)throw u.error}}})}function*Ny(n,e){for(const t of it(n))e(t)&&(yield t)}function Ly(n,e){return ui(this,arguments,function*(){var i,r,s,a;try{for(var o=!0,l=ai(Xe(n)),u;u=yield we(l.next()),i=u.done,!i;o=!0){a=u.value,o=!1;const h=a;(yield we(e(h)))&&(yield yield we(h))}}catch(h){r={error:h}}finally{try{!o&&!i&&(s=l.return)&&(yield we(s.call(l)))}finally{if(r)throw r.error}}})}function*gu(n,e,t,i=!0){if(e<1)throw new ei(`Chunk size must be ≥ 1. Got ${e}`);if(t>=e)throw new ei("Overlap size must be less than chunk size");let r=[],s=!1;for(const a of it(n))s=!1,r.push(a),r.length===e&&(yield r,r=r.slice(e-t),s=!0);!s&&r.length>0&&i&&(yield r)}function pu(n,e,t){return ui(this,arguments,function*(r,s,a,o=!0){var l,u,h,d;if(s<1)throw new ei(`Chunk size must be ≥ 1. Got ${s}`);if(a>=s)throw new ei("Overlap size must be less than chunk size");let p=[],g=!1;try{for(var m=!0,y=ai(Xe(r)),b;b=yield we(y.next()),l=b.done,!l;m=!0){d=b.value,m=!1;const A=d;g=!1,p.push(A),p.length===s&&(yield yield we(p),p=p.slice(s-a),g=!0)}}catch(A){u={error:A}}finally{try{!m&&!l&&(h=y.return)&&(yield we(h.call(y)))}finally{if(u)throw u.error}}!g&&p.length>0&&o&&(yield yield we(p))})}function*_y(n,e){for(const t of gu(n,e,0))yield t}function My(n,e){return ui(this,arguments,function*(){var i,r,s,a;try{for(var o=!0,l=ai(pu(n,e,0)),u;u=yield we(l.next()),i=u.done,!i;o=!0)a=u.value,o=!1,yield yield we(a)}catch(h){r={error:h}}finally{try{!o&&!i&&(s=l.return)&&(yield we(s.call(l)))}finally{if(r)throw r.error}}})}function*Ia(n){const e=gu(n,2,1,!1);for(const t of e)yield t}function mu(n){return ui(this,arguments,function*(){var t,i,r,s;const a=pu(n,2,1,!1);try{for(var o=!0,l=ai(a),u;u=yield we(l.next()),t=u.done,!t;o=!0)s=u.value,o=!1,yield yield we(s)}catch(h){i={error:h}}finally{try{!o&&!t&&(r=l.return)&&(yield we(r.call(l)))}finally{if(i)throw i.error}}})}function*ky(n,e){if(e<0)throw new ei(`Limit must be ≥ 0. Got ${e}`);let t=0;for(const i of it(n)){if(t>=e)return;yield i,++t}}function Py(n,e){return ui(this,arguments,function*(){var i,r,s,a;if(e<0)throw new ei(`Limit must be ≥ 0. Got ${e}`);let o=0;try{for(var l=!0,u=ai(Xe(n)),h;h=yield we(u.next()),i=h.done,!i;l=!0){a=h.value,l=!1;const d=a;if(o>=e)return yield we(void 0);yield yield we(d),++o}}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield we(s.call(u)))}finally{if(r)throw r.error}}})}function*Ca(n){let e=0;for(const t of it(n))yield[e++,t]}function Oy(n){return ui(this,arguments,function*(){var t,i,r,s;let a=0;try{for(var o=!0,l=ai(Xe(n)),u;u=yield we(l.next()),t=u.done,!t;o=!0){s=u.value,o=!1;const h=s;yield yield we([a++,h])}}catch(h){i={error:h}}finally{try{!o&&!t&&(r=l.return)&&(yield we(r.call(l)))}finally{if(i)throw i.error}}})}function*Fy(n,e=0,t,i=1){if(e<0)throw new ei("Parameter 'start' cannot be negative");if(t!==void 0&&t<0)throw new ei("Parameter 'count' cannot be negative");if(i<=0)throw new ei("Parameter 'step' must be positive");let r=0,s=0;for(const a of it(n))if(!(r++<e||(r-e-1)%i!==0)){if(s++===t&&t!==void 0)break;yield a}}function By(n){return ui(this,arguments,function*(t,i=0,r,s=1){var a,o,l,u;if(i<0)throw new ei("Parameter 'start' cannot be negative");if(r!==void 0&&r<0)throw new ei("Parameter 'count' cannot be negative");if(s<=0)throw new ei("Parameter 'step' must be positive");let h=0,d=0;try{for(var p=!0,g=ai(Xe(t)),m;m=yield we(g.next()),a=m.done,!a;p=!0){u=m.value,p=!1;const y=u;if(!(h++<i||(h-i-1)%s!==0)){if(d++===r&&r!==void 0)break;yield yield we(y)}}}catch(y){o={error:y}}finally{try{!p&&!a&&(l=g.return)&&(yield we(l.call(g)))}finally{if(o)throw o.error}}})}function*Uy(n){for(const[e]of it(n))yield e}function $y(n){return ui(this,arguments,function*(){var t,i,r,s;try{for(var a=!0,o=ai(Xe(n)),l;l=yield we(o.next()),t=l.done,!t;a=!0){s=l.value,a=!1;const[u]=s;yield yield we(u)}}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield we(r.call(o)))}finally{if(i)throw i.error}}})}function*Gy(n,e,t=0){if(e<0||t<0)throw new ei;let i=-t;for(const r of it(n))(i<0||i>=e)&&(yield r),++i}function qy(n,e){return ui(this,arguments,function*(i,r,s=0){var a,o,l,u;if(r<0||s<0)throw new ei;let h=-s;try{for(var d=!0,p=ai(Xe(i)),g;g=yield we(p.next()),a=g.done,!a;d=!0){u=g.value,d=!1;const m=u;(h<0||h>=r)&&(yield yield we(m)),++h}}catch(m){o={error:m}}finally{try{!d&&!a&&(l=p.return)&&(yield we(l.call(p)))}finally{if(o)throw o.error}}})}function*Vy(n){for(const[,e]of it(n))yield e}function Hy(n){return ui(this,arguments,function*(){var t,i,r,s;try{for(var a=!0,o=ai(Xe(n)),l;l=yield we(o.next()),t=l.done,!t;a=!0){s=l.value,a=!1;const[,u]=s;yield yield we(u)}}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield we(r.call(o)))}finally{if(i)throw i.error}}})}function*Ky(n,e,t){const i=new Map,r=s=>{i.has(s)||(t!==void 0?i.set(s,{}):i.set(s,[]))};for(const s of it(n)){const a=e(s),o=t!==void 0?t(s):void 0,l=(en(a)||fs(a))&&!Da(a)?a:[a];for(const u of nd(l))r(u),o===void 0?i.get(u).push(s):i.get(u)[o]=s}for(const s of i)yield s}function Wy(n,e,t){return ui(this,arguments,function*(){var r,s,a,o,l,u,h,d;const p=new Map,g=N=>{p.has(N)||(t!==void 0?p.set(N,{}):p.set(N,[]))};try{for(var m=!0,y=ai(Xe(n)),b;b=yield we(y.next()),r=b.done,!r;m=!0){o=b.value,m=!1;const N=o,F=yield we(e(N)),L=t!==void 0?yield we(t(N)):void 0,C=(Ko(F)||en(F)||fs(F))&&!Da(F)?F:[F];try{for(var A=!0,w=(u=void 0,ai(Ay(C))),x;x=yield we(w.next()),l=x.done,!l;A=!0){d=x.value,A=!1;const M=d;g(M),L===void 0?p.get(M).push(N):p.get(M)[L]=N}}catch(M){u={error:M}}finally{try{!A&&!l&&(h=w.return)&&(yield we(h.call(w)))}finally{if(u)throw u.error}}}}catch(N){s={error:N}}finally{try{!m&&!r&&(a=y.return)&&(yield we(a.call(y)))}finally{if(s)throw s.error}}for(const N of p)yield yield we(N)})}function*Yy(n,e){const t=Ra(n);e!==void 0?t.sort(e):t.sort();for(const i of t)yield i}function zy(n,e){return ui(this,arguments,function*(){const i=yield we(zs(n));e!==void 0?i.sort(e):i.sort();for(const r of i)yield yield we(r)})}var jy=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},gs=function(n){return this instanceof gs?(this.v=n,this):new gs(n)},cR=function(n){var e,t;return e={},i("next"),i("throw",function(r){throw r}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(r,s){e[r]=n[r]?function(a){return(t=!t)?{value:gs(n[r](a)),done:!1}:s?s(a):a}:s}},hR=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof gs?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*dR(n=1,e=1){for(let t=n;;t+=e)yield t}function*Xy(n){const e=[...it(n)];if(e.length!==0)for(;;)for(const t of e)yield t}function fR(n){return hR(this,arguments,function*(){var t,i,r,s;const a=[];try{for(var o=!0,l=jy(Xe(n)),u;u=yield gs(l.next()),t=u.done,!t;o=!0){s=u.value,o=!1;const h=s;a.push(h),yield yield gs(h)}}catch(h){i={error:h}}finally{try{!o&&!t&&(r=l.return)&&(yield gs(r.call(l)))}finally{if(i)throw i.error}}yield gs(yield*cR(jy(Xy(a))))})}function*gR(n){for(;;)yield n}var Na=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},Ot=function(n){return this instanceof Ot?(this.v=n,this):new Ot(n)},La=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof Ot?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};function*pR(n,e){let t=0;for(const i of Jy(it(n),e))t++,yield i/t}function mR(n,e){return La(this,arguments,function*(){var i,r,s,a;let o=0;try{for(var l=!0,u=Na(Qy(Xe(n),e)),h;h=yield Ot(u.next()),i=h.done,!i;l=!0){a=h.value,l=!1;const d=a;o++,yield yield Ot(d/o)}}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ot(s.call(u)))}finally{if(r)throw r.error}}})}function*yR(n,e){e!==void 0&&(yield e);let t=e??0;for(const i of it(n))t-=Number(i),yield t}function vR(n,e){return La(this,arguments,function*(){var i,r,s,a;e!==void 0&&(yield yield Ot(e));let o=e??0;try{for(var l=!0,u=Na(Xe(n)),h;h=yield Ot(u.next()),i=h.done,!i;l=!0)a=h.value,l=!1,o-=Number(a),yield yield Ot(o)}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ot(s.call(u)))}finally{if(r)throw r.error}}})}function*bR(n,e){e!==void 0&&(yield e);let t=e??-1/0;for(const i of it(n))t=Math.max(t,i),yield t}function ER(n,e){return La(this,arguments,function*(){var i,r,s,a;e!==void 0&&(yield yield Ot(e));let o=e??-1/0;try{for(var l=!0,u=Na(Xe(n)),h;h=yield Ot(u.next()),i=h.done,!i;l=!0)a=h.value,l=!1,o=Math.max(o,a),yield yield Ot(o)}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ot(s.call(u)))}finally{if(r)throw r.error}}})}function*AR(n,e){e!==void 0&&(yield e);let t=e??1/0;for(const i of it(n))t=Math.min(t,i),yield t}function SR(n,e){return La(this,arguments,function*(){var i,r,s,a;e!==void 0&&(yield yield Ot(e));let o=e??1/0;try{for(var l=!0,u=Na(Xe(n)),h;h=yield Ot(u.next()),i=h.done,!i;l=!0)a=h.value,l=!1,o=Math.min(o,a),yield yield Ot(o)}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ot(s.call(u)))}finally{if(r)throw r.error}}})}function*xR(n,e){e!==void 0&&(yield e);let t=e??1;for(const i of it(n))t*=Number(i),yield t}function TR(n,e){return La(this,arguments,function*(){var i,r,s,a;e!==void 0&&(yield yield Ot(e));let o=e??1;try{for(var l=!0,u=Na(Xe(n)),h;h=yield Ot(u.next()),i=h.done,!i;l=!0)a=h.value,l=!1,o*=Number(a),yield yield Ot(o)}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ot(s.call(u)))}finally{if(r)throw r.error}}})}function*Jy(n,e){e!==void 0&&(yield e);let t=e??0;for(const i of it(n))t+=Number(i),yield t}function Qy(n,e){return La(this,arguments,function*(){var i,r,s,a;e!==void 0&&(yield yield Ot(e));let o=e??0;try{for(var l=!0,u=Na(Xe(n)),h;h=yield Ot(u.next()),i=h.done,!i;l=!0)a=h.value,l=!1,o+=Number(a),yield yield Ot(o)}catch(d){r={error:d}}finally{try{!l&&!i&&(s=u.return)&&(yield Ot(s.call(u)))}finally{if(r)throw r.error}}})}var wR=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})},Bi=function(n){return this instanceof Bi?(this.v=n,this):new Bi(n)},ud=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},cd=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof Bi?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}},Zy=function(n){var e,t;return e={},i("next"),i("throw",function(r){throw r}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(r,s){e[r]=n[r]?function(a){return(t=!t)?{value:Bi(n[r](a)),done:!1}:s?s(a):a}:s}};function*DR(...n){if(n.length===0)return;if(n.length===1){for(const i of it(n[0]))yield[i];return}const t=Ra(fu(n,i=>Ra(i))).reduce((i,r)=>i.flatMap(s=>r.map(a=>[...s,a])),[[]]);for(const i of t)yield i}function RR(...n){return cd(this,arguments,function*(){var t,i,r,s;if(n.length===0)return yield Bi(void 0);if(n.length===1){try{for(var a=!0,o=ud(Xe(n[0])),l;l=yield Bi(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield Bi([s])}catch(d){i={error:d}}finally{try{!a&&!t&&(r=o.return)&&(yield Bi(r.call(o)))}finally{if(i)throw i.error}}return yield Bi(void 0)}const h=(yield Bi(zs(zo(n,d=>wR(this,void 0,void 0,function*(){return yield zs(d)}))))).reduce((d,p)=>d.flatMap(g=>p.map(m=>[...g,m])),[[]]);for(const d of h)yield yield Bi(d)})}function*ev(n,e){if(e<0)throw new ei("Parameter 'length' cannot be negative");const t=Ra(n);function*i(r,s){if(r.length===e)yield r.slice();else for(let a=0;a<s.length;a++){const o=[...r,s[a]],l=s.slice(0,a).concat(s.slice(a+1));yield*i(o,l)}}yield*i([],t)}function IR(n,e){return cd(this,arguments,function*(){yield Bi(yield*Zy(ud(ev(yield Bi(zs(n)),e))))})}function*tv(n,e){if(e<0)throw new ei("Parameter 'length' cannot be negative");const t=Ra(n),i=t.length;if(e===0){yield[];return}if(e>i||e<0)return;const r=Array.from({length:e},(s,a)=>a);for(yield r.map(s=>t[s]);;){let s=e-1;for(;s>=0&&r[s]===s+i-e;)s--;if(s<0)break;r[s]++;for(let a=s+1;a<e;a++)r[a]=r[a-1]+1;yield r.map(a=>t[a])}}function CR(n,e){return cd(this,arguments,function*(){yield Bi(yield*Zy(ud(tv(yield Bi(zs(n)),e))))})}let sr=class qs{static of(e){return new qs(it(e))}static ofEmpty(){return new qs([])}static ofCount(e=1,t=1){return new qs(Ma.count(e,t))}static ofCycle(e){return new qs(Ma.cycle(e))}static ofRepeat(e){return new qs(Ma.repeat(e))}zipWith(...e){return this.data=X0(this.data,...e),this}zipFilledWith(e,...t){return this.data=ID(e,this.data,...t),this}zipLongestWith(...e){return this.data=ND(this.data,...e),this}zipEqualWith(...e){return this.data=Q0(this.data,...e),this}chainWith(...e){return this.data=_D(this.data,...e),this}chunkwiseOverlap(e,t,i=!0){return this.data=gu(this.data,e,t,i),this}chunkwise(e){return this.data=_y(this.data,e),this}compress(e){return this.data=Sy(this.data,e),this}dropWhile(e){return this.data=Ty(this.data,e),this}filter(e){return this.data=Ny(this.data,e),this}enumerate(){return this.data=Ca(this.data),this}keys(){return this.data=Uy(this.data),this}limit(e){return this.data=ky(this.data,e),this}map(e){return this.data=fu(this.data,e),this}flatMap(e){return this.data=Iy(this.data,e),this}flatten(e=1/0){return this.data=od(this.data,e),this}groupBy(e,t){return this.data=Ky(this.data,e,t),this}pairwise(){return this.data=Ia(this.data),this}runningAverage(e){return this.data=pR(this.data,e),this}runningDifference(e){return this.data=yR(this.data,e),this}runningMax(e){return this.data=bR(this.data,e),this}runningMin(e){return this.data=AR(this.data,e),this}runningProduct(e){return this.data=xR(this.data,e),this}runningTotal(e){return this.data=Jy(this.data,e),this}skip(e,t=0){return this.data=Gy(this.data,e,t),this}slice(e=0,t,i=1){return this.data=Fy(this.data,e,t,i),this}takeWhile(e){return this.data=Dy(this.data,e),this}values(){return this.data=Vy(this.data),this}sort(e){return this.data=Yy(this.data,e),this}distinct(e){return this.data=nd(this.data,e),this}intersectionWith(...e){return this.data=iR(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=sd(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=nR(this.data,...e),this}unionWith(...e){return this.data=aR(this.data,...e),this}cartesianProductWith(...e){return this.data=DR(this.data,...e),this}permutations(e){return this.data=ev(this.data,e),this}combinations(e){return this.data=tv(this.data,e),this}peek(e){const[t,i]=id(this.data,2);this.data=t;for(const r of i)e(r);return this}peekStream(e){const[t,i]=id(this.data,2);return this.data=t,e(qs.of(i)),this}toValue(e,t){return kr(this,e,t)}toAverage(){return ey(this)}toCount(){return hu(this)}toMax(e){return iy(this,e)}toMin(e){return ny(this,e)}toMinMax(e){return Jh(this,e)}toFirst(){return dy(this)}toFirstAndLast(){return my(this)}toLast(){return gy(this)}toSum(){return ly(this)}toProduct(){return cy(this)}toRange(){return ay(this)}allMatch(e){return kD(this,e)}allUnique(){return OD(this)}anyMatch(e){return BD(this,e)}exactlyN(e,t){return $D(this,e,t)}isSorted(){return HD(this)}isReversed(){return qD(this)}noneMatch(e){return WD(this,e)}sameWith(...e){return zD(this.data,...e)}sameCountWith(...e){return XD(this.data,...e)}tee(e){return id(this.data,e).map(t=>new qs(t))}toArray(){return Ra(this)}toMap(){return QD(this)}toSet(){return eR(this)}*[Symbol.iterator](){for(const e of this.data)yield e}constructor(e){this.data=e}};var Bt=function(n,e,t,i){function r(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(h){try{u(i.next(h))}catch(d){a(d)}}function l(h){try{u(i.throw(h))}catch(d){a(d)}}function u(h){h.done?s(h.value):r(h.value).then(o,l)}u((i=i.apply(n,e||[])).next())})},iv=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(s){t[s]=n[s]&&function(a){return new Promise(function(o,l){a=n[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}},_a=function(n){return this instanceof _a?(this.v=n,this):new _a(n)},NR=function(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(g){return function(m){return Promise.resolve(m).then(g,d)}}function o(g,m){i[g]&&(r[g]=function(y){return new Promise(function(b,A){s.push([g,y,b,A])>1||l(g,y)})},m&&(r[g]=m(r[g])))}function l(g,m){try{u(i[g](m))}catch(y){p(s[0][3],y)}}function u(g){g.value instanceof _a?Promise.resolve(g.value.v).then(h,d):p(s[0][2],g)}function h(g){l("next",g)}function d(g){l("throw",g)}function p(g,m){g(m),s.shift(),s.length&&l(s[0][0],s[0][1])}};class In{static of(e){return new In(Xe(e))}static ofEmpty(){return new In(Xe([]))}static ofCount(e=1,t=1){return new In(Xe(Ma.count(e,t)))}static ofCycle(e){return new In(Ma.cycleAsync(e))}static ofRepeat(e){return new In(Xe(Ma.repeat(e)))}zipWith(...e){return this.data=J0(this.data,...e),this}zipFilledWith(e,...t){return this.data=CD(e,this.data,...t),this}zipLongestWith(...e){return this.data=LD(this.data,...e),this}zipEqualWith(...e){return this.data=Z0(this.data,...e),this}chainWith(...e){return this.data=MD(this.data,...e),this}chunkwiseOverlap(e,t,i=!0){return this.data=pu(this.data,e,t,i),this}chunkwise(e){return this.data=My(this.data,e),this}compress(e){return this.data=xy(this.data,e),this}dropWhile(e){return this.data=wy(this.data,e),this}filter(e){return this.data=Ly(this.data,e),this}enumerate(){return this.data=Oy(this.data),this}keys(){return this.data=$y(this.data),this}limit(e){return this.data=Py(this.data,e),this}map(e){return this.data=zo(this.data,e),this}flatMap(e){return this.data=Cy(this.data,e),this}flatten(e=1/0){return this.data=ld(this.data,e),this}groupBy(e,t){return this.data=Wy(this.data,e,t),this}pairwise(){return this.data=mu(this.data),this}runningAverage(e){return this.data=mR(this.data,e),this}runningDifference(e){return this.data=vR(this.data,e),this}runningMax(e){return this.data=ER(this.data,e),this}runningMin(e){return this.data=SR(this.data,e),this}runningProduct(e){return this.data=TR(this.data,e),this}runningTotal(e){return this.data=Qy(this.data,e),this}skip(e,t=0){return this.data=qy(this.data,e,t),this}slice(e=0,t,i=1){return this.data=By(this.data,e,t,i),this}takeWhile(e){return this.data=Ry(this.data,e),this}values(){return this.data=Hy(this.data),this}sort(e){return this.data=zy(this.data,e),this}distinct(e){return this.data=Ay(this.data,e),this}intersectionWith(...e){return this.data=rR(this.data,...e),this}partialIntersectionWith(e,...t){return this.data=ad(e,this.data,...t),this}symmetricDifferenceWith(...e){return this.data=sR(this.data,...e),this}unionWith(...e){return this.data=oR(this.data,...e),this}cartesianProductWith(...e){return this.data=RR(this.data,...e),this}permutations(e){return this.data=IR(this.data,e),this}combinations(e){return this.data=CR(this.data,e),this}peek(e){const[t,i]=rd(this.data,2);return this.data=t,Bt(this,void 0,void 0,function*(){var r,s,a,o;try{for(var l=!0,u=iv(i),h;h=yield u.next(),r=h.done,!r;l=!0)o=h.value,l=!1,e(o)}catch(d){s={error:d}}finally{try{!l&&!r&&(a=u.return)&&(yield a.call(u))}finally{if(s)throw s.error}}}),this}peekStream(e){const[t,i]=rd(this.data,2);return this.data=t,e(In.of(i)),this}toValue(e,t){return Bt(this,void 0,void 0,function*(){return yield Pr(this,e,t)})}toAverage(){return Bt(this,void 0,void 0,function*(){return yield ty(this)})}toCount(){return Bt(this,void 0,void 0,function*(){return yield Zh(this)})}toMax(e){return Bt(this,void 0,void 0,function*(){return yield ry(this,e)})}toMin(e){return Bt(this,void 0,void 0,function*(){return yield sy(this,e)})}toMinMax(e){return Bt(this,void 0,void 0,function*(){return yield Qh(this,e)})}toFirst(){return Bt(this,void 0,void 0,function*(){return yield fy(this)})}toFirstAndLast(){return Bt(this,void 0,void 0,function*(){return yield yy(this)})}toLast(){return Bt(this,void 0,void 0,function*(){return yield py(this)})}toSum(){return Bt(this,void 0,void 0,function*(){return yield uy(this)})}toProduct(){return Bt(this,void 0,void 0,function*(){return yield hy(this)})}toRange(){return Bt(this,void 0,void 0,function*(){return yield oy(this)})}allMatch(e){return Bt(this,void 0,void 0,function*(){return yield PD(this,e)})}allUnique(){return Bt(this,void 0,void 0,function*(){return yield FD(this)})}anyMatch(e){return Bt(this,void 0,void 0,function*(){return yield UD(this,e)})}exactlyN(e,t){return Bt(this,void 0,void 0,function*(){return GD(this,e,t)})}isSorted(){return Bt(this,void 0,void 0,function*(){return yield KD(this)})}isReversed(){return Bt(this,void 0,void 0,function*(){return yield VD(this)})}noneMatch(e){return Bt(this,void 0,void 0,function*(){return yield YD(this,e)})}sameWith(...e){return Bt(this,void 0,void 0,function*(){return yield jD(this.data,...e)})}sameCountWith(...e){return Bt(this,void 0,void 0,function*(){return yield JD(this.data,...e)})}tee(e){return rd(this.data,e).map(t=>new In(t))}toArray(){return Bt(this,void 0,void 0,function*(){return yield zs(this)})}toMap(){return Bt(this,void 0,void 0,function*(){return yield ZD(this)})}toSet(){return Bt(this,void 0,void 0,function*(){return yield tR(this)})}[Symbol.asyncIterator](){return NR(this,arguments,function*(){var t,i,r,s;try{for(var a=!0,o=iv(this.data),l;l=yield _a(o.next()),t=l.done,!t;a=!0)s=l.value,a=!1,yield yield _a(s)}catch(u){i={error:u}}finally{try{!a&&!t&&(r=o.return)&&(yield _a(r.call(o)))}finally{if(i)throw i.error}}})}constructor(e){this.data=e}}const hd={chunkwise:_y,chunkwiseOverlap:gu,compress:Sy,dropWhile:Ty,enumerate:Ca,filter:Ny,flatMap:Iy,flatten:od,groupBy:Ky,keys:Uy,limit:ky,map:fu,pairwise:Ia,repeat:lR,skip:Gy,slice:Fy,sort:Yy,takeWhile:Dy,values:Vy,chunkwiseAsync:My,chunkwiseOverlapAsync:pu,compressAsync:xy,dropWhileAsync:wy,enumerateAsync:Oy,filterAsync:Ly,flatMapAsync:Cy,flattenAsync:ld,groupByAsync:Wy,keysAsync:$y,limitAsync:Py,mapAsync:zo,pairwiseAsync:mu,repeatAsync:uR,skipAsync:qy,sliceAsync:By,sortAsync:zy,takeWhileAsync:Ry,valuesAsync:Hy},Ma={count:dR,cycle:Xy,cycleAsync:fR,repeat:gR},rv={toAverage:ey,toCount:hu,toFirst:dy,toFirstAndLast:my,toLast:gy,toMax:iy,toMin:ny,toMinMax:Jh,toProduct:cy,toRange:ay,toSum:ly,toValue:kr,toAverageAsync:ty,toCountAsync:Zh,toFirstAsync:fy,toFirstAndLastAsync:yy,toLastAsync:py,toMaxAsync:ry,toMinAsync:sy,toMinMaxAsync:Qh,toProductAsync:hy,toRangeAsync:oy,toSumAsync:uy,toValueAsync:Pr};var LR={763:()=>{}},nv={};function js(n){var e=nv[n];if(e!==void 0)return e.exports;var t=nv[n]={exports:{}};return LR[n](t,t.exports,js),t.exports}js.d=(n,e)=>{for(var t in e)js.o(e,t)&&!js.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},js.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var ht={};js.d(ht,{MG:()=>Ut,fr:()=>Ld,sR:()=>Cv,Zo:()=>Qs,iH:()=>Mv,rt:()=>_n,jB:()=>Pv,M8:()=>Dv,$t:()=>Du,aq:()=>Iv,pG:()=>Zo,eP:()=>Fd,KU:()=>Ua,zW:()=>Ud,IX:()=>pt,mY:()=>Er,a7:()=>bu,JG:()=>Kt,ay:()=>Wt,X2:()=>Tu,WU:()=>Od,Uw:()=>Rv,gw:()=>wu,iX:()=>$d,re:()=>xv,Pg:()=>Gd,tD:()=>Tv,R$:()=>ci,Dj:()=>Mn,m7:()=>Xs,NZ:()=>jo,xo:()=>rn,ou:()=>Ee,qC:()=>Ru,mD:()=>Cn,Ay:()=>sI});let Ee=class{constructor(){this.source=null,this.type=null,this.channel=null,this.start=null,this.stop=null,this.tokenIndex=null,this.line=null,this.column=null,this._text=null}getTokenSource(){return this.source[0]}getInputStream(){return this.source[1]}get text(){return this._text}set text(e){this._text=e}};function ka(n,e){if(!Array.isArray(n)||!Array.isArray(e))return!1;if(n===e)return!0;if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!(n[t]===e[t]||n[t].equals&&n[t].equals(e[t])))return!1;return!0}Ee.INVALID_TYPE=0,Ee.EPSILON=-2,Ee.MIN_USER_TOKEN_TYPE=1,Ee.EOF=-1,Ee.DEFAULT_CHANNEL=0,Ee.HIDDEN_CHANNEL=1;const _R=Math.round(Math.random()*Math.pow(2,32));function sv(n){if(!n)return 0;const e=typeof n,t=e==="string"?n:!(e!=="object"||!n.toString)&&n.toString();if(!t)return 0;let i,r;const s=3&t.length,a=t.length-s;let o=_R;const l=3432918353,u=461845907;let h=0;for(;h<a;)r=255&t.charCodeAt(h)|(255&t.charCodeAt(++h))<<8|(255&t.charCodeAt(++h))<<16|(255&t.charCodeAt(++h))<<24,++h,r=(65535&r)*l+(((r>>>16)*l&65535)<<16)&4294967295,r=r<<15|r>>>17,r=(65535&r)*u+(((r>>>16)*u&65535)<<16)&4294967295,o^=r,o=o<<13|o>>>19,i=5*(65535&o)+((5*(o>>>16)&65535)<<16)&4294967295,o=27492+(65535&i)+((58964+(i>>>16)&65535)<<16);switch(r=0,s){case 3:r^=(255&t.charCodeAt(h+2))<<16;case 2:r^=(255&t.charCodeAt(h+1))<<8;case 1:r^=255&t.charCodeAt(h),r=(65535&r)*l+(((r>>>16)*l&65535)<<16)&4294967295,r=r<<15|r>>>17,r=(65535&r)*u+(((r>>>16)*u&65535)<<16)&4294967295,o^=r}return o^=t.length,o^=o>>>16,o=2246822507*(65535&o)+((2246822507*(o>>>16)&65535)<<16)&4294967295,o^=o>>>13,o=3266489909*(65535&o)+((3266489909*(o>>>16)&65535)<<16)&4294967295,o^=o>>>16,o>>>0}class ar{constructor(){this.count=0,this.hash=0}update(){for(let e=0;e<arguments.length;e++){const t=arguments[e];if(t!=null)if(Array.isArray(t))this.update.apply(this,t);else{let i=0;switch(typeof t){case"undefined":case"function":continue;case"number":case"boolean":i=t;break;case"string":i=sv(t);break;default:t.updateHashCode?t.updateHashCode(this):console.log("No updateHashCode for "+t.toString());continue}i*=3432918353,i=i<<15|i>>>17,i*=461845907,this.count=this.count+1;let r=this.hash^i;r=r<<13|r>>>19,r=5*r+3864292196,this.hash=r}}}finish(){let e=this.hash^4*this.count;return e^=e>>>16,e*=2246822507,e^=e>>>13,e*=3266489909,e^=e>>>16,e}static hashStuff(){const e=new ar;return e.update.apply(e,arguments),e.finish()}}function av(n){return n?typeof n=="string"?sv(n):n.hashCode():-1}function ov(n,e){return n&&n.equals?n.equals(e):n===e}function MR(n){return n===null?"null":n}function Cn(n){return Array.isArray(n)?"["+n.map(MR).join(", ")+"]":"null"}let or=class{constructor(e,t){this.buckets=new Array(16),this.threshold=Math.floor(12),this.itemCount=0,this.hashFunction=e||av,this.equalsFunction=t||ov}get(e){if(e==null)return e;const t=this._getBucket(e);if(!t)return null;for(const i of t)if(this.equalsFunction(i,e))return i;return null}add(e){return this.getOrAdd(e)===e}getOrAdd(e){this._expand();const t=this._getSlot(e);let i=this.buckets[t];if(!i)return i=[e],this.buckets[t]=i,this.itemCount++,e;for(const r of i)if(this.equalsFunction(r,e))return r;return i.push(e),this.itemCount++,e}has(e){return this.get(e)!=null}values(){return this.buckets.filter(e=>e!=null).flat(1)}toString(){return Cn(this.values())}get length(){return this.itemCount}_getSlot(e){return this.hashFunction(e)&this.buckets.length-1}_getBucket(e){return this.buckets[this._getSlot(e)]}_expand(){if(this.itemCount<=this.threshold)return;const e=this.buckets,t=2*this.buckets.length;this.buckets=new Array(t),this.threshold=Math.floor(.75*t);for(const i of e)if(i)for(const r of i){const s=this._getSlot(r);let a=this.buckets[s];a||(a=[],this.buckets[s]=a),a.push(r)}}};class bt{hashCode(){const e=new ar;return this.updateHashCode(e),e.finish()}evaluate(e,t){}evalPrecedence(e,t){return this}static andContext(e,t){if(e===null||e===bt.NONE)return t;if(t===null||t===bt.NONE)return e;const i=new kR(e,t);return i.opnds.length===1?i.opnds[0]:i}static orContext(e,t){if(e===null)return t;if(t===null)return e;if(e===bt.NONE||t===bt.NONE)return bt.NONE;const i=new PR(e,t);return i.opnds.length===1?i.opnds[0]:i}}let kR=class Ih extends bt{constructor(e,t){super();const i=new or;e instanceof Ih?e.opnds.map(function(s){i.add(s)}):i.add(e),t instanceof Ih?t.opnds.map(function(s){i.add(s)}):i.add(t);const r=lv(i);if(r.length>0){let s=null;r.map(function(a){(s===null||a.precedence<s.precedence)&&(s=a)}),i.add(s)}this.opnds=Array.from(i.values())}equals(e){return this===e||e instanceof Ih&&ka(this.opnds,e.opnds)}updateHashCode(e){e.update(this.opnds,"AND")}evaluate(e,t){for(let i=0;i<this.opnds.length;i++)if(!this.opnds[i].evaluate(e,t))return!1;return!0}evalPrecedence(e,t){let i=!1;const r=[];for(let a=0;a<this.opnds.length;a++){const o=this.opnds[a],l=o.evalPrecedence(e,t);if(i|=l!==o,l===null)return null;l!==bt.NONE&&r.push(l)}if(!i)return this;if(r.length===0)return bt.NONE;let s=null;return r.map(function(a){s=s===null?a:bt.andContext(s,a)}),s}toString(){const e=this.opnds.map(t=>t.toString());return(e.length>3?e.slice(3):e).join("&&")}},PR=class Ch extends bt{constructor(e,t){super();const i=new or;e instanceof Ch?e.opnds.map(function(s){i.add(s)}):i.add(e),t instanceof Ch?t.opnds.map(function(s){i.add(s)}):i.add(t);const r=lv(i);if(r.length>0){const s=r.sort(function(o,l){return o.compareTo(l)}),a=s[s.length-1];i.add(a)}this.opnds=Array.from(i.values())}equals(e){return this===e||e instanceof Ch&&ka(this.opnds,e.opnds)}updateHashCode(e){e.update(this.opnds,"OR")}evaluate(e,t){for(let i=0;i<this.opnds.length;i++)if(this.opnds[i].evaluate(e,t))return!0;return!1}evalPrecedence(e,t){let i=!1;const r=[];for(let s=0;s<this.opnds.length;s++){const a=this.opnds[s],o=a.evalPrecedence(e,t);if(i|=o!==a,o===bt.NONE)return bt.NONE;o!==null&&r.push(o)}return i?(r.length===0,null):this}toString(){const e=this.opnds.map(t=>t.toString());return(e.length>3?e.slice(3):e).join("||")}};function lv(n){const e=[];return n.values().map(function(t){t instanceof bt.PrecedencePredicate&&e.push(t)}),e}function uv(n,e){if(n===null){const t={state:null,alt:null,context:null,semanticContext:null};return e&&(t.reachesIntoOuterContext=0),t}{const t={};return t.state=n.state||null,t.alt=n.alt===void 0?null:n.alt,t.context=n.context||null,t.semanticContext=n.semanticContext||null,e&&(t.reachesIntoOuterContext=n.reachesIntoOuterContext||0,t.precedenceFilterSuppressed=n.precedenceFilterSuppressed||!1),t}}class ti{constructor(e,t){this.checkContext(e,t),e=uv(e),t=uv(t,!0),this.state=e.state!==null?e.state:t.state,this.alt=e.alt!==null?e.alt:t.alt,this.context=e.context!==null?e.context:t.context,this.semanticContext=e.semanticContext!==null?e.semanticContext:t.semanticContext!==null?t.semanticContext:bt.NONE,this.reachesIntoOuterContext=t.reachesIntoOuterContext,this.precedenceFilterSuppressed=t.precedenceFilterSuppressed}checkContext(e,t){e.context!==null&&e.context!==void 0||t!==null&&t.context!==null&&t.context!==void 0||(this.context=null)}hashCode(){const e=new ar;return this.updateHashCode(e),e.finish()}updateHashCode(e){e.update(this.state.stateNumber,this.alt,this.context,this.semanticContext)}equals(e){return this===e||e instanceof ti&&this.state.stateNumber===e.state.stateNumber&&this.alt===e.alt&&(this.context===null?e.context===null:this.context.equals(e.context))&&this.semanticContext.equals(e.semanticContext)&&this.precedenceFilterSuppressed===e.precedenceFilterSuppressed}hashCodeForConfigSet(){const e=new ar;return e.update(this.state.stateNumber,this.alt,this.semanticContext),e.finish()}equalsForConfigSet(e){return this===e||e instanceof ti&&this.state.stateNumber===e.state.stateNumber&&this.alt===e.alt&&this.semanticContext.equals(e.semanticContext)}toString(){return"("+this.state+","+this.alt+(this.context!==null?",["+this.context.toString()+"]":"")+(this.semanticContext!==bt.NONE?","+this.semanticContext.toString():"")+(this.reachesIntoOuterContext>0?",up="+this.reachesIntoOuterContext:"")+")"}}let pt=class aw{constructor(e,t){this.start=e,this.stop=t}clone(){return new aw(this.start,this.stop)}contains(e){return e>=this.start&&e<this.stop}toString(){return this.start===this.stop-1?this.start.toString():this.start.toString()+".."+(this.stop-1).toString()}get length(){return this.stop-this.start}};pt.INVALID_INTERVAL=new pt(-1,-2);let Er=class ow{constructor(){this.intervals=null,this.readOnly=!1}first(e){return this.intervals===null||this.intervals.length===0?Ee.INVALID_TYPE:this.intervals[0].start}addOne(e){this.addInterval(new pt(e,e+1))}addRange(e,t){this.addInterval(new pt(e,t+1))}addInterval(e){if(this.intervals===null)this.intervals=[],this.intervals.push(e.clone());else{for(let t=0;t<this.intervals.length;t++){const i=this.intervals[t];if(e.stop<i.start)return void this.intervals.splice(t,0,e);if(e.stop===i.start)return void(this.intervals[t]=new pt(e.start,i.stop));if(e.start<=i.stop)return this.intervals[t]=new pt(Math.min(i.start,e.start),Math.max(i.stop,e.stop)),void this.reduce(t)}this.intervals.push(e.clone())}}addSet(e){return e.intervals!==null&&e.intervals.forEach(t=>this.addInterval(t),this),this}reduce(e){if(e<this.intervals.length-1){const t=this.intervals[e],i=this.intervals[e+1];t.stop>=i.stop?(this.intervals.splice(e+1,1),this.reduce(e)):t.stop>=i.start&&(this.intervals[e]=new pt(t.start,i.stop),this.intervals.splice(e+1,1))}}complement(e,t){const i=new ow;return i.addInterval(new pt(e,t+1)),this.intervals!==null&&this.intervals.forEach(r=>i.removeRange(r)),i}contains(e){if(this.intervals===null)return!1;for(let t=0;t<this.intervals.length;t++)if(this.intervals[t].contains(e))return!0;return!1}removeRange(e){if(e.start===e.stop-1)this.removeOne(e.start);else if(this.intervals!==null){let t=0;for(let i=0;i<this.intervals.length;i++){const r=this.intervals[t];if(e.stop<=r.start)return;if(e.start>r.start&&e.stop<r.stop){this.intervals[t]=new pt(r.start,e.start);const s=new pt(e.stop,r.stop);return void this.intervals.splice(t,0,s)}e.start<=r.start&&e.stop>=r.stop?(this.intervals.splice(t,1),t-=1):e.start<r.stop?this.intervals[t]=new pt(r.start,e.start):e.stop<r.stop&&(this.intervals[t]=new pt(e.stop,r.stop)),t+=1}}}removeOne(e){if(this.intervals!==null)for(let t=0;t<this.intervals.length;t++){const i=this.intervals[t];if(e<i.start)return;if(e===i.start&&e===i.stop-1)return void this.intervals.splice(t,1);if(e===i.start)return void(this.intervals[t]=new pt(i.start+1,i.stop));if(e===i.stop-1)return void(this.intervals[t]=new pt(i.start,i.stop-1));if(e<i.stop-1){const r=new pt(i.start,e);return i.start=e+1,void this.intervals.splice(t,0,r)}}}toString(e,t,i){return e=e||null,t=t||null,i=i||!1,this.intervals===null?"{}":e!==null||t!==null?this.toTokenString(e,t):i?this.toCharString():this.toIndexString()}toCharString(){const e=[];for(let t=0;t<this.intervals.length;t++){const i=this.intervals[t];i.stop===i.start+1?i.start===Ee.EOF?e.push("<EOF>"):e.push("'"+String.fromCharCode(i.start)+"'"):e.push("'"+String.fromCharCode(i.start)+"'..'"+String.fromCharCode(i.stop-1)+"'")}return e.length>1?"{"+e.join(", ")+"}":e[0]}toIndexString(){const e=[];for(let t=0;t<this.intervals.length;t++){const i=this.intervals[t];i.stop===i.start+1?i.start===Ee.EOF?e.push("<EOF>"):e.push(i.start.toString()):e.push(i.start.toString()+".."+(i.stop-1).toString())}return e.length>1?"{"+e.join(", ")+"}":e[0]}toTokenString(e,t){const i=[];for(let r=0;r<this.intervals.length;r++){const s=this.intervals[r];for(let a=s.start;a<s.stop;a++)i.push(this.elementName(e,t,a))}return i.length>1?"{"+i.join(", ")+"}":i[0]}elementName(e,t,i){return i===Ee.EOF?"<EOF>":i===Ee.EPSILON?"<EPSILON>":e[i]||t[i]}get length(){return this.intervals.map(e=>e.length).reduce((e,t)=>e+t)}};class Fe{constructor(){this.atn=null,this.stateNumber=Fe.INVALID_STATE_NUMBER,this.stateType=null,this.ruleIndex=0,this.epsilonOnlyTransitions=!1,this.transitions=[],this.nextTokenWithinRule=null}toString(){return this.stateNumber}equals(e){return e instanceof Fe&&this.stateNumber===e.stateNumber}isNonGreedyExitState(){return!1}addTransition(e,t){t===void 0&&(t=-1),this.transitions.length===0?this.epsilonOnlyTransitions=e.isEpsilon:this.epsilonOnlyTransitions!==e.isEpsilon&&(this.epsilonOnlyTransitions=!1),t===-1?this.transitions.push(e):this.transitions.splice(t,1,e)}}Fe.INVALID_TYPE=0,Fe.BASIC=1,Fe.RULE_START=2,Fe.BLOCK_START=3,Fe.PLUS_BLOCK_START=4,Fe.STAR_BLOCK_START=5,Fe.TOKEN_START=6,Fe.RULE_STOP=7,Fe.BLOCK_END=8,Fe.STAR_LOOP_BACK=9,Fe.STAR_LOOP_ENTRY=10,Fe.PLUS_LOOP_BACK=11,Fe.LOOP_END=12,Fe.serializationNames=["INVALID","BASIC","RULE_START","BLOCK_START","PLUS_BLOCK_START","STAR_BLOCK_START","TOKEN_START","RULE_STOP","BLOCK_END","STAR_LOOP_BACK","STAR_LOOP_ENTRY","PLUS_LOOP_BACK","LOOP_END"],Fe.INVALID_STATE_NUMBER=-1;class Ui extends Fe{constructor(){return super(),this.stateType=Fe.RULE_STOP,this}}class Pe{constructor(e){if(e==null)throw"target cannot be null.";this.target=e,this.isEpsilon=!1,this.label=null}}Pe.EPSILON=1,Pe.RANGE=2,Pe.RULE=3,Pe.PREDICATE=4,Pe.ATOM=5,Pe.ACTION=6,Pe.SET=7,Pe.NOT_SET=8,Pe.WILDCARD=9,Pe.PRECEDENCE=10,Pe.serializationNames=["INVALID","EPSILON","RANGE","RULE","PREDICATE","ATOM","ACTION","SET","NOT_SET","WILDCARD","PRECEDENCE"],Pe.serializationTypes={EpsilonTransition:Pe.EPSILON,RangeTransition:Pe.RANGE,RuleTransition:Pe.RULE,PredicateTransition:Pe.PREDICATE,AtomTransition:Pe.ATOM,ActionTransition:Pe.ACTION,SetTransition:Pe.SET,NotSetTransition:Pe.NOT_SET,WildcardTransition:Pe.WILDCARD,PrecedencePredicateTransition:Pe.PRECEDENCE};class yu extends Pe{constructor(e,t,i,r){super(e),this.ruleIndex=t,this.precedence=i,this.followState=r,this.serializationType=Pe.RULE,this.isEpsilon=!0}matches(e,t,i){return!1}}let dd=class extends Pe{constructor(e,t){super(e),this.serializationType=Pe.SET,t!=null?this.label=t:(this.label=new Er,this.label.addOne(Ee.INVALID_TYPE))}matches(e,t,i){return this.label.contains(e)}toString(){return this.label.toString()}},fd=class extends dd{constructor(e,t){super(e,t),this.serializationType=Pe.NOT_SET}matches(e,t,i){return e>=t&&e<=i&&!super.matches(e,t,i)}toString(){return"~"+super.toString()}};class cv extends Pe{constructor(e){super(e),this.serializationType=Pe.WILDCARD}matches(e,t,i){return e>=t&&e<=i}toString(){return"."}}class gd extends Pe{constructor(e){super(e)}}class OR{}class FR extends OR{}let hv=class extends FR{},jo=class extends hv{get ruleContext(){throw new Error("missing interface implementation")}},rn=class extends hv{},vu=class extends rn{};const Nn={toStringTree:function(n,e,t){e=e||null,(t=t||null)!==null&&(e=t.ruleNames);let i=Nn.getNodeText(n,e);i=function(a){return a=a.replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r")}(i);const r=n.getChildCount();if(r===0)return i;let s="("+i+" ";r>0&&(i=Nn.toStringTree(n.getChild(0),e),s=s.concat(i));for(let a=1;a<r;a++)i=Nn.toStringTree(n.getChild(a),e),s=s.concat(" "+i);return s=s.concat(")"),s},getNodeText:function(n,e,t){if(e=e||null,(t=t||null)!==null&&(e=t.ruleNames),e!==null){if(n instanceof jo){const r=n.ruleContext.getAltNumber();return r!=0?e[n.ruleIndex]+":"+r:e[n.ruleIndex]}if(n instanceof vu)return n.toString();if(n instanceof rn&&n.symbol!==null)return n.symbol.text}const i=n.getPayload();return i instanceof Ee?i.text:n.getPayload().toString()},getChildren:function(n){const e=[];for(let t=0;t<n.getChildCount();t++)e.push(n.getChild(t));return e},getAncestors:function(n){let e=[];for(n=n.getParent();n!==null;)e=[n].concat(e),n=n.getParent();return e},findAllTokenNodes:function(n,e){return Nn.findAllNodes(n,e,!0)},findAllRuleNodes:function(n,e){return Nn.findAllNodes(n,e,!1)},findAllNodes:function(n,e,t){const i=[];return Nn._findAllNodes(n,e,t,i),i},_findAllNodes:function(n,e,t,i){t&&n instanceof rn?n.symbol.type===e&&i.push(n):!t&&n instanceof jo&&n.ruleIndex===e&&i.push(n);for(let r=0;r<n.getChildCount();r++)Nn._findAllNodes(n.getChild(r),e,t,i)},descendants:function(n){let e=[n];for(let t=0;t<n.getChildCount();t++)e=e.concat(Nn.descendants(n.getChild(t)));return e}},dv=Nn;class Xs extends jo{constructor(e,t){super(),this.parentCtx=e||null,this.invokingState=t||-1}depth(){let e=0,t=this;for(;t!==null;)t=t.parentCtx,e+=1;return e}isEmpty(){return this.invokingState===-1}getSourceInterval(){return pt.INVALID_INTERVAL}get ruleContext(){return this}getPayload(){return this}getText(){return this.getChildCount()===0?"":this.children.map(function(e){return e.getText()}).join("")}getAltNumber(){return 0}setAltNumber(e){}getChild(e){return null}getChildCount(){return 0}accept(e){return e.visitChildren(this)}toStringTree(e,t){return dv.toStringTree(this,e,t)}toString(e,t){e=e||null,t=t||null;let i=this,r="[";for(;i!==null&&i!==t;){if(e===null)i.isEmpty()||(r+=i.invokingState);else{const s=i.ruleIndex;r+=s>=0&&s<e.length?e[s]:""+s}i.parentCtx===null||e===null&&i.parentCtx.isEmpty()||(r+=" "),i=i.parentCtx}return r+="]",r}}class je{constructor(e){this.cachedHashCode=e}isEmpty(){return this===je.EMPTY}hasEmptyPath(){return this.getReturnState(this.length-1)===je.EMPTY_RETURN_STATE}hashCode(){return this.cachedHashCode}updateHashCode(e){e.update(this.cachedHashCode)}}je.EMPTY=null,je.EMPTY_RETURN_STATE=2147483647,je.globalNodeCount=1,je.id=je.globalNodeCount,je.trace_atn_sim=!1;class nn extends je{constructor(e,t){const i=new ar;return i.update(e,t),super(i.finish()),this.parents=e,this.returnStates=t,this}isEmpty(){return this.returnStates[0]===je.EMPTY_RETURN_STATE}getParent(e){return this.parents[e]}getReturnState(e){return this.returnStates[e]}equals(e){return this===e||e instanceof nn&&this.hashCode()===e.hashCode()&&ka(this.returnStates,e.returnStates)&&ka(this.parents,e.parents)}toString(){if(this.isEmpty())return"[]";{let e="[";for(let t=0;t<this.returnStates.length;t++)t>0&&(e+=", "),this.returnStates[t]!==je.EMPTY_RETURN_STATE?(e+=this.returnStates[t],this.parents[t]!==null?e=e+" "+this.parents[t]:e+="null"):e+="$";return e+"]"}}get length(){return this.returnStates.length}}class $i extends je{constructor(e,t){let i=0;const r=new ar;e!==null?r.update(e,t):r.update(1),i=r.finish(),super(i),this.parentCtx=e,this.returnState=t}getParent(e){return this.parentCtx}getReturnState(e){return this.returnState}equals(e){return this===e||e instanceof $i&&this.hashCode()===e.hashCode()&&this.returnState===e.returnState&&(this.parentCtx==null?e.parentCtx==null:this.parentCtx.equals(e.parentCtx))}toString(){const e=this.parentCtx===null?"":this.parentCtx.toString();return e.length===0?this.returnState===je.EMPTY_RETURN_STATE?"$":""+this.returnState:this.returnState+" "+e}get length(){return 1}static create(e,t){return t===je.EMPTY_RETURN_STATE&&e===null?je.EMPTY:new $i(e,t)}}let pd=class extends $i{constructor(){super(null,je.EMPTY_RETURN_STATE)}isEmpty(){return!0}getParent(e){return null}getReturnState(e){return this.returnState}equals(e){return this===e}toString(){return"$"}};je.EMPTY=new pd;class Xo{constructor(e,t){this.buckets=new Array(16),this.threshold=Math.floor(12),this.itemCount=0,this.hashFunction=e||av,this.equalsFunction=t||ov}set(e,t){this._expand();const i=this._getSlot(e);let r=this.buckets[i];if(!r)return r=[[e,t]],this.buckets[i]=r,this.itemCount++,t;const s=r.find(a=>this.equalsFunction(a[0],e),this);if(s){const a=s[1];return s[1]=t,a}return r.push([e,t]),this.itemCount++,t}containsKey(e){const t=this._getBucket(e);return!!t&&!!t.find(i=>this.equalsFunction(i[0],e),this)}get(e){const t=this._getBucket(e);if(!t)return null;const i=t.find(r=>this.equalsFunction(r[0],e),this);return i?i[1]:null}entries(){return this.buckets.filter(e=>e!=null).flat(1)}getKeys(){return this.entries().map(e=>e[0])}getValues(){return this.entries().map(e=>e[1])}toString(){return"["+this.entries().map(e=>"{"+e[0]+":"+e[1]+"}").join(", ")+"]"}get length(){return this.itemCount}_getSlot(e){return this.hashFunction(e)&this.buckets.length-1}_getBucket(e){return this.buckets[this._getSlot(e)]}_expand(){if(this.itemCount<=this.threshold)return;const e=this.buckets,t=2*this.buckets.length;this.buckets=new Array(t),this.threshold=Math.floor(.75*t);for(const i of e)if(i)for(const r of i){const s=this._getSlot(r[0]);let a=this.buckets[s];a||(a=[],this.buckets[s]=a),a.push(r)}}}function md(n,e){if(e==null&&(e=Xs.EMPTY),e.parentCtx===null||e===Xs.EMPTY)return je.EMPTY;const t=md(n,e.parentCtx),i=n.states[e.invokingState].transitions[0];return $i.create(t,i.followState.stateNumber)}function fv(n,e,t){if(n.isEmpty())return n;let i=t.get(n)||null;if(i!==null)return i;if(i=e.get(n),i!==null)return t.set(n,i),i;let r=!1,s=[];for(let o=0;o<s.length;o++){const l=fv(n.getParent(o),e,t);if(r||l!==n.getParent(o)){if(!r){s=[];for(let u=0;u<n.length;u++)s[u]=n.getParent(u);r=!0}s[o]=l}}if(!r)return e.add(n),t.set(n,n),n;let a=null;return a=s.length===0?je.EMPTY:s.length===1?$i.create(s[0],n.getReturnState(0)):new nn(s,n.returnStates),e.add(a),t.set(a,a),t.set(n,a),a}function yd(n,e,t,i){if(n===e)return n;if(n instanceof $i&&e instanceof $i)return function(r,s,a,o){if(o!==null){let u=o.get(r,s);if(u!==null||(u=o.get(s,r),u!==null))return u}const l=function(u,h,d){if(d){if(u===je.EMPTY||h===je.EMPTY)return je.EMPTY}else{if(u===je.EMPTY&&h===je.EMPTY)return je.EMPTY;if(u===je.EMPTY){const p=[h.returnState,je.EMPTY_RETURN_STATE],g=[h.parentCtx,null];return new nn(g,p)}if(h===je.EMPTY){const p=[u.returnState,je.EMPTY_RETURN_STATE],g=[u.parentCtx,null];return new nn(g,p)}}return null}(r,s,a);if(l!==null)return o!==null&&o.set(r,s,l),l;if(r.returnState===s.returnState){const u=yd(r.parentCtx,s.parentCtx,a,o);if(u===r.parentCtx)return r;if(u===s.parentCtx)return s;const h=$i.create(u,r.returnState);return o!==null&&o.set(r,s,h),h}{let u=null;if((r===s||r.parentCtx!==null&&r.parentCtx===s.parentCtx)&&(u=r.parentCtx),u!==null){const g=[r.returnState,s.returnState];r.returnState>s.returnState&&(g[0]=s.returnState,g[1]=r.returnState);const m=new nn([u,u],g);return o!==null&&o.set(r,s,m),m}const h=[r.returnState,s.returnState];let d=[r.parentCtx,s.parentCtx];r.returnState>s.returnState&&(h[0]=s.returnState,h[1]=r.returnState,d=[s.parentCtx,r.parentCtx]);const p=new nn(d,h);return o!==null&&o.set(r,s,p),p}}(n,e,t,i);if(t){if(n instanceof pd)return n;if(e instanceof pd)return e}return n instanceof $i&&(n=new nn([n.getParent()],[n.returnState])),e instanceof $i&&(e=new nn([e.getParent()],[e.returnState])),function(r,s,a,o){if(o!==null){let m=o.get(r,s);if(m!==null||(m=o.get(s,r),m!==null))return je.trace_atn_sim&&console.log("mergeArrays a="+r+",b="+s+" -> previous"),m}let l=0,u=0,h=0,d=new Array(r.returnStates.length+s.returnStates.length).fill(0),p=new Array(r.returnStates.length+s.returnStates.length).fill(null);for(;l<r.returnStates.length&&u<s.returnStates.length;){const m=r.parents[l],y=s.parents[u];if(r.returnStates[l]===s.returnStates[u]){const b=r.returnStates[l];b===je.EMPTY_RETURN_STATE&&m===null&&y===null||m!==null&&y!==null&&m===y?(p[h]=m,d[h]=b):(p[h]=yd(m,y,a,o),d[h]=b),l+=1,u+=1}else r.returnStates[l]<s.returnStates[u]?(p[h]=m,d[h]=r.returnStates[l],l+=1):(p[h]=y,d[h]=s.returnStates[u],u+=1);h+=1}if(l<r.returnStates.length)for(let m=l;m<r.returnStates.length;m++)p[h]=r.parents[m],d[h]=r.returnStates[m],h+=1;else for(let m=u;m<s.returnStates.length;m++)p[h]=s.parents[m],d[h]=s.returnStates[m],h+=1;if(h<p.length){if(h===1){const m=$i.create(p[0],d[0]);return o!==null&&o.set(r,s,m),m}p=p.slice(0,h),d=d.slice(0,h)}const g=new nn(p,d);return g.equals(r)?(o!==null&&o.set(r,s,r),je.trace_atn_sim&&console.log("mergeArrays a="+r+",b="+s+" -> a"),r):g.equals(s)?(o!==null&&o.set(r,s,s),je.trace_atn_sim&&console.log("mergeArrays a="+r+",b="+s+" -> b"),s):(function(m){const y=new Xo;for(let b=0;b<m.length;b++){const A=m[b];y.containsKey(A)||y.set(A,A)}for(let b=0;b<m.length;b++)m[b]=y.get(m[b])}(p),o!==null&&o.set(r,s,g),je.trace_atn_sim&&console.log("mergeArrays a="+r+",b="+s+" -> "+g),g)}(n,e,t,i)}class Gi{constructor(){this.data=new Uint32Array(1)}set(e){Gi._checkIndex(e),this._resize(e),this.data[e>>>5]|=1<<e%32}get(e){Gi._checkIndex(e);const t=e>>>5;return!(t>=this.data.length||!(this.data[t]&1<<e%32))}clear(e){Gi._checkIndex(e);const t=e>>>5;t<this.data.length&&(this.data[t]&=~(1<<e))}or(e){const t=Math.min(this.data.length,e.data.length);for(let i=0;i<t;++i)this.data[i]|=e.data[i];if(this.data.length<e.data.length){this._resize((e.data.length<<5)-1);const i=e.data.length;for(let r=t;r<i;++r)this.data[r]=e.data[r]}}values(){const e=new Array(this.length);let t=0;const i=this.data.length;for(let r=0;r<i;++r){let s=this.data[r];for(;s!==0;){const a=s&-s;e[t++]=(r<<5)+Gi._bitCount(a-1),s^=a}}return e}minValue(){for(let e=0;e<this.data.length;++e){let t=this.data[e];if(t!==0){let i=0;for(;!(1&t);)i++,t>>=1;return i+32*e}}return 0}hashCode(){return ar.hashStuff(this.values())}equals(e){return e instanceof Gi&&ka(this.data,e.data)}toString(){return"{"+this.values().join(", ")+"}"}get length(){return this.data.map(e=>Gi._bitCount(e)).reduce((e,t)=>e+t,0)}_resize(e){const t=e+32>>>5;if(t<=this.data.length)return;const i=new Uint32Array(t);i.set(this.data),i.fill(0,this.data.length),this.data=i}static _checkIndex(e){if(e<0)throw new RangeError("index cannot be negative")}static _bitCount(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,0+(e+=e>>16)&63}}let bu=class l0{constructor(e){this.atn=e}getDecisionLookahead(e){if(e===null)return null;const t=e.transitions.length,i=[];for(let r=0;r<t;r++){i[r]=new Er;const s=new or;this._LOOK(e.transition(r).target,null,je.EMPTY,i[r],s,new Gi,!1,!1),(i[r].length===0||i[r].contains(l0.HIT_PRED))&&(i[r]=null)}return i}LOOK(e,t,i){const r=new Er,s=(i=i||null)!==null?md(e.atn,i):null;return this._LOOK(e,t,s,r,new or,new Gi,!0,!0),r}_LOOK(e,t,i,r,s,a,o,l){const u=new ti({state:e,alt:0,context:i},null);if(!s.has(u)){if(s.add(u),e===t){if(i===null)return void r.addOne(Ee.EPSILON);if(i.isEmpty()&&l)return void r.addOne(Ee.EOF)}if(e instanceof Ui){if(i===null)return void r.addOne(Ee.EPSILON);if(i.isEmpty()&&l)return void r.addOne(Ee.EOF);if(i!==je.EMPTY){const h=a.get(e.ruleIndex);try{a.clear(e.ruleIndex);for(let d=0;d<i.length;d++){const p=this.atn.states[i.getReturnState(d)];this._LOOK(p,t,i.getParent(d),r,s,a,o,l)}}finally{h&&a.set(e.ruleIndex)}return}}for(let h=0;h<e.transitions.length;h++){const d=e.transitions[h];if(d.constructor===yu){if(a.get(d.target.ruleIndex))continue;const p=$i.create(i,d.followState.stateNumber);try{a.set(d.target.ruleIndex),this._LOOK(d.target,t,p,r,s,a,o,l)}finally{a.clear(d.target.ruleIndex)}}else if(d instanceof gd)o?this._LOOK(d.target,t,i,r,s,a,o,l):r.addOne(l0.HIT_PRED);else if(d.isEpsilon)this._LOOK(d.target,t,i,r,s,a,o,l);else if(d.constructor===cv)r.addRange(Ee.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType);else{let p=d.label;p!==null&&(d instanceof fd&&(p=p.complement(Ee.MIN_USER_TOKEN_TYPE,this.atn.maxTokenType)),r.addSet(p))}}}}};bu.HIT_PRED=Ee.INVALID_TYPE;let Ut=class{constructor(e,t){this.grammarType=e,this.maxTokenType=t,this.states=[],this.decisionToState=[],this.ruleToStartState=[],this.ruleToStopState=null,this.modeNameToStartState={},this.ruleToTokenType=null,this.lexerActions=null,this.modeToStartState=[]}nextTokensInContext(e,t){return new bu(this).LOOK(e,null,t)}nextTokensNoContext(e){return e.nextTokenWithinRule!==null||(e.nextTokenWithinRule=this.nextTokensInContext(e,null),e.nextTokenWithinRule.readOnly=!0),e.nextTokenWithinRule}nextTokens(e,t){return t===void 0?this.nextTokensNoContext(e):this.nextTokensInContext(e,t)}addState(e){e!==null&&(e.atn=this,e.stateNumber=this.states.length),this.states.push(e)}removeState(e){this.states[e.stateNumber]=null}defineDecisionState(e){return this.decisionToState.push(e),e.decision=this.decisionToState.length-1,e.decision}getDecisionState(e){return this.decisionToState.length===0?null:this.decisionToState[e]}getExpectedTokens(e,t){if(e<0||e>=this.states.length)throw"Invalid state number.";const i=this.states[e];let r=this.nextTokens(i);if(!r.contains(Ee.EPSILON))return r;const s=new Er;for(s.addSet(r),s.removeOne(Ee.EPSILON);t!==null&&t.invokingState>=0&&r.contains(Ee.EPSILON);){const a=this.states[t.invokingState].transitions[0];r=this.nextTokens(a.followState),s.addSet(r),s.removeOne(Ee.EPSILON),t=t.parentCtx}return r.contains(Ee.EPSILON)&&s.addOne(Ee.EOF),s}};Ut.INVALID_ALT_NUMBER=0;class gv extends Fe{constructor(){super(),this.stateType=Fe.BASIC}}class Pa extends Fe{constructor(){return super(),this.decision=-1,this.nonGreedy=!1,this}}class Oa extends Pa{constructor(){return super(),this.endState=null,this}}let vd=class extends Fe{constructor(){return super(),this.stateType=Fe.BLOCK_END,this.startState=null,this}};class Fa extends Fe{constructor(){return super(),this.stateType=Fe.LOOP_END,this.loopBackState=null,this}}class pv extends Fe{constructor(){return super(),this.stateType=Fe.RULE_START,this.stopState=null,this.isPrecedenceRule=!1,this}}class BR extends Pa{constructor(){return super(),this.stateType=Fe.TOKEN_START,this}}class mv extends Pa{constructor(){return super(),this.stateType=Fe.PLUS_LOOP_BACK,this}}class bd extends Fe{constructor(){return super(),this.stateType=Fe.STAR_LOOP_BACK,this}}class Js extends Pa{constructor(){return super(),this.stateType=Fe.STAR_LOOP_ENTRY,this.loopBackState=null,this.isPrecedenceDecision=null,this}}class Ed extends Oa{constructor(){return super(),this.stateType=Fe.PLUS_BLOCK_START,this.loopBackState=null,this}}class Ad extends Oa{constructor(){return super(),this.stateType=Fe.STAR_BLOCK_START,this}}class yv extends Oa{constructor(){return super(),this.stateType=Fe.BLOCK_START,this}}class Sd extends Pe{constructor(e,t){super(e),this.label_=t,this.label=this.makeLabel(),this.serializationType=Pe.ATOM}makeLabel(){const e=new Er;return e.addOne(this.label_),e}matches(e,t,i){return this.label_===e}toString(){return this.label_}}class UR extends Pe{constructor(e,t,i){super(e),this.serializationType=Pe.RANGE,this.start=t,this.stop=i,this.label=this.makeLabel()}makeLabel(){const e=new Er;return e.addRange(this.start,this.stop),e}matches(e,t,i){return e>=this.start&&e<=this.stop}toString(){return"'"+String.fromCharCode(this.start)+"'..'"+String.fromCharCode(this.stop)+"'"}}class vv extends Pe{constructor(e,t,i,r){super(e),this.serializationType=Pe.ACTION,this.ruleIndex=t,this.actionIndex=i===void 0?-1:i,this.isCtxDependent=r!==void 0&&r,this.isEpsilon=!0}matches(e,t,i){return!1}toString(){return"action_"+this.ruleIndex+":"+this.actionIndex}}class Jo extends Pe{constructor(e,t){super(e),this.serializationType=Pe.EPSILON,this.isEpsilon=!0,this.outermostPrecedenceReturn=t}matches(e,t,i){return!1}toString(){return"epsilon"}}class Eu extends bt{constructor(e,t,i){super(),this.ruleIndex=e===void 0?-1:e,this.predIndex=t===void 0?-1:t,this.isCtxDependent=i!==void 0&&i}evaluate(e,t){const i=this.isCtxDependent?t:null;return e.sempred(i,this.ruleIndex,this.predIndex)}updateHashCode(e){e.update(this.ruleIndex,this.predIndex,this.isCtxDependent)}equals(e){return this===e||e instanceof Eu&&this.ruleIndex===e.ruleIndex&&this.predIndex===e.predIndex&&this.isCtxDependent===e.isCtxDependent}toString(){return"{"+this.ruleIndex+":"+this.predIndex+"}?"}}bt.NONE=new Eu;class bv extends gd{constructor(e,t,i,r){super(e),this.serializationType=Pe.PREDICATE,this.ruleIndex=t,this.predIndex=i,this.isCtxDependent=r,this.isEpsilon=!0}matches(e,t,i){return!1}getPredicate(){return new Eu(this.ruleIndex,this.predIndex,this.isCtxDependent)}toString(){return"pred_"+this.ruleIndex+":"+this.predIndex}}class Au extends bt{constructor(e){super(),this.precedence=e===void 0?0:e}evaluate(e,t){return e.precpred(t,this.precedence)}evalPrecedence(e,t){return e.precpred(t,this.precedence)?bt.NONE:null}compareTo(e){return this.precedence-e.precedence}updateHashCode(e){e.update(this.precedence)}equals(e){return this===e||e instanceof Au&&this.precedence===e.precedence}toString(){return"{"+this.precedence+">=prec}?"}}bt.PrecedencePredicate=Au;class $R extends gd{constructor(e,t){super(e),this.serializationType=Pe.PRECEDENCE,this.precedence=t,this.isEpsilon=!0}matches(e,t,i){return!1}getPredicate(){return new Au(this.precedence)}toString(){return this.precedence+" >= _p"}}class Qo{constructor(e){e===void 0&&(e=null),this.readOnly=!1,this.verifyATN=e===null||e.verifyATN,this.generateRuleBypassTransitions=e!==null&&e.generateRuleBypassTransitions}}Qo.defaultOptions=new Qo,Qo.defaultOptions.readOnly=!0;class Ln{constructor(e){this.actionType=e,this.isPositionDependent=!1}hashCode(){const e=new ar;return this.updateHashCode(e),e.finish()}updateHashCode(e){e.update(this.actionType)}equals(e){return this===e}}class xd extends Ln{constructor(){super(6)}execute(e){e.skip()}toString(){return"skip"}}xd.INSTANCE=new xd;class Td extends Ln{constructor(e){super(0),this.channel=e}execute(e){e._channel=this.channel}updateHashCode(e){e.update(this.actionType,this.channel)}equals(e){return this===e||e instanceof Td&&this.channel===e.channel}toString(){return"channel("+this.channel+")"}}class wd extends Ln{constructor(e,t){super(1),this.ruleIndex=e,this.actionIndex=t,this.isPositionDependent=!0}execute(e){e.action(null,this.ruleIndex,this.actionIndex)}updateHashCode(e){e.update(this.actionType,this.ruleIndex,this.actionIndex)}equals(e){return this===e||e instanceof wd&&this.ruleIndex===e.ruleIndex&&this.actionIndex===e.actionIndex}}class Dd extends Ln{constructor(){super(3)}execute(e){e.more()}toString(){return"more"}}Dd.INSTANCE=new Dd;class Rd extends Ln{constructor(e){super(7),this.type=e}execute(e){e.type=this.type}updateHashCode(e){e.update(this.actionType,this.type)}equals(e){return this===e||e instanceof Rd&&this.type===e.type}toString(){return"type("+this.type+")"}}class Id extends Ln{constructor(e){super(5),this.mode=e}execute(e){e.pushMode(this.mode)}updateHashCode(e){e.update(this.actionType,this.mode)}equals(e){return this===e||e instanceof Id&&this.mode===e.mode}toString(){return"pushMode("+this.mode+")"}}class Cd extends Ln{constructor(){super(4)}execute(e){e.popMode()}toString(){return"popMode"}}Cd.INSTANCE=new Cd;class Nd extends Ln{constructor(e){super(2),this.mode=e}execute(e){e.setMode(this.mode)}updateHashCode(e){e.update(this.actionType,this.mode)}equals(e){return this===e||e instanceof Nd&&this.mode===e.mode}toString(){return"mode("+this.mode+")"}}function Su(n,e){const t=[];return t[n-1]=e,t.map(function(i){return e})}class Ld{constructor(e){e==null&&(e=Qo.defaultOptions),this.deserializationOptions=e,this.stateFactories=null,this.actionFactories=null}deserialize(e){const t=this.reset(e);this.checkVersion(t),t&&this.skipUUID();const i=this.readATN();this.readStates(i,t),this.readRules(i,t),this.readModes(i);const r=[];return this.readSets(i,r,this.readInt.bind(this)),t&&this.readSets(i,r,this.readInt32.bind(this)),this.readEdges(i,r),this.readDecisions(i),this.readLexerActions(i,t),this.markPrecedenceDecisions(i),this.verifyATN(i),this.deserializationOptions.generateRuleBypassTransitions&&i.grammarType===1&&(this.generateRuleBypassTransitions(i),this.verifyATN(i)),i}reset(e){if((e.charCodeAt?e.charCodeAt(0):e[0])===3){const t=function(r){const s=r.charCodeAt(0);return s>1?s-2:s+65534},i=e.split("").map(t);return i[0]=e.charCodeAt(0),this.data=i,this.pos=0,!0}return this.data=e,this.pos=0,!1}skipUUID(){let e=0;for(;e++<8;)this.readInt()}checkVersion(e){const t=this.readInt();if(!e&&t!==4)throw"Could not deserialize ATN with version "+t+" (expected 4)."}readATN(){const e=this.readInt(),t=this.readInt();return new Ut(e,t)}readStates(e,t){let i,r,s;const a=[],o=[],l=this.readInt();for(let d=0;d<l;d++){const p=this.readInt();if(p===Fe.INVALID_TYPE){e.addState(null);continue}let g=this.readInt();t&&g===65535&&(g=-1);const m=this.stateFactory(p,g);if(p===Fe.LOOP_END){const y=this.readInt();a.push([m,y])}else if(m instanceof Oa){const y=this.readInt();o.push([m,y])}e.addState(m)}for(i=0;i<a.length;i++)r=a[i],r[0].loopBackState=e.states[r[1]];for(i=0;i<o.length;i++)r=o[i],r[0].endState=e.states[r[1]];let u=this.readInt();for(i=0;i<u;i++)s=this.readInt(),e.states[s].nonGreedy=!0;let h=this.readInt();for(i=0;i<h;i++)s=this.readInt(),e.states[s].isPrecedenceRule=!0}readRules(e,t){let i;const r=this.readInt();for(e.grammarType===0&&(e.ruleToTokenType=Su(r,0)),e.ruleToStartState=Su(r,0),i=0;i<r;i++){const s=this.readInt();if(e.ruleToStartState[i]=e.states[s],e.grammarType===0){let a=this.readInt();t&&a===65535&&(a=Ee.EOF),e.ruleToTokenType[i]=a}}for(e.ruleToStopState=Su(r,0),i=0;i<e.states.length;i++){const s=e.states[i];s instanceof Ui&&(e.ruleToStopState[s.ruleIndex]=s,e.ruleToStartState[s.ruleIndex].stopState=s)}}readModes(e){const t=this.readInt();for(let i=0;i<t;i++){let r=this.readInt();e.modeToStartState.push(e.states[r])}}readSets(e,t,i){const r=this.readInt();for(let s=0;s<r;s++){const a=new Er;t.push(a);const o=this.readInt();this.readInt()!==0&&a.addOne(-1);for(let l=0;l<o;l++){const u=i(),h=i();a.addRange(u,h)}}}readEdges(e,t){let i,r,s,a,o;const l=this.readInt();for(i=0;i<l;i++){const u=this.readInt(),h=this.readInt(),d=this.readInt(),p=this.readInt(),g=this.readInt(),m=this.readInt();a=this.edgeFactory(e,d,u,h,p,g,m,t),e.states[u].addTransition(a)}for(i=0;i<e.states.length;i++)for(s=e.states[i],r=0;r<s.transitions.length;r++){const u=s.transitions[r];if(!(u instanceof yu))continue;let h=-1;e.ruleToStartState[u.target.ruleIndex].isPrecedenceRule&&u.precedence===0&&(h=u.target.ruleIndex),a=new Jo(u.followState,h),e.ruleToStopState[u.target.ruleIndex].addTransition(a)}for(i=0;i<e.states.length;i++){if(s=e.states[i],s instanceof Oa){if(s.endState===null||s.endState.startState!==null)throw"IllegalState";s.endState.startState=s}if(s instanceof mv)for(r=0;r<s.transitions.length;r++)o=s.transitions[r].target,o instanceof Ed&&(o.loopBackState=s);else if(s instanceof bd)for(r=0;r<s.transitions.length;r++)o=s.transitions[r].target,o instanceof Js&&(o.loopBackState=s)}}readDecisions(e){const t=this.readInt();for(let i=0;i<t;i++){const r=this.readInt(),s=e.states[r];e.decisionToState.push(s),s.decision=i}}readLexerActions(e,t){if(e.grammarType===0){const i=this.readInt();e.lexerActions=Su(i,null);for(let r=0;r<i;r++){const s=this.readInt();let a=this.readInt();t&&a===65535&&(a=-1);let o=this.readInt();t&&o===65535&&(o=-1),e.lexerActions[r]=this.lexerActionFactory(s,a,o)}}}generateRuleBypassTransitions(e){let t;const i=e.ruleToStartState.length;for(t=0;t<i;t++)e.ruleToTokenType[t]=e.maxTokenType+t+1;for(t=0;t<i;t++)this.generateRuleBypassTransition(e,t)}generateRuleBypassTransition(e,t){let i,r;const s=new yv;s.ruleIndex=t,e.addState(s);const a=new vd;a.ruleIndex=t,e.addState(a),s.endState=a,e.defineDecisionState(s),a.startState=s;let o=null,l=null;if(e.ruleToStartState[t].isPrecedenceRule){for(l=null,i=0;i<e.states.length;i++)if(r=e.states[i],this.stateIsEndStateFor(r,t)){l=r,o=r.loopBackState.transitions[0];break}if(o===null)throw"Couldn't identify final state of the precedence rule prefix section."}else l=e.ruleToStopState[t];for(i=0;i<e.states.length;i++){r=e.states[i];for(let p=0;p<r.transitions.length;p++){const g=r.transitions[p];g!==o&&g.target===l&&(g.target=a)}}const u=e.ruleToStartState[t],h=u.transitions.length;for(;h>0;)s.addTransition(u.transitions[h-1]),u.transitions=u.transitions.slice(-1);e.ruleToStartState[t].addTransition(new Jo(s)),a.addTransition(new Jo(l));const d=new gv;e.addState(d),d.addTransition(new Sd(a,e.ruleToTokenType[t])),s.addTransition(new Jo(d))}stateIsEndStateFor(e,t){if(e.ruleIndex!==t||!(e instanceof Js))return null;const i=e.transitions[e.transitions.length-1].target;return i instanceof Fa&&i.epsilonOnlyTransitions&&i.transitions[0].target instanceof Ui?e:null}markPrecedenceDecisions(e){for(let t=0;t<e.states.length;t++){const i=e.states[t];if(i instanceof Js&&e.ruleToStartState[i.ruleIndex].isPrecedenceRule){const r=i.transitions[i.transitions.length-1].target;r instanceof Fa&&r.epsilonOnlyTransitions&&r.transitions[0].target instanceof Ui&&(i.isPrecedenceDecision=!0)}}}verifyATN(e){if(this.deserializationOptions.verifyATN)for(let t=0;t<e.states.length;t++){const i=e.states[t];if(i!==null)if(this.checkCondition(i.epsilonOnlyTransitions||i.transitions.length<=1),i instanceof Ed)this.checkCondition(i.loopBackState!==null);else if(i instanceof Js)if(this.checkCondition(i.loopBackState!==null),this.checkCondition(i.transitions.length===2),i.transitions[0].target instanceof Ad)this.checkCondition(i.transitions[1].target instanceof Fa),this.checkCondition(!i.nonGreedy);else{if(!(i.transitions[0].target instanceof Fa))throw"IllegalState";this.checkCondition(i.transitions[1].target instanceof Ad),this.checkCondition(i.nonGreedy)}else i instanceof bd?(this.checkCondition(i.transitions.length===1),this.checkCondition(i.transitions[0].target instanceof Js)):i instanceof Fa?this.checkCondition(i.loopBackState!==null):i instanceof pv?this.checkCondition(i.stopState!==null):i instanceof Oa?this.checkCondition(i.endState!==null):i instanceof vd?this.checkCondition(i.startState!==null):i instanceof Pa?this.checkCondition(i.transitions.length<=1||i.decision>=0):this.checkCondition(i.transitions.length<=1||i instanceof Ui)}}checkCondition(e,t){if(!e)throw t==null&&(t="IllegalState"),t}readInt(){return this.data[this.pos++]}readInt32(){return this.readInt()|this.readInt()<<16}edgeFactory(e,t,i,r,s,a,o,l){const u=e.states[r];switch(t){case Pe.EPSILON:return new Jo(u);case Pe.RANGE:return new UR(u,o!==0?Ee.EOF:s,a);case Pe.RULE:return new yu(e.states[s],a,o,u);case Pe.PREDICATE:return new bv(u,s,a,o!==0);case Pe.PRECEDENCE:return new $R(u,s);case Pe.ATOM:return new Sd(u,o!==0?Ee.EOF:s);case Pe.ACTION:return new vv(u,s,a,o!==0);case Pe.SET:return new dd(u,l[s]);case Pe.NOT_SET:return new fd(u,l[s]);case Pe.WILDCARD:return new cv(u);default:throw"The specified transition type: "+t+" is not valid."}}stateFactory(e,t){if(this.stateFactories===null){const i=[];i[Fe.INVALID_TYPE]=null,i[Fe.BASIC]=()=>new gv,i[Fe.RULE_START]=()=>new pv,i[Fe.BLOCK_START]=()=>new yv,i[Fe.PLUS_BLOCK_START]=()=>new Ed,i[Fe.STAR_BLOCK_START]=()=>new Ad,i[Fe.TOKEN_START]=()=>new BR,i[Fe.RULE_STOP]=()=>new Ui,i[Fe.BLOCK_END]=()=>new vd,i[Fe.STAR_LOOP_BACK]=()=>new bd,i[Fe.STAR_LOOP_ENTRY]=()=>new Js,i[Fe.PLUS_LOOP_BACK]=()=>new mv,i[Fe.LOOP_END]=()=>new Fa,this.stateFactories=i}if(e>this.stateFactories.length||this.stateFactories[e]===null)throw"The specified state type "+e+" is not valid.";{const i=this.stateFactories[e]();if(i!==null)return i.ruleIndex=t,i}}lexerActionFactory(e,t,i){if(this.actionFactories===null){const r=[];r[0]=(s,a)=>new Td(s),r[1]=(s,a)=>new wd(s,a),r[2]=(s,a)=>new Nd(s),r[3]=(s,a)=>Dd.INSTANCE,r[4]=(s,a)=>Cd.INSTANCE,r[5]=(s,a)=>new Id(s),r[6]=(s,a)=>xd.INSTANCE,r[7]=(s,a)=>new Rd(s),this.actionFactories=r}if(e>this.actionFactories.length||this.actionFactories[e]===null)throw"The specified lexer action type "+e+" is not valid.";return this.actionFactories[e](t,i)}}class Zo{syntaxError(e,t,i,r,s,a){}reportAmbiguity(e,t,i,r,s,a,o){}reportAttemptingFullContext(e,t,i,r,s,a){}reportContextSensitivity(e,t,i,r,s,a){}}class _d extends Zo{constructor(){super()}syntaxError(e,t,i,r,s,a){console.error("line "+i+":"+r+" "+s)}}_d.INSTANCE=new _d;class GR extends Zo{constructor(e){if(super(),e===null)throw"delegates";return this.delegates=e,this}syntaxError(e,t,i,r,s,a){this.delegates.map(o=>o.syntaxError(e,t,i,r,s,a))}reportAmbiguity(e,t,i,r,s,a,o){this.delegates.map(l=>l.reportAmbiguity(e,t,i,r,s,a,o))}reportAttemptingFullContext(e,t,i,r,s,a){this.delegates.map(o=>o.reportAttemptingFullContext(e,t,i,r,s,a))}reportContextSensitivity(e,t,i,r,s,a){this.delegates.map(o=>o.reportContextSensitivity(e,t,i,r,s,a))}}class xu{constructor(){this._listeners=[_d.INSTANCE],this._interp=null,this._stateNumber=-1}checkVersion(e){const t="4.13.2";t!==e&&console.log("ANTLR runtime and generated code versions disagree: "+t+"!="+e)}addErrorListener(e){this._listeners.push(e)}removeErrorListeners(){this._listeners=[]}getLiteralNames(){return Object.getPrototypeOf(this).constructor.literalNames||[]}getSymbolicNames(){return Object.getPrototypeOf(this).constructor.symbolicNames||[]}getTokenNames(){if(!this.tokenNames){const e=this.getLiteralNames(),t=this.getSymbolicNames(),i=e.length>t.length?e.length:t.length;this.tokenNames=[];for(let r=0;r<i;r++)this.tokenNames[r]=e[r]||t[r]||"<INVALID"}return this.tokenNames}getTokenTypeMap(){const e=this.getTokenNames();if(e===null)throw"The current recognizer does not provide a list of token names.";let t=this.tokenTypeMapCache[e];return t===void 0&&(t=e.reduce(function(i,r,s){i[r]=s}),t.EOF=Ee.EOF,this.tokenTypeMapCache[e]=t),t}getRuleIndexMap(){const e=this.ruleNames;if(e===null)throw"The current recognizer does not provide a list of rule names.";let t=this.ruleIndexMapCache[e];return t===void 0&&(t=e.reduce(function(i,r,s){i[r]=s}),this.ruleIndexMapCache[e]=t),t}getTokenType(e){const t=this.getTokenTypeMap()[e];return t!==void 0?t:Ee.INVALID_TYPE}getErrorHeader(e){return"line "+e.getOffendingToken().line+":"+e.getOffendingToken().column}getTokenErrorDisplay(e){if(e===null)return"<no token>";let t=e.text;return t===null&&(t=e.type===Ee.EOF?"<EOF>":"<"+e.type+">"),t=t.replace(`
`,"\\n").replace("\r","\\r").replace("	","\\t"),"'"+t+"'"}getErrorListenerDispatch(){return console.warn("Calling deprecated method in Recognizer class: getErrorListenerDispatch()"),this.getErrorListener()}getErrorListener(){return new GR(this._listeners)}sempred(e,t,i){return!0}precpred(e,t){return!0}get atn(){return this._interp.atn}get state(){return this._stateNumber}set state(e){this._stateNumber=e}}xu.tokenTypeMapCache={},xu.ruleIndexMapCache={};class _n extends Ee{constructor(e,t,i,r,s){super(),this.source=e!==void 0?e:_n.EMPTY_SOURCE,this.type=t!==void 0?t:null,this.channel=i!==void 0?i:Ee.DEFAULT_CHANNEL,this.start=r!==void 0?r:-1,this.stop=s!==void 0?s:-1,this.tokenIndex=-1,this.source[0]!==null?(this.line=e[0].line,this.column=e[0].column):this.column=-1}clone(){const e=new _n(this.source,this.type,this.channel,this.start,this.stop);return e.tokenIndex=this.tokenIndex,e.line=this.line,e.column=this.column,e.text=this.text,e}cloneWithType(e){const t=new _n(this.source,e,this.channel,this.start,this.stop);return t.tokenIndex=this.tokenIndex,t.line=this.line,t.column=this.column,e===Ee.EOF&&(t.text=""),t}toString(){let e=this.text;return e=e!==null?e.replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t"):"<no text>","[@"+this.tokenIndex+","+this.start+":"+this.stop+"='"+e+"',<"+this.type+">"+(this.channel>0?",channel="+this.channel:"")+","+this.line+":"+this.column+"]"}get text(){if(this._text!==null)return this._text;const e=this.getInputStream();if(e===null)return null;const t=e.size;return this.start<t&&this.stop<t?e.getText(this.start,this.stop):"<EOF>"}set text(e){this._text=e}}_n.EMPTY_SOURCE=[null,null];class qR{}class Md extends qR{constructor(e){super(),this.copyText=e!==void 0&&e}create(e,t,i,r,s,a,o,l){const u=new _n(e,t,r,s,a);return u.line=o,u.column=l,i!==null?u.text=i:this.copyText&&e[1]!==null&&(u.text=e[1].getText(s,a)),u}createThin(e,t){const i=new _n(null,e);return i.text=t,i}}Md.DEFAULT=new Md;class Mn extends Error{constructor(e){super(e.message),Error.captureStackTrace&&Error.captureStackTrace(this,Mn),this.message=e.message,this.recognizer=e.recognizer,this.input=e.input,this.ctx=e.ctx,this.offendingToken=null,this.offendingState=-1,this.recognizer!==null&&(this.offendingState=this.recognizer.state)}getExpectedTokens(){return this.recognizer!==null?this.recognizer.atn.getExpectedTokens(this.offendingState,this.ctx):null}toString(){return this.message}}class kd extends Mn{constructor(e,t,i,r){super({message:"",recognizer:e,input:t,ctx:null}),this.startIndex=i,this.deadEndConfigs=r}toString(){let e="";return this.startIndex>=0&&this.startIndex<this.input.size&&(e=this.input.getText(new pt(this.startIndex,this.startIndex))),"LexerNoViableAltException"+e}}class Kt extends xu{constructor(e){super(),this._input=e,this._factory=Md.DEFAULT,this._tokenFactorySourcePair=[this,e],this._interp=null,this._token=null,this._tokenStartCharIndex=-1,this._tokenStartLine=-1,this._tokenStartColumn=-1,this._hitEOF=!1,this._channel=Ee.DEFAULT_CHANNEL,this._type=Ee.INVALID_TYPE,this._modeStack=[],this._mode=Kt.DEFAULT_MODE,this._text=null}reset(){this._input!==null&&this._input.seek(0),this._token=null,this._type=Ee.INVALID_TYPE,this._channel=Ee.DEFAULT_CHANNEL,this._tokenStartCharIndex=-1,this._tokenStartColumn=-1,this._tokenStartLine=-1,this._text=null,this._hitEOF=!1,this._mode=Kt.DEFAULT_MODE,this._modeStack=[],this._interp.reset()}nextToken(){if(this._input===null)throw"nextToken requires a non-null input stream.";const e=this._input.mark();try{for(;;){if(this._hitEOF)return this.emitEOF(),this._token;this._token=null,this._channel=Ee.DEFAULT_CHANNEL,this._tokenStartCharIndex=this._input.index,this._tokenStartColumn=this._interp.column,this._tokenStartLine=this._interp.line,this._text=null;let t=!1;for(;;){this._type=Ee.INVALID_TYPE;let i=Kt.SKIP;try{i=this._interp.match(this._input,this._mode)}catch(r){if(!(r instanceof Mn))throw console.log(r.stack),r;this.notifyListeners(r),this.recover(r)}if(this._input.LA(1)===Ee.EOF&&(this._hitEOF=!0),this._type===Ee.INVALID_TYPE&&(this._type=i),this._type===Kt.SKIP){t=!0;break}if(this._type!==Kt.MORE)break}if(!t)return this._token===null&&this.emit(),this._token}}finally{this._input.release(e)}}skip(){this._type=Kt.SKIP}more(){this._type=Kt.MORE}mode(e){console.warn("Calling deprecated method in Lexer class: mode(...)"),this.setMode(e)}setMode(e){this._mode=e}getMode(){return this._mode}getModeStack(){return this._modeStack}pushMode(e){this._interp.debug&&console.log("pushMode "+e),this._modeStack.push(this._mode),this.setMode(e)}popMode(){if(this._modeStack.length===0)throw"Empty Stack";return this._interp.debug&&console.log("popMode back to "+this._modeStack.slice(0,-1)),this.setMode(this._modeStack.pop()),this._mode}emitToken(e){this._token=e}emit(){const e=this._factory.create(this._tokenFactorySourcePair,this._type,this._text,this._channel,this._tokenStartCharIndex,this.getCharIndex()-1,this._tokenStartLine,this._tokenStartColumn);return this.emitToken(e),e}emitEOF(){const e=this.column,t=this.line,i=this._factory.create(this._tokenFactorySourcePair,Ee.EOF,null,Ee.DEFAULT_CHANNEL,this._input.index,this._input.index-1,t,e);return this.emitToken(i),i}getCharIndex(){return this._input.index}getAllTokens(){const e=[];let t=this.nextToken();for(;t.type!==Ee.EOF;)e.push(t),t=this.nextToken();return e}notifyListeners(e){const t=this._tokenStartCharIndex,i=this._input.index,r=this._input.getText(t,i),s="token recognition error at: '"+this.getErrorDisplay(r)+"'";this.getErrorListener().syntaxError(this,null,this._tokenStartLine,this._tokenStartColumn,s,e)}getErrorDisplay(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i]);return t.join("")}getErrorDisplayForChar(e){return e.charCodeAt(0)===Ee.EOF?"<EOF>":e===`
`?"\\n":e==="	"?"\\t":e==="\r"?"\\r":e}getCharErrorDisplay(e){return"'"+this.getErrorDisplayForChar(e)+"'"}recover(e){this._input.LA(1)!==Ee.EOF&&(e instanceof kd?this._interp.consume(this._input):this._input.consume())}get inputStream(){return this._input}set inputStream(e){this._input=null,this._tokenFactorySourcePair=[this,this._input],this.reset(),this._input=e,this._tokenFactorySourcePair=[this,this._input]}get sourceName(){return this._input.sourceName}get type(){return this._type}set type(e){this._type=e}get line(){return this._interp.line}set line(e){this._interp.line=e}get column(){return this._interp.column}set column(e){this._interp.column=e}get text(){return this._text!==null?this._text:this._interp.getText(this._input)}set text(e){this._text=e}}function VR(n){return n.hashCodeForConfigSet()}function HR(n,e){return n===e||n!==null&&e!==null&&n.equalsForConfigSet(e)}Kt.DEFAULT_MODE=0,Kt.MORE=-2,Kt.SKIP=-3,Kt.DEFAULT_TOKEN_CHANNEL=Ee.DEFAULT_CHANNEL,Kt.HIDDEN=Ee.HIDDEN_CHANNEL,Kt.MIN_CHAR_VALUE=0,Kt.MAX_CHAR_VALUE=1114111;class qi{constructor(e){this.configLookup=new or(VR,HR),this.fullCtx=e===void 0||e,this.readOnly=!1,this.configs=[],this.uniqueAlt=0,this.conflictingAlts=null,this.hasSemanticContext=!1,this.dipsIntoOuterContext=!1,this.cachedHashCode=-1}add(e,t){if(t===void 0&&(t=null),this.readOnly)throw"This set is readonly";e.semanticContext!==bt.NONE&&(this.hasSemanticContext=!0),e.reachesIntoOuterContext>0&&(this.dipsIntoOuterContext=!0);const i=this.configLookup.getOrAdd(e);if(i===e)return this.cachedHashCode=-1,this.configs.push(e),!0;const r=!this.fullCtx,s=yd(i.context,e.context,r,t);return i.reachesIntoOuterContext=Math.max(i.reachesIntoOuterContext,e.reachesIntoOuterContext),e.precedenceFilterSuppressed&&(i.precedenceFilterSuppressed=!0),i.context=s,!0}getStates(){const e=new or;for(let t=0;t<this.configs.length;t++)e.add(this.configs[t].state);return e}getPredicates(){const e=[];for(let t=0;t<this.configs.length;t++){const i=this.configs[t].semanticContext;i!==bt.NONE&&e.push(i.semanticContext)}return e}optimizeConfigs(e){if(this.readOnly)throw"This set is readonly";if(this.configLookup.length!==0)for(let t=0;t<this.configs.length;t++){const i=this.configs[t];i.context=e.getCachedContext(i.context)}}addAll(e){for(let t=0;t<e.length;t++)this.add(e[t]);return!1}equals(e){return this===e||e instanceof qi&&ka(this.configs,e.configs)&&this.fullCtx===e.fullCtx&&this.uniqueAlt===e.uniqueAlt&&this.conflictingAlts===e.conflictingAlts&&this.hasSemanticContext===e.hasSemanticContext&&this.dipsIntoOuterContext===e.dipsIntoOuterContext}hashCode(){const e=new ar;return e.update(this.configs),e.finish()}updateHashCode(e){this.readOnly?(this.cachedHashCode===-1&&(this.cachedHashCode=this.hashCode()),e.update(this.cachedHashCode)):e.update(this.hashCode())}isEmpty(){return this.configs.length===0}contains(e){if(this.configLookup===null)throw"This method is not implemented for readonly sets.";return this.configLookup.contains(e)}containsFast(e){if(this.configLookup===null)throw"This method is not implemented for readonly sets.";return this.configLookup.containsFast(e)}clear(){if(this.readOnly)throw"This set is readonly";this.configs=[],this.cachedHashCode=-1,this.configLookup=new or}setReadonly(e){this.readOnly=e,e&&(this.configLookup=null)}toString(){return Cn(this.configs)+(this.hasSemanticContext?",hasSemanticContext="+this.hasSemanticContext:"")+(this.uniqueAlt!==Ut.INVALID_ALT_NUMBER?",uniqueAlt="+this.uniqueAlt:"")+(this.conflictingAlts!==null?",conflictingAlts="+this.conflictingAlts:"")+(this.dipsIntoOuterContext?",dipsIntoOuterContext":"")}get items(){return this.configs}get length(){return this.configs.length}}class kn{constructor(e,t){return e===null&&(e=-1),t===null&&(t=new qi),this.stateNumber=e,this.configs=t,this.edges=null,this.isAcceptState=!1,this.prediction=0,this.lexerActionExecutor=null,this.requiresFullContext=!1,this.predicates=null,this}getAltSet(){const e=new or;if(this.configs!==null)for(let t=0;t<this.configs.length;t++){const i=this.configs[t];e.add(i.alt)}return e.length===0?null:e}equals(e){return this===e||e instanceof kn&&this.configs.equals(e.configs)}toString(){let e=this.stateNumber+":"+this.configs;return this.isAcceptState&&(e+="=>",this.predicates!==null?e+=this.predicates:e+=this.prediction),e}hashCode(){const e=new ar;return e.update(this.configs),e.finish()}}class sn{constructor(e,t){return this.atn=e,this.sharedContextCache=t,this}getCachedContext(e){if(this.sharedContextCache===null)return e;const t=new Xo;return fv(e,this.sharedContextCache,t)}}sn.ERROR=new kn(2147483647,new qi);class Ev extends qi{constructor(){super(),this.configLookup=new or}}class Ji extends ti{constructor(e,t){super(e,t);const i=e.lexerActionExecutor||null;return this.lexerActionExecutor=i||(t!==null?t.lexerActionExecutor:null),this.passedThroughNonGreedyDecision=t!==null&&this.checkNonGreedyDecision(t,this.state),this.hashCodeForConfigSet=Ji.prototype.hashCode,this.equalsForConfigSet=Ji.prototype.equals,this}updateHashCode(e){e.update(this.state.stateNumber,this.alt,this.context,this.semanticContext,this.passedThroughNonGreedyDecision,this.lexerActionExecutor)}equals(e){return this===e||e instanceof Ji&&this.passedThroughNonGreedyDecision===e.passedThroughNonGreedyDecision&&(this.lexerActionExecutor?this.lexerActionExecutor.equals(e.lexerActionExecutor):!e.lexerActionExecutor)&&super.equals(e)}checkNonGreedyDecision(e,t){return e.passedThroughNonGreedyDecision||t instanceof Pa&&t.nonGreedy}}class el extends Ln{constructor(e,t){super(t.actionType),this.offset=e,this.action=t,this.isPositionDependent=!0}execute(e){this.action.execute(e)}updateHashCode(e){e.update(this.actionType,this.offset,this.action)}equals(e){return this===e||e instanceof el&&this.offset===e.offset&&this.action===e.action}}class Ba{constructor(e){return this.lexerActions=e===null?[]:e,this.cachedHashCode=ar.hashStuff(e),this}fixOffsetBeforeMatch(e){let t=null;for(let i=0;i<this.lexerActions.length;i++)!this.lexerActions[i].isPositionDependent||this.lexerActions[i]instanceof el||(t===null&&(t=this.lexerActions.concat([])),t[i]=new el(e,this.lexerActions[i]));return t===null?this:new Ba(t)}execute(e,t,i){let r=!1;const s=t.index;try{for(let a=0;a<this.lexerActions.length;a++){let o=this.lexerActions[a];if(o instanceof el){const l=o.offset;t.seek(i+l),o=o.action,r=i+l!==s}else o.isPositionDependent&&(t.seek(s),r=!1);o.execute(e)}}finally{r&&t.seek(s)}}hashCode(){return this.cachedHashCode}updateHashCode(e){e.update(this.cachedHashCode)}equals(e){if(this===e)return!0;if(e instanceof Ba){if(this.cachedHashCode!=e.cachedHashCode||this.lexerActions.length!=e.lexerActions.length)return!1;{const t=this.lexerActions.length;for(let i=0;i<t;++i)if(!this.lexerActions[i].equals(e.lexerActions[i]))return!1;return!0}}return!1}static append(e,t){if(e===null)return new Ba([t]);const i=e.lexerActions.concat([t]);return new Ba(i)}}function Av(n){n.index=-1,n.line=0,n.column=-1,n.dfaState=null}class KR{constructor(){Av(this)}reset(){Av(this)}}class Wt extends sn{constructor(e,t,i,r){super(t,r),this.decisionToDFA=i,this.recog=e,this.startIndex=-1,this.line=1,this.column=0,this.mode=Kt.DEFAULT_MODE,this.prevAccept=new KR}copyState(e){this.column=e.column,this.line=e.line,this.mode=e.mode,this.startIndex=e.startIndex}match(e,t){this.mode=t;const i=e.mark();try{this.startIndex=e.index,this.prevAccept.reset();const r=this.decisionToDFA[t];return r.s0===null?this.matchATN(e):this.execATN(e,r.s0)}finally{e.release(i)}}reset(){this.prevAccept.reset(),this.startIndex=-1,this.line=1,this.column=0,this.mode=Kt.DEFAULT_MODE}matchATN(e){const t=this.atn.modeToStartState[this.mode];Wt.debug&&console.log("matchATN mode "+this.mode+" start: "+t);const i=this.mode,r=this.computeStartState(e,t),s=r.hasSemanticContext;r.hasSemanticContext=!1;const a=this.addDFAState(r);s||(this.decisionToDFA[this.mode].s0=a);const o=this.execATN(e,a);return Wt.debug&&console.log("DFA after matchATN: "+this.decisionToDFA[i].toLexerString()),o}execATN(e,t){Wt.debug&&console.log("start state closure="+t.configs),t.isAcceptState&&this.captureSimState(this.prevAccept,e,t);let i=e.LA(1),r=t;for(;;){Wt.debug&&console.log("execATN loop starting closure: "+r.configs);let s=this.getExistingTargetState(r,i);if(s===null&&(s=this.computeTargetState(e,r,i)),s===sn.ERROR||(i!==Ee.EOF&&this.consume(e),s.isAcceptState&&(this.captureSimState(this.prevAccept,e,s),i===Ee.EOF)))break;i=e.LA(1),r=s}return this.failOrAccept(this.prevAccept,e,r.configs,i)}getExistingTargetState(e,t){if(e.edges===null||t<Wt.MIN_DFA_EDGE||t>Wt.MAX_DFA_EDGE)return null;let i=e.edges[t-Wt.MIN_DFA_EDGE];return i===void 0&&(i=null),Wt.debug&&i!==null&&console.log("reuse state "+e.stateNumber+" edge to "+i.stateNumber),i}computeTargetState(e,t,i){const r=new Ev;return this.getReachableConfigSet(e,t.configs,r,i),r.items.length===0?(r.hasSemanticContext||this.addDFAEdge(t,i,sn.ERROR),sn.ERROR):this.addDFAEdge(t,i,null,r)}failOrAccept(e,t,i,r){if(this.prevAccept.dfaState!==null){const s=e.dfaState.lexerActionExecutor;return this.accept(t,s,this.startIndex,e.index,e.line,e.column),e.dfaState.prediction}if(r===Ee.EOF&&t.index===this.startIndex)return Ee.EOF;throw new kd(this.recog,t,this.startIndex,i)}getReachableConfigSet(e,t,i,r){let s=Ut.INVALID_ALT_NUMBER;for(let a=0;a<t.items.length;a++){const o=t.items[a],l=o.alt===s;if(!l||!o.passedThroughNonGreedyDecision){Wt.debug&&console.log(`testing %s at %s
`,this.getTokenName(r),o.toString(this.recog,!0));for(let u=0;u<o.state.transitions.length;u++){const h=o.state.transitions[u],d=this.getReachableTarget(h,r);if(d!==null){let p=o.lexerActionExecutor;p!==null&&(p=p.fixOffsetBeforeMatch(e.index-this.startIndex));const g=r===Ee.EOF,m=new Ji({state:d,lexerActionExecutor:p},o);this.closure(e,m,i,l,!0,g)&&(s=o.alt)}}}}}accept(e,t,i,r,s,a){Wt.debug&&console.log(`ACTION %s
`,t),e.seek(r),this.line=s,this.column=a,t!==null&&this.recog!==null&&t.execute(this.recog,e,i)}getReachableTarget(e,t){return e.matches(t,0,Kt.MAX_CHAR_VALUE)?e.target:null}computeStartState(e,t){const i=je.EMPTY,r=new Ev;for(let s=0;s<t.transitions.length;s++){const a=t.transitions[s].target,o=new Ji({state:a,alt:s+1,context:i},null);this.closure(e,o,r,!1,!1,!1)}return r}closure(e,t,i,r,s,a){let o=null;if(Wt.debug&&console.log("closure("+t.toString(this.recog,!0)+")"),t.state instanceof Ui){if(Wt.debug&&(this.recog!==null?console.log(`closure at %s rule stop %s
`,this.recog.ruleNames[t.state.ruleIndex],t):console.log(`closure at rule stop %s
`,t)),t.context===null||t.context.hasEmptyPath()){if(t.context===null||t.context.isEmpty())return i.add(t),!0;i.add(new Ji({state:t.state,context:je.EMPTY},t)),r=!0}if(t.context!==null&&!t.context.isEmpty()){for(let l=0;l<t.context.length;l++)if(t.context.getReturnState(l)!==je.EMPTY_RETURN_STATE){const u=t.context.getParent(l),h=this.atn.states[t.context.getReturnState(l)];o=new Ji({state:h,context:u},t),r=this.closure(e,o,i,r,s,a)}}return r}t.state.epsilonOnlyTransitions||r&&t.passedThroughNonGreedyDecision||i.add(t);for(let l=0;l<t.state.transitions.length;l++){const u=t.state.transitions[l];o=this.getEpsilonTarget(e,t,u,i,s,a),o!==null&&(r=this.closure(e,o,i,r,s,a))}return r}getEpsilonTarget(e,t,i,r,s,a){let o=null;if(i.serializationType===Pe.RULE){const l=$i.create(t.context,i.followState.stateNumber);o=new Ji({state:i.target,context:l},t)}else{if(i.serializationType===Pe.PRECEDENCE)throw"Precedence predicates are not supported in lexers.";if(i.serializationType===Pe.PREDICATE)Wt.debug&&console.log("EVAL rule "+i.ruleIndex+":"+i.predIndex),r.hasSemanticContext=!0,this.evaluatePredicate(e,i.ruleIndex,i.predIndex,s)&&(o=new Ji({state:i.target},t));else if(i.serializationType===Pe.ACTION)if(t.context===null||t.context.hasEmptyPath()){const l=Ba.append(t.lexerActionExecutor,this.atn.lexerActions[i.actionIndex]);o=new Ji({state:i.target,lexerActionExecutor:l},t)}else o=new Ji({state:i.target},t);else i.serializationType===Pe.EPSILON?o=new Ji({state:i.target},t):i.serializationType!==Pe.ATOM&&i.serializationType!==Pe.RANGE&&i.serializationType!==Pe.SET||a&&i.matches(Ee.EOF,0,Kt.MAX_CHAR_VALUE)&&(o=new Ji({state:i.target},t))}return o}evaluatePredicate(e,t,i,r){if(this.recog===null)return!0;if(!r)return this.recog.sempred(null,t,i);const s=this.column,a=this.line,o=e.index,l=e.mark();try{return this.consume(e),this.recog.sempred(null,t,i)}finally{this.column=s,this.line=a,e.seek(o),e.release(l)}}captureSimState(e,t,i){e.index=t.index,e.line=this.line,e.column=this.column,e.dfaState=i}addDFAEdge(e,t,i,r){if(i===void 0&&(i=null),r===void 0&&(r=null),i===null&&r!==null){const s=r.hasSemanticContext;if(r.hasSemanticContext=!1,i=this.addDFAState(r),s)return i}return t<Wt.MIN_DFA_EDGE||t>Wt.MAX_DFA_EDGE||(Wt.debug&&console.log("EDGE "+e+" -> "+i+" upon "+t),e.edges===null&&(e.edges=[]),e.edges[t-Wt.MIN_DFA_EDGE]=i),i}addDFAState(e){const t=new kn(null,e);let i=null;for(let o=0;o<e.items.length;o++){const l=e.items[o];if(l.state instanceof Ui){i=l;break}}i!==null&&(t.isAcceptState=!0,t.lexerActionExecutor=i.lexerActionExecutor,t.prediction=this.atn.ruleToTokenType[i.state.ruleIndex]);const r=this.decisionToDFA[this.mode],s=r.states.get(t);if(s!==null)return s;const a=t;return a.stateNumber=r.states.length,e.setReadonly(!0),a.configs=e,r.states.add(a),a}getDFA(e){return this.decisionToDFA[e]}getText(e){return e.getText(this.startIndex,e.index-1)}consume(e){e.LA(1)===10?(this.line+=1,this.column=0):this.column+=1,e.consume()}getTokenName(e){return e===-1?"EOF":"'"+String.fromCharCode(e)+"'"}}Wt.debug=!1,Wt.dfa_debug=!1,Wt.MIN_DFA_EDGE=0,Wt.MAX_DFA_EDGE=127;class Sv{constructor(e,t){this.alt=t,this.pred=e}toString(){return"("+this.pred+", "+this.alt+")"}}class WR{constructor(){this.data={}}get(e){return this.data["k-"+e]||null}set(e,t){this.data["k-"+e]=t}values(){return Object.keys(this.data).filter(e=>e.startsWith("k-")).map(e=>this.data[e],this)}}const an={SLL:0,LL:1,LL_EXACT_AMBIG_DETECTION:2,hasSLLConflictTerminatingPrediction:function(n,e){if(an.allConfigsInRuleStopStates(e))return!0;if(n===an.SLL&&e.hasSemanticContext){const i=new qi;for(let r=0;r<e.items.length;r++){let s=e.items[r];s=new ti({semanticContext:bt.NONE},s),i.add(s)}e=i}const t=an.getConflictingAltSubsets(e);return an.hasConflictingAltSet(t)&&!an.hasStateAssociatedWithOneAlt(e)},hasConfigInRuleStopState:function(n){for(let e=0;e<n.items.length;e++)if(n.items[e].state instanceof Ui)return!0;return!1},allConfigsInRuleStopStates:function(n){for(let e=0;e<n.items.length;e++)if(!(n.items[e].state instanceof Ui))return!1;return!0},resolvesToJustOneViableAlt:function(n){return an.getSingleViableAlt(n)},allSubsetsConflict:function(n){return!an.hasNonConflictingAltSet(n)},hasNonConflictingAltSet:function(n){for(let e=0;e<n.length;e++)if(n[e].length===1)return!0;return!1},hasConflictingAltSet:function(n){for(let e=0;e<n.length;e++)if(n[e].length>1)return!0;return!1},allSubsetsEqual:function(n){let e=null;for(let t=0;t<n.length;t++){const i=n[t];if(e===null)e=i;else if(i!==e)return!1}return!0},getUniqueAlt:function(n){const e=an.getAlts(n);return e.length===1?e.minValue():Ut.INVALID_ALT_NUMBER},getAlts:function(n){const e=new Gi;return n.map(function(t){e.or(t)}),e},getConflictingAltSubsets:function(n){const e=new Xo;return e.hashFunction=function(t){ar.hashStuff(t.state.stateNumber,t.context)},e.equalsFunction=function(t,i){return t.state.stateNumber===i.state.stateNumber&&t.context.equals(i.context)},n.items.map(function(t){let i=e.get(t);i===null&&(i=new Gi,e.set(t,i)),i.set(t.alt)}),e.getValues()},getStateToAltMap:function(n){const e=new WR;return n.items.map(function(t){let i=e.get(t.state);i===null&&(i=new Gi,e.set(t.state,i)),i.set(t.alt)}),e},hasStateAssociatedWithOneAlt:function(n){const e=an.getStateToAltMap(n).values();for(let t=0;t<e.length;t++)if(e[t].length===1)return!0;return!1},getSingleViableAlt:function(n){let e=null;for(let t=0;t<n.length;t++){const i=n[t].minValue();if(e===null)e=i;else if(e!==i)return Ut.INVALID_ALT_NUMBER}return e}},ci=an;let Tu=class extends Mn{constructor(e,t,i,r,s,a){a=a||e._ctx,r=r||e.getCurrentToken(),i=i||e.getCurrentToken(),t=t||e.getInputStream(),super({message:"",recognizer:e,input:t,ctx:a}),this.deadEndConfigs=s,this.startToken=i,this.offendingToken=r}},YR=class{constructor(e){this.defaultMapCtor=e||Xo,this.cacheMap=new this.defaultMapCtor}get(e,t){const i=this.cacheMap.get(e)||null;return i===null?null:i.get(t)||null}set(e,t,i){let r=this.cacheMap.get(e)||null;r===null&&(r=new this.defaultMapCtor,this.cacheMap.set(e,r)),r.set(t,i)}};class xv extends sn{constructor(e,t,i,r){super(t,r),this.parser=e,this.decisionToDFA=i,this.predictionMode=ci.LL,this._input=null,this._startIndex=0,this._outerContext=null,this._dfa=null,this.mergeCache=null,this.debug=!1,this.debug_closure=!1,this.debug_add=!1,this.trace_atn_sim=!1,this.dfa_debug=!1,this.retry_debug=!1}reset(){}adaptivePredict(e,t,i){(this.debug||this.trace_atn_sim)&&console.log("adaptivePredict decision "+t+" exec LA(1)=="+this.getLookaheadName(e)+" line "+e.LT(1).line+":"+e.LT(1).column),this._input=e,this._startIndex=e.index,this._outerContext=i;const r=this.decisionToDFA[t];this._dfa=r;const s=e.mark(),a=e.index;try{let o;if(o=r.precedenceDfa?r.getPrecedenceStartState(this.parser.getPrecedence()):r.s0,o===null){i===null&&(i=Xs.EMPTY),this.debug&&console.log("predictATN decision "+r.decision+" exec LA(1)=="+this.getLookaheadName(e)+", outerContext="+i.toString(this.parser.ruleNames));let h=this.computeStartState(r.atnStartState,Xs.EMPTY,!1);r.precedenceDfa?(r.s0.configs=h,h=this.applyPrecedenceFilter(h),o=this.addDFAState(r,new kn(null,h)),r.setPrecedenceStartState(this.parser.getPrecedence(),o)):(o=this.addDFAState(r,new kn(null,h)),r.s0=o)}const l=this.execATN(r,o,e,a,i);return this.debug&&console.log("DFA after predictATN: "+r.toString(this.parser.literalNames,this.parser.symbolicNames)),l}finally{this._dfa=null,this.mergeCache=null,e.seek(a),e.release(s)}}execATN(e,t,i,r,s){let a;(this.debug||this.trace_atn_sim)&&console.log("execATN decision "+e.decision+", DFA state "+t+", LA(1)=="+this.getLookaheadName(i)+" line "+i.LT(1).line+":"+i.LT(1).column);let o=t;this.debug&&console.log("s0 = "+t);let l=i.LA(1);for(;;){let u=this.getExistingTargetState(o,l);if(u===null&&(u=this.computeTargetState(e,o,l)),u===sn.ERROR){const h=this.noViableAlt(i,s,o.configs,r);if(i.seek(r),a=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(o.configs,s),a!==Ut.INVALID_ALT_NUMBER)return a;throw h}if(u.requiresFullContext&&this.predictionMode!==ci.SLL){let h=null;if(u.predicates!==null){this.debug&&console.log("DFA state has preds in DFA sim LL failover");const g=i.index;if(g!==r&&i.seek(r),h=this.evalSemanticContext(u.predicates,s,!0),h.length===1)return this.debug&&console.log("Full LL avoided"),h.minValue();g!==r&&i.seek(g)}this.dfa_debug&&console.log("ctx sensitive state "+s+" in "+u);const d=!0,p=this.computeStartState(e.atnStartState,s,d);return this.reportAttemptingFullContext(e,h,u.configs,r,i.index),a=this.execATNWithFullContext(e,u,p,i,r,s),a}if(u.isAcceptState){if(u.predicates===null)return u.prediction;const h=i.index;i.seek(r);const d=this.evalSemanticContext(u.predicates,s,!0);if(d.length===0)throw this.noViableAlt(i,s,u.configs,r);return d.length===1||this.reportAmbiguity(e,u,r,h,!1,d,u.configs),d.minValue()}o=u,l!==Ee.EOF&&(i.consume(),l=i.LA(1))}}getExistingTargetState(e,t){const i=e.edges;return i===null?null:i[t+1]||null}computeTargetState(e,t,i){const r=this.computeReachSet(t.configs,i,!1);if(r===null)return this.addDFAEdge(e,t,i,sn.ERROR),sn.ERROR;let s=new kn(null,r);const a=this.getUniqueAlt(r);if(this.debug){const o=ci.getConflictingAltSubsets(r);console.log("SLL altSubSets="+Cn(o)+", configs="+r+", predict="+a+", allSubsetsConflict="+ci.allSubsetsConflict(o)+", conflictingAlts="+this.getConflictingAlts(r))}return a!==Ut.INVALID_ALT_NUMBER?(s.isAcceptState=!0,s.configs.uniqueAlt=a,s.prediction=a):ci.hasSLLConflictTerminatingPrediction(this.predictionMode,r)&&(s.configs.conflictingAlts=this.getConflictingAlts(r),s.requiresFullContext=!0,s.isAcceptState=!0,s.prediction=s.configs.conflictingAlts.minValue()),s.isAcceptState&&s.configs.hasSemanticContext&&(this.predicateDFAState(s,this.atn.getDecisionState(e.decision)),s.predicates!==null&&(s.prediction=Ut.INVALID_ALT_NUMBER)),s=this.addDFAEdge(e,t,i,s),s}predicateDFAState(e,t){const i=t.transitions.length,r=this.getConflictingAltsOrUniqueAlt(e.configs),s=this.getPredsForAmbigAlts(r,e.configs,i);s!==null?(e.predicates=this.getPredicatePredictions(r,s),e.prediction=Ut.INVALID_ALT_NUMBER):e.prediction=r.minValue()}execATNWithFullContext(e,t,i,r,s,a){(this.debug||this.trace_atn_sim)&&console.log("execATNWithFullContext "+i);let o,l=!1,u=i;r.seek(s);let h=r.LA(1),d=-1;for(;;){if(o=this.computeReachSet(u,h,!0),o===null){const g=this.noViableAlt(r,a,u,s);r.seek(s);const m=this.getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(u,a);if(m!==Ut.INVALID_ALT_NUMBER)return m;throw g}const p=ci.getConflictingAltSubsets(o);if(this.debug&&console.log("LL altSubSets="+p+", predict="+ci.getUniqueAlt(p)+", resolvesToJustOneViableAlt="+ci.resolvesToJustOneViableAlt(p)),o.uniqueAlt=this.getUniqueAlt(o),o.uniqueAlt!==Ut.INVALID_ALT_NUMBER){d=o.uniqueAlt;break}if(this.predictionMode!==ci.LL_EXACT_AMBIG_DETECTION){if(d=ci.resolvesToJustOneViableAlt(p),d!==Ut.INVALID_ALT_NUMBER)break}else if(ci.allSubsetsConflict(p)&&ci.allSubsetsEqual(p)){l=!0,d=ci.getSingleViableAlt(p);break}u=o,h!==Ee.EOF&&(r.consume(),h=r.LA(1))}return o.uniqueAlt!==Ut.INVALID_ALT_NUMBER?(this.reportContextSensitivity(e,d,o,s,r.index),d):(this.reportAmbiguity(e,t,s,r.index,l,null,o),d)}computeReachSet(e,t,i){this.debug&&console.log("in computeReachSet, starting closure: "+e),this.mergeCache===null&&(this.mergeCache=new YR);const r=new qi(i);let s=null;for(let o=0;o<e.items.length;o++){const l=e.items[o];if(this.debug&&console.log("testing "+this.getTokenName(t)+" at "+l),l.state instanceof Ui)(i||t===Ee.EOF)&&(s===null&&(s=[]),s.push(l),this.debug_add&&console.log("added "+l+" to skippedStopStates"));else for(let u=0;u<l.state.transitions.length;u++){const h=l.state.transitions[u],d=this.getReachableTarget(h,t);if(d!==null){const p=new ti({state:d},l);r.add(p,this.mergeCache),this.debug_add&&console.log("added "+p+" to intermediate")}}}let a=null;if(s===null&&t!==Ee.EOF&&(r.items.length===1||this.getUniqueAlt(r)!==Ut.INVALID_ALT_NUMBER)&&(a=r),a===null){a=new qi(i);const o=new or,l=t===Ee.EOF;for(let u=0;u<r.items.length;u++)this.closure(r.items[u],a,o,!1,i,l)}if(t===Ee.EOF&&(a=this.removeAllConfigsNotInRuleStopState(a,a===r)),!(s===null||i&&ci.hasConfigInRuleStopState(a)))for(let o=0;o<s.length;o++)a.add(s[o],this.mergeCache);return this.trace_atn_sim&&console.log("computeReachSet "+e+" -> "+a),a.items.length===0?null:a}removeAllConfigsNotInRuleStopState(e,t){if(ci.allConfigsInRuleStopStates(e))return e;const i=new qi(e.fullCtx);for(let r=0;r<e.items.length;r++){const s=e.items[r];if(s.state instanceof Ui)i.add(s,this.mergeCache);else if(t&&s.state.epsilonOnlyTransitions&&this.atn.nextTokens(s.state).contains(Ee.EPSILON)){const a=this.atn.ruleToStopState[s.state.ruleIndex];i.add(new ti({state:a},s),this.mergeCache)}}return i}computeStartState(e,t,i){const r=md(this.atn,t),s=new qi(i);this.trace_atn_sim&&console.log("computeStartState from ATN state "+e+" initialContext="+r.toString(this.parser));for(let a=0;a<e.transitions.length;a++){const o=e.transitions[a].target,l=new ti({state:o,alt:a+1,context:r},null),u=new or;this.closure(l,s,u,!0,i,!1)}return s}applyPrecedenceFilter(e){let t;const i=[],r=new qi(e.fullCtx);for(let s=0;s<e.items.length;s++){if(t=e.items[s],t.alt!==1)continue;const a=t.semanticContext.evalPrecedence(this.parser,this._outerContext);a!==null&&(i[t.state.stateNumber]=t.context,a!==t.semanticContext?r.add(new ti({semanticContext:a},t),this.mergeCache):r.add(t,this.mergeCache))}for(let s=0;s<e.items.length;s++)if(t=e.items[s],t.alt!==1){if(!t.precedenceFilterSuppressed){const a=i[t.state.stateNumber]||null;if(a!==null&&a.equals(t.context))continue}r.add(t,this.mergeCache)}return r}getReachableTarget(e,t){return e.matches(t,0,this.atn.maxTokenType)?e.target:null}getPredsForAmbigAlts(e,t,i){let r=[];for(let a=0;a<t.items.length;a++){const o=t.items[a];e.get(o.alt)&&(r[o.alt]=bt.orContext(r[o.alt]||null,o.semanticContext))}let s=0;for(let a=1;a<i+1;a++){const o=r[a]||null;o===null?r[a]=bt.NONE:o!==bt.NONE&&(s+=1)}return s===0&&(r=null),this.debug&&console.log("getPredsForAmbigAlts result "+Cn(r)),r}getPredicatePredictions(e,t){const i=[];let r=!1;for(let s=1;s<t.length;s++){const a=t[s];e!==null&&e.get(s)&&i.push(new Sv(a,s)),a!==bt.NONE&&(r=!0)}return r?i:null}getSynValidOrSemInvalidAltThatFinishedDecisionEntryRule(e,t){const i=this.splitAccordingToSemanticValidity(e,t),r=i[0],s=i[1];let a=this.getAltThatFinishedDecisionEntryRule(r);return a!==Ut.INVALID_ALT_NUMBER||s.items.length>0&&(a=this.getAltThatFinishedDecisionEntryRule(s),a!==Ut.INVALID_ALT_NUMBER)?a:Ut.INVALID_ALT_NUMBER}getAltThatFinishedDecisionEntryRule(e){const t=[];for(let i=0;i<e.items.length;i++){const r=e.items[i];(r.reachesIntoOuterContext>0||r.state instanceof Ui&&r.context.hasEmptyPath())&&t.indexOf(r.alt)<0&&t.push(r.alt)}return t.length===0?Ut.INVALID_ALT_NUMBER:Math.min.apply(null,t)}splitAccordingToSemanticValidity(e,t){const i=new qi(e.fullCtx),r=new qi(e.fullCtx);for(let s=0;s<e.items.length;s++){const a=e.items[s];a.semanticContext!==bt.NONE?a.semanticContext.evaluate(this.parser,t)?i.add(a):r.add(a):i.add(a)}return[i,r]}evalSemanticContext(e,t,i){const r=new Gi;for(let s=0;s<e.length;s++){const a=e[s];if(a.pred===bt.NONE){if(r.set(a.alt),!i)break;continue}const o=a.pred.evaluate(this.parser,t);if((this.debug||this.dfa_debug)&&console.log("eval pred "+a+"="+o),o&&((this.debug||this.dfa_debug)&&console.log("PREDICT "+a.alt),r.set(a.alt),!i))break}return r}closure(e,t,i,r,s,a){this.closureCheckingStopState(e,t,i,r,s,0,a)}closureCheckingStopState(e,t,i,r,s,a,o){if((this.trace_atn_sim||this.debug_closure)&&console.log("closure("+e.toString(this.parser,!0)+")"),e.state instanceof Ui){if(!e.context.isEmpty()){for(let l=0;l<e.context.length;l++){if(e.context.getReturnState(l)===je.EMPTY_RETURN_STATE){if(s){t.add(new ti({state:e.state,context:je.EMPTY},e),this.mergeCache);continue}this.debug&&console.log("FALLING off rule "+this.getRuleName(e.state.ruleIndex)),this.closure_(e,t,i,r,s,a,o);continue}const u=this.atn.states[e.context.getReturnState(l)],h=e.context.getParent(l),d={state:u,alt:e.alt,context:h,semanticContext:e.semanticContext},p=new ti(d,null);p.reachesIntoOuterContext=e.reachesIntoOuterContext,this.closureCheckingStopState(p,t,i,r,s,a-1,o)}return}if(s)return void t.add(e,this.mergeCache);this.debug&&console.log("FALLING off rule "+this.getRuleName(e.state.ruleIndex))}this.closure_(e,t,i,r,s,a,o)}closure_(e,t,i,r,s,a,o){const l=e.state;l.epsilonOnlyTransitions||t.add(e,this.mergeCache);for(let u=0;u<l.transitions.length;u++){if(u===0&&this.canDropLoopEntryEdgeInLeftRecursiveRule(e))continue;const h=l.transitions[u],d=r&&!(h instanceof vv),p=this.getEpsilonTarget(e,h,d,a===0,s,o);if(p!==null){let g=a;if(e.state instanceof Ui){if(this._dfa!==null&&this._dfa.precedenceDfa&&h.outermostPrecedenceReturn===this._dfa.atnStartState.ruleIndex&&(p.precedenceFilterSuppressed=!0),p.reachesIntoOuterContext+=1,i.getOrAdd(p)!==p)continue;t.dipsIntoOuterContext=!0,g-=1,this.debug&&console.log("dips into outer ctx: "+p)}else{if(!h.isEpsilon&&i.getOrAdd(p)!==p)continue;h instanceof yu&&g>=0&&(g+=1)}this.closureCheckingStopState(p,t,i,d,s,g,o)}}}canDropLoopEntryEdgeInLeftRecursiveRule(e){const t=e.state;if(t.stateType!==Fe.STAR_LOOP_ENTRY||t.stateType!==Fe.STAR_LOOP_ENTRY||!t.isPrecedenceDecision||e.context.isEmpty()||e.context.hasEmptyPath())return!1;const i=e.context.length;for(let a=0;a<i;a++)if(this.atn.states[e.context.getReturnState(a)].ruleIndex!==t.ruleIndex)return!1;const r=t.transitions[0].target.endState.stateNumber,s=this.atn.states[r];for(let a=0;a<i;a++){const o=e.context.getReturnState(a),l=this.atn.states[o];if(l.transitions.length!==1||!l.transitions[0].isEpsilon)return!1;const u=l.transitions[0].target;if(!(l.stateType===Fe.BLOCK_END&&u===t||l===s||u===s||u.stateType===Fe.BLOCK_END&&u.transitions.length===1&&u.transitions[0].isEpsilon&&u.transitions[0].target===t))return!1}return!0}getRuleName(e){return this.parser!==null&&e>=0?this.parser.ruleNames[e]:"<rule "+e+">"}getEpsilonTarget(e,t,i,r,s,a){switch(t.serializationType){case Pe.RULE:return this.ruleTransition(e,t);case Pe.PRECEDENCE:return this.precedenceTransition(e,t,i,r,s);case Pe.PREDICATE:return this.predTransition(e,t,i,r,s);case Pe.ACTION:return this.actionTransition(e,t);case Pe.EPSILON:return new ti({state:t.target},e);case Pe.ATOM:case Pe.RANGE:case Pe.SET:return a&&t.matches(Ee.EOF,0,1)?new ti({state:t.target},e):null;default:return null}}actionTransition(e,t){if(this.debug){const i=t.actionIndex===-1?65535:t.actionIndex;console.log("ACTION edge "+t.ruleIndex+":"+i)}return new ti({state:t.target},e)}precedenceTransition(e,t,i,r,s){this.debug&&(console.log("PRED (collectPredicates="+i+") "+t.precedence+">=_p, ctx dependent=true"),this.parser!==null&&console.log("context surrounding pred is "+Cn(this.parser.getRuleInvocationStack())));let a=null;if(i&&r)if(s){const o=this._input.index;this._input.seek(this._startIndex);const l=t.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(o),l&&(a=new ti({state:t.target},e))}else{const o=bt.andContext(e.semanticContext,t.getPredicate());a=new ti({state:t.target,semanticContext:o},e)}else a=new ti({state:t.target},e);return this.debug&&console.log("config from pred transition="+a),a}predTransition(e,t,i,r,s){this.debug&&(console.log("PRED (collectPredicates="+i+") "+t.ruleIndex+":"+t.predIndex+", ctx dependent="+t.isCtxDependent),this.parser!==null&&console.log("context surrounding pred is "+Cn(this.parser.getRuleInvocationStack())));let a=null;if(i&&(t.isCtxDependent&&r||!t.isCtxDependent))if(s){const o=this._input.index;this._input.seek(this._startIndex);const l=t.getPredicate().evaluate(this.parser,this._outerContext);this._input.seek(o),l&&(a=new ti({state:t.target},e))}else{const o=bt.andContext(e.semanticContext,t.getPredicate());a=new ti({state:t.target,semanticContext:o},e)}else a=new ti({state:t.target},e);return this.debug&&console.log("config from pred transition="+a),a}ruleTransition(e,t){this.debug&&console.log("CALL rule "+this.getRuleName(t.target.ruleIndex)+", ctx="+e.context);const i=t.followState,r=$i.create(e.context,i.stateNumber);return new ti({state:t.target,context:r},e)}getConflictingAlts(e){const t=ci.getConflictingAltSubsets(e);return ci.getAlts(t)}getConflictingAltsOrUniqueAlt(e){let t=null;return e.uniqueAlt!==Ut.INVALID_ALT_NUMBER?(t=new Gi,t.set(e.uniqueAlt)):t=e.conflictingAlts,t}getTokenName(e){if(e===Ee.EOF)return"EOF";if(this.parser!==null&&this.parser.literalNames!==null){if(!(e>=this.parser.literalNames.length&&e>=this.parser.symbolicNames.length))return(this.parser.literalNames[e]||this.parser.symbolicNames[e])+"<"+e+">";console.log(e+" ttype out of range: "+this.parser.literalNames),console.log(""+this.parser.getInputStream().getTokens())}return""+e}getLookaheadName(e){return this.getTokenName(e.LA(1))}dumpDeadEndConfigs(e){console.log("dead end configs: ");const t=e.getDeadEndConfigs();for(let i=0;i<t.length;i++){const r=t[i];let s="no edges";if(r.state.transitions.length>0){const a=r.state.transitions[0];a instanceof Sd?s="Atom "+this.getTokenName(a.label):a instanceof dd&&(s=(a instanceof fd?"~":"")+"Set "+a.set)}console.error(r.toString(this.parser,!0)+":"+s)}}noViableAlt(e,t,i,r){return new Tu(this.parser,e,e.get(r),e.LT(1),i,t)}getUniqueAlt(e){let t=Ut.INVALID_ALT_NUMBER;for(let i=0;i<e.items.length;i++){const r=e.items[i];if(t===Ut.INVALID_ALT_NUMBER)t=r.alt;else if(r.alt!==t)return Ut.INVALID_ALT_NUMBER}return t}addDFAEdge(e,t,i,r){if(this.debug&&console.log("EDGE "+t+" -> "+r+" upon "+this.getTokenName(i)),r===null)return null;if(r=this.addDFAState(e,r),t===null||i<-1||i>this.atn.maxTokenType)return r;if(t.edges===null&&(t.edges=[]),t.edges[i+1]=r,this.debug){const s=this.parser===null?null:this.parser.literalNames,a=this.parser===null?null:this.parser.symbolicNames;console.log(`DFA=
`+e.toString(s,a))}return r}addDFAState(e,t){if(t===sn.ERROR)return t;const i=e.states.get(t);return i!==null?(this.trace_atn_sim&&console.log("addDFAState "+t+" exists"),i):(t.stateNumber=e.states.length,t.configs.readOnly||(t.configs.optimizeConfigs(this),t.configs.setReadonly(!0)),this.trace_atn_sim&&console.log("addDFAState new "+t),e.states.add(t),this.debug&&console.log("adding new DFA state: "+t),t)}reportAttemptingFullContext(e,t,i,r,s){if(this.debug||this.retry_debug){const a=new pt(r,s+1);console.log("reportAttemptingFullContext decision="+e.decision+":"+i+", input="+this.parser.getTokenStream().getText(a))}this.parser!==null&&this.parser.getErrorListener().reportAttemptingFullContext(this.parser,e,r,s,t,i)}reportContextSensitivity(e,t,i,r,s){if(this.debug||this.retry_debug){const a=new pt(r,s+1);console.log("reportContextSensitivity decision="+e.decision+":"+i+", input="+this.parser.getTokenStream().getText(a))}this.parser!==null&&this.parser.getErrorListener().reportContextSensitivity(this.parser,e,r,s,t,i)}reportAmbiguity(e,t,i,r,s,a,o){if(this.debug||this.retry_debug){const l=new pt(i,r+1);console.log("reportAmbiguity "+a+":"+o+", input="+this.parser.getTokenStream().getText(l))}this.parser!==null&&this.parser.getErrorListener().reportAmbiguity(this.parser,e,i,r,s,a,o)}}class Tv{constructor(){this.cache=new Xo}add(e){if(e===je.EMPTY)return je.EMPTY;const t=this.cache.get(e)||null;return t!==null?t:(this.cache.set(e,e),e)}get(e){return this.cache.get(e)||null}get length(){return this.cache.length}}const zR={ATN:Ut,ATNDeserializer:Ld,LexerATNSimulator:Wt,ParserATNSimulator:xv,PredictionMode:ci,PredictionContextCache:Tv};class Pd{constructor(e,t,i){this.dfa=e,this.literalNames=t||[],this.symbolicNames=i||[]}toString(){if(this.dfa.s0===null)return null;let e="";const t=this.dfa.sortedStates();for(let i=0;i<t.length;i++){const r=t[i];if(r.edges!==null){const s=r.edges.length;for(let a=0;a<s;a++){const o=r.edges[a]||null;o!==null&&o.stateNumber!==2147483647&&(e=e.concat(this.getStateString(r)),e=e.concat("-"),e=e.concat(this.getEdgeLabel(a)),e=e.concat("->"),e=e.concat(this.getStateString(o)),e=e.concat(`
`))}}}return e.length===0?null:e}getEdgeLabel(e){return e===0?"EOF":this.literalNames!==null||this.symbolicNames!==null?this.literalNames[e-1]||this.symbolicNames[e-1]:String.fromCharCode(e-1)}getStateString(e){const t=(e.isAcceptState?":":"")+"s"+e.stateNumber+(e.requiresFullContext?"^":"");return e.isAcceptState?e.predicates!==null?t+"=>"+Cn(e.predicates):t+"=>"+e.prediction.toString():t}}let wv=class extends Pd{constructor(e){super(e,null)}getEdgeLabel(e){return"'"+String.fromCharCode(e)+"'"}};class Dv{constructor(e,t){if(t===void 0&&(t=0),this.atnStartState=e,this.decision=t,this._states=new or,this.s0=null,this.precedenceDfa=!1,e instanceof Js&&e.isPrecedenceDecision){this.precedenceDfa=!0;const i=new kn(null,new qi);i.edges=[],i.isAcceptState=!1,i.requiresFullContext=!1,this.s0=i}}getPrecedenceStartState(e){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";return e<0||e>=this.s0.edges.length?null:this.s0.edges[e]||null}setPrecedenceStartState(e,t){if(!this.precedenceDfa)throw"Only precedence DFAs may contain a precedence start state.";e<0||(this.s0.edges[e]=t)}setPrecedenceDfa(e){if(this.precedenceDfa!==e){if(this._states=new or,e){const t=new kn(null,new qi);t.edges=[],t.isAcceptState=!1,t.requiresFullContext=!1,this.s0=t}else this.s0=null;this.precedenceDfa=e}}sortedStates(){return this._states.values().sort(function(e,t){return e.stateNumber-t.stateNumber})}toString(e,t){return e=e||null,t=t||null,this.s0===null?"":new Pd(this,e,t).toString()}toLexerString(){return this.s0===null?"":new wv(this).toString()}get states(){return this._states}}const jR={DFA:Dv,DFASerializer:Pd,LexerDFASerializer:wv,PredPrediction:Sv},XR={PredictionContext:je},JR={Interval:pt,IntervalSet:Er};class Od{visitTerminal(e){}visitErrorNode(e){}enterEveryRule(e){}exitEveryRule(e){}}class Rv{visit(e){return Array.isArray(e)?e.map(function(t){return t.accept(this)},this):e.accept(this)}visitChildren(e){return e.children?this.visit(e.children):null}visitTerminal(e){}visitErrorNode(e){}}class wu{walk(e,t){if(t instanceof vu||t.isErrorNode!==void 0&&t.isErrorNode())e.visitErrorNode(t);else if(t instanceof rn)e.visitTerminal(t);else{this.enterRule(e,t);for(let i=0;i<t.getChildCount();i++){const r=t.getChild(i);this.walk(e,r)}this.exitRule(e,t)}}enterRule(e,t){const i=t.ruleContext;e.enterEveryRule(i),i.enterRule(e)}exitRule(e,t){const i=t.ruleContext;i.exitRule(e),e.exitEveryRule(i)}}wu.DEFAULT=new wu;const QR={Trees:dv,RuleNode:jo,ErrorNode:vu,TerminalNode:rn,ParseTreeListener:Od,ParseTreeVisitor:Rv,ParseTreeWalker:wu};class Ua extends Mn{constructor(e){super({message:"",recognizer:e,input:e.getInputStream(),ctx:e._ctx}),this.offendingToken=e.getCurrentToken()}}class Fd extends Mn{constructor(e,t,i){super({message:ZR(t,i||null),recognizer:e,input:e.getInputStream(),ctx:e._ctx});const r=e._interp.atn.states[e.state].transitions[0];r instanceof bv?(this.ruleIndex=r.ruleIndex,this.predicateIndex=r.predIndex):(this.ruleIndex=0,this.predicateIndex=0),this.predicate=t,this.offendingToken=e.getCurrentToken()}}function ZR(n,e){return e!==null?e:"failed predicate: {"+n+"}?"}class Iv extends Zo{constructor(e){super(),e=e||!0,this.exactOnly=e}reportAmbiguity(e,t,i,r,s,a,o){if(this.exactOnly&&!s)return;const l="reportAmbiguity d="+this.getDecisionDescription(e,t)+": ambigAlts="+this.getConflictingAlts(a,o)+", input='"+e.getTokenStream().getText(new pt(i,r))+"'";e.notifyErrorListeners(l)}reportAttemptingFullContext(e,t,i,r,s,a){const o="reportAttemptingFullContext d="+this.getDecisionDescription(e,t)+", input='"+e.getTokenStream().getText(new pt(i,r))+"'";e.notifyErrorListeners(o)}reportContextSensitivity(e,t,i,r,s,a){const o="reportContextSensitivity d="+this.getDecisionDescription(e,t)+", input='"+e.getTokenStream().getText(new pt(i,r))+"'";e.notifyErrorListeners(o)}getDecisionDescription(e,t){const i=t.decision,r=t.atnStartState.ruleIndex,s=e.ruleNames;if(r<0||r>=s.length)return""+i;const a=s[r]||null;return a===null||a.length===0?""+i:`${i} (${a})`}getConflictingAlts(e,t){if(e!==null)return e;const i=new Gi;for(let r=0;r<t.items.length;r++)i.set(t.items[r].alt);return`{${i.values().join(", ")}}`}}class Bd extends Error{constructor(){super(),Error.captureStackTrace(this,Bd)}}class eI{reset(e){}recoverInline(e){}recover(e,t){}sync(e){}inErrorRecoveryMode(e){}reportError(e){}}class Du extends eI{constructor(){super(),this.errorRecoveryMode=!1,this.lastErrorIndex=-1,this.lastErrorStates=null,this.nextTokensContext=null,this.nextTokenState=0}reset(e){this.endErrorCondition(e)}beginErrorCondition(e){this.errorRecoveryMode=!0}inErrorRecoveryMode(e){return this.errorRecoveryMode}endErrorCondition(e){this.errorRecoveryMode=!1,this.lastErrorStates=null,this.lastErrorIndex=-1}reportMatch(e){this.endErrorCondition(e)}reportError(e,t){this.inErrorRecoveryMode(e)||(this.beginErrorCondition(e),t instanceof Tu?this.reportNoViableAlternative(e,t):t instanceof Ua?this.reportInputMismatch(e,t):t instanceof Fd?this.reportFailedPredicate(e,t):(console.log("unknown recognition error type: "+t.constructor.name),console.log(t.stack),e.notifyErrorListeners(t.getOffendingToken(),t.getMessage(),t)))}recover(e,t){this.lastErrorIndex===e.getInputStream().index&&this.lastErrorStates!==null&&this.lastErrorStates.indexOf(e.state)>=0&&e.consume(),this.lastErrorIndex=e._input.index,this.lastErrorStates===null&&(this.lastErrorStates=[]),this.lastErrorStates.push(e.state);const i=this.getErrorRecoverySet(e);this.consumeUntil(e,i)}sync(e){if(this.inErrorRecoveryMode(e))return;const t=e._interp.atn.states[e.state],i=e.getTokenStream().LA(1),r=e.atn.nextTokens(t);if(r.contains(i))return this.nextTokensContext=null,void(this.nextTokenState=Fe.INVALID_STATE_NUMBER);if(r.contains(Ee.EPSILON))this.nextTokensContext===null&&(this.nextTokensContext=e._ctx,this.nextTokensState=e._stateNumber);else switch(t.stateType){case Fe.BLOCK_START:case Fe.STAR_BLOCK_START:case Fe.PLUS_BLOCK_START:case Fe.STAR_LOOP_ENTRY:if(this.singleTokenDeletion(e)!==null)return;throw new Ua(e);case Fe.PLUS_LOOP_BACK:case Fe.STAR_LOOP_BACK:{this.reportUnwantedToken(e);const s=new Er;s.addSet(e.getExpectedTokens());const a=s.addSet(this.getErrorRecoverySet(e));this.consumeUntil(e,a)}}}reportNoViableAlternative(e,t){const i=e.getTokenStream();let r;r=i!==null?t.startToken.type===Ee.EOF?"<EOF>":i.getText(new pt(t.startToken.tokenIndex,t.offendingToken.tokenIndex)):"<unknown input>";const s="no viable alternative at input "+this.escapeWSAndQuote(r);e.notifyErrorListeners(s,t.offendingToken,t)}reportInputMismatch(e,t){const i="mismatched input "+this.getTokenErrorDisplay(t.offendingToken)+" expecting "+t.getExpectedTokens().toString(e.literalNames,e.symbolicNames);e.notifyErrorListeners(i,t.offendingToken,t)}reportFailedPredicate(e,t){const i="rule "+e.ruleNames[e._ctx.ruleIndex]+" "+t.message;e.notifyErrorListeners(i,t.offendingToken,t)}reportUnwantedToken(e){if(this.inErrorRecoveryMode(e))return;this.beginErrorCondition(e);const t=e.getCurrentToken(),i="extraneous input "+this.getTokenErrorDisplay(t)+" expecting "+this.getExpectedTokens(e).toString(e.literalNames,e.symbolicNames);e.notifyErrorListeners(i,t,null)}reportMissingToken(e){if(this.inErrorRecoveryMode(e))return;this.beginErrorCondition(e);const t=e.getCurrentToken(),i="missing "+this.getExpectedTokens(e).toString(e.literalNames,e.symbolicNames)+" at "+this.getTokenErrorDisplay(t);e.notifyErrorListeners(i,t,null)}recoverInline(e){const t=this.singleTokenDeletion(e);if(t!==null)return e.consume(),t;if(this.singleTokenInsertion(e))return this.getMissingSymbol(e);throw new Ua(e)}singleTokenInsertion(e){const t=e.getTokenStream().LA(1),i=e._interp.atn,r=i.states[e.state].transitions[0].target;return!!i.nextTokens(r,e._ctx).contains(t)&&(this.reportMissingToken(e),!0)}singleTokenDeletion(e){const t=e.getTokenStream().LA(2);if(this.getExpectedTokens(e).contains(t)){this.reportUnwantedToken(e),e.consume();const i=e.getCurrentToken();return this.reportMatch(e),i}return null}getMissingSymbol(e){const t=e.getCurrentToken(),i=this.getExpectedTokens(e).first();let r;r=i===Ee.EOF?"<missing EOF>":"<missing "+e.literalNames[i]+">";let s=t;const a=e.getTokenStream().LT(-1);return s.type===Ee.EOF&&a!==null&&(s=a),e.getTokenFactory().create(s.source,i,r,Ee.DEFAULT_CHANNEL,-1,-1,s.line,s.column)}getExpectedTokens(e){return e.getExpectedTokens()}getTokenErrorDisplay(e){if(e===null)return"<no token>";let t=e.text;return t===null&&(t=e.type===Ee.EOF?"<EOF>":"<"+e.type+">"),this.escapeWSAndQuote(t)}escapeWSAndQuote(e){return"'"+(e=(e=(e=e.replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t"))+"'"}getErrorRecoverySet(e){const t=e._interp.atn;let i=e._ctx;const r=new Er;for(;i!==null&&i.invokingState>=0;){const s=t.states[i.invokingState].transitions[0],a=t.nextTokens(s.followState);r.addSet(a),i=i.parentCtx}return r.removeOne(Ee.EPSILON),r}consumeUntil(e,t){let i=e.getTokenStream().LA(1);for(;i!==Ee.EOF&&!t.contains(i);)e.consume(),i=e.getTokenStream().LA(1)}}class Cv extends Du{constructor(){super()}recover(e,t){let i=e._ctx;for(;i!==null;)i.exception=t,i=i.parentCtx;throw new Bd(t)}recoverInline(e){this.recover(e,new Ua(e))}sync(e){}}const tI={RecognitionException:Mn,NoViableAltException:Tu,LexerNoViableAltException:kd,InputMismatchException:Ua,FailedPredicateException:Fd,DiagnosticErrorListener:Iv,BailErrorStrategy:Cv,DefaultErrorStrategy:Du,ErrorListener:Zo};class Qs{constructor(e,t){if(this.name="<empty>",this.strdata=e,this.decodeToUnicodeCodePoints=t||!1,this._index=0,this.data=[],this.decodeToUnicodeCodePoints)for(let i=0;i<this.strdata.length;){const r=this.strdata.codePointAt(i);this.data.push(r),i+=r<=65535?1:2}else{this.data=new Array(this.strdata.length);for(let i=0;i<this.strdata.length;i++)this.data[i]=this.strdata.charCodeAt(i)}this._size=this.data.length}reset(){this._index=0}consume(){if(this._index>=this._size)throw"cannot consume EOF";this._index+=1}LA(e){if(e===0)return 0;e<0&&(e+=1);const t=this._index+e-1;return t<0||t>=this._size?Ee.EOF:this.data[t]}LT(e){return this.LA(e)}mark(){return-1}release(e){}seek(e){e<=this._index?this._index=e:this._index=Math.min(e,this._size)}getText(e,t){if(t>=this._size&&(t=this._size-1),e>=this._size)return"";if(this.decodeToUnicodeCodePoints){let i="";for(let r=e;r<=t;r++)i+=String.fromCodePoint(this.data[r]);return i}return this.strdata.slice(e,t+1)}toString(){return this.strdata}get index(){return this._index}get size(){return this._size}}class Ud extends Qs{constructor(e,t){super(e,t)}}var Nv=js(763);const Lv=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;class _v extends Ud{static fromPath(e,t,i){if(!Lv)throw new Error("FileStream is only available when running in Node!");Nv.readFile(e,t,function(r,s){let a=null;s!==null&&(a=new Qs(s,!0)),i(r,a)})}constructor(e,t,i){if(!Lv)throw new Error("FileStream is only available when running in Node!");super(Nv.readFileSync(e,t||"utf-8"),i),this.fileName=e}}const Mv={fromString:function(n){return new Qs(n,!0)},fromBlob:function(n,e,t,i){const r=new window.FileReader;r.onload=function(s){const a=new Qs(s.target.result,!0);t(a)},r.onerror=i,r.readAsText(n,e)},fromBuffer:function(n,e){return new Qs(n.toString(e),!0)},fromPath:function(n,e,t){_v.fromPath(n,e,t)},fromPathSync:function(n,e){return new _v(n,e)}},iI={arrayToString:Cn,stringToCharArray:function(n){let e=new Uint16Array(n.length);for(let t=0;t<n.length;t++)e[t]=n.charCodeAt(t);return e}};class rI{}class kv extends rI{constructor(e){super(),this.tokenSource=e,this.tokens=[],this.index=-1,this.fetchedEOF=!1}mark(){return 0}release(e){}reset(){this.seek(0)}seek(e){this.lazyInit(),this.index=this.adjustSeekIndex(e)}get size(){return this.tokens.length}get(e){return this.lazyInit(),this.tokens[e]}consume(){let e=!1;if(e=this.index>=0&&(this.fetchedEOF?this.index<this.tokens.length-1:this.index<this.tokens.length),!e&&this.LA(1)===Ee.EOF)throw"cannot consume EOF";this.sync(this.index+1)&&(this.index=this.adjustSeekIndex(this.index+1))}sync(e){const t=e-this.tokens.length+1;return!(t>0)||this.fetch(t)>=t}fetch(e){if(this.fetchedEOF)return 0;for(let t=0;t<e;t++){const i=this.tokenSource.nextToken();if(i.tokenIndex=this.tokens.length,this.tokens.push(i),i.type===Ee.EOF)return this.fetchedEOF=!0,t+1}return e}getTokens(e,t,i){if(i===void 0&&(i=null),e<0||t<0)return null;this.lazyInit();const r=[];t>=this.tokens.length&&(t=this.tokens.length-1);for(let s=e;s<t;s++){const a=this.tokens[s];if(a.type===Ee.EOF)break;(i===null||i.contains(a.type))&&r.push(a)}return r}LA(e){return this.LT(e).type}LB(e){return this.index-e<0?null:this.tokens[this.index-e]}LT(e){if(this.lazyInit(),e===0)return null;if(e<0)return this.LB(-e);const t=this.index+e-1;return this.sync(t),t>=this.tokens.length?this.tokens[this.tokens.length-1]:this.tokens[t]}adjustSeekIndex(e){return e}lazyInit(){this.index===-1&&this.setup()}setup(){this.sync(0),this.index=this.adjustSeekIndex(0)}setTokenSource(e){this.tokenSource=e,this.tokens=[],this.index=-1,this.fetchedEOF=!1}nextTokenOnChannel(e,t){if(this.sync(e),e>=this.tokens.length)return-1;let i=this.tokens[e];for(;i.channel!==t;){if(i.type===Ee.EOF)return-1;e+=1,this.sync(e),i=this.tokens[e]}return e}previousTokenOnChannel(e,t){for(;e>=0&&this.tokens[e].channel!==t;)e-=1;return e}getHiddenTokensToRight(e,t){if(t===void 0&&(t=-1),this.lazyInit(),e<0||e>=this.tokens.length)throw e+" not in 0.."+this.tokens.length-1;const i=this.nextTokenOnChannel(e+1,Kt.DEFAULT_TOKEN_CHANNEL),r=e+1,s=i===-1?this.tokens.length-1:i;return this.filterForChannel(r,s,t)}getHiddenTokensToLeft(e,t){if(t===void 0&&(t=-1),this.lazyInit(),e<0||e>=this.tokens.length)throw e+" not in 0.."+this.tokens.length-1;const i=this.previousTokenOnChannel(e-1,Kt.DEFAULT_TOKEN_CHANNEL);if(i===e-1)return null;const r=i+1,s=e-1;return this.filterForChannel(r,s,t)}filterForChannel(e,t,i){const r=[];for(let s=e;s<t+1;s++){const a=this.tokens[s];i===-1?a.channel!==Kt.DEFAULT_TOKEN_CHANNEL&&r.push(a):a.channel===i&&r.push(a)}return r.length===0?null:r}getSourceName(){return this.tokenSource.getSourceName()}getText(e){this.lazyInit(),this.fill(),e||(e=new pt(0,this.tokens.length-1));let t=e.start;t instanceof Ee&&(t=t.tokenIndex);let i=e.stop;if(i instanceof Ee&&(i=i.tokenIndex),t===null||i===null||t<0||i<0)return"";i>=this.tokens.length&&(i=this.tokens.length-1);let r="";for(let s=t;s<i+1;s++){const a=this.tokens[s];if(a.type===Ee.EOF)break;r+=a.text}return r}fill(){for(this.lazyInit();this.fetch(1e3)===1e3;);}}Object.defineProperty(kv,"size",{get:function(){return this.tokens.length}});class Pv extends kv{constructor(e,t){super(e),this.channel=t===void 0?Ee.DEFAULT_CHANNEL:t}adjustSeekIndex(e){return this.nextTokenOnChannel(e,this.channel)}LB(e){if(e===0||this.index-e<0)return null;let t=this.index,i=1;for(;i<=e;)t=this.previousTokenOnChannel(t-1,this.channel),i+=1;return t<0?null:this.tokens[t]}LT(e){if(this.lazyInit(),e===0)return null;if(e<0)return this.LB(-e);let t=this.index,i=1;for(;i<e;)this.sync(t+1)&&(t=this.nextTokenOnChannel(t+1,this.channel)),i+=1;return this.tokens[t]}getNumberOfOnChannelTokens(){let e=0;this.fill();for(let t=0;t<this.tokens.length;t++){const i=this.tokens[t];if(i.channel===this.channel&&(e+=1),i.type===Ee.EOF)break}return e}}class nI extends Od{constructor(e){super(),this.parser=e}enterEveryRule(e){console.log("enter   "+this.parser.ruleNames[e.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}visitTerminal(e){console.log("consume "+e.symbol+" rule "+this.parser.ruleNames[this.parser._ctx.ruleIndex])}exitEveryRule(e){console.log("exit    "+this.parser.ruleNames[e.ruleIndex]+", LT(1)="+this.parser._input.LT(1).text)}}class $d extends xu{constructor(e){super(),this._input=null,this._errHandler=new Du,this._precedenceStack=[],this._precedenceStack.push(0),this._ctx=null,this.buildParseTrees=!0,this._tracer=null,this._parseListeners=null,this._syntaxErrors=0,this.setInputStream(e)}reset(){this._input!==null&&this._input.seek(0),this._errHandler.reset(this),this._ctx=null,this._syntaxErrors=0,this.setTrace(!1),this._precedenceStack=[],this._precedenceStack.push(0),this._interp!==null&&this._interp.reset()}match(e){let t=this.getCurrentToken();return t.type===e?(this._errHandler.reportMatch(this),this.consume()):(t=this._errHandler.recoverInline(this),this.buildParseTrees&&t.tokenIndex===-1&&this._ctx.addErrorNode(t)),t}matchWildcard(){let e=this.getCurrentToken();return e.type>0?(this._errHandler.reportMatch(this),this.consume()):(e=this._errHandler.recoverInline(this),this.buildParseTrees&&e.tokenIndex===-1&&this._ctx.addErrorNode(e)),e}getParseListeners(){return this._parseListeners||[]}addParseListener(e){if(e===null)throw"listener";this._parseListeners===null&&(this._parseListeners=[]),this._parseListeners.push(e)}removeParseListener(e){if(this._parseListeners!==null){const t=this._parseListeners.indexOf(e);t>=0&&this._parseListeners.splice(t,1),this._parseListeners.length===0&&(this._parseListeners=null)}}removeParseListeners(){this._parseListeners=null}triggerEnterRuleEvent(){if(this._parseListeners!==null){const e=this._ctx;this._parseListeners.forEach(function(t){t.enterEveryRule(e),e.enterRule(t)})}}triggerExitRuleEvent(){if(this._parseListeners!==null){const e=this._ctx;this._parseListeners.slice(0).reverse().forEach(function(t){e.exitRule(t),t.exitEveryRule(e)})}}getTokenFactory(){return this._input.tokenSource._factory}setTokenFactory(e){this._input.tokenSource._factory=e}getATNWithBypassAlts(){const e=this.getSerializedATN();if(e===null)throw"The current parser does not support an ATN with bypass alternatives.";let t=this.bypassAltsAtnCache[e];if(t===null){const i=new Qo;i.generateRuleBypassTransitions=!0,t=new Ld(i).deserialize(e),this.bypassAltsAtnCache[e]=t}return t}getInputStream(){return this.getTokenStream()}setInputStream(e){this.setTokenStream(e)}getTokenStream(){return this._input}setTokenStream(e){this._input=null,this.reset(),this._input=e}get syntaxErrorsCount(){return this._syntaxErrors}getCurrentToken(){return this._input.LT(1)}notifyErrorListeners(e,t,i){i=i||null,(t=t||null)===null&&(t=this.getCurrentToken()),this._syntaxErrors+=1;const r=t.line,s=t.column;this.getErrorListener().syntaxError(this,t,r,s,e,i)}consume(){const e=this.getCurrentToken();e.type!==Ee.EOF&&this.getInputStream().consume();const t=this._parseListeners!==null&&this._parseListeners.length>0;if(this.buildParseTrees||t){let i;i=this._errHandler.inErrorRecoveryMode(this)?this._ctx.addErrorNode(e):this._ctx.addTokenNode(e),i.invokingState=this.state,t&&this._parseListeners.forEach(function(r){i instanceof vu||i.isErrorNode!==void 0&&i.isErrorNode()?r.visitErrorNode(i):i instanceof rn&&r.visitTerminal(i)})}return e}addContextToParseTree(){this._ctx.parentCtx!==null&&this._ctx.parentCtx.addChild(this._ctx)}enterRule(e,t,i){this.state=t,this._ctx=e,this._ctx.start=this._input.LT(1),this.buildParseTrees&&this.addContextToParseTree(),this.triggerEnterRuleEvent()}exitRule(){this._ctx.stop=this._input.LT(-1),this.triggerExitRuleEvent(),this.state=this._ctx.invokingState,this._ctx=this._ctx.parentCtx}enterOuterAlt(e,t){e.setAltNumber(t),this.buildParseTrees&&this._ctx!==e&&this._ctx.parentCtx!==null&&(this._ctx.parentCtx.removeLastChild(),this._ctx.parentCtx.addChild(e)),this._ctx=e}getPrecedence(){return this._precedenceStack.length===0?-1:this._precedenceStack[this._precedenceStack.length-1]}enterRecursionRule(e,t,i,r){this.state=t,this._precedenceStack.push(r),this._ctx=e,this._ctx.start=this._input.LT(1),this.triggerEnterRuleEvent()}pushNewRecursionContext(e,t,i){const r=this._ctx;r.parentCtx=e,r.invokingState=t,r.stop=this._input.LT(-1),this._ctx=e,this._ctx.start=r.start,this.buildParseTrees&&this._ctx.addChild(r),this.triggerEnterRuleEvent()}unrollRecursionContexts(e){this._precedenceStack.pop(),this._ctx.stop=this._input.LT(-1);const t=this._ctx,i=this.getParseListeners();if(i!==null&&i.length>0)for(;this._ctx!==e;)this.triggerExitRuleEvent(),this._ctx=this._ctx.parentCtx;else this._ctx=e;t.parentCtx=e,this.buildParseTrees&&e!==null&&e.addChild(t)}getInvokingContext(e){let t=this._ctx;for(;t!==null;){if(t.ruleIndex===e)return t;t=t.parentCtx}return null}precpred(e,t){return t>=this._precedenceStack[this._precedenceStack.length-1]}inContext(e){return!1}isExpectedToken(e){const t=this._interp.atn;let i=this._ctx;const r=t.states[this.state];let s=t.nextTokens(r);if(s.contains(e))return!0;if(!s.contains(Ee.EPSILON))return!1;for(;i!==null&&i.invokingState>=0&&s.contains(Ee.EPSILON);){const a=t.states[i.invokingState].transitions[0];if(s=t.nextTokens(a.followState),s.contains(e))return!0;i=i.parentCtx}return!(!s.contains(Ee.EPSILON)||e!==Ee.EOF)}getExpectedTokens(){return this._interp.atn.getExpectedTokens(this.state,this._ctx)}getExpectedTokensWithinCurrentRule(){const e=this._interp.atn,t=e.states[this.state];return e.nextTokens(t)}getRuleIndex(e){const t=this.getRuleIndexMap()[e];return t!==null?t:-1}getRuleInvocationStack(e){(e=e||null)===null&&(e=this._ctx);const t=[];for(;e!==null;){const i=e.ruleIndex;i<0?t.push("n/a"):t.push(this.ruleNames[i]),e=e.parentCtx}return t}getDFAStrings(){return this._interp.decisionToDFA.toString()}dumpDFA(){let e=!1;for(let t=0;t<this._interp.decisionToDFA.length;t++){const i=this._interp.decisionToDFA[t];i.states.length>0&&(e&&console.log(),this.printer.println("Decision "+i.decision+":"),this.printer.print(i.toString(this.literalNames,this.symbolicNames)),e=!0)}}getSourceName(){return this._input.getSourceName()}setTrace(e){e?(this._tracer!==null&&this.removeParseListener(this._tracer),this._tracer=new nI(this),this.addParseListener(this._tracer)):(this.removeParseListener(this._tracer),this._tracer=null)}}$d.bypassAltsAtnCache={};class Ov extends rn{constructor(e){super(),this.parentCtx=null,this.symbol=e}getChild(e){return null}getSymbol(){return this.symbol}getParent(){return this.parentCtx}getPayload(){return this.symbol}getSourceInterval(){if(this.symbol===null)return pt.INVALID_INTERVAL;const e=this.symbol.tokenIndex;return new pt(e,e)}getChildCount(){return 0}accept(e){return e.visitTerminal(this)}getText(){return this.symbol.text}toString(){return this.symbol.type===Ee.EOF?"<EOF>":this.symbol.text}}class Fv extends Ov{constructor(e){super(e)}isErrorNode(){return!0}accept(e){return e.visitErrorNode(this)}}class Gd extends Xs{constructor(e,t){super(e,t),this.children=null,this.start=null,this.stop=null,this.exception=null}copyFrom(e){this.parentCtx=e.parentCtx,this.invokingState=e.invokingState,this.children=null,this.start=e.start,this.stop=e.stop,e.children&&(this.children=[],e.children.map(function(t){t instanceof Fv&&(this.children.push(t),t.parentCtx=this)},this))}enterRule(e){}exitRule(e){}addChild(e){return this.children===null&&(this.children=[]),this.children.push(e),e}removeLastChild(){this.children!==null&&this.children.pop()}addTokenNode(e){const t=new Ov(e);return this.addChild(t),t.parentCtx=this,t}addErrorNode(e){const t=new Fv(e);return this.addChild(t),t.parentCtx=this,t}getChild(e,t){if(t=t||null,this.children===null||e<0||e>=this.children.length)return null;if(t===null)return this.children[e];for(let i=0;i<this.children.length;i++){const r=this.children[i];if(r instanceof t){if(e===0)return r;e-=1}}return null}getToken(e,t){if(this.children===null||t<0||t>=this.children.length)return null;for(let i=0;i<this.children.length;i++){const r=this.children[i];if(r instanceof rn&&r.symbol.type===e){if(t===0)return r;t-=1}}return null}getTokens(e){if(this.children===null)return[];{const t=[];for(let i=0;i<this.children.length;i++){const r=this.children[i];r instanceof rn&&r.symbol.type===e&&t.push(r)}return t}}getTypedRuleContext(e,t){return this.getChild(t,e)}getTypedRuleContexts(e){if(this.children===null)return[];{const t=[];for(let i=0;i<this.children.length;i++){const r=this.children[i];r instanceof e&&t.push(r)}return t}}getChildCount(){return this.children===null?0:this.children.length}getSourceInterval(){return this.start===null||this.stop===null?pt.INVALID_INTERVAL:new pt(this.start.tokenIndex,this.stop.tokenIndex)}}Xs.EMPTY=new Gd;const Wn=class Wn{constructor(e){this.tokens=e,this.programs=new Map}getTokenStream(){return this.tokens}insertAfter(e,t){let i,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wn.DEFAULT_PROGRAM_NAME;i=typeof e=="number"?e:e.tokenIndex;let s=this.getProgram(r),a=new Uv(this.tokens,i,s.length,t);s.push(a)}insertBefore(e,t){let i,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wn.DEFAULT_PROGRAM_NAME;i=typeof e=="number"?e:e.tokenIndex;const s=this.getProgram(r),a=new $a(this.tokens,i,s.length,t);s.push(a)}replaceSingle(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wn.DEFAULT_PROGRAM_NAME;this.replace(e,e,t,i)}replace(e,t,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:Wn.DEFAULT_PROGRAM_NAME;if(typeof e!="number"&&(e=e.tokenIndex),typeof t!="number"&&(t=t.tokenIndex),e>t||e<0||t<0||t>=this.tokens.size)throw new RangeError(`replace: range invalid: ${e}..${t}(size=${this.tokens.size})`);let s=this.getProgram(r),a=new Iu(this.tokens,e,t,s.length,i);s.push(a)}delete(e,t){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Wn.DEFAULT_PROGRAM_NAME;t===void 0&&(t=e),this.replace(e,t,null,i)}getProgram(e){let t=this.programs.get(e);return t==null&&(t=this.initializeProgram(e)),t}initializeProgram(e){const t=[];return this.programs.set(e,t),t}getText(e){let t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Wn.DEFAULT_PROGRAM_NAME;t=e instanceof pt?e:new pt(0,this.tokens.size-1),typeof e=="string"&&(i=e);const r=this.programs.get(i);let s=t.start,a=t.stop;if(a>this.tokens.size-1&&(a=this.tokens.size-1),s<0&&(s=0),r==null||r.length===0)return this.tokens.getText(new pt(s,a));let o=[],l=this.reduceToSingleOperationPerIndex(r),u=s;for(;u<=a&&u<this.tokens.size;){let h=l.get(u);l.delete(u);let d=this.tokens.get(u);h==null?(d.type!==Ee.EOF&&o.push(String(d.text)),u++):u=h.execute(o)}if(a===this.tokens.size-1)for(const h of l.values())h.index>=this.tokens.size-1&&o.push(h.text.toString());return o.join("")}reduceToSingleOperationPerIndex(e){for(let i=0;i<e.length;i++){let r=e[i];if(r==null||!(r instanceof Iu))continue;let s=r,a=this.getKindOfOps(e,$a,i);for(let l of a)l.index===s.index?(e[l.instructionIndex]=void 0,s.text=l.text.toString()+(s.text!=null?s.text.toString():"")):l.index>s.index&&l.index<=s.lastIndex&&(e[l.instructionIndex]=void 0);let o=this.getKindOfOps(e,Iu,i);for(let l of o){if(l.index>=s.index&&l.lastIndex<=s.lastIndex){e[l.instructionIndex]=void 0;continue}let u=l.lastIndex<s.index||l.index>s.lastIndex;if(l.text!=null||s.text!=null||u){if(!u)throw new Error(`replace op boundaries of ${s} overlap with previous ${l}`)}else e[l.instructionIndex]=void 0,s.index=Math.min(l.index,s.index),s.lastIndex=Math.max(l.lastIndex,s.lastIndex)}}for(let i=0;i<e.length;i++){let r=e[i];if(r==null||!(r instanceof $a))continue;let s=r,a=this.getKindOfOps(e,$a,i);for(let l of a)l.index===s.index&&(l instanceof Uv?(s.text=this.catOpText(l.text,s.text),e[l.instructionIndex]=void 0):l instanceof $a&&(s.text=this.catOpText(s.text,l.text),e[l.instructionIndex]=void 0));let o=this.getKindOfOps(e,Iu,i);for(let l of o)if(s.index!==l.index){if(s.index>=l.index&&s.index<=l.lastIndex)throw new Error(`insert op ${s} within boundaries of previous ${l}`)}else l.text=this.catOpText(s.text,l.text),e[i]=void 0}let t=new Map;for(let i of e)if(i!=null){if(t.get(i.index)!=null)throw new Error("should only be one op per index");t.set(i.index,i)}return t}catOpText(e,t){let i="",r="";return e!=null&&(i=e.toString()),t!=null&&(r=t.toString()),i+r}getKindOfOps(e,t,i){return e.slice(0,i).filter(r=>r&&r instanceof t)}};X(Wn,"DEFAULT_PROGRAM_NAME","default");let Ru=Wn;class Bv{constructor(e,t,i,r){this.tokens=e,this.instructionIndex=i,this.index=t,this.text=r===void 0?"":r}toString(){let e=this.constructor.name;const t=e.indexOf("$");return e=e.substring(t+1,e.length),"<"+e+"@"+this.tokens.get(this.index)+':"'+this.text+'">'}}class $a extends Bv{constructor(e,t,i,r){super(e,t,i,r)}execute(e){return this.text&&e.push(this.text.toString()),this.tokens.get(this.index).type!==Ee.EOF&&e.push(String(this.tokens.get(this.index).text)),this.index+1}}class Uv extends $a{constructor(e,t,i,r){super(e,t+1,i,r)}}class Iu extends Bv{constructor(e,t,i,r,s){super(e,t,r,s),this.lastIndex=i}execute(e){return this.text&&e.push(this.text.toString()),this.lastIndex+1}toString(){return this.text==null?"<DeleteOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+">":"<ReplaceOp@"+this.tokens.get(this.index)+".."+this.tokens.get(this.lastIndex)+':"'+this.text+'">'}}const sI={atn:zR,dfa:jR,context:XR,misc:JR,tree:QR,error:tI,Token:Ee,CommonToken:_n,CharStreams:Mv,CharStream:Qs,InputStream:Ud,CommonTokenStream:Pv,Lexer:Kt,Parser:$d,ParserRuleContext:Gd,Interval:pt,IntervalSet:Er,LL1Analyzer:bu,Utils:iI,TokenStreamRewriter:Ru};ht.MG,ht.fr,ht.sR,ht.Zo,ht.iH,ht.rt,ht.jB,ht.M8,ht.$t,ht.aq,ht.pG,ht.eP,ht.KU,ht.zW,ht.IX,ht.mY,ht.a7,ht.JG,ht.ay,ht.X2,ht.WU,ht.Uw,ht.gw,ht.iX,ht.re,ht.Pg,ht.tD,ht.R$,ht.Dj,ht.m7,ht.NZ,ht.xo,ht.ou,ht.qC,ht.mD;var aI=ht.Ay,oI={63:n=>{n.exports=function e(t,i){if(t===i)return!0;if(t&&i&&typeof t=="object"&&typeof i=="object"){if(t.constructor!==i.constructor)return!1;var r,s,a;if(Array.isArray(t)){if((r=t.length)!=i.length)return!1;for(s=r;s--!=0;)if(!e(t[s],i[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(s=r;s--!=0;)if(!Object.prototype.hasOwnProperty.call(i,a[s]))return!1;for(s=r;s--!=0;){var o=a[s];if(!e(t[o],i[o]))return!1}return!0}return t!=t&&i!=i}}},$v={};function ps(n){var e=$v[n];if(e!==void 0)return e.exports;var t=$v[n]={exports:{}};return oI[n](t,t.exports,ps),t.exports}ps.d=(n,e)=>{for(var t in e)ps.o(e,t)&&!ps.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})},ps.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Ga={};(()=>{ps.d(Ga,{yS:()=>i,Qc:()=>V,Hb:()=>B,IO:()=>Ae,Pz:()=>Me});const n=(e={default:()=>aI},t={},ps.d(t,e),t);var e,t;class i extends Error{constructor(D,S,P){super(P),this.line=D,this.charPositionInLine=S,this.msg=P}}const r=new n.default.atn.ATNDeserializer().deserialize([4,0,45,356,6,-1,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,2,19,7,19,2,20,7,20,2,21,7,21,2,22,7,22,2,23,7,23,2,24,7,24,2,25,7,25,2,26,7,26,2,27,7,27,2,28,7,28,2,29,7,29,2,30,7,30,2,31,7,31,2,32,7,32,2,33,7,33,2,34,7,34,2,35,7,35,2,36,7,36,2,37,7,37,2,38,7,38,2,39,7,39,2,40,7,40,2,41,7,41,2,42,7,42,2,43,7,43,2,44,7,44,2,45,7,45,2,46,7,46,2,47,7,47,2,48,7,48,2,49,7,49,2,50,7,50,2,51,7,51,2,52,7,52,1,0,1,0,1,1,1,1,1,1,1,2,1,2,1,3,1,3,1,4,1,4,1,5,1,5,1,5,1,6,1,6,1,6,1,7,1,7,1,7,1,8,1,8,1,9,1,9,1,9,1,10,1,10,1,11,1,11,1,11,1,12,1,12,1,12,1,13,1,13,1,13,1,13,1,13,1,14,1,14,1,14,1,14,1,14,1,14,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,15,1,16,1,16,1,16,1,16,1,16,1,16,1,16,1,16,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,18,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,20,1,20,1,20,1,20,1,20,1,20,1,20,1,21,1,21,1,22,1,22,1,22,1,23,1,23,1,23,1,23,1,23,1,24,1,24,1,24,1,24,1,24,1,24,1,25,1,25,1,25,1,25,1,25,1,26,1,26,1,27,1,27,1,28,1,28,1,29,1,29,1,30,1,30,1,31,1,31,1,32,1,32,1,33,1,33,1,34,1,34,1,35,1,35,1,35,1,36,1,36,1,37,1,37,1,38,5,38,250,8,38,10,38,12,38,253,9,38,1,39,1,39,5,39,257,8,39,10,39,12,39,260,9,39,1,39,1,39,1,40,5,40,265,8,40,10,40,12,40,268,9,40,1,40,1,40,5,40,272,8,40,10,40,12,40,275,9,40,1,41,4,41,278,8,41,11,41,12,41,279,1,42,4,42,283,8,42,11,42,12,42,284,1,42,1,42,1,43,3,43,290,8,43,1,43,1,43,1,43,4,43,295,8,43,11,43,12,43,296,3,43,299,8,43,1,43,3,43,302,8,43,1,44,1,44,1,44,5,44,307,8,44,10,44,12,44,310,9,44,1,44,1,44,1,44,1,44,5,44,316,8,44,10,44,12,44,319,9,44,1,44,3,44,322,8,44,1,45,1,45,1,45,3,45,327,8,45,1,46,1,46,1,46,3,46,332,8,46,1,47,1,47,1,47,1,47,1,47,1,47,1,48,1,48,1,49,1,49,1,50,1,50,1,51,4,51,347,8,51,11,51,12,51,348,1,52,1,52,3,52,353,8,52,1,52,1,52,1,258,0,53,1,1,3,2,5,3,7,4,9,5,11,6,13,7,15,8,17,9,19,10,21,11,23,12,25,13,27,14,29,15,31,16,33,17,35,18,37,19,39,20,41,21,43,22,45,23,47,24,49,25,51,26,53,27,55,28,57,29,59,30,61,31,63,32,65,33,67,34,69,35,71,36,73,37,75,38,77,39,79,40,81,41,83,42,85,43,87,44,89,45,91,0,93,0,95,0,97,0,99,0,101,0,103,0,105,0,1,0,14,6,0,103,103,105,105,109,109,115,115,117,117,121,121,4,0,45,45,65,90,95,95,97,122,3,0,65,90,95,95,97,122,4,0,48,57,65,90,95,95,97,122,2,0,95,95,128,65535,3,0,9,10,13,13,32,32,1,0,48,57,8,0,39,39,47,47,92,92,98,98,102,102,110,110,114,114,116,116,8,0,34,34,47,47,92,92,98,98,102,102,110,110,114,114,116,116,3,0,48,57,65,70,97,102,3,0,0,31,39,39,92,92,3,0,0,31,34,34,92,92,2,0,69,69,101,101,2,0,43,43,45,45,366,0,1,1,0,0,0,0,3,1,0,0,0,0,5,1,0,0,0,0,7,1,0,0,0,0,9,1,0,0,0,0,11,1,0,0,0,0,13,1,0,0,0,0,15,1,0,0,0,0,17,1,0,0,0,0,19,1,0,0,0,0,21,1,0,0,0,0,23,1,0,0,0,0,25,1,0,0,0,0,27,1,0,0,0,0,29,1,0,0,0,0,31,1,0,0,0,0,33,1,0,0,0,0,35,1,0,0,0,0,37,1,0,0,0,0,39,1,0,0,0,0,41,1,0,0,0,0,43,1,0,0,0,0,45,1,0,0,0,0,47,1,0,0,0,0,49,1,0,0,0,0,51,1,0,0,0,0,53,1,0,0,0,0,55,1,0,0,0,0,57,1,0,0,0,0,59,1,0,0,0,0,61,1,0,0,0,0,63,1,0,0,0,0,65,1,0,0,0,0,67,1,0,0,0,0,69,1,0,0,0,0,71,1,0,0,0,0,73,1,0,0,0,0,75,1,0,0,0,0,77,1,0,0,0,0,79,1,0,0,0,0,81,1,0,0,0,0,83,1,0,0,0,0,85,1,0,0,0,0,87,1,0,0,0,0,89,1,0,0,0,1,107,1,0,0,0,3,109,1,0,0,0,5,112,1,0,0,0,7,114,1,0,0,0,9,116,1,0,0,0,11,118,1,0,0,0,13,121,1,0,0,0,15,124,1,0,0,0,17,127,1,0,0,0,19,129,1,0,0,0,21,132,1,0,0,0,23,134,1,0,0,0,25,137,1,0,0,0,27,140,1,0,0,0,29,145,1,0,0,0,31,151,1,0,0,0,33,162,1,0,0,0,35,170,1,0,0,0,37,179,1,0,0,0,39,188,1,0,0,0,41,195,1,0,0,0,43,202,1,0,0,0,45,204,1,0,0,0,47,207,1,0,0,0,49,212,1,0,0,0,51,218,1,0,0,0,53,223,1,0,0,0,55,225,1,0,0,0,57,227,1,0,0,0,59,229,1,0,0,0,61,231,1,0,0,0,63,233,1,0,0,0,65,235,1,0,0,0,67,237,1,0,0,0,69,239,1,0,0,0,71,241,1,0,0,0,73,244,1,0,0,0,75,246,1,0,0,0,77,251,1,0,0,0,79,254,1,0,0,0,81,266,1,0,0,0,83,277,1,0,0,0,85,282,1,0,0,0,87,289,1,0,0,0,89,321,1,0,0,0,91,323,1,0,0,0,93,328,1,0,0,0,95,333,1,0,0,0,97,339,1,0,0,0,99,341,1,0,0,0,101,343,1,0,0,0,103,346,1,0,0,0,105,350,1,0,0,0,107,108,5,64,0,0,108,2,1,0,0,0,109,110,5,46,0,0,110,111,5,46,0,0,111,4,1,0,0,0,112,113,5,36,0,0,113,6,1,0,0,0,114,115,5,46,0,0,115,8,1,0,0,0,116,117,5,42,0,0,117,10,1,0,0,0,118,119,5,38,0,0,119,120,5,38,0,0,120,12,1,0,0,0,121,122,5,61,0,0,122,123,5,61,0,0,123,14,1,0,0,0,124,125,5,62,0,0,125,126,5,61,0,0,126,16,1,0,0,0,127,128,5,62,0,0,128,18,1,0,0,0,129,130,5,60,0,0,130,131,5,61,0,0,131,20,1,0,0,0,132,133,5,60,0,0,133,22,1,0,0,0,134,135,5,33,0,0,135,136,5,61,0,0,136,24,1,0,0,0,137,138,5,61,0,0,138,139,5,126,0,0,139,26,1,0,0,0,140,141,5,32,0,0,141,142,5,105,0,0,142,143,5,110,0,0,143,144,5,32,0,0,144,28,1,0,0,0,145,146,5,32,0,0,146,147,5,110,0,0,147,148,5,105,0,0,148,149,5,110,0,0,149,150,5,32,0,0,150,30,1,0,0,0,151,152,5,32,0,0,152,153,5,115,0,0,153,154,5,117,0,0,154,155,5,98,0,0,155,156,5,115,0,0,156,157,5,101,0,0,157,158,5,116,0,0,158,159,5,111,0,0,159,160,5,102,0,0,160,161,5,32,0,0,161,32,1,0,0,0,162,163,5,32,0,0,163,164,5,97,0,0,164,165,5,110,0,0,165,166,5,121,0,0,166,167,5,111,0,0,167,168,5,102,0,0,168,169,5,32,0,0,169,34,1,0,0,0,170,171,5,32,0,0,171,172,5,110,0,0,172,173,5,111,0,0,173,174,5,110,0,0,174,175,5,101,0,0,175,176,5,111,0,0,176,177,5,102,0,0,177,178,5,32,0,0,178,36,1,0,0,0,179,180,5,32,0,0,180,181,5,115,0,0,181,182,5,105,0,0,182,183,5,122,0,0,183,184,5,101,0,0,184,185,5,111,0,0,185,186,5,102,0,0,186,187,5,32,0,0,187,38,1,0,0,0,188,189,5,32,0,0,189,190,5,115,0,0,190,191,5,105,0,0,191,192,5,122,0,0,192,193,5,101,0,0,193,194,5,32,0,0,194,40,1,0,0,0,195,196,5,32,0,0,196,197,5,101,0,0,197,198,5,109,0,0,198,199,5,112,0,0,199,200,5,116,0,0,200,201,5,121,0,0,201,42,1,0,0,0,202,203,5,33,0,0,203,44,1,0,0,0,204,205,5,124,0,0,205,206,5,124,0,0,206,46,1,0,0,0,207,208,5,116,0,0,208,209,5,114,0,0,209,210,5,117,0,0,210,211,5,101,0,0,211,48,1,0,0,0,212,213,5,102,0,0,213,214,5,97,0,0,214,215,5,108,0,0,215,216,5,115,0,0,216,217,5,101,0,0,217,50,1,0,0,0,218,219,5,110,0,0,219,220,5,117,0,0,220,221,5,108,0,0,221,222,5,108,0,0,222,52,1,0,0,0,223,224,5,123,0,0,224,54,1,0,0,0,225,226,5,125,0,0,226,56,1,0,0,0,227,228,5,91,0,0,228,58,1,0,0,0,229,230,5,93,0,0,230,60,1,0,0,0,231,232,5,58,0,0,232,62,1,0,0,0,233,234,5,44,0,0,234,64,1,0,0,0,235,236,5,40,0,0,236,66,1,0,0,0,237,238,5,41,0,0,238,68,1,0,0,0,239,240,5,63,0,0,240,70,1,0,0,0,241,242,5,45,0,0,242,243,5,32,0,0,243,72,1,0,0,0,244,245,5,43,0,0,245,74,1,0,0,0,246,247,5,47,0,0,247,76,1,0,0,0,248,250,7,0,0,0,249,248,1,0,0,0,250,253,1,0,0,0,251,249,1,0,0,0,251,252,1,0,0,0,252,78,1,0,0,0,253,251,1,0,0,0,254,258,5,47,0,0,255,257,9,0,0,0,256,255,1,0,0,0,257,260,1,0,0,0,258,259,1,0,0,0,258,256,1,0,0,0,259,261,1,0,0,0,260,258,1,0,0,0,261,262,5,47,0,0,262,80,1,0,0,0,263,265,7,1,0,0,264,263,1,0,0,0,265,268,1,0,0,0,266,264,1,0,0,0,266,267,1,0,0,0,267,269,1,0,0,0,268,266,1,0,0,0,269,273,7,2,0,0,270,272,7,3,0,0,271,270,1,0,0,0,272,275,1,0,0,0,273,271,1,0,0,0,273,274,1,0,0,0,274,82,1,0,0,0,275,273,1,0,0,0,276,278,7,4,0,0,277,276,1,0,0,0,278,279,1,0,0,0,279,277,1,0,0,0,279,280,1,0,0,0,280,84,1,0,0,0,281,283,7,5,0,0,282,281,1,0,0,0,283,284,1,0,0,0,284,282,1,0,0,0,284,285,1,0,0,0,285,286,1,0,0,0,286,287,6,42,0,0,287,86,1,0,0,0,288,290,5,45,0,0,289,288,1,0,0,0,289,290,1,0,0,0,290,291,1,0,0,0,291,298,3,103,51,0,292,294,5,46,0,0,293,295,7,6,0,0,294,293,1,0,0,0,295,296,1,0,0,0,296,294,1,0,0,0,296,297,1,0,0,0,297,299,1,0,0,0,298,292,1,0,0,0,298,299,1,0,0,0,299,301,1,0,0,0,300,302,3,105,52,0,301,300,1,0,0,0,301,302,1,0,0,0,302,88,1,0,0,0,303,308,5,34,0,0,304,307,3,93,46,0,305,307,3,101,50,0,306,304,1,0,0,0,306,305,1,0,0,0,307,310,1,0,0,0,308,306,1,0,0,0,308,309,1,0,0,0,309,311,1,0,0,0,310,308,1,0,0,0,311,322,5,34,0,0,312,317,5,39,0,0,313,316,3,91,45,0,314,316,3,99,49,0,315,313,1,0,0,0,315,314,1,0,0,0,316,319,1,0,0,0,317,315,1,0,0,0,317,318,1,0,0,0,318,320,1,0,0,0,319,317,1,0,0,0,320,322,5,39,0,0,321,303,1,0,0,0,321,312,1,0,0,0,322,90,1,0,0,0,323,326,5,92,0,0,324,327,7,7,0,0,325,327,3,95,47,0,326,324,1,0,0,0,326,325,1,0,0,0,327,92,1,0,0,0,328,331,5,92,0,0,329,332,7,8,0,0,330,332,3,95,47,0,331,329,1,0,0,0,331,330,1,0,0,0,332,94,1,0,0,0,333,334,5,117,0,0,334,335,3,97,48,0,335,336,3,97,48,0,336,337,3,97,48,0,337,338,3,97,48,0,338,96,1,0,0,0,339,340,7,9,0,0,340,98,1,0,0,0,341,342,8,10,0,0,342,100,1,0,0,0,343,344,8,11,0,0,344,102,1,0,0,0,345,347,7,6,0,0,346,345,1,0,0,0,347,348,1,0,0,0,348,346,1,0,0,0,348,349,1,0,0,0,349,104,1,0,0,0,350,352,7,12,0,0,351,353,7,13,0,0,352,351,1,0,0,0,352,353,1,0,0,0,353,354,1,0,0,0,354,355,3,103,51,0,355,106,1,0,0,0,20,0,251,258,266,273,279,284,289,296,298,301,306,308,315,317,321,326,331,348,352,1,6,0,0]),s=r.decisionToState.map((K,D)=>new n.default.dfa.DFA(K,D));class a extends n.default.Lexer{constructor(D){super(D),this._interp=new n.default.atn.LexerATNSimulator(this,r,s,new n.default.atn.PredictionContextCache)}}X(a,"grammarFileName","JSONPath.g4"),X(a,"channelNames",["DEFAULT_TOKEN_CHANNEL","HIDDEN"]),X(a,"modeNames",["DEFAULT_MODE"]),X(a,"literalNames",[null,"'@'","'..'","'$'","'.'","'*'","'&&'","'=='","'>='","'>'","'<='","'<'","'!='","'=~'","' in '","' nin '","' subsetof '","' anyof '","' noneof '","' sizeof '","' size '","' empty'","'!'","'||'","'true'","'false'","'null'","'{'","'}'","'['","']'","':'","','","'('","')'","'?'","'- '","'+'","'/'"]),X(a,"symbolicNames",[null,"CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING"]),X(a,"ruleNames",["CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING","ESC_SINGLE","ESC_DOUBLE","UNICODE","HEX","SAFECODEPOINT_SINGLE","SAFECODEPOINT_DOUBLE","INT","EXP"]),a.EOF=n.default.Token.EOF,a.CURRENT_VALUE=1,a.DOTDOT=2,a.ROOT_VALUE=3,a.DOT=4,a.STAR=5,a.AND=6,a.EQ=7,a.GE=8,a.GT=9,a.LE=10,a.LT=11,a.NE=12,a.REG=13,a.IN=14,a.NIN=15,a.SUB=16,a.ANY=17,a.NON=18,a.SIZO=19,a.SIZ=20,a.EMPT=21,a.NOT=22,a.OR=23,a.TRUE=24,a.FALSE=25,a.NULL=26,a.BRACE_LEFT=27,a.BRACE_RIGHT=28,a.BRACKET_LEFT=29,a.BRACKET_RIGHT=30,a.COLON=31,a.COMMA=32,a.PAREN_LEFT=33,a.PAREN_RIGHT=34,a.QUESTION=35,a.MINUS_SP=36,a.PLUS=37,a.DIV=38,a.REGEX_OPT=39,a.REGEX_EXPR=40,a.KEY=41,a.SPECIAL_KEY=42,a.WS=43,a.NUMBER=44,a.STRING=45;class o extends n.default.tree.ParseTreeListener{enterJsonpath(D){}exitJsonpath(D){}enterFilterarg(D){}exitFilterarg(D){}enterSubscript(D){}exitSubscript(D){}enterDotdotContent(D){}exitDotdotContent(D){}enterDotContent(D){}exitDotContent(D){}enterBracket(D){}exitBracket(D){}enterBracketContent(D){}exitBracketContent(D){}enterFilterExpression(D){}exitFilterExpression(D){}enterIndexes(D){}exitIndexes(D){}enterUnions(D){}exitUnions(D){}enterSlices(D){}exitSlices(D){}enterRegex(D){}exitRegex(D){}enterExpression(D){}exitExpression(D){}enterFilterpath(D){}exitFilterpath(D){}enterIdentifier(D){}exitIdentifier(D){}enterObj(D){}exitObj(D){}enterPair(D){}exitPair(D){}enterArray(D){}exitArray(D){}enterValue(D){}exitValue(D){}}const l=new n.default.atn.ATNDeserializer().deserialize([4,1,45,236,2,0,7,0,2,1,7,1,2,2,7,2,2,3,7,3,2,4,7,4,2,5,7,5,2,6,7,6,2,7,7,7,2,8,7,8,2,9,7,9,2,10,7,10,2,11,7,11,2,12,7,12,2,13,7,13,2,14,7,14,2,15,7,15,2,16,7,16,2,17,7,17,2,18,7,18,1,0,1,0,3,0,41,8,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,52,8,1,1,1,1,1,1,1,1,1,1,1,3,1,59,8,1,1,1,5,1,62,8,1,10,1,12,1,65,9,1,1,2,1,2,1,2,3,2,70,8,2,1,2,1,2,1,2,3,2,75,8,2,1,2,1,2,3,2,79,8,2,3,2,81,8,2,1,3,1,3,1,3,3,3,86,8,3,1,4,1,4,1,4,3,4,91,8,4,1,5,1,5,1,5,1,5,1,6,1,6,1,6,1,6,1,6,1,6,1,6,1,6,3,6,105,8,6,1,7,1,7,1,7,1,7,1,7,1,8,1,8,1,8,4,8,115,8,8,11,8,12,8,116,1,9,1,9,1,9,4,9,122,8,9,11,9,12,9,123,1,9,1,9,1,9,4,9,129,8,9,11,9,12,9,130,3,9,133,8,9,1,10,3,10,136,8,10,1,10,1,10,3,10,140,8,10,1,10,1,10,3,10,144,8,10,3,10,146,8,10,1,11,1,11,3,11,150,8,11,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,1,12,3,12,177,8,12,1,12,1,12,1,12,5,12,182,8,12,10,12,12,12,185,9,12,1,13,1,13,3,13,189,8,13,1,14,1,14,1,15,1,15,1,15,1,15,5,15,197,8,15,10,15,12,15,200,9,15,1,15,1,15,1,15,1,15,3,15,206,8,15,1,16,1,16,1,16,1,16,1,17,1,17,1,17,1,17,5,17,216,8,17,10,17,12,17,219,9,17,1,17,1,17,1,17,1,17,3,17,225,8,17,1,18,1,18,1,18,1,18,1,18,1,18,1,18,3,18,234,8,18,1,18,0,2,2,24,19,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,0,6,2,0,5,5,38,38,1,0,36,37,2,0,7,12,14,20,2,0,6,6,23,23,2,0,1,1,3,3,2,0,24,26,41,42,267,0,38,1,0,0,0,2,51,1,0,0,0,4,80,1,0,0,0,6,85,1,0,0,0,8,90,1,0,0,0,10,92,1,0,0,0,12,104,1,0,0,0,14,106,1,0,0,0,16,111,1,0,0,0,18,132,1,0,0,0,20,135,1,0,0,0,22,147,1,0,0,0,24,176,1,0,0,0,26,186,1,0,0,0,28,190,1,0,0,0,30,205,1,0,0,0,32,207,1,0,0,0,34,224,1,0,0,0,36,233,1,0,0,0,38,40,5,3,0,0,39,41,3,4,2,0,40,39,1,0,0,0,40,41,1,0,0,0,41,42,1,0,0,0,42,43,5,0,0,1,43,1,1,0,0,0,44,45,6,1,-1,0,45,46,5,33,0,0,46,47,3,2,1,0,47,48,5,34,0,0,48,52,1,0,0,0,49,52,3,36,18,0,50,52,3,26,13,0,51,44,1,0,0,0,51,49,1,0,0,0,51,50,1,0,0,0,52,63,1,0,0,0,53,54,10,4,0,0,54,55,7,0,0,0,55,62,3,2,1,5,56,58,10,3,0,0,57,59,7,1,0,0,58,57,1,0,0,0,58,59,1,0,0,0,59,60,1,0,0,0,60,62,3,2,1,4,61,53,1,0,0,0,61,56,1,0,0,0,62,65,1,0,0,0,63,61,1,0,0,0,63,64,1,0,0,0,64,3,1,0,0,0,65,63,1,0,0,0,66,67,5,2,0,0,67,69,3,6,3,0,68,70,3,4,2,0,69,68,1,0,0,0,69,70,1,0,0,0,70,81,1,0,0,0,71,72,5,4,0,0,72,74,3,8,4,0,73,75,3,4,2,0,74,73,1,0,0,0,74,75,1,0,0,0,75,81,1,0,0,0,76,78,3,10,5,0,77,79,3,4,2,0,78,77,1,0,0,0,78,79,1,0,0,0,79,81,1,0,0,0,80,66,1,0,0,0,80,71,1,0,0,0,80,76,1,0,0,0,81,5,1,0,0,0,82,86,5,5,0,0,83,86,3,28,14,0,84,86,3,10,5,0,85,82,1,0,0,0,85,83,1,0,0,0,85,84,1,0,0,0,86,7,1,0,0,0,87,91,5,5,0,0,88,91,5,44,0,0,89,91,3,28,14,0,90,87,1,0,0,0,90,88,1,0,0,0,90,89,1,0,0,0,91,9,1,0,0,0,92,93,5,29,0,0,93,94,3,12,6,0,94,95,5,30,0,0,95,11,1,0,0,0,96,105,3,18,9,0,97,105,3,16,8,0,98,105,3,20,10,0,99,105,5,5,0,0,100,105,5,44,0,0,101,105,5,45,0,0,102,105,3,28,14,0,103,105,3,14,7,0,104,96,1,0,0,0,104,97,1,0,0,0,104,98,1,0,0,0,104,99,1,0,0,0,104,100,1,0,0,0,104,101,1,0,0,0,104,102,1,0,0,0,104,103,1,0,0,0,105,13,1,0,0,0,106,107,5,35,0,0,107,108,5,33,0,0,108,109,3,24,12,0,109,110,5,34,0,0,110,15,1,0,0,0,111,114,5,44,0,0,112,113,5,32,0,0,113,115,5,44,0,0,114,112,1,0,0,0,115,116,1,0,0,0,116,114,1,0,0,0,116,117,1,0,0,0,117,17,1,0,0,0,118,121,5,45,0,0,119,120,5,32,0,0,120,122,5,45,0,0,121,119,1,0,0,0,122,123,1,0,0,0,123,121,1,0,0,0,123,124,1,0,0,0,124,133,1,0,0,0,125,128,3,28,14,0,126,127,5,32,0,0,127,129,3,28,14,0,128,126,1,0,0,0,129,130,1,0,0,0,130,128,1,0,0,0,130,131,1,0,0,0,131,133,1,0,0,0,132,118,1,0,0,0,132,125,1,0,0,0,133,19,1,0,0,0,134,136,5,44,0,0,135,134,1,0,0,0,135,136,1,0,0,0,136,137,1,0,0,0,137,139,5,31,0,0,138,140,5,44,0,0,139,138,1,0,0,0,139,140,1,0,0,0,140,145,1,0,0,0,141,143,5,31,0,0,142,144,5,44,0,0,143,142,1,0,0,0,143,144,1,0,0,0,144,146,1,0,0,0,145,141,1,0,0,0,145,146,1,0,0,0,146,21,1,0,0,0,147,149,5,40,0,0,148,150,5,39,0,0,149,148,1,0,0,0,149,150,1,0,0,0,150,23,1,0,0,0,151,152,6,12,-1,0,152,153,5,22,0,0,153,154,5,33,0,0,154,155,3,24,12,0,155,156,5,34,0,0,156,177,1,0,0,0,157,158,5,33,0,0,158,159,3,24,12,0,159,160,5,34,0,0,160,177,1,0,0,0,161,162,3,2,1,0,162,163,7,2,0,0,163,164,3,2,1,0,164,177,1,0,0,0,165,166,3,2,1,0,166,167,5,13,0,0,167,168,3,22,11,0,168,177,1,0,0,0,169,170,3,2,1,0,170,171,5,21,0,0,171,177,1,0,0,0,172,177,3,26,13,0,173,177,5,24,0,0,174,177,5,25,0,0,175,177,5,26,0,0,176,151,1,0,0,0,176,157,1,0,0,0,176,161,1,0,0,0,176,165,1,0,0,0,176,169,1,0,0,0,176,172,1,0,0,0,176,173,1,0,0,0,176,174,1,0,0,0,176,175,1,0,0,0,177,183,1,0,0,0,178,179,10,8,0,0,179,180,7,3,0,0,180,182,3,24,12,9,181,178,1,0,0,0,182,185,1,0,0,0,183,181,1,0,0,0,183,184,1,0,0,0,184,25,1,0,0,0,185,183,1,0,0,0,186,188,7,4,0,0,187,189,3,4,2,0,188,187,1,0,0,0,188,189,1,0,0,0,189,27,1,0,0,0,190,191,7,5,0,0,191,29,1,0,0,0,192,193,5,27,0,0,193,198,3,32,16,0,194,195,5,32,0,0,195,197,3,32,16,0,196,194,1,0,0,0,197,200,1,0,0,0,198,196,1,0,0,0,198,199,1,0,0,0,199,201,1,0,0,0,200,198,1,0,0,0,201,202,5,28,0,0,202,206,1,0,0,0,203,204,5,27,0,0,204,206,5,28,0,0,205,192,1,0,0,0,205,203,1,0,0,0,206,31,1,0,0,0,207,208,5,45,0,0,208,209,5,31,0,0,209,210,3,36,18,0,210,33,1,0,0,0,211,212,5,29,0,0,212,217,3,36,18,0,213,214,5,32,0,0,214,216,3,36,18,0,215,213,1,0,0,0,216,219,1,0,0,0,217,215,1,0,0,0,217,218,1,0,0,0,218,220,1,0,0,0,219,217,1,0,0,0,220,221,5,30,0,0,221,225,1,0,0,0,222,223,5,29,0,0,223,225,5,30,0,0,224,211,1,0,0,0,224,222,1,0,0,0,225,35,1,0,0,0,226,234,5,45,0,0,227,234,5,44,0,0,228,234,3,30,15,0,229,234,3,34,17,0,230,234,5,24,0,0,231,234,5,25,0,0,232,234,5,26,0,0,233,226,1,0,0,0,233,227,1,0,0,0,233,228,1,0,0,0,233,229,1,0,0,0,233,230,1,0,0,0,233,231,1,0,0,0,233,232,1,0,0,0,234,37,1,0,0,0,29,40,51,58,61,63,69,74,78,80,85,90,104,116,123,130,132,135,139,143,145,149,176,183,188,198,205,217,224,233]),u=l.decisionToState.map((K,D)=>new n.default.dfa.DFA(K,D)),h=new n.default.atn.PredictionContextCache,ue=class ue extends n.default.Parser{constructor(D){super(D),this._interp=new n.default.atn.ParserATNSimulator(this,l,u,h),this.ruleNames=ue.ruleNames,this.literalNames=ue.literalNames,this.symbolicNames=ue.symbolicNames}sempred(D,S,P){switch(S){case 1:return this.filterarg_sempred(D,P);case 12:return this.expression_sempred(D,P);default:throw"No predicate with index:"+S}}filterarg_sempred(D,S){switch(S){case 0:return this.precpred(this._ctx,4);case 1:return this.precpred(this._ctx,3);default:throw"No predicate with index:"+S}}expression_sempred(D,S){if(S===2)return this.precpred(this._ctx,8);throw"No predicate with index:"+S}jsonpath(){let D=new p(this,this._ctx,this.state);this.enterRule(D,0,ue.RULE_jsonpath);var S=0;try{this.enterOuterAlt(D,1),this.state=38,this.match(ue.ROOT_VALUE),this.state=40,this._errHandler.sync(this),(-32&(S=this._input.LA(1)))==0&&(1<<S&536870932)!=0&&(this.state=39,this.subscript()),this.state=42,this.match(ue.EOF)}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}filterarg(D){D===void 0&&(D=0);const S=this._ctx,P=this.state;let W=new g(this,this._ctx,P),Se=W;this.enterRecursionRule(W,2,ue.RULE_filterarg,D);var se=0;try{switch(this.enterOuterAlt(W,1),this.state=51,this._errHandler.sync(this),this._input.LA(1)){case 33:this.state=45,this.match(ue.PAREN_LEFT),this.state=46,this.filterarg(0),this.state=47,this.match(ue.PAREN_RIGHT);break;case 24:case 25:case 26:case 27:case 29:case 44:case 45:this.state=49,this.value();break;case 1:case 3:this.state=50,this.filterpath();break;default:throw new n.default.error.NoViableAltException(this)}this._ctx.stop=this._input.LT(-1),this.state=63,this._errHandler.sync(this);for(var le=this._interp.adaptivePredict(this._input,4,this._ctx);le!=2&&le!=n.default.atn.ATN.INVALID_ALT_NUMBER;){if(le===1)switch(this._parseListeners!==null&&this.triggerExitRuleEvent(),Se=W,this.state=61,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,3,this._ctx)){case 1:if(W=new g(this,S,P),this.pushNewRecursionContext(W,2,ue.RULE_filterarg),this.state=53,!this.precpred(this._ctx,4))throw new n.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 4)");this.state=54,(se=this._input.LA(1))!==5&&se!==38?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=55,this.filterarg(5);break;case 2:if(W=new g(this,S,P),this.pushNewRecursionContext(W,2,ue.RULE_filterarg),this.state=56,!this.precpred(this._ctx,3))throw new n.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 3)");this.state=58,this._errHandler.sync(this),(se=this._input.LA(1))!==36&&se!==37||(this.state=57,(se=this._input.LA(1))!==36&&se!==37?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())),this.state=60,this.filterarg(4)}this.state=65,this._errHandler.sync(this),le=this._interp.adaptivePredict(this._input,4,this._ctx)}}catch(xe){if(!(xe instanceof n.default.error.RecognitionException))throw xe;W.exception=xe,this._errHandler.reportError(this,xe),this._errHandler.recover(this,xe)}finally{this.unrollRecursionContexts(S)}return W}subscript(){let D=new m(this,this._ctx,this.state);this.enterRule(D,4,ue.RULE_subscript);try{switch(this.state=80,this._errHandler.sync(this),this._input.LA(1)){case 2:this.enterOuterAlt(D,1),this.state=66,this.match(ue.DOTDOT),this.state=67,this.dotdotContent(),this.state=69,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,5,this._ctx)===1&&(this.state=68,this.subscript());break;case 4:this.enterOuterAlt(D,2),this.state=71,this.match(ue.DOT),this.state=72,this.dotContent(),this.state=74,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,6,this._ctx)===1&&(this.state=73,this.subscript());break;case 29:this.enterOuterAlt(D,3),this.state=76,this.bracket(),this.state=78,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,7,this._ctx)===1&&(this.state=77,this.subscript());break;default:throw new n.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}dotdotContent(){let D=new y(this,this._ctx,this.state);this.enterRule(D,6,ue.RULE_dotdotContent);try{switch(this.state=85,this._errHandler.sync(this),this._input.LA(1)){case 5:this.enterOuterAlt(D,1),this.state=82,this.match(ue.STAR);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(D,2),this.state=83,this.identifier();break;case 29:this.enterOuterAlt(D,3),this.state=84,this.bracket();break;default:throw new n.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}dotContent(){let D=new b(this,this._ctx,this.state);this.enterRule(D,8,ue.RULE_dotContent);try{switch(this.state=90,this._errHandler.sync(this),this._input.LA(1)){case 5:this.enterOuterAlt(D,1),this.state=87,this.match(ue.STAR);break;case 44:this.enterOuterAlt(D,2),this.state=88,this.match(ue.NUMBER);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(D,3),this.state=89,this.identifier();break;default:throw new n.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}bracket(){let D=new A(this,this._ctx,this.state);this.enterRule(D,10,ue.RULE_bracket);try{this.enterOuterAlt(D,1),this.state=92,this.match(ue.BRACKET_LEFT),this.state=93,this.bracketContent(),this.state=94,this.match(ue.BRACKET_RIGHT)}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}bracketContent(){let D=new w(this,this._ctx,this.state);this.enterRule(D,12,ue.RULE_bracketContent);try{switch(this.state=104,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,11,this._ctx)){case 1:this.enterOuterAlt(D,1),this.state=96,this.unions();break;case 2:this.enterOuterAlt(D,2),this.state=97,this.indexes();break;case 3:this.enterOuterAlt(D,3),this.state=98,this.slices();break;case 4:this.enterOuterAlt(D,4),this.state=99,this.match(ue.STAR);break;case 5:this.enterOuterAlt(D,5),this.state=100,this.match(ue.NUMBER);break;case 6:this.enterOuterAlt(D,6),this.state=101,this.match(ue.STRING);break;case 7:this.enterOuterAlt(D,7),this.state=102,this.identifier();break;case 8:this.enterOuterAlt(D,8),this.state=103,this.filterExpression()}}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}filterExpression(){let D=new x(this,this._ctx,this.state);this.enterRule(D,14,ue.RULE_filterExpression);try{this.enterOuterAlt(D,1),this.state=106,this.match(ue.QUESTION),this.state=107,this.match(ue.PAREN_LEFT),this.state=108,this.expression(0),this.state=109,this.match(ue.PAREN_RIGHT)}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}indexes(){let D=new N(this,this._ctx,this.state);this.enterRule(D,16,ue.RULE_indexes);var S=0;try{this.enterOuterAlt(D,1),this.state=111,this.match(ue.NUMBER),this.state=114,this._errHandler.sync(this),S=this._input.LA(1);do this.state=112,this.match(ue.COMMA),this.state=113,this.match(ue.NUMBER),this.state=116,this._errHandler.sync(this),S=this._input.LA(1);while(S===32)}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}unions(){let D=new F(this,this._ctx,this.state);this.enterRule(D,18,ue.RULE_unions);var S=0;try{switch(this.state=132,this._errHandler.sync(this),this._input.LA(1)){case 45:this.enterOuterAlt(D,1),this.state=118,this.match(ue.STRING),this.state=121,this._errHandler.sync(this),S=this._input.LA(1);do this.state=119,this.match(ue.COMMA),this.state=120,this.match(ue.STRING),this.state=123,this._errHandler.sync(this),S=this._input.LA(1);while(S===32);break;case 24:case 25:case 26:case 41:case 42:this.enterOuterAlt(D,2),this.state=125,this.identifier(),this.state=128,this._errHandler.sync(this),S=this._input.LA(1);do this.state=126,this.match(ue.COMMA),this.state=127,this.identifier(),this.state=130,this._errHandler.sync(this),S=this._input.LA(1);while(S===32);break;default:throw new n.default.error.NoViableAltException(this)}}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}slices(){let D=new L(this,this._ctx,this.state);this.enterRule(D,20,ue.RULE_slices);try{this.enterOuterAlt(D,1),this.state=135,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=134,this.match(ue.NUMBER)),this.state=137,this.match(ue.COLON),this.state=139,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=138,this.match(ue.NUMBER)),this.state=145,this._errHandler.sync(this),this._input.LA(1)===31&&(this.state=141,this.match(ue.COLON),this.state=143,this._errHandler.sync(this),this._input.LA(1)===44&&(this.state=142,this.match(ue.NUMBER)))}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}regex(){let D=new C(this,this._ctx,this.state);this.enterRule(D,22,ue.RULE_regex);try{this.enterOuterAlt(D,1),this.state=147,this.match(ue.REGEX_EXPR),this.state=149,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,20,this._ctx)===1&&(this.state=148,this.match(ue.REGEX_OPT))}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}expression(D){D===void 0&&(D=0);const S=this._ctx,P=this.state;let W=new M(this,this._ctx,P),Se=W;this.enterRecursionRule(W,24,ue.RULE_expression,D);var se=0;try{switch(this.enterOuterAlt(W,1),this.state=176,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,21,this._ctx)){case 1:this.state=152,this.match(ue.NOT),this.state=153,this.match(ue.PAREN_LEFT),this.state=154,this.expression(0),this.state=155,this.match(ue.PAREN_RIGHT);break;case 2:this.state=157,this.match(ue.PAREN_LEFT),this.state=158,this.expression(0),this.state=159,this.match(ue.PAREN_RIGHT);break;case 3:this.state=161,this.filterarg(0),this.state=162,(-32&(se=this._input.LA(1)))!=0||(1<<se&2088832)==0?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=163,this.filterarg(0);break;case 4:this.state=165,this.filterarg(0),this.state=166,this.match(ue.REG),this.state=167,this.regex();break;case 5:this.state=169,this.filterarg(0),this.state=170,this.match(ue.EMPT);break;case 6:this.state=172,this.filterpath();break;case 7:this.state=173,this.match(ue.TRUE);break;case 8:this.state=174,this.match(ue.FALSE);break;case 9:this.state=175,this.match(ue.NULL)}this._ctx.stop=this._input.LT(-1),this.state=183,this._errHandler.sync(this);for(var le=this._interp.adaptivePredict(this._input,22,this._ctx);le!=2&&le!=n.default.atn.ATN.INVALID_ALT_NUMBER;){if(le===1){if(this._parseListeners!==null&&this.triggerExitRuleEvent(),Se=W,W=new M(this,S,P),this.pushNewRecursionContext(W,24,ue.RULE_expression),this.state=178,!this.precpred(this._ctx,8))throw new n.default.error.FailedPredicateException(this,"this.precpred(this._ctx, 8)");this.state=179,(se=this._input.LA(1))!==6&&se!==23?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=180,this.expression(9)}this.state=185,this._errHandler.sync(this),le=this._interp.adaptivePredict(this._input,22,this._ctx)}}catch(xe){if(!(xe instanceof n.default.error.RecognitionException))throw xe;W.exception=xe,this._errHandler.reportError(this,xe),this._errHandler.recover(this,xe)}finally{this.unrollRecursionContexts(S)}return W}filterpath(){let D=new _(this,this._ctx,this.state);this.enterRule(D,26,ue.RULE_filterpath);var S=0;try{this.enterOuterAlt(D,1),this.state=186,(S=this._input.LA(1))!==1&&S!==3?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume()),this.state=188,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,23,this._ctx)===1&&(this.state=187,this.subscript())}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}identifier(){let D=new R(this,this._ctx,this.state);this.enterRule(D,28,ue.RULE_identifier);var S=0;try{this.enterOuterAlt(D,1),this.state=190,((S=this._input.LA(1))-24&-32)!=0||(1<<S-24&393223)==0?this._errHandler.recoverInline(this):(this._errHandler.reportMatch(this),this.consume())}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}obj(){let D=new U(this,this._ctx,this.state);this.enterRule(D,30,ue.RULE_obj);var S=0;try{switch(this.state=205,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,25,this._ctx)){case 1:for(this.enterOuterAlt(D,1),this.state=192,this.match(ue.BRACE_LEFT),this.state=193,this.pair(),this.state=198,this._errHandler.sync(this),S=this._input.LA(1);S===32;)this.state=194,this.match(ue.COMMA),this.state=195,this.pair(),this.state=200,this._errHandler.sync(this),S=this._input.LA(1);this.state=201,this.match(ue.BRACE_RIGHT);break;case 2:this.enterOuterAlt(D,2),this.state=203,this.match(ue.BRACE_LEFT),this.state=204,this.match(ue.BRACE_RIGHT)}}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}pair(){let D=new q(this,this._ctx,this.state);this.enterRule(D,32,ue.RULE_pair);try{this.enterOuterAlt(D,1),this.state=207,this.match(ue.STRING),this.state=208,this.match(ue.COLON),this.state=209,this.value()}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}array(){let D=new $(this,this._ctx,this.state);this.enterRule(D,34,ue.RULE_array);var S=0;try{switch(this.state=224,this._errHandler.sync(this),this._interp.adaptivePredict(this._input,27,this._ctx)){case 1:for(this.enterOuterAlt(D,1),this.state=211,this.match(ue.BRACKET_LEFT),this.state=212,this.value(),this.state=217,this._errHandler.sync(this),S=this._input.LA(1);S===32;)this.state=213,this.match(ue.COMMA),this.state=214,this.value(),this.state=219,this._errHandler.sync(this),S=this._input.LA(1);this.state=220,this.match(ue.BRACKET_RIGHT);break;case 2:this.enterOuterAlt(D,2),this.state=222,this.match(ue.BRACKET_LEFT),this.state=223,this.match(ue.BRACKET_RIGHT)}}catch(P){if(!(P instanceof n.default.error.RecognitionException))throw P;D.exception=P,this._errHandler.reportError(this,P),this._errHandler.recover(this,P)}finally{this.exitRule()}return D}value(){let D=new Y(this,this._ctx,this.state);this.enterRule(D,36,ue.RULE_value);try{switch(this.state=233,this._errHandler.sync(this),this._input.LA(1)){case 45:this.enterOuterAlt(D,1),this.state=226,this.match(ue.STRING);break;case 44:this.enterOuterAlt(D,2),this.state=227,this.match(ue.NUMBER);break;case 27:this.enterOuterAlt(D,3),this.state=228,this.obj();break;case 29:this.enterOuterAlt(D,4),this.state=229,this.array();break;case 24:this.enterOuterAlt(D,5),this.state=230,this.match(ue.TRUE);break;case 25:this.enterOuterAlt(D,6),this.state=231,this.match(ue.FALSE);break;case 26:this.enterOuterAlt(D,7),this.state=232,this.match(ue.NULL);break;default:throw new n.default.error.NoViableAltException(this)}}catch(S){if(!(S instanceof n.default.error.RecognitionException))throw S;D.exception=S,this._errHandler.reportError(this,S),this._errHandler.recover(this,S)}finally{this.exitRule()}return D}};X(ue,"grammarFileName","JSONPath.g4"),X(ue,"literalNames",[null,"'@'","'..'","'$'","'.'","'*'","'&&'","'=='","'>='","'>'","'<='","'<'","'!='","'=~'","' in '","' nin '","' subsetof '","' anyof '","' noneof '","' sizeof '","' size '","' empty'","'!'","'||'","'true'","'false'","'null'","'{'","'}'","'['","']'","':'","','","'('","')'","'?'","'- '","'+'","'/'"]),X(ue,"symbolicNames",[null,"CURRENT_VALUE","DOTDOT","ROOT_VALUE","DOT","STAR","AND","EQ","GE","GT","LE","LT","NE","REG","IN","NIN","SUB","ANY","NON","SIZO","SIZ","EMPT","NOT","OR","TRUE","FALSE","NULL","BRACE_LEFT","BRACE_RIGHT","BRACKET_LEFT","BRACKET_RIGHT","COLON","COMMA","PAREN_LEFT","PAREN_RIGHT","QUESTION","MINUS_SP","PLUS","DIV","REGEX_OPT","REGEX_EXPR","KEY","SPECIAL_KEY","WS","NUMBER","STRING"]),X(ue,"ruleNames",["jsonpath","filterarg","subscript","dotdotContent","dotContent","bracket","bracketContent","filterExpression","indexes","unions","slices","regex","expression","filterpath","identifier","obj","pair","array","value"]);let d=ue;d.EOF=n.default.Token.EOF,d.CURRENT_VALUE=1,d.DOTDOT=2,d.ROOT_VALUE=3,d.DOT=4,d.STAR=5,d.AND=6,d.EQ=7,d.GE=8,d.GT=9,d.LE=10,d.LT=11,d.NE=12,d.REG=13,d.IN=14,d.NIN=15,d.SUB=16,d.ANY=17,d.NON=18,d.SIZO=19,d.SIZ=20,d.EMPT=21,d.NOT=22,d.OR=23,d.TRUE=24,d.FALSE=25,d.NULL=26,d.BRACE_LEFT=27,d.BRACE_RIGHT=28,d.BRACKET_LEFT=29,d.BRACKET_RIGHT=30,d.COLON=31,d.COMMA=32,d.PAREN_LEFT=33,d.PAREN_RIGHT=34,d.QUESTION=35,d.MINUS_SP=36,d.PLUS=37,d.DIV=38,d.REGEX_OPT=39,d.REGEX_EXPR=40,d.KEY=41,d.SPECIAL_KEY=42,d.WS=43,d.NUMBER=44,d.STRING=45,d.RULE_jsonpath=0,d.RULE_filterarg=1,d.RULE_subscript=2,d.RULE_dotdotContent=3,d.RULE_dotContent=4,d.RULE_bracket=5,d.RULE_bracketContent=6,d.RULE_filterExpression=7,d.RULE_indexes=8,d.RULE_unions=9,d.RULE_slices=10,d.RULE_regex=11,d.RULE_expression=12,d.RULE_filterpath=13,d.RULE_identifier=14,d.RULE_obj=15,d.RULE_pair=16,d.RULE_array=17,d.RULE_value=18;class p extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_jsonpath}ROOT_VALUE(){return this.getToken(d.ROOT_VALUE,0)}EOF(){return this.getToken(d.EOF,0)}subscript(){return this.getTypedRuleContext(m,0)}enterRule(D){D instanceof o&&D.enterJsonpath(this)}exitRule(D){D instanceof o&&D.exitJsonpath(this)}}class g extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"filterarg",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(g):this.getTypedRuleContext(g,S)});this.parser=S,this.ruleIndex=d.RULE_filterarg}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}value(){return this.getTypedRuleContext(Y,0)}filterpath(){return this.getTypedRuleContext(_,0)}STAR(){return this.getToken(d.STAR,0)}DIV(){return this.getToken(d.DIV,0)}PLUS(){return this.getToken(d.PLUS,0)}MINUS_SP(){return this.getToken(d.MINUS_SP,0)}enterRule(S){S instanceof o&&S.enterFilterarg(this)}exitRule(S){S instanceof o&&S.exitFilterarg(this)}}class m extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_subscript}DOTDOT(){return this.getToken(d.DOTDOT,0)}dotdotContent(){return this.getTypedRuleContext(y,0)}subscript(){return this.getTypedRuleContext(m,0)}DOT(){return this.getToken(d.DOT,0)}dotContent(){return this.getTypedRuleContext(b,0)}bracket(){return this.getTypedRuleContext(A,0)}enterRule(D){D instanceof o&&D.enterSubscript(this)}exitRule(D){D instanceof o&&D.exitSubscript(this)}}class y extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_dotdotContent}STAR(){return this.getToken(d.STAR,0)}identifier(){return this.getTypedRuleContext(R,0)}bracket(){return this.getTypedRuleContext(A,0)}enterRule(D){D instanceof o&&D.enterDotdotContent(this)}exitRule(D){D instanceof o&&D.exitDotdotContent(this)}}class b extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_dotContent}STAR(){return this.getToken(d.STAR,0)}NUMBER(){return this.getToken(d.NUMBER,0)}identifier(){return this.getTypedRuleContext(R,0)}enterRule(D){D instanceof o&&D.enterDotContent(this)}exitRule(D){D instanceof o&&D.exitDotContent(this)}}class A extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_bracket}BRACKET_LEFT(){return this.getToken(d.BRACKET_LEFT,0)}bracketContent(){return this.getTypedRuleContext(w,0)}BRACKET_RIGHT(){return this.getToken(d.BRACKET_RIGHT,0)}enterRule(D){D instanceof o&&D.enterBracket(this)}exitRule(D){D instanceof o&&D.exitBracket(this)}}class w extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_bracketContent}unions(){return this.getTypedRuleContext(F,0)}indexes(){return this.getTypedRuleContext(N,0)}slices(){return this.getTypedRuleContext(L,0)}STAR(){return this.getToken(d.STAR,0)}NUMBER(){return this.getToken(d.NUMBER,0)}STRING(){return this.getToken(d.STRING,0)}identifier(){return this.getTypedRuleContext(R,0)}filterExpression(){return this.getTypedRuleContext(x,0)}enterRule(D){D instanceof o&&D.enterBracketContent(this)}exitRule(D){D instanceof o&&D.exitBracketContent(this)}}class x extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_filterExpression}QUESTION(){return this.getToken(d.QUESTION,0)}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}expression(){return this.getTypedRuleContext(M,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}enterRule(D){D instanceof o&&D.enterFilterExpression(this)}exitRule(D){D instanceof o&&D.exitFilterExpression(this)}}class N extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"NUMBER",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.NUMBER):this.getToken(d.NUMBER,S)});X(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_indexes}enterRule(S){S instanceof o&&S.enterIndexes(this)}exitRule(S){S instanceof o&&S.exitIndexes(this)}}class F extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"STRING",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.STRING):this.getToken(d.STRING,S)});X(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});X(this,"identifier",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(R):this.getTypedRuleContext(R,S)});this.parser=S,this.ruleIndex=d.RULE_unions}enterRule(S){S instanceof o&&S.enterUnions(this)}exitRule(S){S instanceof o&&S.exitUnions(this)}}class L extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"COLON",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COLON):this.getToken(d.COLON,S)});X(this,"NUMBER",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.NUMBER):this.getToken(d.NUMBER,S)});this.parser=S,this.ruleIndex=d.RULE_slices}enterRule(S){S instanceof o&&S.enterSlices(this)}exitRule(S){S instanceof o&&S.exitSlices(this)}}class C extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_regex}REGEX_EXPR(){return this.getToken(d.REGEX_EXPR,0)}REGEX_OPT(){return this.getToken(d.REGEX_OPT,0)}enterRule(D){D instanceof o&&D.enterRegex(this)}exitRule(D){D instanceof o&&D.exitRegex(this)}}class M extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"expression",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(M):this.getTypedRuleContext(M,S)});X(this,"filterarg",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(g):this.getTypedRuleContext(g,S)});this.parser=S,this.ruleIndex=d.RULE_expression}NOT(){return this.getToken(d.NOT,0)}PAREN_LEFT(){return this.getToken(d.PAREN_LEFT,0)}PAREN_RIGHT(){return this.getToken(d.PAREN_RIGHT,0)}EQ(){return this.getToken(d.EQ,0)}NE(){return this.getToken(d.NE,0)}LT(){return this.getToken(d.LT,0)}LE(){return this.getToken(d.LE,0)}GT(){return this.getToken(d.GT,0)}GE(){return this.getToken(d.GE,0)}IN(){return this.getToken(d.IN,0)}NIN(){return this.getToken(d.NIN,0)}SUB(){return this.getToken(d.SUB,0)}ANY(){return this.getToken(d.ANY,0)}SIZO(){return this.getToken(d.SIZO,0)}NON(){return this.getToken(d.NON,0)}SIZ(){return this.getToken(d.SIZ,0)}REG(){return this.getToken(d.REG,0)}regex(){return this.getTypedRuleContext(C,0)}EMPT(){return this.getToken(d.EMPT,0)}filterpath(){return this.getTypedRuleContext(_,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}AND(){return this.getToken(d.AND,0)}OR(){return this.getToken(d.OR,0)}enterRule(S){S instanceof o&&S.enterExpression(this)}exitRule(S){S instanceof o&&S.exitExpression(this)}}class _ extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_filterpath}ROOT_VALUE(){return this.getToken(d.ROOT_VALUE,0)}CURRENT_VALUE(){return this.getToken(d.CURRENT_VALUE,0)}subscript(){return this.getTypedRuleContext(m,0)}enterRule(D){D instanceof o&&D.enterFilterpath(this)}exitRule(D){D instanceof o&&D.exitFilterpath(this)}}class R extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_identifier}KEY(){return this.getToken(d.KEY,0)}SPECIAL_KEY(){return this.getToken(d.SPECIAL_KEY,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}enterRule(D){D instanceof o&&D.enterIdentifier(this)}exitRule(D){D instanceof o&&D.exitIdentifier(this)}}class U extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"pair",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(q):this.getTypedRuleContext(q,S)});X(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_obj}BRACE_LEFT(){return this.getToken(d.BRACE_LEFT,0)}BRACE_RIGHT(){return this.getToken(d.BRACE_RIGHT,0)}enterRule(S){S instanceof o&&S.enterObj(this)}exitRule(S){S instanceof o&&S.exitObj(this)}}class q extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_pair}STRING(){return this.getToken(d.STRING,0)}COLON(){return this.getToken(d.COLON,0)}value(){return this.getTypedRuleContext(Y,0)}enterRule(D){D instanceof o&&D.enterPair(this)}exitRule(D){D instanceof o&&D.exitPair(this)}}class $ extends n.default.ParserRuleContext{constructor(S,P,W){P===void 0&&(P=null),W==null&&(W=-1);super(P,W);X(this,"value",function(S){return S===void 0&&(S=null),S===null?this.getTypedRuleContexts(Y):this.getTypedRuleContext(Y,S)});X(this,"COMMA",function(S){return S===void 0&&(S=null),S===null?this.getTokens(d.COMMA):this.getToken(d.COMMA,S)});this.parser=S,this.ruleIndex=d.RULE_array}BRACKET_LEFT(){return this.getToken(d.BRACKET_LEFT,0)}BRACKET_RIGHT(){return this.getToken(d.BRACKET_RIGHT,0)}enterRule(S){S instanceof o&&S.enterArray(this)}exitRule(S){S instanceof o&&S.exitArray(this)}}class Y extends n.default.ParserRuleContext{constructor(D,S,P){S===void 0&&(S=null),P==null&&(P=-1),super(S,P),this.parser=D,this.ruleIndex=d.RULE_value}STRING(){return this.getToken(d.STRING,0)}NUMBER(){return this.getToken(d.NUMBER,0)}obj(){return this.getTypedRuleContext(U,0)}array(){return this.getTypedRuleContext($,0)}TRUE(){return this.getToken(d.TRUE,0)}FALSE(){return this.getToken(d.FALSE,0)}NULL(){return this.getToken(d.NULL,0)}enterRule(D){D instanceof o&&D.enterValue(this)}exitRule(D){D instanceof o&&D.exitValue(this)}}d.JsonpathContext=p,d.FilterargContext=g,d.SubscriptContext=m,d.DotdotContentContext=y,d.DotContentContext=b,d.BracketContext=A,d.BracketContentContext=w,d.FilterExpressionContext=x,d.IndexesContext=N,d.UnionsContext=F,d.SlicesContext=L,d.RegexContext=C,d.ExpressionContext=M,d.FilterpathContext=_,d.IdentifierContext=R,d.ObjContext=U,d.PairContext=q,d.ArrayContext=$,d.ValueContext=Y;const ae={root:K=>"type"in K&&K.type==="root",value:K=>"type"in K&&K.type==="value",regex:K=>"type"in K&&K.type==="value"&&K.subtype==="regex",operationContent:K=>"type"in K&&typeof K.type=="string"&&["value","current","root","groupOperation","operation"].includes(K.type),subscript:K=>"type"in K&&K.type==="subscript",bracket:K=>"type"in K&&["bracketMember","bracketExpression"].includes(K.type),unions:K=>"type"in K&&K.type==="unions",indexes:K=>"type"in K&&K.type==="indexes",slices:K=>"type"in K&&K.type==="slices",filterExpression:K=>"type"in K&&K.type==="filterExpression",dotContent:K=>"type"in K&&["identifier","numericLiteral","wildcard"].includes(K.type),dotdotContent:K=>"type"in K&&["identifier","wildcard","bracketMember","bracketExpression"].includes(K.type),bracketContent:K=>"type"in K&&["identifier","wildcard","numericLiteral","stringLiteral","filterExpression","slices","unions","indexes"].includes(K.type),expressionContent:K=>"type"in K&&["value","comparator","groupExpression","logicalExpression","notExpression","current","root"].includes(K.type)};class ne extends o{constructor(){super(...arguments),this._stack=[]}getTree(){return this.popWithCheck("root",null)}popWithCheck(D,S){const P=this._stack.pop();if(P!==void 0&&ae[D](P))return P;throw new Error(`bad type (${JSON.stringify(P)}) returned for ${D} with token: ${S==null?void 0:S.getText()}`)}push(D){this._stack.push(D)}exitJsonpath(D){if(D.ROOT_VALUE()){const S=D.subscript()?this.popWithCheck("subscript",D):null;this.push({type:"root",next:S})}}exitBracketContent(D){switch(!0){case!!D.identifier():{const S=D.identifier().getText();this.push({type:"identifier",value:S});break}case!!D.STAR():this.push({type:"wildcard"});break;case!!D.unions():{const S=this.popWithCheck("unions",D);this.push(S);break}case!!D.indexes():{const S=this.popWithCheck("indexes",D);this.push(S);break}case!!D.slices():{const S=this.popWithCheck("slices",D);this.push(S);break}case!!D.STRING():{const S=D.STRING().getText().slice(1,-1);this.push({type:"stringLiteral",value:S});break}case!!D.NUMBER():{const S=Number.parseInt(D.NUMBER().getText());this.push({type:"numericLiteral",value:S});break}case!!D.filterExpression():{const S=this.popWithCheck("filterExpression",D);this.push(S);break}}}exitBracket(D){const S=this.popWithCheck("bracketContent",D);["identifier","numericLiteral","stringLiteral"].includes(S.type)?this.push({type:"bracketMember",value:S}):this.push({type:"bracketExpression",value:S})}exitDotdotContent(D){switch(!0){case!!D.STAR():this.push({type:"wildcard"});break;case!!D.identifier():{const S=D.identifier().getText();this.push({type:"identifier",value:S});break}case!!D.bracket():{const S=this.popWithCheck("bracket",D);this.push(S);break}}}exitDotContent(D){switch(!0){case!!D.STAR():this.push({type:"wildcard"});break;case!!D.identifier():{const S=D.identifier().getText();this.push({type:"identifier",value:S});break}case!!D.NUMBER():{const S=Number.parseInt(D.NUMBER().getText());this.push({type:"numericLiteral",value:S});break}}}exitSubscript(D){switch(!0){case!!D.DOT():{const S=D.subscript()?this.popWithCheck("subscript",D):null,P=this.popWithCheck("dotContent",D);this.push({type:"subscript",value:{type:"dot",value:P},next:S});break}case!!D.DOTDOT():{const S=D.subscript()?this.popWithCheck("subscript",D):null,P=this.popWithCheck("dotdotContent",D);this.push({type:"subscript",value:{type:"dotdot",value:P},next:S});break}case!!D.bracket():{const S=D.subscript()?this.popWithCheck("subscript",D):null,P=this.popWithCheck("bracket",D);this.push({type:"subscript",next:S,value:P});break}}}exitFilterpath(D){switch(!0){case!!D.ROOT_VALUE():{const S=D.subscript()?this.popWithCheck("subscript",D):null;this.push({type:"root",next:S});break}case!!D.CURRENT_VALUE():{const S=D.subscript()?this.popWithCheck("subscript",D):null;this.push({type:"current",next:S});break}}}exitUnions(D){const S=[];for(let P=0;P<D.identifier().length;P+=1){const W=D.identifier(P).getText();S.push({type:"identifier",value:W})}for(let P=0;P<D.STRING().length;P+=1){const W=D.STRING(P).getText().slice(1,-1);S.push({type:"stringLiteral",value:W})}this.push({type:"unions",values:S})}exitIndexes(D){const S=[];for(let P=0;P<D.NUMBER().length;P+=1){const W=Number.parseInt(D.NUMBER(P).getText());S.push({type:"numericLiteral",value:W})}this.push({type:"indexes",values:S})}exitSlices(D){const S=[0,1,2].map(le=>D.getToken(d.NUMBER,le)),P=[0,1].map(le=>D.getToken(d.COLON,le));let W=null,Se=null,se=null;P[0]&&S[0]&&S[0].getSourceInterval().start<P[0].getSourceInterval().start&&(W=Number.parseInt(S[0].getText())),!P[1]&&P[0]&&S[1]&&S[1].getSourceInterval().start>P[0].getSourceInterval().start||P[1]&&S[1]&&S[1].getSourceInterval().start<P[1].getSourceInterval().start?Se=Number.parseInt(S[1].getText()):P[0]&&S[0]&&S[0].getSourceInterval().start>P[0].getSourceInterval().start&&(!P[1]||S[0].getSourceInterval().start<P[1].getSourceInterval().start)&&(Se=Number.parseInt(S[0].getText())),P[1]&&S[2]?se=Number.parseInt(S[2].getText()):P[1]&&S[1]&&S[1].getSourceInterval().start>P[1].getSourceInterval().start?se=Number.parseInt(S[1].getText()):P[1]&&S[0]&&S[0].getSourceInterval().start>P[1].getSourceInterval().start&&(se=Number.parseInt(S[0].getText())),this.push({type:"slices",start:W,end:Se,step:se})}exitFilterExpression(D){const S=this.popWithCheck("expressionContent",D);this.push({type:"filterExpression",value:S})}exitRegex(D){var S;const P=D.REGEX_EXPR().getText(),W=((S=D.REGEX_OPT())===null||S===void 0?void 0:S.getText())||"";this.push({type:"value",subtype:"regex",value:P,opts:W})}exitExpression(D){switch(!0){case!!D.NOT():{const S=this.popWithCheck("expressionContent",D);this.push({type:"notExpression",value:S});break}case!!D.NULL():this.push({type:"value",value:null,subtype:"null"});break;case!!D.FALSE():this.push({type:"value",value:!1,subtype:"boolean"});break;case!!D.TRUE():this.push({type:"value",value:!0,subtype:"boolean"});break;case!!D.AND():{const S=this.popWithCheck("expressionContent",D),P=this.popWithCheck("expressionContent",D);this.push({type:"logicalExpression",operator:"and",left:P,right:S});break}case!!D.OR():{const S=this.popWithCheck("expressionContent",D),P=this.popWithCheck("expressionContent",D);this.push({type:"logicalExpression",operator:"or",left:P,right:S});break}case!!D.PAREN_LEFT():{const S=this.popWithCheck("expressionContent",D);this.push({type:"groupExpression",value:S});break}case!!D.regex():{const S=this.popWithCheck("regex",D),P=this.popWithCheck("operationContent",D);this.push({type:"comparator",operator:"reg",left:P,right:S});break}case!!D.EMPT():{const S=this.popWithCheck("operationContent",D);this.push({type:"comparator",operator:"empty",left:S,right:null});break}case!!D.getTypedRuleContext(d.FilterargContext,1):{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);switch(!0){case!!D.EQ():this.push({type:"comparator",operator:"eq",left:P,right:S});break;case!!D.NE():this.push({type:"comparator",operator:"ne",left:P,right:S});break;case!!D.LT():this.push({type:"comparator",operator:"lt",left:P,right:S});break;case!!D.LE():this.push({type:"comparator",operator:"le",left:P,right:S});break;case!!D.GT():this.push({type:"comparator",operator:"gt",left:P,right:S});break;case!!D.GE():this.push({type:"comparator",operator:"ge",left:P,right:S});break;case!!D.IN():this.push({type:"comparator",operator:"in",left:P,right:S});break;case!!D.NIN():this.push({type:"comparator",operator:"nin",left:P,right:S});break;case!!D.SUB():this.push({type:"comparator",operator:"subsetof",left:P,right:S});break;case!!D.ANY():this.push({type:"comparator",operator:"anyof",left:P,right:S});break;case!!D.NON():this.push({type:"comparator",operator:"noneof",left:P,right:S});break;case!!D.SIZ():this.push({type:"comparator",operator:"size",left:P,right:S});break;case!!D.SIZO():this.push({type:"comparator",operator:"sizeof",left:P,right:S})}break}}}exitObj(D){const S={};for(const P of D.pair()){const W=this.popWithCheck("value",D);S[P.STRING().getText().slice(1,-1)]=W.value}this.push({type:"value",subtype:"object",value:S})}exitArray(D){const S=[];for(let P=0;P<D.value().length;P+=1){const W=this.popWithCheck("value",D);S.unshift(W.value)}this.push({type:"value",subtype:"array",value:S})}exitFilterarg(D){switch(!0){case!!D.getTypedRuleContext(d.FilterargContext,1):switch(!0){case!!D.STAR():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"multi",left:P,right:S});break}case!!D.DIV():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"div",left:P,right:S});break}case!!D.PLUS():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"plus",left:P,right:S});break}case!!D.MINUS_SP():{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"minus",left:P,right:S});break}default:{const S=this.popWithCheck("operationContent",D),P=this.popWithCheck("operationContent",D);this.push({type:"operation",operator:"",left:P,right:S});break}}break;case!!D.PAREN_LEFT():{const S=this.popWithCheck("operationContent",D);this.push({type:"groupOperation",value:S});break}case!!D.value():{const S=this.popWithCheck("operationContent",D);this.push(S);break}case!!D.filterpath():{const S=this.popWithCheck("operationContent",D);this.push(S);break}}}exitValue(D){switch(!0){case!!D.STRING():{const P=D.STRING().getText().slice(1,-1);this.push({type:"value",subtype:"string",value:P});break}case!!D.NUMBER():{const P=D.NUMBER().getText();P!==`${Number.parseInt(P)}`?this.push({type:"value",subtype:"number",value:Number.parseFloat(P)}):this.push({type:"value",subtype:"number",value:Number.parseInt(P)});break}case!!D.array():const S=this.popWithCheck("value",D);this.push(S);break;case!!D.obj():{const P=this.popWithCheck("value",D);this.push(P);break}case!!D.TRUE():this.push({type:"value",value:!0,subtype:"boolean"});break;case!!D.FALSE():this.push({type:"value",value:!1,subtype:"boolean"});break;case!!D.NULL():this.push({type:"value",value:null,subtype:"null"})}}}const ce={syntaxError:(K,D,S,P,W,Se)=>{throw new i(S,P,W)},reportAmbiguity:function(K,D,S,P,W,Se,se){},reportAttemptingFullContext:function(K,D,S,P,W,Se){},reportContextSensitivity:function(K,D,S,P,W,Se){}};function re(K){const D=new n.default.InputStream(K),S=new a(D),P=new n.default.CommonTokenStream(S),W=new d(P);W.removeErrorListeners(),W.addErrorListener(ce);const Se=new ne;W.buildParseTrees=!0;const se=W.jsonpath();return n.default.tree.ParseTreeWalker.DEFAULT.walk(Se,se),Se.getTree()}function V(K,D={}){try{return re(K)}catch(S){if(!D.hideExceptions)throw S;return null}}var J=ps(63);const ve=(K,D)=>J(K,D),pe=K=>Array.isArray(K),Te=K=>{if(typeof K!="object"||K===null)return!1;let D=K;for(;Object.getPrototypeOf(D)!==null;)D=Object.getPrototypeOf(D);return Object.getPrototypeOf(K)===D},Ce=K=>typeof K=="number",Re=K=>typeof K=="string",Be=K=>K===void 0,Ue=K=>K!==void 0,Qe=(K,D)=>K<0?D+K:K,Ze=(K,D)=>K.concat(`["${D}"]`),qe=(K,D)=>K.concat(`[${D}]`);class nt{constructor(D){this.handleIdentifier=(S,P)=>{if(Te(S.value)&&P.value in S.value)return{value:S.value[P.value],paths:Ze(S.paths,P.value)}},this.handleWildcard=({value:S,paths:P})=>Te(S)||pe(S)?pe(S)?S.map((W,Se)=>({value:W,paths:qe(P,Se)})):Object.keys(S).map(W=>({value:S[W],paths:Ze(P,W)})):[],this.handleOperationContent=(S,P)=>{var W,Se;switch(P.type){case"root":return this.handleSubscript(this.rootPayload,P.next);case"current":return this.handleSubscript(S,P.next);case"value":return{value:P.value,paths:S.paths};case"groupOperation":return this.handleOperationContent(S,P.value);case"operation":{const se=(W=this.handleOperationContent(S,P.left))===null||W===void 0?void 0:W.value,le=(Se=this.handleOperationContent(S,P.right))===null||Se===void 0?void 0:Se.value;if(!Ce(se)||!Ce(le))return;switch(P.operator){case"plus":return{value:se+le,paths:S.paths};case"minus":return{value:se-le,paths:S.paths};case"div":return le===0?void 0:{value:se/le,paths:S.paths};case"multi":return{value:se*le,paths:S.paths};case"":if(le>0)throw new i(0,0,"Missing operator in operation");return{value:se+le,paths:S.paths}}}}},this.handleComparator=(S,P)=>{var W,Se;const se=(W=this.handleOperationContent(S,P.left))===null||W===void 0?void 0:W.value;if(P.operator==="empty")return!(!pe(se)&&!Re(se))&&se.length===0;const le=(Se=this.handleOperationContent(S,P.right))===null||Se===void 0?void 0:Se.value;switch(P.operator){case"subsetof":{if(!pe(se)||!pe(le))return!1;const xe=new Set(le);return se.every(We=>xe.has(We))}case"anyof":{if(!pe(se)||!pe(le))return!1;const xe=new Set(le);return se.some(We=>xe.has(We))}case"noneof":{if(!pe(se)||!pe(le))return!1;const xe=new Set(le);return!se.some(We=>xe.has(We))}case"sizeof":return!(!pe(se)&&!Re(se)||!pe(le)&&!Re(le))&&se.length===le.length;case"size":return!(!pe(se)&&!Re(se)||!Ce(le))&&se.length===le;case"eq":return ve(se,le);case"ne":return!ve(se,le);case"lt":return(Ce(se)&&Ce(le)||!(!Re(se)||!Re(le)))&&se<le;case"le":return(Ce(se)&&Ce(le)||!(!Re(se)||!Re(le)))&&se<=le;case"gt":return(Ce(se)&&Ce(le)||!(!Re(se)||!Re(le)))&&se>le;case"ge":return(Ce(se)&&Ce(le)||!(!Re(se)||!Re(le)))&&se>=le;case"in":return!!pe(le)&&le.includes(se);case"nin":return!!pe(le)&&!le.includes(se);case"reg":{if(!Re(se)||!Re(le))return!1;const xe=le.slice(1,-1);return!!se.match(new RegExp(xe,P.right.opts))}}},this.handleLogicalExpression=(S,P)=>{const W=this.handleFilterExpressionContent(S,P.left),Se=this.handleFilterExpressionContent(S,P.right);switch(P.operator){case"and":return W&&Se;case"or":return W||Se}},this.handleFilterExpressionContent=(S,P)=>{switch(P.type){case"logicalExpression":return this.handleLogicalExpression(S,P);case"comparator":return this.handleComparator(S,P);case"groupExpression":return this.handleFilterExpressionContent(S,P.value);case"notExpression":return!this.handleFilterExpressionContent(S,P.value);case"root":return Ue(this.handleSubscript(this.rootPayload,P.next));case"current":return Ue(this.handleSubscript(S,P.next));case"value":return!!P.value}},this.handleNumericLiteral=({value:S,paths:P},W)=>{if(!pe(S)&&!Te(S))return;if(Te(S))return this.handleStringLiteral({value:S,paths:P},{type:"stringLiteral",value:`${W.value}`});const Se=Qe(W.value,S.length);return Se<S.length&&Se>=0?{value:S[Se],paths:qe(P,Se)}:void 0},this.handleSlices=({value:S,paths:P},W)=>{const Se=[];if(!pe(S))return[];const se=W.start!==null?Qe(W.start,S.length):0,le=W.end!==null?Qe(W.end,S.length):S.length,xe=W.step===null||W.step<=0?1:W.step;let We=0;return S.forEach((ri,kt)=>{kt>=se&&kt<le&&(We%xe==0&&Se.push({value:ri,paths:qe(P,kt)}),We+=1)}),Se},this.handleStringLiteral=({value:S,paths:P},W)=>{if(Te(S)&&W.value in S)return{value:S[W.value],paths:Ze(P,W.value)}},this.handleUnions=(S,P)=>Te(S.value)?P.values.map(W=>{switch(W.type){case"identifier":return this.handleIdentifier(S,W);case"stringLiteral":return this.handleStringLiteral(S,W)}}).filter(Ue):[],this.handleIndexes=({value:S,paths:P},W)=>pe(S)?W.values.map(Se=>this.handleNumericLiteral({value:S,paths:P},Se)).filter(Ue):[],this.handleDotdot=(S,P)=>{const W=P.value,Se=S.value;let se=[];switch(W.type){case"bracketMember":{const le=this.handleBracketMemberContent(S,W.value);Ue(le)&&(se=se.concat(le));break}case"bracketExpression":if(Te(Se)||pe(Se)&&W.value.type==="wildcard"){const le=this.handleBracketExpressionContent(S,W.value);se=se.concat(le)}break;case"wildcard":{const le=this.handleWildcard(S);se=se.concat(le);break}case"identifier":{const le=this.handleIdentifier(S,W);Ue(le)&&(se=se.concat(le));break}}return Te(Se)?Object.keys(Se).forEach(le=>{const xe=this.handleDotdot({value:Se[le],paths:Ze(S.paths,le)},P);se=se.concat(xe)}):pe(Se)&&Se.forEach((le,xe)=>{const We=this.handleDotdot({value:le,paths:qe(S.paths,xe)},P);se=se.concat(We)}),se},this.handleBracketMemberContent=(S,P)=>{switch(P.type){case"identifier":return this.handleIdentifier(S,P);case"numericLiteral":return this.handleNumericLiteral(S,P);case"stringLiteral":return this.handleStringLiteral(S,P)}},this.handleBracketExpressionContent=(S,P)=>{const W=S.value;switch(P.type){case"filterExpression":{let Se=[];return pe(W)?W.forEach((se,le)=>{const xe={value:se,paths:qe(S.paths,le)};this.handleFilterExpressionContent(xe,P.value)&&(Se=Se.concat(xe))}):Te(W)&&this.handleFilterExpressionContent(S,P.value)&&(Se=Se.concat(S)),Se}case"indexes":return this.handleIndexes(S,P);case"unions":return this.handleUnions(S,P);case"wildcard":return this.handleWildcard(S);case"slices":return this.handleSlices(S,P)}},this.concatIndefiniteValuePaths=(S,P)=>{if(!P)return S.reduce((se,le)=>({isIndefinite:!0,value:[...se.value,le.value],paths:[...se.paths,le.paths]}),{value:[],paths:[],isIndefinite:!0});let W=[],Se=[];return S.forEach(se=>{const le=this.handleSubscript(se,P);Be(le)||(W=le.isIndefinite?W.concat(le.value):[...W,le.value],Se=Se.concat(le.paths))}),{value:W,paths:Se,isIndefinite:!0}},this.handleSubscript=(S,P)=>{if(P===null)return S;const W=P.value;switch(W.type){case"bracketExpression":{const Se=this.handleBracketExpressionContent(S,W.value);return this.concatIndefiniteValuePaths(Se,P.next)}case"bracketMember":{const Se=this.handleBracketMemberContent(S,W.value);return Be(Se)?void 0:this.handleSubscript(Se,P.next)}case"dot":switch(W.value.type){case"identifier":{const Se=this.handleIdentifier(S,W.value);return Be(Se)?void 0:this.handleSubscript(Se,P.next)}case"numericLiteral":{const Se=this.handleNumericLiteral(S,W.value);return Be(Se)?void 0:this.handleSubscript(Se,P.next)}case"wildcard":{const Se=this.handleWildcard(S);return this.concatIndefiniteValuePaths(Se,P.next)}}case"dotdot":{const Se=this.handleDotdot(S,W);return this.concatIndefiniteValuePaths(Se,P.next)}}},this.handleRoot=S=>this.handleSubscript(this.rootPayload,S.next),this.rootPayload={value:D,paths:"$"}}}const B=(K,D,S={})=>{try{const P=re(D),W=new nt(K).handleRoot(P);return Be(W)?[]:pe(W.paths)?W.paths:[W.paths]}catch(P){if(!S.hideExceptions)throw P;return[]}},oe=(K,D,S)=>{const P=re(D),W=new nt(K).handleRoot(P);return!(W!=null&&W.isIndefinite)&&S.returnArray?Be(W)?[]:[W.value]:W==null?void 0:W.value},Ae=(K,D,S={})=>{try{return pe(D)?((P,W,Se)=>{const se=[];for(const le of W){const xe=oe(P,le,Se);Ue(xe)&&se.push(xe)}return se})(K,D,S):oe(K,D,S)}catch(P){if(!S.hideExceptions)throw P;return S.returnArray?[]:void 0}},be={eq:"==",ne:"!=",lt:"<",le:"<=",gt:">",ge:">=",in:"in",reg:"=~",nin:"nin",subsetof:"subsetof",anyof:"anyof",noneof:"noneof",empty:"empty",sizeof:"sizeof",size:"size"},me={plus:"+",minus:"-",multi:"*",div:"/","":""},Ie={and:"&&",or:"||"};function Me(K){if(K===null)return"";switch(K.type){case"root":return"$"+Me(K.next);case"current":return"@"+Me(K.next);case"dot":return"."+Me(K.value);case"dotdot":return".."+Me(K.value);case"bracketExpression":case"bracketMember":return"["+Me(K.value)+"]";case"subscript":return Me(K.value)+Me(K.next);case"identifier":return K.value;case"wildcard":return"*";case"indexes":case"unions":return K.values.map(Me).join(", ");case"stringLiteral":return`"${K.value}"`;case"numericLiteral":return`${K.value}`;case"notExpression":return"!("+Me(K.value)+")";case"value":return K.subtype==="regex"?`${K.value}${K.opts}`:JSON.stringify(K.value);case"filterExpression":return"?("+Me(K.value)+")";case"groupOperation":case"groupExpression":return"("+Me(K.value)+")";case"operation":return Me(K.left)+" "+me[K.operator]+" "+Me(K.right);case"comparator":return Me(K.left)+` ${be[K.operator]} `+Me(K.right);case"logicalExpression":return Me(K.left)+` ${Ie[K.operator]} `+Me(K.right);case"slices":return`${K.start!==null?K.start:""}:${K.end!==null?K.end:""}${K.step!==null?":"+K.step:""}`}}})(),Ga.yS,Ga.Qc,Ga.Hb;var on=Ga.IO;Ga.Pz;var Or=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ms(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function lI(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}),t}var tl={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var uI=tl.exports,Gv;function cI(){return Gv||(Gv=1,function(n,e){(function(){var t,i="4.17.20",r=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",a="Expected a function",o="__lodash_hash_undefined__",l=500,u="__lodash_placeholder__",h=1,d=2,p=4,g=1,m=2,y=1,b=2,A=4,w=8,x=16,N=32,F=64,L=128,C=256,M=512,_=30,R="...",U=800,q=16,$=1,Y=2,ae=3,ne=1/0,ce=9007199254740991,re=17976931348623157e292,V=NaN,J=4294967295,ve=J-1,pe=J>>>1,Te=[["ary",L],["bind",y],["bindKey",b],["curry",w],["curryRight",x],["flip",M],["partial",N],["partialRight",F],["rearg",C]],Ce="[object Arguments]",Re="[object Array]",Be="[object AsyncFunction]",Ue="[object Boolean]",Qe="[object Date]",Ze="[object DOMException]",qe="[object Error]",nt="[object Function]",B="[object GeneratorFunction]",oe="[object Map]",Ae="[object Number]",be="[object Null]",me="[object Object]",Ie="[object Promise]",Me="[object Proxy]",ue="[object RegExp]",K="[object Set]",D="[object String]",S="[object Symbol]",P="[object Undefined]",W="[object WeakMap]",Se="[object WeakSet]",se="[object ArrayBuffer]",le="[object DataView]",xe="[object Float32Array]",We="[object Float64Array]",ri="[object Int8Array]",kt="[object Int16Array]",ft="[object Int32Array]",Ve="[object Uint8Array]",Si="[object Uint8ClampedArray]",wr="[object Uint16Array]",ee="[object Uint32Array]",te=/\b__p \+= '';/g,yt=/\b(__p \+=) '' \+/g,Nt=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Lt=/&(?:amp|lt|gt|quot|#39);/g,st=/[&<>"']/g,En=RegExp(Lt.source),jn=RegExp(st.source),Wi=/<%-([\s\S]+?)%>/g,An=/<%([\s\S]+?)%>/g,yo=/<%=([\s\S]+?)%>/g,Ns=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,dr=/^\w*$/,Pc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,vo=/[\\^$.*+?()[\]{}|]/g,Oc=RegExp(vo.source),Ls=/^\s+|\s+$/g,bo=/^\s+/,Eo=/\s+$/,_l=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ml=/\{\n\/\* \[wrapped with (.+)\] \*/,Fc=/,? & /,Bc=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,kl=/\\(\\)?/g,Uc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ao=/\w*$/,$c=/^[-+]0x[0-9a-f]+$/i,jp=/^0b[01]+$/i,Pl=/^\[object .+?Constructor\]$/,_s=/^0o[0-7]+$/i,So=/^(?:0|[1-9]\d*)$/,Xp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ca=/($^)/,wB=/['\n\r\u2028\u2029\\]/g,Gc="\\ud800-\\udfff",DB="\\u0300-\\u036f",RB="\\ufe20-\\ufe2f",IB="\\u20d0-\\u20ff",F2=DB+RB+IB,B2="\\u2700-\\u27bf",U2="a-z\\xdf-\\xf6\\xf8-\\xff",CB="\\xac\\xb1\\xd7\\xf7",NB="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",LB="\\u2000-\\u206f",_B=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$2="A-Z\\xc0-\\xd6\\xd8-\\xde",G2="\\ufe0e\\ufe0f",q2=CB+NB+LB+_B,Jp="['’]",MB="["+Gc+"]",V2="["+q2+"]",qc="["+F2+"]",H2="\\d+",kB="["+B2+"]",K2="["+U2+"]",W2="[^"+Gc+q2+H2+B2+U2+$2+"]",Qp="\\ud83c[\\udffb-\\udfff]",PB="(?:"+qc+"|"+Qp+")",Y2="[^"+Gc+"]",Zp="(?:\\ud83c[\\udde6-\\uddff]){2}",em="[\\ud800-\\udbff][\\udc00-\\udfff]",xo="["+$2+"]",z2="\\u200d",j2="(?:"+K2+"|"+W2+")",OB="(?:"+xo+"|"+W2+")",X2="(?:"+Jp+"(?:d|ll|m|re|s|t|ve))?",J2="(?:"+Jp+"(?:D|LL|M|RE|S|T|VE))?",Q2=PB+"?",Z2="["+G2+"]?",FB="(?:"+z2+"(?:"+[Y2,Zp,em].join("|")+")"+Z2+Q2+")*",BB="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",UB="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ex=Z2+Q2+FB,$B="(?:"+[kB,Zp,em].join("|")+")"+ex,GB="(?:"+[Y2+qc+"?",qc,Zp,em,MB].join("|")+")",qB=RegExp(Jp,"g"),VB=RegExp(qc,"g"),tm=RegExp(Qp+"(?="+Qp+")|"+GB+ex,"g"),HB=RegExp([xo+"?"+K2+"+"+X2+"(?="+[V2,xo,"$"].join("|")+")",OB+"+"+J2+"(?="+[V2,xo+j2,"$"].join("|")+")",xo+"?"+j2+"+"+X2,xo+"+"+J2,UB,BB,H2,$B].join("|"),"g"),KB=RegExp("["+z2+Gc+F2+G2+"]"),WB=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,YB=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],zB=-1,Gt={};Gt[xe]=Gt[We]=Gt[ri]=Gt[kt]=Gt[ft]=Gt[Ve]=Gt[Si]=Gt[wr]=Gt[ee]=!0,Gt[Ce]=Gt[Re]=Gt[se]=Gt[Ue]=Gt[le]=Gt[Qe]=Gt[qe]=Gt[nt]=Gt[oe]=Gt[Ae]=Gt[me]=Gt[ue]=Gt[K]=Gt[D]=Gt[W]=!1;var Ft={};Ft[Ce]=Ft[Re]=Ft[se]=Ft[le]=Ft[Ue]=Ft[Qe]=Ft[xe]=Ft[We]=Ft[ri]=Ft[kt]=Ft[ft]=Ft[oe]=Ft[Ae]=Ft[me]=Ft[ue]=Ft[K]=Ft[D]=Ft[S]=Ft[Ve]=Ft[Si]=Ft[wr]=Ft[ee]=!0,Ft[qe]=Ft[nt]=Ft[W]=!1;var jB={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},XB={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},JB={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},QB={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ZB=parseFloat,e5=parseInt,tx=typeof Or=="object"&&Or&&Or.Object===Object&&Or,t5=typeof self=="object"&&self&&self.Object===Object&&self,Ii=tx||t5||Function("return this")(),im=e&&!e.nodeType&&e,ha=im&&!0&&n&&!n.nodeType&&n,ix=ha&&ha.exports===im,rm=ix&&tx.process,Dr=function(){try{var j=ha&&ha.require&&ha.require("util").types;return j||rm&&rm.binding&&rm.binding("util")}catch{}}(),rx=Dr&&Dr.isArrayBuffer,nx=Dr&&Dr.isDate,sx=Dr&&Dr.isMap,ax=Dr&&Dr.isRegExp,ox=Dr&&Dr.isSet,lx=Dr&&Dr.isTypedArray;function fr(j,he,ie){switch(ie.length){case 0:return j.call(he);case 1:return j.call(he,ie[0]);case 2:return j.call(he,ie[0],ie[1]);case 3:return j.call(he,ie[0],ie[1],ie[2])}return j.apply(he,ie)}function i5(j,he,ie,ke){for(var et=-1,St=j==null?0:j.length;++et<St;){var gi=j[et];he(ke,gi,ie(gi),j)}return ke}function Rr(j,he){for(var ie=-1,ke=j==null?0:j.length;++ie<ke&&he(j[ie],ie,j)!==!1;);return j}function r5(j,he){for(var ie=j==null?0:j.length;ie--&&he(j[ie],ie,j)!==!1;);return j}function ux(j,he){for(var ie=-1,ke=j==null?0:j.length;++ie<ke;)if(!he(j[ie],ie,j))return!1;return!0}function Ms(j,he){for(var ie=-1,ke=j==null?0:j.length,et=0,St=[];++ie<ke;){var gi=j[ie];he(gi,ie,j)&&(St[et++]=gi)}return St}function Vc(j,he){var ie=j==null?0:j.length;return!!ie&&To(j,he,0)>-1}function nm(j,he,ie){for(var ke=-1,et=j==null?0:j.length;++ke<et;)if(ie(he,j[ke]))return!0;return!1}function jt(j,he){for(var ie=-1,ke=j==null?0:j.length,et=Array(ke);++ie<ke;)et[ie]=he(j[ie],ie,j);return et}function ks(j,he){for(var ie=-1,ke=he.length,et=j.length;++ie<ke;)j[et+ie]=he[ie];return j}function sm(j,he,ie,ke){var et=-1,St=j==null?0:j.length;for(ke&&St&&(ie=j[++et]);++et<St;)ie=he(ie,j[et],et,j);return ie}function n5(j,he,ie,ke){var et=j==null?0:j.length;for(ke&&et&&(ie=j[--et]);et--;)ie=he(ie,j[et],et,j);return ie}function am(j,he){for(var ie=-1,ke=j==null?0:j.length;++ie<ke;)if(he(j[ie],ie,j))return!0;return!1}var s5=om("length");function a5(j){return j.split("")}function o5(j){return j.match(Bc)||[]}function cx(j,he,ie){var ke;return ie(j,function(et,St,gi){if(he(et,St,gi))return ke=St,!1}),ke}function Hc(j,he,ie,ke){for(var et=j.length,St=ie+(ke?1:-1);ke?St--:++St<et;)if(he(j[St],St,j))return St;return-1}function To(j,he,ie){return he===he?b5(j,he,ie):Hc(j,hx,ie)}function l5(j,he,ie,ke){for(var et=ie-1,St=j.length;++et<St;)if(ke(j[et],he))return et;return-1}function hx(j){return j!==j}function dx(j,he){var ie=j==null?0:j.length;return ie?um(j,he)/ie:V}function om(j){return function(he){return he==null?t:he[j]}}function lm(j){return function(he){return j==null?t:j[he]}}function fx(j,he,ie,ke,et){return et(j,function(St,gi,Pt){ie=ke?(ke=!1,St):he(ie,St,gi,Pt)}),ie}function u5(j,he){var ie=j.length;for(j.sort(he);ie--;)j[ie]=j[ie].value;return j}function um(j,he){for(var ie,ke=-1,et=j.length;++ke<et;){var St=he(j[ke]);St!==t&&(ie=ie===t?St:ie+St)}return ie}function cm(j,he){for(var ie=-1,ke=Array(j);++ie<j;)ke[ie]=he(ie);return ke}function c5(j,he){return jt(he,function(ie){return[ie,j[ie]]})}function gr(j){return function(he){return j(he)}}function hm(j,he){return jt(he,function(ie){return j[ie]})}function Ol(j,he){return j.has(he)}function gx(j,he){for(var ie=-1,ke=j.length;++ie<ke&&To(he,j[ie],0)>-1;);return ie}function px(j,he){for(var ie=j.length;ie--&&To(he,j[ie],0)>-1;);return ie}function h5(j,he){for(var ie=j.length,ke=0;ie--;)j[ie]===he&&++ke;return ke}var d5=lm(jB),f5=lm(XB);function g5(j){return"\\"+QB[j]}function p5(j,he){return j==null?t:j[he]}function wo(j){return KB.test(j)}function m5(j){return WB.test(j)}function y5(j){for(var he,ie=[];!(he=j.next()).done;)ie.push(he.value);return ie}function dm(j){var he=-1,ie=Array(j.size);return j.forEach(function(ke,et){ie[++he]=[et,ke]}),ie}function mx(j,he){return function(ie){return j(he(ie))}}function Ps(j,he){for(var ie=-1,ke=j.length,et=0,St=[];++ie<ke;){var gi=j[ie];(gi===he||gi===u)&&(j[ie]=u,St[et++]=ie)}return St}function Kc(j){var he=-1,ie=Array(j.size);return j.forEach(function(ke){ie[++he]=ke}),ie}function v5(j){var he=-1,ie=Array(j.size);return j.forEach(function(ke){ie[++he]=[ke,ke]}),ie}function b5(j,he,ie){for(var ke=ie-1,et=j.length;++ke<et;)if(j[ke]===he)return ke;return-1}function E5(j,he,ie){for(var ke=ie+1;ke--;)if(j[ke]===he)return ke;return ke}function Do(j){return wo(j)?S5(j):s5(j)}function Gr(j){return wo(j)?x5(j):a5(j)}var A5=lm(JB);function S5(j){for(var he=tm.lastIndex=0;tm.test(j);)++he;return he}function x5(j){return j.match(tm)||[]}function T5(j){return j.match(HB)||[]}var w5=function j(he){he=he==null?Ii:Ro.defaults(Ii.Object(),he,Ro.pick(Ii,YB));var ie=he.Array,ke=he.Date,et=he.Error,St=he.Function,gi=he.Math,Pt=he.Object,fm=he.RegExp,D5=he.String,Ir=he.TypeError,Wc=ie.prototype,R5=St.prototype,Io=Pt.prototype,Yc=he["__core-js_shared__"],zc=R5.toString,Ct=Io.hasOwnProperty,I5=0,yx=function(){var c=/[^.]+$/.exec(Yc&&Yc.keys&&Yc.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),jc=Io.toString,C5=zc.call(Pt),N5=Ii._,L5=fm("^"+zc.call(Ct).replace(vo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xc=ix?he.Buffer:t,Os=he.Symbol,Jc=he.Uint8Array,vx=Xc?Xc.allocUnsafe:t,Qc=mx(Pt.getPrototypeOf,Pt),bx=Pt.create,Ex=Io.propertyIsEnumerable,Zc=Wc.splice,Ax=Os?Os.isConcatSpreadable:t,Fl=Os?Os.iterator:t,da=Os?Os.toStringTag:t,eh=function(){try{var c=ya(Pt,"defineProperty");return c({},"",{}),c}catch{}}(),_5=he.clearTimeout!==Ii.clearTimeout&&he.clearTimeout,M5=ke&&ke.now!==Ii.Date.now&&ke.now,k5=he.setTimeout!==Ii.setTimeout&&he.setTimeout,th=gi.ceil,ih=gi.floor,gm=Pt.getOwnPropertySymbols,P5=Xc?Xc.isBuffer:t,Sx=he.isFinite,O5=Wc.join,F5=mx(Pt.keys,Pt),pi=gi.max,ki=gi.min,B5=ke.now,U5=he.parseInt,xx=gi.random,$5=Wc.reverse,pm=ya(he,"DataView"),Bl=ya(he,"Map"),mm=ya(he,"Promise"),Co=ya(he,"Set"),Ul=ya(he,"WeakMap"),$l=ya(Pt,"create"),rh=Ul&&new Ul,No={},G5=va(pm),q5=va(Bl),V5=va(mm),H5=va(Co),K5=va(Ul),nh=Os?Os.prototype:t,Gl=nh?nh.valueOf:t,Tx=nh?nh.toString:t;function k(c){if(ni(c)&&!tt(c)&&!(c instanceof gt)){if(c instanceof Cr)return c;if(Ct.call(c,"__wrapped__"))return wT(c)}return new Cr(c)}var Lo=function(){function c(){}return function(f){if(!Qt(f))return{};if(bx)return bx(f);c.prototype=f;var v=new c;return c.prototype=t,v}}();function sh(){}function Cr(c,f){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!f,this.__index__=0,this.__values__=t}k.templateSettings={escape:Wi,evaluate:An,interpolate:yo,variable:"",imports:{_:k}},k.prototype=sh.prototype,k.prototype.constructor=k,Cr.prototype=Lo(sh.prototype),Cr.prototype.constructor=Cr;function gt(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=J,this.__views__=[]}function W5(){var c=new gt(this.__wrapped__);return c.__actions__=tr(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=tr(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=tr(this.__views__),c}function Y5(){if(this.__filtered__){var c=new gt(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function z5(){var c=this.__wrapped__.value(),f=this.__dir__,v=tt(c),E=f<0,I=v?c.length:0,O=a4(0,I,this.__views__),G=O.start,H=O.end,z=H-G,fe=E?H:G-1,ge=this.__iteratees__,ye=ge.length,Ne=0,Ge=ki(z,this.__takeCount__);if(!v||!E&&I==z&&Ge==z)return zx(c,this.__actions__);var ze=[];e:for(;z--&&Ne<Ge;){fe+=f;for(var lt=-1,Ye=c[fe];++lt<ye;){var dt=ge[lt],mt=dt.iteratee,yr=dt.type,ji=mt(Ye);if(yr==Y)Ye=ji;else if(!ji){if(yr==$)continue e;break e}}ze[Ne++]=Ye}return ze}gt.prototype=Lo(sh.prototype),gt.prototype.constructor=gt;function fa(c){var f=-1,v=c==null?0:c.length;for(this.clear();++f<v;){var E=c[f];this.set(E[0],E[1])}}function j5(){this.__data__=$l?$l(null):{},this.size=0}function X5(c){var f=this.has(c)&&delete this.__data__[c];return this.size-=f?1:0,f}function J5(c){var f=this.__data__;if($l){var v=f[c];return v===o?t:v}return Ct.call(f,c)?f[c]:t}function Q5(c){var f=this.__data__;return $l?f[c]!==t:Ct.call(f,c)}function Z5(c,f){var v=this.__data__;return this.size+=this.has(c)?0:1,v[c]=$l&&f===t?o:f,this}fa.prototype.clear=j5,fa.prototype.delete=X5,fa.prototype.get=J5,fa.prototype.has=Q5,fa.prototype.set=Z5;function Xn(c){var f=-1,v=c==null?0:c.length;for(this.clear();++f<v;){var E=c[f];this.set(E[0],E[1])}}function eU(){this.__data__=[],this.size=0}function tU(c){var f=this.__data__,v=ah(f,c);if(v<0)return!1;var E=f.length-1;return v==E?f.pop():Zc.call(f,v,1),--this.size,!0}function iU(c){var f=this.__data__,v=ah(f,c);return v<0?t:f[v][1]}function rU(c){return ah(this.__data__,c)>-1}function nU(c,f){var v=this.__data__,E=ah(v,c);return E<0?(++this.size,v.push([c,f])):v[E][1]=f,this}Xn.prototype.clear=eU,Xn.prototype.delete=tU,Xn.prototype.get=iU,Xn.prototype.has=rU,Xn.prototype.set=nU;function Jn(c){var f=-1,v=c==null?0:c.length;for(this.clear();++f<v;){var E=c[f];this.set(E[0],E[1])}}function sU(){this.size=0,this.__data__={hash:new fa,map:new(Bl||Xn),string:new fa}}function aU(c){var f=vh(this,c).delete(c);return this.size-=f?1:0,f}function oU(c){return vh(this,c).get(c)}function lU(c){return vh(this,c).has(c)}function uU(c,f){var v=vh(this,c),E=v.size;return v.set(c,f),this.size+=v.size==E?0:1,this}Jn.prototype.clear=sU,Jn.prototype.delete=aU,Jn.prototype.get=oU,Jn.prototype.has=lU,Jn.prototype.set=uU;function ga(c){var f=-1,v=c==null?0:c.length;for(this.__data__=new Jn;++f<v;)this.add(c[f])}function cU(c){return this.__data__.set(c,o),this}function hU(c){return this.__data__.has(c)}ga.prototype.add=ga.prototype.push=cU,ga.prototype.has=hU;function qr(c){var f=this.__data__=new Xn(c);this.size=f.size}function dU(){this.__data__=new Xn,this.size=0}function fU(c){var f=this.__data__,v=f.delete(c);return this.size=f.size,v}function gU(c){return this.__data__.get(c)}function pU(c){return this.__data__.has(c)}function mU(c,f){var v=this.__data__;if(v instanceof Xn){var E=v.__data__;if(!Bl||E.length<r-1)return E.push([c,f]),this.size=++v.size,this;v=this.__data__=new Jn(E)}return v.set(c,f),this.size=v.size,this}qr.prototype.clear=dU,qr.prototype.delete=fU,qr.prototype.get=gU,qr.prototype.has=pU,qr.prototype.set=mU;function wx(c,f){var v=tt(c),E=!v&&ba(c),I=!v&&!E&&Gs(c),O=!v&&!E&&!I&&Po(c),G=v||E||I||O,H=G?cm(c.length,D5):[],z=H.length;for(var fe in c)(f||Ct.call(c,fe))&&!(G&&(fe=="length"||I&&(fe=="offset"||fe=="parent")||O&&(fe=="buffer"||fe=="byteLength"||fe=="byteOffset")||ts(fe,z)))&&H.push(fe);return H}function Dx(c){var f=c.length;return f?c[Rm(0,f-1)]:t}function yU(c,f){return bh(tr(c),pa(f,0,c.length))}function vU(c){return bh(tr(c))}function ym(c,f,v){(v!==t&&!Vr(c[f],v)||v===t&&!(f in c))&&Qn(c,f,v)}function ql(c,f,v){var E=c[f];(!(Ct.call(c,f)&&Vr(E,v))||v===t&&!(f in c))&&Qn(c,f,v)}function ah(c,f){for(var v=c.length;v--;)if(Vr(c[v][0],f))return v;return-1}function bU(c,f,v,E){return Fs(c,function(I,O,G){f(E,I,v(I),G)}),E}function Rx(c,f){return c&&xn(f,xi(f),c)}function EU(c,f){return c&&xn(f,rr(f),c)}function Qn(c,f,v){f=="__proto__"&&eh?eh(c,f,{configurable:!0,enumerable:!0,value:v,writable:!0}):c[f]=v}function vm(c,f){for(var v=-1,E=f.length,I=ie(E),O=c==null;++v<E;)I[v]=O?t:Qm(c,f[v]);return I}function pa(c,f,v){return c===c&&(v!==t&&(c=c<=v?c:v),f!==t&&(c=c>=f?c:f)),c}function Nr(c,f,v,E,I,O){var G,H=f&h,z=f&d,fe=f&p;if(v&&(G=I?v(c,E,I,O):v(c)),G!==t)return G;if(!Qt(c))return c;var ge=tt(c);if(ge){if(G=l4(c),!H)return tr(c,G)}else{var ye=Pi(c),Ne=ye==nt||ye==B;if(Gs(c))return Jx(c,H);if(ye==me||ye==Ce||Ne&&!I){if(G=z||Ne?{}:mT(c),!H)return z?JU(c,EU(G,c)):XU(c,Rx(G,c))}else{if(!Ft[ye])return I?c:{};G=u4(c,ye,H)}}O||(O=new qr);var Ge=O.get(c);if(Ge)return Ge;O.set(c,G),KT(c)?c.forEach(function(Ye){G.add(Nr(Ye,f,v,Ye,c,O))}):VT(c)&&c.forEach(function(Ye,dt){G.set(dt,Nr(Ye,f,v,dt,c,O))});var ze=fe?z?Bm:Fm:z?rr:xi,lt=ge?t:ze(c);return Rr(lt||c,function(Ye,dt){lt&&(dt=Ye,Ye=c[dt]),ql(G,dt,Nr(Ye,f,v,dt,c,O))}),G}function AU(c){var f=xi(c);return function(v){return Ix(v,c,f)}}function Ix(c,f,v){var E=v.length;if(c==null)return!E;for(c=Pt(c);E--;){var I=v[E],O=f[I],G=c[I];if(G===t&&!(I in c)||!O(G))return!1}return!0}function Cx(c,f,v){if(typeof c!="function")throw new Ir(a);return jl(function(){c.apply(t,v)},f)}function Vl(c,f,v,E){var I=-1,O=Vc,G=!0,H=c.length,z=[],fe=f.length;if(!H)return z;v&&(f=jt(f,gr(v))),E?(O=nm,G=!1):f.length>=r&&(O=Ol,G=!1,f=new ga(f));e:for(;++I<H;){var ge=c[I],ye=v==null?ge:v(ge);if(ge=E||ge!==0?ge:0,G&&ye===ye){for(var Ne=fe;Ne--;)if(f[Ne]===ye)continue e;z.push(ge)}else O(f,ye,E)||z.push(ge)}return z}var Fs=iT(Sn),Nx=iT(Em,!0);function SU(c,f){var v=!0;return Fs(c,function(E,I,O){return v=!!f(E,I,O),v}),v}function oh(c,f,v){for(var E=-1,I=c.length;++E<I;){var O=c[E],G=f(O);if(G!=null&&(H===t?G===G&&!mr(G):v(G,H)))var H=G,z=O}return z}function xU(c,f,v,E){var I=c.length;for(v=at(v),v<0&&(v=-v>I?0:I+v),E=E===t||E>I?I:at(E),E<0&&(E+=I),E=v>E?0:YT(E);v<E;)c[v++]=f;return c}function Lx(c,f){var v=[];return Fs(c,function(E,I,O){f(E,I,O)&&v.push(E)}),v}function Ci(c,f,v,E,I){var O=-1,G=c.length;for(v||(v=h4),I||(I=[]);++O<G;){var H=c[O];f>0&&v(H)?f>1?Ci(H,f-1,v,E,I):ks(I,H):E||(I[I.length]=H)}return I}var bm=rT(),_x=rT(!0);function Sn(c,f){return c&&bm(c,f,xi)}function Em(c,f){return c&&_x(c,f,xi)}function lh(c,f){return Ms(f,function(v){return is(c[v])})}function ma(c,f){f=Us(f,c);for(var v=0,E=f.length;c!=null&&v<E;)c=c[Tn(f[v++])];return v&&v==E?c:t}function Mx(c,f,v){var E=f(c);return tt(c)?E:ks(E,v(c))}function Yi(c){return c==null?c===t?P:be:da&&da in Pt(c)?s4(c):v4(c)}function Am(c,f){return c>f}function TU(c,f){return c!=null&&Ct.call(c,f)}function wU(c,f){return c!=null&&f in Pt(c)}function DU(c,f,v){return c>=ki(f,v)&&c<pi(f,v)}function Sm(c,f,v){for(var E=v?nm:Vc,I=c[0].length,O=c.length,G=O,H=ie(O),z=1/0,fe=[];G--;){var ge=c[G];G&&f&&(ge=jt(ge,gr(f))),z=ki(ge.length,z),H[G]=!v&&(f||I>=120&&ge.length>=120)?new ga(G&&ge):t}ge=c[0];var ye=-1,Ne=H[0];e:for(;++ye<I&&fe.length<z;){var Ge=ge[ye],ze=f?f(Ge):Ge;if(Ge=v||Ge!==0?Ge:0,!(Ne?Ol(Ne,ze):E(fe,ze,v))){for(G=O;--G;){var lt=H[G];if(!(lt?Ol(lt,ze):E(c[G],ze,v)))continue e}Ne&&Ne.push(ze),fe.push(Ge)}}return fe}function RU(c,f,v,E){return Sn(c,function(I,O,G){f(E,v(I),O,G)}),E}function Hl(c,f,v){f=Us(f,c),c=ET(c,f);var E=c==null?c:c[Tn(_r(f))];return E==null?t:fr(E,c,v)}function kx(c){return ni(c)&&Yi(c)==Ce}function IU(c){return ni(c)&&Yi(c)==se}function CU(c){return ni(c)&&Yi(c)==Qe}function Kl(c,f,v,E,I){return c===f?!0:c==null||f==null||!ni(c)&&!ni(f)?c!==c&&f!==f:NU(c,f,v,E,Kl,I)}function NU(c,f,v,E,I,O){var G=tt(c),H=tt(f),z=G?Re:Pi(c),fe=H?Re:Pi(f);z=z==Ce?me:z,fe=fe==Ce?me:fe;var ge=z==me,ye=fe==me,Ne=z==fe;if(Ne&&Gs(c)){if(!Gs(f))return!1;G=!0,ge=!1}if(Ne&&!ge)return O||(O=new qr),G||Po(c)?fT(c,f,v,E,I,O):r4(c,f,z,v,E,I,O);if(!(v&g)){var Ge=ge&&Ct.call(c,"__wrapped__"),ze=ye&&Ct.call(f,"__wrapped__");if(Ge||ze){var lt=Ge?c.value():c,Ye=ze?f.value():f;return O||(O=new qr),I(lt,Ye,v,E,O)}}return Ne?(O||(O=new qr),n4(c,f,v,E,I,O)):!1}function LU(c){return ni(c)&&Pi(c)==oe}function xm(c,f,v,E){var I=v.length,O=I,G=!E;if(c==null)return!O;for(c=Pt(c);I--;){var H=v[I];if(G&&H[2]?H[1]!==c[H[0]]:!(H[0]in c))return!1}for(;++I<O;){H=v[I];var z=H[0],fe=c[z],ge=H[1];if(G&&H[2]){if(fe===t&&!(z in c))return!1}else{var ye=new qr;if(E)var Ne=E(fe,ge,z,c,f,ye);if(!(Ne===t?Kl(ge,fe,g|m,E,ye):Ne))return!1}}return!0}function Px(c){if(!Qt(c)||f4(c))return!1;var f=is(c)?L5:Pl;return f.test(va(c))}function _U(c){return ni(c)&&Yi(c)==ue}function MU(c){return ni(c)&&Pi(c)==K}function kU(c){return ni(c)&&wh(c.length)&&!!Gt[Yi(c)]}function Ox(c){return typeof c=="function"?c:c==null?nr:typeof c=="object"?tt(c)?Ux(c[0],c[1]):Bx(c):nw(c)}function Tm(c){if(!zl(c))return F5(c);var f=[];for(var v in Pt(c))Ct.call(c,v)&&v!="constructor"&&f.push(v);return f}function PU(c){if(!Qt(c))return y4(c);var f=zl(c),v=[];for(var E in c)E=="constructor"&&(f||!Ct.call(c,E))||v.push(E);return v}function wm(c,f){return c<f}function Fx(c,f){var v=-1,E=ir(c)?ie(c.length):[];return Fs(c,function(I,O,G){E[++v]=f(I,O,G)}),E}function Bx(c){var f=$m(c);return f.length==1&&f[0][2]?vT(f[0][0],f[0][1]):function(v){return v===c||xm(v,c,f)}}function Ux(c,f){return qm(c)&&yT(f)?vT(Tn(c),f):function(v){var E=Qm(v,c);return E===t&&E===f?Zm(v,c):Kl(f,E,g|m)}}function uh(c,f,v,E,I){c!==f&&bm(f,function(O,G){if(I||(I=new qr),Qt(O))OU(c,f,G,v,uh,E,I);else{var H=E?E(Hm(c,G),O,G+"",c,f,I):t;H===t&&(H=O),ym(c,G,H)}},rr)}function OU(c,f,v,E,I,O,G){var H=Hm(c,v),z=Hm(f,v),fe=G.get(z);if(fe){ym(c,v,fe);return}var ge=O?O(H,z,v+"",c,f,G):t,ye=ge===t;if(ye){var Ne=tt(z),Ge=!Ne&&Gs(z),ze=!Ne&&!Ge&&Po(z);ge=z,Ne||Ge||ze?tt(H)?ge=H:oi(H)?ge=tr(H):Ge?(ye=!1,ge=Jx(z,!0)):ze?(ye=!1,ge=Qx(z,!0)):ge=[]:Xl(z)||ba(z)?(ge=H,ba(H)?ge=zT(H):(!Qt(H)||is(H))&&(ge=mT(z))):ye=!1}ye&&(G.set(z,ge),I(ge,z,E,O,G),G.delete(z)),ym(c,v,ge)}function $x(c,f){var v=c.length;if(v)return f+=f<0?v:0,ts(f,v)?c[f]:t}function Gx(c,f,v){f.length?f=jt(f,function(O){return tt(O)?function(G){return ma(G,O.length===1?O[0]:O)}:O}):f=[nr];var E=-1;f=jt(f,gr(He()));var I=Fx(c,function(O,G,H){var z=jt(f,function(fe){return fe(O)});return{criteria:z,index:++E,value:O}});return u5(I,function(O,G){return jU(O,G,v)})}function FU(c,f){return qx(c,f,function(v,E){return Zm(c,E)})}function qx(c,f,v){for(var E=-1,I=f.length,O={};++E<I;){var G=f[E],H=ma(c,G);v(H,G)&&Wl(O,Us(G,c),H)}return O}function BU(c){return function(f){return ma(f,c)}}function Dm(c,f,v,E){var I=E?l5:To,O=-1,G=f.length,H=c;for(c===f&&(f=tr(f)),v&&(H=jt(c,gr(v)));++O<G;)for(var z=0,fe=f[O],ge=v?v(fe):fe;(z=I(H,ge,z,E))>-1;)H!==c&&Zc.call(H,z,1),Zc.call(c,z,1);return c}function Vx(c,f){for(var v=c?f.length:0,E=v-1;v--;){var I=f[v];if(v==E||I!==O){var O=I;ts(I)?Zc.call(c,I,1):Nm(c,I)}}return c}function Rm(c,f){return c+ih(xx()*(f-c+1))}function UU(c,f,v,E){for(var I=-1,O=pi(th((f-c)/(v||1)),0),G=ie(O);O--;)G[E?O:++I]=c,c+=v;return G}function Im(c,f){var v="";if(!c||f<1||f>ce)return v;do f%2&&(v+=c),f=ih(f/2),f&&(c+=c);while(f);return v}function ut(c,f){return Km(bT(c,f,nr),c+"")}function $U(c){return Dx(Oo(c))}function GU(c,f){var v=Oo(c);return bh(v,pa(f,0,v.length))}function Wl(c,f,v,E){if(!Qt(c))return c;f=Us(f,c);for(var I=-1,O=f.length,G=O-1,H=c;H!=null&&++I<O;){var z=Tn(f[I]),fe=v;if(z==="__proto__"||z==="constructor"||z==="prototype")return c;if(I!=G){var ge=H[z];fe=E?E(ge,z,H):t,fe===t&&(fe=Qt(ge)?ge:ts(f[I+1])?[]:{})}ql(H,z,fe),H=H[z]}return c}var Hx=rh?function(c,f){return rh.set(c,f),c}:nr,qU=eh?function(c,f){return eh(c,"toString",{configurable:!0,enumerable:!1,value:t0(f),writable:!0})}:nr;function VU(c){return bh(Oo(c))}function Lr(c,f,v){var E=-1,I=c.length;f<0&&(f=-f>I?0:I+f),v=v>I?I:v,v<0&&(v+=I),I=f>v?0:v-f>>>0,f>>>=0;for(var O=ie(I);++E<I;)O[E]=c[E+f];return O}function HU(c,f){var v;return Fs(c,function(E,I,O){return v=f(E,I,O),!v}),!!v}function ch(c,f,v){var E=0,I=c==null?E:c.length;if(typeof f=="number"&&f===f&&I<=pe){for(;E<I;){var O=E+I>>>1,G=c[O];G!==null&&!mr(G)&&(v?G<=f:G<f)?E=O+1:I=O}return I}return Cm(c,f,nr,v)}function Cm(c,f,v,E){var I=0,O=c==null?0:c.length;if(O===0)return 0;f=v(f);for(var G=f!==f,H=f===null,z=mr(f),fe=f===t;I<O;){var ge=ih((I+O)/2),ye=v(c[ge]),Ne=ye!==t,Ge=ye===null,ze=ye===ye,lt=mr(ye);if(G)var Ye=E||ze;else fe?Ye=ze&&(E||Ne):H?Ye=ze&&Ne&&(E||!Ge):z?Ye=ze&&Ne&&!Ge&&(E||!lt):Ge||lt?Ye=!1:Ye=E?ye<=f:ye<f;Ye?I=ge+1:O=ge}return ki(O,ve)}function Kx(c,f){for(var v=-1,E=c.length,I=0,O=[];++v<E;){var G=c[v],H=f?f(G):G;if(!v||!Vr(H,z)){var z=H;O[I++]=G===0?0:G}}return O}function Wx(c){return typeof c=="number"?c:mr(c)?V:+c}function pr(c){if(typeof c=="string")return c;if(tt(c))return jt(c,pr)+"";if(mr(c))return Tx?Tx.call(c):"";var f=c+"";return f=="0"&&1/c==-ne?"-0":f}function Bs(c,f,v){var E=-1,I=Vc,O=c.length,G=!0,H=[],z=H;if(v)G=!1,I=nm;else if(O>=r){var fe=f?null:t4(c);if(fe)return Kc(fe);G=!1,I=Ol,z=new ga}else z=f?[]:H;e:for(;++E<O;){var ge=c[E],ye=f?f(ge):ge;if(ge=v||ge!==0?ge:0,G&&ye===ye){for(var Ne=z.length;Ne--;)if(z[Ne]===ye)continue e;f&&z.push(ye),H.push(ge)}else I(z,ye,v)||(z!==H&&z.push(ye),H.push(ge))}return H}function Nm(c,f){return f=Us(f,c),c=ET(c,f),c==null||delete c[Tn(_r(f))]}function Yx(c,f,v,E){return Wl(c,f,v(ma(c,f)),E)}function hh(c,f,v,E){for(var I=c.length,O=E?I:-1;(E?O--:++O<I)&&f(c[O],O,c););return v?Lr(c,E?0:O,E?O+1:I):Lr(c,E?O+1:0,E?I:O)}function zx(c,f){var v=c;return v instanceof gt&&(v=v.value()),sm(f,function(E,I){return I.func.apply(I.thisArg,ks([E],I.args))},v)}function Lm(c,f,v){var E=c.length;if(E<2)return E?Bs(c[0]):[];for(var I=-1,O=ie(E);++I<E;)for(var G=c[I],H=-1;++H<E;)H!=I&&(O[I]=Vl(O[I]||G,c[H],f,v));return Bs(Ci(O,1),f,v)}function jx(c,f,v){for(var E=-1,I=c.length,O=f.length,G={};++E<I;){var H=E<O?f[E]:t;v(G,c[E],H)}return G}function _m(c){return oi(c)?c:[]}function Mm(c){return typeof c=="function"?c:nr}function Us(c,f){return tt(c)?c:qm(c,f)?[c]:TT(wt(c))}var KU=ut;function $s(c,f,v){var E=c.length;return v=v===t?E:v,!f&&v>=E?c:Lr(c,f,v)}var Xx=_5||function(c){return Ii.clearTimeout(c)};function Jx(c,f){if(f)return c.slice();var v=c.length,E=vx?vx(v):new c.constructor(v);return c.copy(E),E}function km(c){var f=new c.constructor(c.byteLength);return new Jc(f).set(new Jc(c)),f}function WU(c,f){var v=f?km(c.buffer):c.buffer;return new c.constructor(v,c.byteOffset,c.byteLength)}function YU(c){var f=new c.constructor(c.source,Ao.exec(c));return f.lastIndex=c.lastIndex,f}function zU(c){return Gl?Pt(Gl.call(c)):{}}function Qx(c,f){var v=f?km(c.buffer):c.buffer;return new c.constructor(v,c.byteOffset,c.length)}function Zx(c,f){if(c!==f){var v=c!==t,E=c===null,I=c===c,O=mr(c),G=f!==t,H=f===null,z=f===f,fe=mr(f);if(!H&&!fe&&!O&&c>f||O&&G&&z&&!H&&!fe||E&&G&&z||!v&&z||!I)return 1;if(!E&&!O&&!fe&&c<f||fe&&v&&I&&!E&&!O||H&&v&&I||!G&&I||!z)return-1}return 0}function jU(c,f,v){for(var E=-1,I=c.criteria,O=f.criteria,G=I.length,H=v.length;++E<G;){var z=Zx(I[E],O[E]);if(z){if(E>=H)return z;var fe=v[E];return z*(fe=="desc"?-1:1)}}return c.index-f.index}function eT(c,f,v,E){for(var I=-1,O=c.length,G=v.length,H=-1,z=f.length,fe=pi(O-G,0),ge=ie(z+fe),ye=!E;++H<z;)ge[H]=f[H];for(;++I<G;)(ye||I<O)&&(ge[v[I]]=c[I]);for(;fe--;)ge[H++]=c[I++];return ge}function tT(c,f,v,E){for(var I=-1,O=c.length,G=-1,H=v.length,z=-1,fe=f.length,ge=pi(O-H,0),ye=ie(ge+fe),Ne=!E;++I<ge;)ye[I]=c[I];for(var Ge=I;++z<fe;)ye[Ge+z]=f[z];for(;++G<H;)(Ne||I<O)&&(ye[Ge+v[G]]=c[I++]);return ye}function tr(c,f){var v=-1,E=c.length;for(f||(f=ie(E));++v<E;)f[v]=c[v];return f}function xn(c,f,v,E){var I=!v;v||(v={});for(var O=-1,G=f.length;++O<G;){var H=f[O],z=E?E(v[H],c[H],H,v,c):t;z===t&&(z=c[H]),I?Qn(v,H,z):ql(v,H,z)}return v}function XU(c,f){return xn(c,Gm(c),f)}function JU(c,f){return xn(c,gT(c),f)}function dh(c,f){return function(v,E){var I=tt(v)?i5:bU,O=f?f():{};return I(v,c,He(E,2),O)}}function _o(c){return ut(function(f,v){var E=-1,I=v.length,O=I>1?v[I-1]:t,G=I>2?v[2]:t;for(O=c.length>3&&typeof O=="function"?(I--,O):t,G&&zi(v[0],v[1],G)&&(O=I<3?t:O,I=1),f=Pt(f);++E<I;){var H=v[E];H&&c(f,H,E,O)}return f})}function iT(c,f){return function(v,E){if(v==null)return v;if(!ir(v))return c(v,E);for(var I=v.length,O=f?I:-1,G=Pt(v);(f?O--:++O<I)&&E(G[O],O,G)!==!1;);return v}}function rT(c){return function(f,v,E){for(var I=-1,O=Pt(f),G=E(f),H=G.length;H--;){var z=G[c?H:++I];if(v(O[z],z,O)===!1)break}return f}}function QU(c,f,v){var E=f&y,I=Yl(c);function O(){var G=this&&this!==Ii&&this instanceof O?I:c;return G.apply(E?v:this,arguments)}return O}function nT(c){return function(f){f=wt(f);var v=wo(f)?Gr(f):t,E=v?v[0]:f.charAt(0),I=v?$s(v,1).join(""):f.slice(1);return E[c]()+I}}function Mo(c){return function(f){return sm(iw(tw(f).replace(qB,"")),c,"")}}function Yl(c){return function(){var f=arguments;switch(f.length){case 0:return new c;case 1:return new c(f[0]);case 2:return new c(f[0],f[1]);case 3:return new c(f[0],f[1],f[2]);case 4:return new c(f[0],f[1],f[2],f[3]);case 5:return new c(f[0],f[1],f[2],f[3],f[4]);case 6:return new c(f[0],f[1],f[2],f[3],f[4],f[5]);case 7:return new c(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}var v=Lo(c.prototype),E=c.apply(v,f);return Qt(E)?E:v}}function ZU(c,f,v){var E=Yl(c);function I(){for(var O=arguments.length,G=ie(O),H=O,z=ko(I);H--;)G[H]=arguments[H];var fe=O<3&&G[0]!==z&&G[O-1]!==z?[]:Ps(G,z);if(O-=fe.length,O<v)return uT(c,f,fh,I.placeholder,t,G,fe,t,t,v-O);var ge=this&&this!==Ii&&this instanceof I?E:c;return fr(ge,this,G)}return I}function sT(c){return function(f,v,E){var I=Pt(f);if(!ir(f)){var O=He(v,3);f=xi(f),v=function(H){return O(I[H],H,I)}}var G=c(f,v,E);return G>-1?I[O?f[G]:G]:t}}function aT(c){return es(function(f){var v=f.length,E=v,I=Cr.prototype.thru;for(c&&f.reverse();E--;){var O=f[E];if(typeof O!="function")throw new Ir(a);if(I&&!G&&yh(O)=="wrapper")var G=new Cr([],!0)}for(E=G?E:v;++E<v;){O=f[E];var H=yh(O),z=H=="wrapper"?Um(O):t;z&&Vm(z[0])&&z[1]==(L|w|N|C)&&!z[4].length&&z[9]==1?G=G[yh(z[0])].apply(G,z[3]):G=O.length==1&&Vm(O)?G[H]():G.thru(O)}return function(){var fe=arguments,ge=fe[0];if(G&&fe.length==1&&tt(ge))return G.plant(ge).value();for(var ye=0,Ne=v?f[ye].apply(this,fe):ge;++ye<v;)Ne=f[ye].call(this,Ne);return Ne}})}function fh(c,f,v,E,I,O,G,H,z,fe){var ge=f&L,ye=f&y,Ne=f&b,Ge=f&(w|x),ze=f&M,lt=Ne?t:Yl(c);function Ye(){for(var dt=arguments.length,mt=ie(dt),yr=dt;yr--;)mt[yr]=arguments[yr];if(Ge)var ji=ko(Ye),vr=h5(mt,ji);if(E&&(mt=eT(mt,E,I,Ge)),O&&(mt=tT(mt,O,G,Ge)),dt-=vr,Ge&&dt<fe){var li=Ps(mt,ji);return uT(c,f,fh,Ye.placeholder,v,mt,li,H,z,fe-dt)}var Hr=ye?v:this,ns=Ne?Hr[c]:c;return dt=mt.length,H?mt=b4(mt,H):ze&&dt>1&&mt.reverse(),ge&&z<dt&&(mt.length=z),this&&this!==Ii&&this instanceof Ye&&(ns=lt||Yl(ns)),ns.apply(Hr,mt)}return Ye}function oT(c,f){return function(v,E){return RU(v,c,f(E),{})}}function gh(c,f){return function(v,E){var I;if(v===t&&E===t)return f;if(v!==t&&(I=v),E!==t){if(I===t)return E;typeof v=="string"||typeof E=="string"?(v=pr(v),E=pr(E)):(v=Wx(v),E=Wx(E)),I=c(v,E)}return I}}function Pm(c){return es(function(f){return f=jt(f,gr(He())),ut(function(v){var E=this;return c(f,function(I){return fr(I,E,v)})})})}function ph(c,f){f=f===t?" ":pr(f);var v=f.length;if(v<2)return v?Im(f,c):f;var E=Im(f,th(c/Do(f)));return wo(f)?$s(Gr(E),0,c).join(""):E.slice(0,c)}function e4(c,f,v,E){var I=f&y,O=Yl(c);function G(){for(var H=-1,z=arguments.length,fe=-1,ge=E.length,ye=ie(ge+z),Ne=this&&this!==Ii&&this instanceof G?O:c;++fe<ge;)ye[fe]=E[fe];for(;z--;)ye[fe++]=arguments[++H];return fr(Ne,I?v:this,ye)}return G}function lT(c){return function(f,v,E){return E&&typeof E!="number"&&zi(f,v,E)&&(v=E=t),f=rs(f),v===t?(v=f,f=0):v=rs(v),E=E===t?f<v?1:-1:rs(E),UU(f,v,E,c)}}function mh(c){return function(f,v){return typeof f=="string"&&typeof v=="string"||(f=Mr(f),v=Mr(v)),c(f,v)}}function uT(c,f,v,E,I,O,G,H,z,fe){var ge=f&w,ye=ge?G:t,Ne=ge?t:G,Ge=ge?O:t,ze=ge?t:O;f|=ge?N:F,f&=~(ge?F:N),f&A||(f&=-4);var lt=[c,f,I,Ge,ye,ze,Ne,H,z,fe],Ye=v.apply(t,lt);return Vm(c)&&AT(Ye,lt),Ye.placeholder=E,ST(Ye,c,f)}function Om(c){var f=gi[c];return function(v,E){if(v=Mr(v),E=E==null?0:ki(at(E),292),E&&Sx(v)){var I=(wt(v)+"e").split("e"),O=f(I[0]+"e"+(+I[1]+E));return I=(wt(O)+"e").split("e"),+(I[0]+"e"+(+I[1]-E))}return f(v)}}var t4=Co&&1/Kc(new Co([,-0]))[1]==ne?function(c){return new Co(c)}:n0;function cT(c){return function(f){var v=Pi(f);return v==oe?dm(f):v==K?v5(f):c5(f,c(f))}}function Zn(c,f,v,E,I,O,G,H){var z=f&b;if(!z&&typeof c!="function")throw new Ir(a);var fe=E?E.length:0;if(fe||(f&=-97,E=I=t),G=G===t?G:pi(at(G),0),H=H===t?H:at(H),fe-=I?I.length:0,f&F){var ge=E,ye=I;E=I=t}var Ne=z?t:Um(c),Ge=[c,f,v,E,I,ge,ye,O,G,H];if(Ne&&m4(Ge,Ne),c=Ge[0],f=Ge[1],v=Ge[2],E=Ge[3],I=Ge[4],H=Ge[9]=Ge[9]===t?z?0:c.length:pi(Ge[9]-fe,0),!H&&f&(w|x)&&(f&=-25),!f||f==y)var ze=QU(c,f,v);else f==w||f==x?ze=ZU(c,f,H):(f==N||f==(y|N))&&!I.length?ze=e4(c,f,v,E):ze=fh.apply(t,Ge);var lt=Ne?Hx:AT;return ST(lt(ze,Ge),c,f)}function hT(c,f,v,E){return c===t||Vr(c,Io[v])&&!Ct.call(E,v)?f:c}function dT(c,f,v,E,I,O){return Qt(c)&&Qt(f)&&(O.set(f,c),uh(c,f,t,dT,O),O.delete(f)),c}function i4(c){return Xl(c)?t:c}function fT(c,f,v,E,I,O){var G=v&g,H=c.length,z=f.length;if(H!=z&&!(G&&z>H))return!1;var fe=O.get(c),ge=O.get(f);if(fe&&ge)return fe==f&&ge==c;var ye=-1,Ne=!0,Ge=v&m?new ga:t;for(O.set(c,f),O.set(f,c);++ye<H;){var ze=c[ye],lt=f[ye];if(E)var Ye=G?E(lt,ze,ye,f,c,O):E(ze,lt,ye,c,f,O);if(Ye!==t){if(Ye)continue;Ne=!1;break}if(Ge){if(!am(f,function(dt,mt){if(!Ol(Ge,mt)&&(ze===dt||I(ze,dt,v,E,O)))return Ge.push(mt)})){Ne=!1;break}}else if(!(ze===lt||I(ze,lt,v,E,O))){Ne=!1;break}}return O.delete(c),O.delete(f),Ne}function r4(c,f,v,E,I,O,G){switch(v){case le:if(c.byteLength!=f.byteLength||c.byteOffset!=f.byteOffset)return!1;c=c.buffer,f=f.buffer;case se:return!(c.byteLength!=f.byteLength||!O(new Jc(c),new Jc(f)));case Ue:case Qe:case Ae:return Vr(+c,+f);case qe:return c.name==f.name&&c.message==f.message;case ue:case D:return c==f+"";case oe:var H=dm;case K:var z=E&g;if(H||(H=Kc),c.size!=f.size&&!z)return!1;var fe=G.get(c);if(fe)return fe==f;E|=m,G.set(c,f);var ge=fT(H(c),H(f),E,I,O,G);return G.delete(c),ge;case S:if(Gl)return Gl.call(c)==Gl.call(f)}return!1}function n4(c,f,v,E,I,O){var G=v&g,H=Fm(c),z=H.length,fe=Fm(f),ge=fe.length;if(z!=ge&&!G)return!1;for(var ye=z;ye--;){var Ne=H[ye];if(!(G?Ne in f:Ct.call(f,Ne)))return!1}var Ge=O.get(c),ze=O.get(f);if(Ge&&ze)return Ge==f&&ze==c;var lt=!0;O.set(c,f),O.set(f,c);for(var Ye=G;++ye<z;){Ne=H[ye];var dt=c[Ne],mt=f[Ne];if(E)var yr=G?E(mt,dt,Ne,f,c,O):E(dt,mt,Ne,c,f,O);if(!(yr===t?dt===mt||I(dt,mt,v,E,O):yr)){lt=!1;break}Ye||(Ye=Ne=="constructor")}if(lt&&!Ye){var ji=c.constructor,vr=f.constructor;ji!=vr&&"constructor"in c&&"constructor"in f&&!(typeof ji=="function"&&ji instanceof ji&&typeof vr=="function"&&vr instanceof vr)&&(lt=!1)}return O.delete(c),O.delete(f),lt}function es(c){return Km(bT(c,t,IT),c+"")}function Fm(c){return Mx(c,xi,Gm)}function Bm(c){return Mx(c,rr,gT)}var Um=rh?function(c){return rh.get(c)}:n0;function yh(c){for(var f=c.name+"",v=No[f],E=Ct.call(No,f)?v.length:0;E--;){var I=v[E],O=I.func;if(O==null||O==c)return I.name}return f}function ko(c){var f=Ct.call(k,"placeholder")?k:c;return f.placeholder}function He(){var c=k.iteratee||i0;return c=c===i0?Ox:c,arguments.length?c(arguments[0],arguments[1]):c}function vh(c,f){var v=c.__data__;return d4(f)?v[typeof f=="string"?"string":"hash"]:v.map}function $m(c){for(var f=xi(c),v=f.length;v--;){var E=f[v],I=c[E];f[v]=[E,I,yT(I)]}return f}function ya(c,f){var v=p5(c,f);return Px(v)?v:t}function s4(c){var f=Ct.call(c,da),v=c[da];try{c[da]=t;var E=!0}catch{}var I=jc.call(c);return E&&(f?c[da]=v:delete c[da]),I}var Gm=gm?function(c){return c==null?[]:(c=Pt(c),Ms(gm(c),function(f){return Ex.call(c,f)}))}:s0,gT=gm?function(c){for(var f=[];c;)ks(f,Gm(c)),c=Qc(c);return f}:s0,Pi=Yi;(pm&&Pi(new pm(new ArrayBuffer(1)))!=le||Bl&&Pi(new Bl)!=oe||mm&&Pi(mm.resolve())!=Ie||Co&&Pi(new Co)!=K||Ul&&Pi(new Ul)!=W)&&(Pi=function(c){var f=Yi(c),v=f==me?c.constructor:t,E=v?va(v):"";if(E)switch(E){case G5:return le;case q5:return oe;case V5:return Ie;case H5:return K;case K5:return W}return f});function a4(c,f,v){for(var E=-1,I=v.length;++E<I;){var O=v[E],G=O.size;switch(O.type){case"drop":c+=G;break;case"dropRight":f-=G;break;case"take":f=ki(f,c+G);break;case"takeRight":c=pi(c,f-G);break}}return{start:c,end:f}}function o4(c){var f=c.match(Ml);return f?f[1].split(Fc):[]}function pT(c,f,v){f=Us(f,c);for(var E=-1,I=f.length,O=!1;++E<I;){var G=Tn(f[E]);if(!(O=c!=null&&v(c,G)))break;c=c[G]}return O||++E!=I?O:(I=c==null?0:c.length,!!I&&wh(I)&&ts(G,I)&&(tt(c)||ba(c)))}function l4(c){var f=c.length,v=new c.constructor(f);return f&&typeof c[0]=="string"&&Ct.call(c,"index")&&(v.index=c.index,v.input=c.input),v}function mT(c){return typeof c.constructor=="function"&&!zl(c)?Lo(Qc(c)):{}}function u4(c,f,v){var E=c.constructor;switch(f){case se:return km(c);case Ue:case Qe:return new E(+c);case le:return WU(c,v);case xe:case We:case ri:case kt:case ft:case Ve:case Si:case wr:case ee:return Qx(c,v);case oe:return new E;case Ae:case D:return new E(c);case ue:return YU(c);case K:return new E;case S:return zU(c)}}function c4(c,f){var v=f.length;if(!v)return c;var E=v-1;return f[E]=(v>1?"& ":"")+f[E],f=f.join(v>2?", ":" "),c.replace(_l,`{
/* [wrapped with `+f+`] */
`)}function h4(c){return tt(c)||ba(c)||!!(Ax&&c&&c[Ax])}function ts(c,f){var v=typeof c;return f=f??ce,!!f&&(v=="number"||v!="symbol"&&So.test(c))&&c>-1&&c%1==0&&c<f}function zi(c,f,v){if(!Qt(v))return!1;var E=typeof f;return(E=="number"?ir(v)&&ts(f,v.length):E=="string"&&f in v)?Vr(v[f],c):!1}function qm(c,f){if(tt(c))return!1;var v=typeof c;return v=="number"||v=="symbol"||v=="boolean"||c==null||mr(c)?!0:dr.test(c)||!Ns.test(c)||f!=null&&c in Pt(f)}function d4(c){var f=typeof c;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?c!=="__proto__":c===null}function Vm(c){var f=yh(c),v=k[f];if(typeof v!="function"||!(f in gt.prototype))return!1;if(c===v)return!0;var E=Um(v);return!!E&&c===E[0]}function f4(c){return!!yx&&yx in c}var g4=Yc?is:a0;function zl(c){var f=c&&c.constructor,v=typeof f=="function"&&f.prototype||Io;return c===v}function yT(c){return c===c&&!Qt(c)}function vT(c,f){return function(v){return v==null?!1:v[c]===f&&(f!==t||c in Pt(v))}}function p4(c){var f=xh(c,function(E){return v.size===l&&v.clear(),E}),v=f.cache;return f}function m4(c,f){var v=c[1],E=f[1],I=v|E,O=I<(y|b|L),G=E==L&&v==w||E==L&&v==C&&c[7].length<=f[8]||E==(L|C)&&f[7].length<=f[8]&&v==w;if(!(O||G))return c;E&y&&(c[2]=f[2],I|=v&y?0:A);var H=f[3];if(H){var z=c[3];c[3]=z?eT(z,H,f[4]):H,c[4]=z?Ps(c[3],u):f[4]}return H=f[5],H&&(z=c[5],c[5]=z?tT(z,H,f[6]):H,c[6]=z?Ps(c[5],u):f[6]),H=f[7],H&&(c[7]=H),E&L&&(c[8]=c[8]==null?f[8]:ki(c[8],f[8])),c[9]==null&&(c[9]=f[9]),c[0]=f[0],c[1]=I,c}function y4(c){var f=[];if(c!=null)for(var v in Pt(c))f.push(v);return f}function v4(c){return jc.call(c)}function bT(c,f,v){return f=pi(f===t?c.length-1:f,0),function(){for(var E=arguments,I=-1,O=pi(E.length-f,0),G=ie(O);++I<O;)G[I]=E[f+I];I=-1;for(var H=ie(f+1);++I<f;)H[I]=E[I];return H[f]=v(G),fr(c,this,H)}}function ET(c,f){return f.length<2?c:ma(c,Lr(f,0,-1))}function b4(c,f){for(var v=c.length,E=ki(f.length,v),I=tr(c);E--;){var O=f[E];c[E]=ts(O,v)?I[O]:t}return c}function Hm(c,f){if(!(f==="constructor"&&typeof c[f]=="function")&&f!="__proto__")return c[f]}var AT=xT(Hx),jl=k5||function(c,f){return Ii.setTimeout(c,f)},Km=xT(qU);function ST(c,f,v){var E=f+"";return Km(c,c4(E,E4(o4(E),v)))}function xT(c){var f=0,v=0;return function(){var E=B5(),I=q-(E-v);if(v=E,I>0){if(++f>=U)return arguments[0]}else f=0;return c.apply(t,arguments)}}function bh(c,f){var v=-1,E=c.length,I=E-1;for(f=f===t?E:f;++v<f;){var O=Rm(v,I),G=c[O];c[O]=c[v],c[v]=G}return c.length=f,c}var TT=p4(function(c){var f=[];return c.charCodeAt(0)===46&&f.push(""),c.replace(Pc,function(v,E,I,O){f.push(I?O.replace(kl,"$1"):E||v)}),f});function Tn(c){if(typeof c=="string"||mr(c))return c;var f=c+"";return f=="0"&&1/c==-ne?"-0":f}function va(c){if(c!=null){try{return zc.call(c)}catch{}try{return c+""}catch{}}return""}function E4(c,f){return Rr(Te,function(v){var E="_."+v[0];f&v[1]&&!Vc(c,E)&&c.push(E)}),c.sort()}function wT(c){if(c instanceof gt)return c.clone();var f=new Cr(c.__wrapped__,c.__chain__);return f.__actions__=tr(c.__actions__),f.__index__=c.__index__,f.__values__=c.__values__,f}function A4(c,f,v){(v?zi(c,f,v):f===t)?f=1:f=pi(at(f),0);var E=c==null?0:c.length;if(!E||f<1)return[];for(var I=0,O=0,G=ie(th(E/f));I<E;)G[O++]=Lr(c,I,I+=f);return G}function S4(c){for(var f=-1,v=c==null?0:c.length,E=0,I=[];++f<v;){var O=c[f];O&&(I[E++]=O)}return I}function x4(){var c=arguments.length;if(!c)return[];for(var f=ie(c-1),v=arguments[0],E=c;E--;)f[E-1]=arguments[E];return ks(tt(v)?tr(v):[v],Ci(f,1))}var T4=ut(function(c,f){return oi(c)?Vl(c,Ci(f,1,oi,!0)):[]}),w4=ut(function(c,f){var v=_r(f);return oi(v)&&(v=t),oi(c)?Vl(c,Ci(f,1,oi,!0),He(v,2)):[]}),D4=ut(function(c,f){var v=_r(f);return oi(v)&&(v=t),oi(c)?Vl(c,Ci(f,1,oi,!0),t,v):[]});function R4(c,f,v){var E=c==null?0:c.length;return E?(f=v||f===t?1:at(f),Lr(c,f<0?0:f,E)):[]}function I4(c,f,v){var E=c==null?0:c.length;return E?(f=v||f===t?1:at(f),f=E-f,Lr(c,0,f<0?0:f)):[]}function C4(c,f){return c&&c.length?hh(c,He(f,3),!0,!0):[]}function N4(c,f){return c&&c.length?hh(c,He(f,3),!0):[]}function L4(c,f,v,E){var I=c==null?0:c.length;return I?(v&&typeof v!="number"&&zi(c,f,v)&&(v=0,E=I),xU(c,f,v,E)):[]}function DT(c,f,v){var E=c==null?0:c.length;if(!E)return-1;var I=v==null?0:at(v);return I<0&&(I=pi(E+I,0)),Hc(c,He(f,3),I)}function RT(c,f,v){var E=c==null?0:c.length;if(!E)return-1;var I=E-1;return v!==t&&(I=at(v),I=v<0?pi(E+I,0):ki(I,E-1)),Hc(c,He(f,3),I,!0)}function IT(c){var f=c==null?0:c.length;return f?Ci(c,1):[]}function _4(c){var f=c==null?0:c.length;return f?Ci(c,ne):[]}function M4(c,f){var v=c==null?0:c.length;return v?(f=f===t?1:at(f),Ci(c,f)):[]}function k4(c){for(var f=-1,v=c==null?0:c.length,E={};++f<v;){var I=c[f];E[I[0]]=I[1]}return E}function CT(c){return c&&c.length?c[0]:t}function P4(c,f,v){var E=c==null?0:c.length;if(!E)return-1;var I=v==null?0:at(v);return I<0&&(I=pi(E+I,0)),To(c,f,I)}function O4(c){var f=c==null?0:c.length;return f?Lr(c,0,-1):[]}var F4=ut(function(c){var f=jt(c,_m);return f.length&&f[0]===c[0]?Sm(f):[]}),B4=ut(function(c){var f=_r(c),v=jt(c,_m);return f===_r(v)?f=t:v.pop(),v.length&&v[0]===c[0]?Sm(v,He(f,2)):[]}),U4=ut(function(c){var f=_r(c),v=jt(c,_m);return f=typeof f=="function"?f:t,f&&v.pop(),v.length&&v[0]===c[0]?Sm(v,t,f):[]});function $4(c,f){return c==null?"":O5.call(c,f)}function _r(c){var f=c==null?0:c.length;return f?c[f-1]:t}function G4(c,f,v){var E=c==null?0:c.length;if(!E)return-1;var I=E;return v!==t&&(I=at(v),I=I<0?pi(E+I,0):ki(I,E-1)),f===f?E5(c,f,I):Hc(c,hx,I,!0)}function q4(c,f){return c&&c.length?$x(c,at(f)):t}var V4=ut(NT);function NT(c,f){return c&&c.length&&f&&f.length?Dm(c,f):c}function H4(c,f,v){return c&&c.length&&f&&f.length?Dm(c,f,He(v,2)):c}function K4(c,f,v){return c&&c.length&&f&&f.length?Dm(c,f,t,v):c}var W4=es(function(c,f){var v=c==null?0:c.length,E=vm(c,f);return Vx(c,jt(f,function(I){return ts(I,v)?+I:I}).sort(Zx)),E});function Y4(c,f){var v=[];if(!(c&&c.length))return v;var E=-1,I=[],O=c.length;for(f=He(f,3);++E<O;){var G=c[E];f(G,E,c)&&(v.push(G),I.push(E))}return Vx(c,I),v}function Wm(c){return c==null?c:$5.call(c)}function z4(c,f,v){var E=c==null?0:c.length;return E?(v&&typeof v!="number"&&zi(c,f,v)?(f=0,v=E):(f=f==null?0:at(f),v=v===t?E:at(v)),Lr(c,f,v)):[]}function j4(c,f){return ch(c,f)}function X4(c,f,v){return Cm(c,f,He(v,2))}function J4(c,f){var v=c==null?0:c.length;if(v){var E=ch(c,f);if(E<v&&Vr(c[E],f))return E}return-1}function Q4(c,f){return ch(c,f,!0)}function Z4(c,f,v){return Cm(c,f,He(v,2),!0)}function e8(c,f){var v=c==null?0:c.length;if(v){var E=ch(c,f,!0)-1;if(Vr(c[E],f))return E}return-1}function t8(c){return c&&c.length?Kx(c):[]}function i8(c,f){return c&&c.length?Kx(c,He(f,2)):[]}function r8(c){var f=c==null?0:c.length;return f?Lr(c,1,f):[]}function n8(c,f,v){return c&&c.length?(f=v||f===t?1:at(f),Lr(c,0,f<0?0:f)):[]}function s8(c,f,v){var E=c==null?0:c.length;return E?(f=v||f===t?1:at(f),f=E-f,Lr(c,f<0?0:f,E)):[]}function a8(c,f){return c&&c.length?hh(c,He(f,3),!1,!0):[]}function o8(c,f){return c&&c.length?hh(c,He(f,3)):[]}var l8=ut(function(c){return Bs(Ci(c,1,oi,!0))}),u8=ut(function(c){var f=_r(c);return oi(f)&&(f=t),Bs(Ci(c,1,oi,!0),He(f,2))}),c8=ut(function(c){var f=_r(c);return f=typeof f=="function"?f:t,Bs(Ci(c,1,oi,!0),t,f)});function h8(c){return c&&c.length?Bs(c):[]}function d8(c,f){return c&&c.length?Bs(c,He(f,2)):[]}function f8(c,f){return f=typeof f=="function"?f:t,c&&c.length?Bs(c,t,f):[]}function Ym(c){if(!(c&&c.length))return[];var f=0;return c=Ms(c,function(v){if(oi(v))return f=pi(v.length,f),!0}),cm(f,function(v){return jt(c,om(v))})}function LT(c,f){if(!(c&&c.length))return[];var v=Ym(c);return f==null?v:jt(v,function(E){return fr(f,t,E)})}var g8=ut(function(c,f){return oi(c)?Vl(c,f):[]}),p8=ut(function(c){return Lm(Ms(c,oi))}),m8=ut(function(c){var f=_r(c);return oi(f)&&(f=t),Lm(Ms(c,oi),He(f,2))}),y8=ut(function(c){var f=_r(c);return f=typeof f=="function"?f:t,Lm(Ms(c,oi),t,f)}),v8=ut(Ym);function b8(c,f){return jx(c||[],f||[],ql)}function E8(c,f){return jx(c||[],f||[],Wl)}var A8=ut(function(c){var f=c.length,v=f>1?c[f-1]:t;return v=typeof v=="function"?(c.pop(),v):t,LT(c,v)});function _T(c){var f=k(c);return f.__chain__=!0,f}function S8(c,f){return f(c),c}function Eh(c,f){return f(c)}var x8=es(function(c){var f=c.length,v=f?c[0]:0,E=this.__wrapped__,I=function(O){return vm(O,c)};return f>1||this.__actions__.length||!(E instanceof gt)||!ts(v)?this.thru(I):(E=E.slice(v,+v+(f?1:0)),E.__actions__.push({func:Eh,args:[I],thisArg:t}),new Cr(E,this.__chain__).thru(function(O){return f&&!O.length&&O.push(t),O}))});function T8(){return _T(this)}function w8(){return new Cr(this.value(),this.__chain__)}function D8(){this.__values__===t&&(this.__values__=WT(this.value()));var c=this.__index__>=this.__values__.length,f=c?t:this.__values__[this.__index__++];return{done:c,value:f}}function R8(){return this}function I8(c){for(var f,v=this;v instanceof sh;){var E=wT(v);E.__index__=0,E.__values__=t,f?I.__wrapped__=E:f=E;var I=E;v=v.__wrapped__}return I.__wrapped__=c,f}function C8(){var c=this.__wrapped__;if(c instanceof gt){var f=c;return this.__actions__.length&&(f=new gt(this)),f=f.reverse(),f.__actions__.push({func:Eh,args:[Wm],thisArg:t}),new Cr(f,this.__chain__)}return this.thru(Wm)}function N8(){return zx(this.__wrapped__,this.__actions__)}var L8=dh(function(c,f,v){Ct.call(c,v)?++c[v]:Qn(c,v,1)});function _8(c,f,v){var E=tt(c)?ux:SU;return v&&zi(c,f,v)&&(f=t),E(c,He(f,3))}function M8(c,f){var v=tt(c)?Ms:Lx;return v(c,He(f,3))}var k8=sT(DT),P8=sT(RT);function O8(c,f){return Ci(Ah(c,f),1)}function F8(c,f){return Ci(Ah(c,f),ne)}function B8(c,f,v){return v=v===t?1:at(v),Ci(Ah(c,f),v)}function MT(c,f){var v=tt(c)?Rr:Fs;return v(c,He(f,3))}function kT(c,f){var v=tt(c)?r5:Nx;return v(c,He(f,3))}var U8=dh(function(c,f,v){Ct.call(c,v)?c[v].push(f):Qn(c,v,[f])});function $8(c,f,v,E){c=ir(c)?c:Oo(c),v=v&&!E?at(v):0;var I=c.length;return v<0&&(v=pi(I+v,0)),Dh(c)?v<=I&&c.indexOf(f,v)>-1:!!I&&To(c,f,v)>-1}var G8=ut(function(c,f,v){var E=-1,I=typeof f=="function",O=ir(c)?ie(c.length):[];return Fs(c,function(G){O[++E]=I?fr(f,G,v):Hl(G,f,v)}),O}),q8=dh(function(c,f,v){Qn(c,v,f)});function Ah(c,f){var v=tt(c)?jt:Fx;return v(c,He(f,3))}function V8(c,f,v,E){return c==null?[]:(tt(f)||(f=f==null?[]:[f]),v=E?t:v,tt(v)||(v=v==null?[]:[v]),Gx(c,f,v))}var H8=dh(function(c,f,v){c[v?0:1].push(f)},function(){return[[],[]]});function K8(c,f,v){var E=tt(c)?sm:fx,I=arguments.length<3;return E(c,He(f,4),v,I,Fs)}function W8(c,f,v){var E=tt(c)?n5:fx,I=arguments.length<3;return E(c,He(f,4),v,I,Nx)}function Y8(c,f){var v=tt(c)?Ms:Lx;return v(c,Th(He(f,3)))}function z8(c){var f=tt(c)?Dx:$U;return f(c)}function j8(c,f,v){(v?zi(c,f,v):f===t)?f=1:f=at(f);var E=tt(c)?yU:GU;return E(c,f)}function X8(c){var f=tt(c)?vU:VU;return f(c)}function J8(c){if(c==null)return 0;if(ir(c))return Dh(c)?Do(c):c.length;var f=Pi(c);return f==oe||f==K?c.size:Tm(c).length}function Q8(c,f,v){var E=tt(c)?am:HU;return v&&zi(c,f,v)&&(f=t),E(c,He(f,3))}var Z8=ut(function(c,f){if(c==null)return[];var v=f.length;return v>1&&zi(c,f[0],f[1])?f=[]:v>2&&zi(f[0],f[1],f[2])&&(f=[f[0]]),Gx(c,Ci(f,1),[])}),Sh=M5||function(){return Ii.Date.now()};function e6(c,f){if(typeof f!="function")throw new Ir(a);return c=at(c),function(){if(--c<1)return f.apply(this,arguments)}}function PT(c,f,v){return f=v?t:f,f=c&&f==null?c.length:f,Zn(c,L,t,t,t,t,f)}function OT(c,f){var v;if(typeof f!="function")throw new Ir(a);return c=at(c),function(){return--c>0&&(v=f.apply(this,arguments)),c<=1&&(f=t),v}}var zm=ut(function(c,f,v){var E=y;if(v.length){var I=Ps(v,ko(zm));E|=N}return Zn(c,E,f,v,I)}),FT=ut(function(c,f,v){var E=y|b;if(v.length){var I=Ps(v,ko(FT));E|=N}return Zn(f,E,c,v,I)});function BT(c,f,v){f=v?t:f;var E=Zn(c,w,t,t,t,t,t,f);return E.placeholder=BT.placeholder,E}function UT(c,f,v){f=v?t:f;var E=Zn(c,x,t,t,t,t,t,f);return E.placeholder=UT.placeholder,E}function $T(c,f,v){var E,I,O,G,H,z,fe=0,ge=!1,ye=!1,Ne=!0;if(typeof c!="function")throw new Ir(a);f=Mr(f)||0,Qt(v)&&(ge=!!v.leading,ye="maxWait"in v,O=ye?pi(Mr(v.maxWait)||0,f):O,Ne="trailing"in v?!!v.trailing:Ne);function Ge(li){var Hr=E,ns=I;return E=I=t,fe=li,G=c.apply(ns,Hr),G}function ze(li){return fe=li,H=jl(dt,f),ge?Ge(li):G}function lt(li){var Hr=li-z,ns=li-fe,sw=f-Hr;return ye?ki(sw,O-ns):sw}function Ye(li){var Hr=li-z,ns=li-fe;return z===t||Hr>=f||Hr<0||ye&&ns>=O}function dt(){var li=Sh();if(Ye(li))return mt(li);H=jl(dt,lt(li))}function mt(li){return H=t,Ne&&E?Ge(li):(E=I=t,G)}function yr(){H!==t&&Xx(H),fe=0,E=z=I=H=t}function ji(){return H===t?G:mt(Sh())}function vr(){var li=Sh(),Hr=Ye(li);if(E=arguments,I=this,z=li,Hr){if(H===t)return ze(z);if(ye)return Xx(H),H=jl(dt,f),Ge(z)}return H===t&&(H=jl(dt,f)),G}return vr.cancel=yr,vr.flush=ji,vr}var t6=ut(function(c,f){return Cx(c,1,f)}),i6=ut(function(c,f,v){return Cx(c,Mr(f)||0,v)});function r6(c){return Zn(c,M)}function xh(c,f){if(typeof c!="function"||f!=null&&typeof f!="function")throw new Ir(a);var v=function(){var E=arguments,I=f?f.apply(this,E):E[0],O=v.cache;if(O.has(I))return O.get(I);var G=c.apply(this,E);return v.cache=O.set(I,G)||O,G};return v.cache=new(xh.Cache||Jn),v}xh.Cache=Jn;function Th(c){if(typeof c!="function")throw new Ir(a);return function(){var f=arguments;switch(f.length){case 0:return!c.call(this);case 1:return!c.call(this,f[0]);case 2:return!c.call(this,f[0],f[1]);case 3:return!c.call(this,f[0],f[1],f[2])}return!c.apply(this,f)}}function n6(c){return OT(2,c)}var s6=KU(function(c,f){f=f.length==1&&tt(f[0])?jt(f[0],gr(He())):jt(Ci(f,1),gr(He()));var v=f.length;return ut(function(E){for(var I=-1,O=ki(E.length,v);++I<O;)E[I]=f[I].call(this,E[I]);return fr(c,this,E)})}),jm=ut(function(c,f){var v=Ps(f,ko(jm));return Zn(c,N,t,f,v)}),GT=ut(function(c,f){var v=Ps(f,ko(GT));return Zn(c,F,t,f,v)}),a6=es(function(c,f){return Zn(c,C,t,t,t,f)});function o6(c,f){if(typeof c!="function")throw new Ir(a);return f=f===t?f:at(f),ut(c,f)}function l6(c,f){if(typeof c!="function")throw new Ir(a);return f=f==null?0:pi(at(f),0),ut(function(v){var E=v[f],I=$s(v,0,f);return E&&ks(I,E),fr(c,this,I)})}function u6(c,f,v){var E=!0,I=!0;if(typeof c!="function")throw new Ir(a);return Qt(v)&&(E="leading"in v?!!v.leading:E,I="trailing"in v?!!v.trailing:I),$T(c,f,{leading:E,maxWait:f,trailing:I})}function c6(c){return PT(c,1)}function h6(c,f){return jm(Mm(f),c)}function d6(){if(!arguments.length)return[];var c=arguments[0];return tt(c)?c:[c]}function f6(c){return Nr(c,p)}function g6(c,f){return f=typeof f=="function"?f:t,Nr(c,p,f)}function p6(c){return Nr(c,h|p)}function m6(c,f){return f=typeof f=="function"?f:t,Nr(c,h|p,f)}function y6(c,f){return f==null||Ix(c,f,xi(f))}function Vr(c,f){return c===f||c!==c&&f!==f}var v6=mh(Am),b6=mh(function(c,f){return c>=f}),ba=kx(function(){return arguments}())?kx:function(c){return ni(c)&&Ct.call(c,"callee")&&!Ex.call(c,"callee")},tt=ie.isArray,E6=rx?gr(rx):IU;function ir(c){return c!=null&&wh(c.length)&&!is(c)}function oi(c){return ni(c)&&ir(c)}function A6(c){return c===!0||c===!1||ni(c)&&Yi(c)==Ue}var Gs=P5||a0,S6=nx?gr(nx):CU;function x6(c){return ni(c)&&c.nodeType===1&&!Xl(c)}function T6(c){if(c==null)return!0;if(ir(c)&&(tt(c)||typeof c=="string"||typeof c.splice=="function"||Gs(c)||Po(c)||ba(c)))return!c.length;var f=Pi(c);if(f==oe||f==K)return!c.size;if(zl(c))return!Tm(c).length;for(var v in c)if(Ct.call(c,v))return!1;return!0}function w6(c,f){return Kl(c,f)}function D6(c,f,v){v=typeof v=="function"?v:t;var E=v?v(c,f):t;return E===t?Kl(c,f,t,v):!!E}function Xm(c){if(!ni(c))return!1;var f=Yi(c);return f==qe||f==Ze||typeof c.message=="string"&&typeof c.name=="string"&&!Xl(c)}function R6(c){return typeof c=="number"&&Sx(c)}function is(c){if(!Qt(c))return!1;var f=Yi(c);return f==nt||f==B||f==Be||f==Me}function qT(c){return typeof c=="number"&&c==at(c)}function wh(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=ce}function Qt(c){var f=typeof c;return c!=null&&(f=="object"||f=="function")}function ni(c){return c!=null&&typeof c=="object"}var VT=sx?gr(sx):LU;function I6(c,f){return c===f||xm(c,f,$m(f))}function C6(c,f,v){return v=typeof v=="function"?v:t,xm(c,f,$m(f),v)}function N6(c){return HT(c)&&c!=+c}function L6(c){if(g4(c))throw new et(s);return Px(c)}function _6(c){return c===null}function M6(c){return c==null}function HT(c){return typeof c=="number"||ni(c)&&Yi(c)==Ae}function Xl(c){if(!ni(c)||Yi(c)!=me)return!1;var f=Qc(c);if(f===null)return!0;var v=Ct.call(f,"constructor")&&f.constructor;return typeof v=="function"&&v instanceof v&&zc.call(v)==C5}var Jm=ax?gr(ax):_U;function k6(c){return qT(c)&&c>=-ce&&c<=ce}var KT=ox?gr(ox):MU;function Dh(c){return typeof c=="string"||!tt(c)&&ni(c)&&Yi(c)==D}function mr(c){return typeof c=="symbol"||ni(c)&&Yi(c)==S}var Po=lx?gr(lx):kU;function P6(c){return c===t}function O6(c){return ni(c)&&Pi(c)==W}function F6(c){return ni(c)&&Yi(c)==Se}var B6=mh(wm),U6=mh(function(c,f){return c<=f});function WT(c){if(!c)return[];if(ir(c))return Dh(c)?Gr(c):tr(c);if(Fl&&c[Fl])return y5(c[Fl]());var f=Pi(c),v=f==oe?dm:f==K?Kc:Oo;return v(c)}function rs(c){if(!c)return c===0?c:0;if(c=Mr(c),c===ne||c===-ne){var f=c<0?-1:1;return f*re}return c===c?c:0}function at(c){var f=rs(c),v=f%1;return f===f?v?f-v:f:0}function YT(c){return c?pa(at(c),0,J):0}function Mr(c){if(typeof c=="number")return c;if(mr(c))return V;if(Qt(c)){var f=typeof c.valueOf=="function"?c.valueOf():c;c=Qt(f)?f+"":f}if(typeof c!="string")return c===0?c:+c;c=c.replace(Ls,"");var v=jp.test(c);return v||_s.test(c)?e5(c.slice(2),v?2:8):$c.test(c)?V:+c}function zT(c){return xn(c,rr(c))}function $6(c){return c?pa(at(c),-ce,ce):c===0?c:0}function wt(c){return c==null?"":pr(c)}var G6=_o(function(c,f){if(zl(f)||ir(f)){xn(f,xi(f),c);return}for(var v in f)Ct.call(f,v)&&ql(c,v,f[v])}),jT=_o(function(c,f){xn(f,rr(f),c)}),Rh=_o(function(c,f,v,E){xn(f,rr(f),c,E)}),q6=_o(function(c,f,v,E){xn(f,xi(f),c,E)}),V6=es(vm);function H6(c,f){var v=Lo(c);return f==null?v:Rx(v,f)}var K6=ut(function(c,f){c=Pt(c);var v=-1,E=f.length,I=E>2?f[2]:t;for(I&&zi(f[0],f[1],I)&&(E=1);++v<E;)for(var O=f[v],G=rr(O),H=-1,z=G.length;++H<z;){var fe=G[H],ge=c[fe];(ge===t||Vr(ge,Io[fe])&&!Ct.call(c,fe))&&(c[fe]=O[fe])}return c}),W6=ut(function(c){return c.push(t,dT),fr(XT,t,c)});function Y6(c,f){return cx(c,He(f,3),Sn)}function z6(c,f){return cx(c,He(f,3),Em)}function j6(c,f){return c==null?c:bm(c,He(f,3),rr)}function X6(c,f){return c==null?c:_x(c,He(f,3),rr)}function J6(c,f){return c&&Sn(c,He(f,3))}function Q6(c,f){return c&&Em(c,He(f,3))}function Z6(c){return c==null?[]:lh(c,xi(c))}function e$(c){return c==null?[]:lh(c,rr(c))}function Qm(c,f,v){var E=c==null?t:ma(c,f);return E===t?v:E}function t$(c,f){return c!=null&&pT(c,f,TU)}function Zm(c,f){return c!=null&&pT(c,f,wU)}var i$=oT(function(c,f,v){f!=null&&typeof f.toString!="function"&&(f=jc.call(f)),c[f]=v},t0(nr)),r$=oT(function(c,f,v){f!=null&&typeof f.toString!="function"&&(f=jc.call(f)),Ct.call(c,f)?c[f].push(v):c[f]=[v]},He),n$=ut(Hl);function xi(c){return ir(c)?wx(c):Tm(c)}function rr(c){return ir(c)?wx(c,!0):PU(c)}function s$(c,f){var v={};return f=He(f,3),Sn(c,function(E,I,O){Qn(v,f(E,I,O),E)}),v}function a$(c,f){var v={};return f=He(f,3),Sn(c,function(E,I,O){Qn(v,I,f(E,I,O))}),v}var o$=_o(function(c,f,v){uh(c,f,v)}),XT=_o(function(c,f,v,E){uh(c,f,v,E)}),l$=es(function(c,f){var v={};if(c==null)return v;var E=!1;f=jt(f,function(O){return O=Us(O,c),E||(E=O.length>1),O}),xn(c,Bm(c),v),E&&(v=Nr(v,h|d|p,i4));for(var I=f.length;I--;)Nm(v,f[I]);return v});function u$(c,f){return JT(c,Th(He(f)))}var c$=es(function(c,f){return c==null?{}:FU(c,f)});function JT(c,f){if(c==null)return{};var v=jt(Bm(c),function(E){return[E]});return f=He(f),qx(c,v,function(E,I){return f(E,I[0])})}function h$(c,f,v){f=Us(f,c);var E=-1,I=f.length;for(I||(I=1,c=t);++E<I;){var O=c==null?t:c[Tn(f[E])];O===t&&(E=I,O=v),c=is(O)?O.call(c):O}return c}function d$(c,f,v){return c==null?c:Wl(c,f,v)}function f$(c,f,v,E){return E=typeof E=="function"?E:t,c==null?c:Wl(c,f,v,E)}var QT=cT(xi),ZT=cT(rr);function g$(c,f,v){var E=tt(c),I=E||Gs(c)||Po(c);if(f=He(f,4),v==null){var O=c&&c.constructor;I?v=E?new O:[]:Qt(c)?v=is(O)?Lo(Qc(c)):{}:v={}}return(I?Rr:Sn)(c,function(G,H,z){return f(v,G,H,z)}),v}function p$(c,f){return c==null?!0:Nm(c,f)}function m$(c,f,v){return c==null?c:Yx(c,f,Mm(v))}function y$(c,f,v,E){return E=typeof E=="function"?E:t,c==null?c:Yx(c,f,Mm(v),E)}function Oo(c){return c==null?[]:hm(c,xi(c))}function v$(c){return c==null?[]:hm(c,rr(c))}function b$(c,f,v){return v===t&&(v=f,f=t),v!==t&&(v=Mr(v),v=v===v?v:0),f!==t&&(f=Mr(f),f=f===f?f:0),pa(Mr(c),f,v)}function E$(c,f,v){return f=rs(f),v===t?(v=f,f=0):v=rs(v),c=Mr(c),DU(c,f,v)}function A$(c,f,v){if(v&&typeof v!="boolean"&&zi(c,f,v)&&(f=v=t),v===t&&(typeof f=="boolean"?(v=f,f=t):typeof c=="boolean"&&(v=c,c=t)),c===t&&f===t?(c=0,f=1):(c=rs(c),f===t?(f=c,c=0):f=rs(f)),c>f){var E=c;c=f,f=E}if(v||c%1||f%1){var I=xx();return ki(c+I*(f-c+ZB("1e-"+((I+"").length-1))),f)}return Rm(c,f)}var S$=Mo(function(c,f,v){return f=f.toLowerCase(),c+(v?ew(f):f)});function ew(c){return e0(wt(c).toLowerCase())}function tw(c){return c=wt(c),c&&c.replace(Xp,d5).replace(VB,"")}function x$(c,f,v){c=wt(c),f=pr(f);var E=c.length;v=v===t?E:pa(at(v),0,E);var I=v;return v-=f.length,v>=0&&c.slice(v,I)==f}function T$(c){return c=wt(c),c&&jn.test(c)?c.replace(st,f5):c}function w$(c){return c=wt(c),c&&Oc.test(c)?c.replace(vo,"\\$&"):c}var D$=Mo(function(c,f,v){return c+(v?"-":"")+f.toLowerCase()}),R$=Mo(function(c,f,v){return c+(v?" ":"")+f.toLowerCase()}),I$=nT("toLowerCase");function C$(c,f,v){c=wt(c),f=at(f);var E=f?Do(c):0;if(!f||E>=f)return c;var I=(f-E)/2;return ph(ih(I),v)+c+ph(th(I),v)}function N$(c,f,v){c=wt(c),f=at(f);var E=f?Do(c):0;return f&&E<f?c+ph(f-E,v):c}function L$(c,f,v){c=wt(c),f=at(f);var E=f?Do(c):0;return f&&E<f?ph(f-E,v)+c:c}function _$(c,f,v){return v||f==null?f=0:f&&(f=+f),U5(wt(c).replace(bo,""),f||0)}function M$(c,f,v){return(v?zi(c,f,v):f===t)?f=1:f=at(f),Im(wt(c),f)}function k$(){var c=arguments,f=wt(c[0]);return c.length<3?f:f.replace(c[1],c[2])}var P$=Mo(function(c,f,v){return c+(v?"_":"")+f.toLowerCase()});function O$(c,f,v){return v&&typeof v!="number"&&zi(c,f,v)&&(f=v=t),v=v===t?J:v>>>0,v?(c=wt(c),c&&(typeof f=="string"||f!=null&&!Jm(f))&&(f=pr(f),!f&&wo(c))?$s(Gr(c),0,v):c.split(f,v)):[]}var F$=Mo(function(c,f,v){return c+(v?" ":"")+e0(f)});function B$(c,f,v){return c=wt(c),v=v==null?0:pa(at(v),0,c.length),f=pr(f),c.slice(v,v+f.length)==f}function U$(c,f,v){var E=k.templateSettings;v&&zi(c,f,v)&&(f=t),c=wt(c),f=Rh({},f,E,hT);var I=Rh({},f.imports,E.imports,hT),O=xi(I),G=hm(I,O),H,z,fe=0,ge=f.interpolate||ca,ye="__p += '",Ne=fm((f.escape||ca).source+"|"+ge.source+"|"+(ge===yo?Uc:ca).source+"|"+(f.evaluate||ca).source+"|$","g"),Ge="//# sourceURL="+(Ct.call(f,"sourceURL")?(f.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++zB+"]")+`
`;c.replace(Ne,function(Ye,dt,mt,yr,ji,vr){return mt||(mt=yr),ye+=c.slice(fe,vr).replace(wB,g5),dt&&(H=!0,ye+=`' +
__e(`+dt+`) +
'`),ji&&(z=!0,ye+=`';
`+ji+`;
__p += '`),mt&&(ye+=`' +
((__t = (`+mt+`)) == null ? '' : __t) +
'`),fe=vr+Ye.length,Ye}),ye+=`';
`;var ze=Ct.call(f,"variable")&&f.variable;ze||(ye=`with (obj) {
`+ye+`
}
`),ye=(z?ye.replace(te,""):ye).replace(yt,"$1").replace(Nt,"$1;"),ye="function("+(ze||"obj")+`) {
`+(ze?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(H?", __e = _.escape":"")+(z?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ye+`return __p
}`;var lt=rw(function(){return St(O,Ge+"return "+ye).apply(t,G)});if(lt.source=ye,Xm(lt))throw lt;return lt}function $$(c){return wt(c).toLowerCase()}function G$(c){return wt(c).toUpperCase()}function q$(c,f,v){if(c=wt(c),c&&(v||f===t))return c.replace(Ls,"");if(!c||!(f=pr(f)))return c;var E=Gr(c),I=Gr(f),O=gx(E,I),G=px(E,I)+1;return $s(E,O,G).join("")}function V$(c,f,v){if(c=wt(c),c&&(v||f===t))return c.replace(Eo,"");if(!c||!(f=pr(f)))return c;var E=Gr(c),I=px(E,Gr(f))+1;return $s(E,0,I).join("")}function H$(c,f,v){if(c=wt(c),c&&(v||f===t))return c.replace(bo,"");if(!c||!(f=pr(f)))return c;var E=Gr(c),I=gx(E,Gr(f));return $s(E,I).join("")}function K$(c,f){var v=_,E=R;if(Qt(f)){var I="separator"in f?f.separator:I;v="length"in f?at(f.length):v,E="omission"in f?pr(f.omission):E}c=wt(c);var O=c.length;if(wo(c)){var G=Gr(c);O=G.length}if(v>=O)return c;var H=v-Do(E);if(H<1)return E;var z=G?$s(G,0,H).join(""):c.slice(0,H);if(I===t)return z+E;if(G&&(H+=z.length-H),Jm(I)){if(c.slice(H).search(I)){var fe,ge=z;for(I.global||(I=fm(I.source,wt(Ao.exec(I))+"g")),I.lastIndex=0;fe=I.exec(ge);)var ye=fe.index;z=z.slice(0,ye===t?H:ye)}}else if(c.indexOf(pr(I),H)!=H){var Ne=z.lastIndexOf(I);Ne>-1&&(z=z.slice(0,Ne))}return z+E}function W$(c){return c=wt(c),c&&En.test(c)?c.replace(Lt,A5):c}var Y$=Mo(function(c,f,v){return c+(v?" ":"")+f.toUpperCase()}),e0=nT("toUpperCase");function iw(c,f,v){return c=wt(c),f=v?t:f,f===t?m5(c)?T5(c):o5(c):c.match(f)||[]}var rw=ut(function(c,f){try{return fr(c,t,f)}catch(v){return Xm(v)?v:new et(v)}}),z$=es(function(c,f){return Rr(f,function(v){v=Tn(v),Qn(c,v,zm(c[v],c))}),c});function j$(c){var f=c==null?0:c.length,v=He();return c=f?jt(c,function(E){if(typeof E[1]!="function")throw new Ir(a);return[v(E[0]),E[1]]}):[],ut(function(E){for(var I=-1;++I<f;){var O=c[I];if(fr(O[0],this,E))return fr(O[1],this,E)}})}function X$(c){return AU(Nr(c,h))}function t0(c){return function(){return c}}function J$(c,f){return c==null||c!==c?f:c}var Q$=aT(),Z$=aT(!0);function nr(c){return c}function i0(c){return Ox(typeof c=="function"?c:Nr(c,h))}function e9(c){return Bx(Nr(c,h))}function t9(c,f){return Ux(c,Nr(f,h))}var i9=ut(function(c,f){return function(v){return Hl(v,c,f)}}),r9=ut(function(c,f){return function(v){return Hl(c,v,f)}});function r0(c,f,v){var E=xi(f),I=lh(f,E);v==null&&!(Qt(f)&&(I.length||!E.length))&&(v=f,f=c,c=this,I=lh(f,xi(f)));var O=!(Qt(v)&&"chain"in v)||!!v.chain,G=is(c);return Rr(I,function(H){var z=f[H];c[H]=z,G&&(c.prototype[H]=function(){var fe=this.__chain__;if(O||fe){var ge=c(this.__wrapped__),ye=ge.__actions__=tr(this.__actions__);return ye.push({func:z,args:arguments,thisArg:c}),ge.__chain__=fe,ge}return z.apply(c,ks([this.value()],arguments))})}),c}function n9(){return Ii._===this&&(Ii._=N5),this}function n0(){}function s9(c){return c=at(c),ut(function(f){return $x(f,c)})}var a9=Pm(jt),o9=Pm(ux),l9=Pm(am);function nw(c){return qm(c)?om(Tn(c)):BU(c)}function u9(c){return function(f){return c==null?t:ma(c,f)}}var c9=lT(),h9=lT(!0);function s0(){return[]}function a0(){return!1}function d9(){return{}}function f9(){return""}function g9(){return!0}function p9(c,f){if(c=at(c),c<1||c>ce)return[];var v=J,E=ki(c,J);f=He(f),c-=J;for(var I=cm(E,f);++v<c;)f(v);return I}function m9(c){return tt(c)?jt(c,Tn):mr(c)?[c]:tr(TT(wt(c)))}function y9(c){var f=++I5;return wt(c)+f}var v9=gh(function(c,f){return c+f},0),b9=Om("ceil"),E9=gh(function(c,f){return c/f},1),A9=Om("floor");function S9(c){return c&&c.length?oh(c,nr,Am):t}function x9(c,f){return c&&c.length?oh(c,He(f,2),Am):t}function T9(c){return dx(c,nr)}function w9(c,f){return dx(c,He(f,2))}function D9(c){return c&&c.length?oh(c,nr,wm):t}function R9(c,f){return c&&c.length?oh(c,He(f,2),wm):t}var I9=gh(function(c,f){return c*f},1),C9=Om("round"),N9=gh(function(c,f){return c-f},0);function L9(c){return c&&c.length?um(c,nr):0}function _9(c,f){return c&&c.length?um(c,He(f,2)):0}return k.after=e6,k.ary=PT,k.assign=G6,k.assignIn=jT,k.assignInWith=Rh,k.assignWith=q6,k.at=V6,k.before=OT,k.bind=zm,k.bindAll=z$,k.bindKey=FT,k.castArray=d6,k.chain=_T,k.chunk=A4,k.compact=S4,k.concat=x4,k.cond=j$,k.conforms=X$,k.constant=t0,k.countBy=L8,k.create=H6,k.curry=BT,k.curryRight=UT,k.debounce=$T,k.defaults=K6,k.defaultsDeep=W6,k.defer=t6,k.delay=i6,k.difference=T4,k.differenceBy=w4,k.differenceWith=D4,k.drop=R4,k.dropRight=I4,k.dropRightWhile=C4,k.dropWhile=N4,k.fill=L4,k.filter=M8,k.flatMap=O8,k.flatMapDeep=F8,k.flatMapDepth=B8,k.flatten=IT,k.flattenDeep=_4,k.flattenDepth=M4,k.flip=r6,k.flow=Q$,k.flowRight=Z$,k.fromPairs=k4,k.functions=Z6,k.functionsIn=e$,k.groupBy=U8,k.initial=O4,k.intersection=F4,k.intersectionBy=B4,k.intersectionWith=U4,k.invert=i$,k.invertBy=r$,k.invokeMap=G8,k.iteratee=i0,k.keyBy=q8,k.keys=xi,k.keysIn=rr,k.map=Ah,k.mapKeys=s$,k.mapValues=a$,k.matches=e9,k.matchesProperty=t9,k.memoize=xh,k.merge=o$,k.mergeWith=XT,k.method=i9,k.methodOf=r9,k.mixin=r0,k.negate=Th,k.nthArg=s9,k.omit=l$,k.omitBy=u$,k.once=n6,k.orderBy=V8,k.over=a9,k.overArgs=s6,k.overEvery=o9,k.overSome=l9,k.partial=jm,k.partialRight=GT,k.partition=H8,k.pick=c$,k.pickBy=JT,k.property=nw,k.propertyOf=u9,k.pull=V4,k.pullAll=NT,k.pullAllBy=H4,k.pullAllWith=K4,k.pullAt=W4,k.range=c9,k.rangeRight=h9,k.rearg=a6,k.reject=Y8,k.remove=Y4,k.rest=o6,k.reverse=Wm,k.sampleSize=j8,k.set=d$,k.setWith=f$,k.shuffle=X8,k.slice=z4,k.sortBy=Z8,k.sortedUniq=t8,k.sortedUniqBy=i8,k.split=O$,k.spread=l6,k.tail=r8,k.take=n8,k.takeRight=s8,k.takeRightWhile=a8,k.takeWhile=o8,k.tap=S8,k.throttle=u6,k.thru=Eh,k.toArray=WT,k.toPairs=QT,k.toPairsIn=ZT,k.toPath=m9,k.toPlainObject=zT,k.transform=g$,k.unary=c6,k.union=l8,k.unionBy=u8,k.unionWith=c8,k.uniq=h8,k.uniqBy=d8,k.uniqWith=f8,k.unset=p$,k.unzip=Ym,k.unzipWith=LT,k.update=m$,k.updateWith=y$,k.values=Oo,k.valuesIn=v$,k.without=g8,k.words=iw,k.wrap=h6,k.xor=p8,k.xorBy=m8,k.xorWith=y8,k.zip=v8,k.zipObject=b8,k.zipObjectDeep=E8,k.zipWith=A8,k.entries=QT,k.entriesIn=ZT,k.extend=jT,k.extendWith=Rh,r0(k,k),k.add=v9,k.attempt=rw,k.camelCase=S$,k.capitalize=ew,k.ceil=b9,k.clamp=b$,k.clone=f6,k.cloneDeep=p6,k.cloneDeepWith=m6,k.cloneWith=g6,k.conformsTo=y6,k.deburr=tw,k.defaultTo=J$,k.divide=E9,k.endsWith=x$,k.eq=Vr,k.escape=T$,k.escapeRegExp=w$,k.every=_8,k.find=k8,k.findIndex=DT,k.findKey=Y6,k.findLast=P8,k.findLastIndex=RT,k.findLastKey=z6,k.floor=A9,k.forEach=MT,k.forEachRight=kT,k.forIn=j6,k.forInRight=X6,k.forOwn=J6,k.forOwnRight=Q6,k.get=Qm,k.gt=v6,k.gte=b6,k.has=t$,k.hasIn=Zm,k.head=CT,k.identity=nr,k.includes=$8,k.indexOf=P4,k.inRange=E$,k.invoke=n$,k.isArguments=ba,k.isArray=tt,k.isArrayBuffer=E6,k.isArrayLike=ir,k.isArrayLikeObject=oi,k.isBoolean=A6,k.isBuffer=Gs,k.isDate=S6,k.isElement=x6,k.isEmpty=T6,k.isEqual=w6,k.isEqualWith=D6,k.isError=Xm,k.isFinite=R6,k.isFunction=is,k.isInteger=qT,k.isLength=wh,k.isMap=VT,k.isMatch=I6,k.isMatchWith=C6,k.isNaN=N6,k.isNative=L6,k.isNil=M6,k.isNull=_6,k.isNumber=HT,k.isObject=Qt,k.isObjectLike=ni,k.isPlainObject=Xl,k.isRegExp=Jm,k.isSafeInteger=k6,k.isSet=KT,k.isString=Dh,k.isSymbol=mr,k.isTypedArray=Po,k.isUndefined=P6,k.isWeakMap=O6,k.isWeakSet=F6,k.join=$4,k.kebabCase=D$,k.last=_r,k.lastIndexOf=G4,k.lowerCase=R$,k.lowerFirst=I$,k.lt=B6,k.lte=U6,k.max=S9,k.maxBy=x9,k.mean=T9,k.meanBy=w9,k.min=D9,k.minBy=R9,k.stubArray=s0,k.stubFalse=a0,k.stubObject=d9,k.stubString=f9,k.stubTrue=g9,k.multiply=I9,k.nth=q4,k.noConflict=n9,k.noop=n0,k.now=Sh,k.pad=C$,k.padEnd=N$,k.padStart=L$,k.parseInt=_$,k.random=A$,k.reduce=K8,k.reduceRight=W8,k.repeat=M$,k.replace=k$,k.result=h$,k.round=C9,k.runInContext=j,k.sample=z8,k.size=J8,k.snakeCase=P$,k.some=Q8,k.sortedIndex=j4,k.sortedIndexBy=X4,k.sortedIndexOf=J4,k.sortedLastIndex=Q4,k.sortedLastIndexBy=Z4,k.sortedLastIndexOf=e8,k.startCase=F$,k.startsWith=B$,k.subtract=N9,k.sum=L9,k.sumBy=_9,k.template=U$,k.times=p9,k.toFinite=rs,k.toInteger=at,k.toLength=YT,k.toLower=$$,k.toNumber=Mr,k.toSafeInteger=$6,k.toString=wt,k.toUpper=G$,k.trim=q$,k.trimEnd=V$,k.trimStart=H$,k.truncate=K$,k.unescape=W$,k.uniqueId=y9,k.upperCase=Y$,k.upperFirst=e0,k.each=MT,k.eachRight=kT,k.first=CT,r0(k,function(){var c={};return Sn(k,function(f,v){Ct.call(k.prototype,v)||(c[v]=f)}),c}(),{chain:!1}),k.VERSION=i,Rr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){k[c].placeholder=k}),Rr(["drop","take"],function(c,f){gt.prototype[c]=function(v){v=v===t?1:pi(at(v),0);var E=this.__filtered__&&!f?new gt(this):this.clone();return E.__filtered__?E.__takeCount__=ki(v,E.__takeCount__):E.__views__.push({size:ki(v,J),type:c+(E.__dir__<0?"Right":"")}),E},gt.prototype[c+"Right"]=function(v){return this.reverse()[c](v).reverse()}}),Rr(["filter","map","takeWhile"],function(c,f){var v=f+1,E=v==$||v==ae;gt.prototype[c]=function(I){var O=this.clone();return O.__iteratees__.push({iteratee:He(I,3),type:v}),O.__filtered__=O.__filtered__||E,O}}),Rr(["head","last"],function(c,f){var v="take"+(f?"Right":"");gt.prototype[c]=function(){return this[v](1).value()[0]}}),Rr(["initial","tail"],function(c,f){var v="drop"+(f?"":"Right");gt.prototype[c]=function(){return this.__filtered__?new gt(this):this[v](1)}}),gt.prototype.compact=function(){return this.filter(nr)},gt.prototype.find=function(c){return this.filter(c).head()},gt.prototype.findLast=function(c){return this.reverse().find(c)},gt.prototype.invokeMap=ut(function(c,f){return typeof c=="function"?new gt(this):this.map(function(v){return Hl(v,c,f)})}),gt.prototype.reject=function(c){return this.filter(Th(He(c)))},gt.prototype.slice=function(c,f){c=at(c);var v=this;return v.__filtered__&&(c>0||f<0)?new gt(v):(c<0?v=v.takeRight(-c):c&&(v=v.drop(c)),f!==t&&(f=at(f),v=f<0?v.dropRight(-f):v.take(f-c)),v)},gt.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},gt.prototype.toArray=function(){return this.take(J)},Sn(gt.prototype,function(c,f){var v=/^(?:filter|find|map|reject)|While$/.test(f),E=/^(?:head|last)$/.test(f),I=k[E?"take"+(f=="last"?"Right":""):f],O=E||/^find/.test(f);I&&(k.prototype[f]=function(){var G=this.__wrapped__,H=E?[1]:arguments,z=G instanceof gt,fe=H[0],ge=z||tt(G),ye=function(dt){var mt=I.apply(k,ks([dt],H));return E&&Ne?mt[0]:mt};ge&&v&&typeof fe=="function"&&fe.length!=1&&(z=ge=!1);var Ne=this.__chain__,Ge=!!this.__actions__.length,ze=O&&!Ne,lt=z&&!Ge;if(!O&&ge){G=lt?G:new gt(this);var Ye=c.apply(G,H);return Ye.__actions__.push({func:Eh,args:[ye],thisArg:t}),new Cr(Ye,Ne)}return ze&&lt?c.apply(this,H):(Ye=this.thru(ye),ze?E?Ye.value()[0]:Ye.value():Ye)})}),Rr(["pop","push","shift","sort","splice","unshift"],function(c){var f=Wc[c],v=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",E=/^(?:pop|shift)$/.test(c);k.prototype[c]=function(){var I=arguments;if(E&&!this.__chain__){var O=this.value();return f.apply(tt(O)?O:[],I)}return this[v](function(G){return f.apply(tt(G)?G:[],I)})}}),Sn(gt.prototype,function(c,f){var v=k[f];if(v){var E=v.name+"";Ct.call(No,E)||(No[E]=[]),No[E].push({name:f,func:v})}}),No[fh(t,b).name]=[{name:"wrapper",func:t}],gt.prototype.clone=W5,gt.prototype.reverse=Y5,gt.prototype.value=z5,k.prototype.at=x8,k.prototype.chain=T8,k.prototype.commit=w8,k.prototype.next=D8,k.prototype.plant=I8,k.prototype.reverse=C8,k.prototype.toJSON=k.prototype.valueOf=k.prototype.value=N8,k.prototype.first=k.prototype.head,Fl&&(k.prototype[Fl]=R8),k},Ro=w5();ha?((ha.exports=Ro)._=Ro,im._=Ro):Ii._=Ro}).call(uI)}(tl,tl.exports)),tl.exports}var hI=cI();const _t=ms(hI);var qd,qv;function qa(){return qv||(qv=1,qd=TypeError),qd}const Vd=lI(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Hd,Vv;function Cu(){if(Vv)return Hd;Vv=1;var n=typeof Map=="function"&&Map.prototype,e=Object.getOwnPropertyDescriptor&&n?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,t=n&&e&&typeof e.get=="function"?e.get:null,i=n&&Map.prototype.forEach,r=typeof Set=="function"&&Set.prototype,s=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,a=r&&s&&typeof s.get=="function"?s.get:null,o=r&&Set.prototype.forEach,l=typeof WeakMap=="function"&&WeakMap.prototype,u=l?WeakMap.prototype.has:null,h=typeof WeakSet=="function"&&WeakSet.prototype,d=h?WeakSet.prototype.has:null,p=typeof WeakRef=="function"&&WeakRef.prototype,g=p?WeakRef.prototype.deref:null,m=Boolean.prototype.valueOf,y=Object.prototype.toString,b=Function.prototype.toString,A=String.prototype.match,w=String.prototype.slice,x=String.prototype.replace,N=String.prototype.toUpperCase,F=String.prototype.toLowerCase,L=RegExp.prototype.test,C=Array.prototype.concat,M=Array.prototype.join,_=Array.prototype.slice,R=Math.floor,U=typeof BigInt=="function"?BigInt.prototype.valueOf:null,q=Object.getOwnPropertySymbols,$=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Y=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ae=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Y||!0)?Symbol.toStringTag:null,ne=Object.prototype.propertyIsEnumerable,ce=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(ee){return ee.__proto__}:null);function re(ee,te){if(ee===1/0||ee===-1/0||ee!==ee||ee&&ee>-1e3&&ee<1e3||L.call(/e/,te))return te;var yt=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof ee=="number"){var Nt=ee<0?-R(-ee):R(ee);if(Nt!==ee){var Lt=String(Nt),st=w.call(te,Lt.length+1);return x.call(Lt,yt,"$&_")+"."+x.call(x.call(st,/([0-9]{3})/g,"$&_"),/_$/,"")}}return x.call(te,yt,"$&_")}var V=Vd,J=V.custom,ve=Ae(J)?J:null,pe={__proto__:null,double:'"',single:"'"},Te={__proto__:null,double:/(["\\])/g,single:/(['\\])/g};Hd=function ee(te,yt,Nt,Lt){var st=yt||{};if(Ie(st,"quoteStyle")&&!Ie(pe,st.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ie(st,"maxStringLength")&&(typeof st.maxStringLength=="number"?st.maxStringLength<0&&st.maxStringLength!==1/0:st.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var En=Ie(st,"customInspect")?st.customInspect:!0;if(typeof En!="boolean"&&En!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ie(st,"indent")&&st.indent!==null&&st.indent!=="	"&&!(parseInt(st.indent,10)===st.indent&&st.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ie(st,"numericSeparator")&&typeof st.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var jn=st.numericSeparator;if(typeof te>"u")return"undefined";if(te===null)return"null";if(typeof te=="boolean")return te?"true":"false";if(typeof te=="string")return le(te,st);if(typeof te=="number"){if(te===0)return 1/0/te>0?"0":"-0";var Wi=String(te);return jn?re(te,Wi):Wi}if(typeof te=="bigint"){var An=String(te)+"n";return jn?re(te,An):An}var yo=typeof st.depth>"u"?5:st.depth;if(typeof Nt>"u"&&(Nt=0),Nt>=yo&&yo>0&&typeof te=="object")return Ue(te)?"[Array]":"[Object]";var Ns=Ve(st,Nt);if(typeof Lt>"u")Lt=[];else if(K(Lt,te)>=0)return"[Circular]";function dr(_s,So,Xp){if(So&&(Lt=_.call(Lt),Lt.push(So)),Xp){var ca={depth:st.depth};return Ie(st,"quoteStyle")&&(ca.quoteStyle=st.quoteStyle),ee(_s,ca,Nt+1,Lt)}return ee(_s,st,Nt+1,Lt)}if(typeof te=="function"&&!Ze(te)){var Pc=ue(te),vo=wr(te,dr);return"[Function"+(Pc?": "+Pc:" (anonymous)")+"]"+(vo.length>0?" { "+M.call(vo,", ")+" }":"")}if(Ae(te)){var Oc=Y?x.call(String(te),/^(Symbol\(.*\))_[^)]*$/,"$1"):$.call(te);return typeof te=="object"&&!Y?We(Oc):Oc}if(se(te)){for(var Ls="<"+F.call(String(te.nodeName)),bo=te.attributes||[],Eo=0;Eo<bo.length;Eo++)Ls+=" "+bo[Eo].name+"="+Ce(Re(bo[Eo].value),"double",st);return Ls+=">",te.childNodes&&te.childNodes.length&&(Ls+="..."),Ls+="</"+F.call(String(te.nodeName))+">",Ls}if(Ue(te)){if(te.length===0)return"[]";var _l=wr(te,dr);return Ns&&!ft(_l)?"["+Si(_l,Ns)+"]":"[ "+M.call(_l,", ")+" ]"}if(qe(te)){var Ml=wr(te,dr);return!("cause"in Error.prototype)&&"cause"in te&&!ne.call(te,"cause")?"{ ["+String(te)+"] "+M.call(C.call("[cause]: "+dr(te.cause),Ml),", ")+" }":Ml.length===0?"["+String(te)+"]":"{ ["+String(te)+"] "+M.call(Ml,", ")+" }"}if(typeof te=="object"&&En){if(ve&&typeof te[ve]=="function"&&V)return V(te,{depth:yo-Nt});if(En!=="symbol"&&typeof te.inspect=="function")return te.inspect()}if(D(te)){var Fc=[];return i&&i.call(te,function(_s,So){Fc.push(dr(So,te,!0)+" => "+dr(_s,te))}),kt("Map",t.call(te),Fc,Ns)}if(W(te)){var Bc=[];return o&&o.call(te,function(_s){Bc.push(dr(_s,te))}),kt("Set",a.call(te),Bc,Ns)}if(S(te))return ri("WeakMap");if(Se(te))return ri("WeakSet");if(P(te))return ri("WeakRef");if(B(te))return We(dr(Number(te)));if(be(te))return We(dr(U.call(te)));if(oe(te))return We(m.call(te));if(nt(te))return We(dr(String(te)));if(typeof window<"u"&&te===window)return"{ [object Window] }";if(typeof globalThis<"u"&&te===globalThis||typeof Or<"u"&&te===Or)return"{ [object globalThis] }";if(!Qe(te)&&!Ze(te)){var kl=wr(te,dr),Uc=ce?ce(te)===Object.prototype:te instanceof Object||te.constructor===Object,Ao=te instanceof Object?"":"null prototype",$c=!Uc&&ae&&Object(te)===te&&ae in te?w.call(Me(te),8,-1):Ao?"Object":"",jp=Uc||typeof te.constructor!="function"?"":te.constructor.name?te.constructor.name+" ":"",Pl=jp+($c||Ao?"["+M.call(C.call([],$c||[],Ao||[]),": ")+"] ":"");return kl.length===0?Pl+"{}":Ns?Pl+"{"+Si(kl,Ns)+"}":Pl+"{ "+M.call(kl,", ")+" }"}return String(te)};function Ce(ee,te,yt){var Nt=yt.quoteStyle||te,Lt=pe[Nt];return Lt+ee+Lt}function Re(ee){return x.call(String(ee),/"/g,"&quot;")}function Be(ee){return!ae||!(typeof ee=="object"&&(ae in ee||typeof ee[ae]<"u"))}function Ue(ee){return Me(ee)==="[object Array]"&&Be(ee)}function Qe(ee){return Me(ee)==="[object Date]"&&Be(ee)}function Ze(ee){return Me(ee)==="[object RegExp]"&&Be(ee)}function qe(ee){return Me(ee)==="[object Error]"&&Be(ee)}function nt(ee){return Me(ee)==="[object String]"&&Be(ee)}function B(ee){return Me(ee)==="[object Number]"&&Be(ee)}function oe(ee){return Me(ee)==="[object Boolean]"&&Be(ee)}function Ae(ee){if(Y)return ee&&typeof ee=="object"&&ee instanceof Symbol;if(typeof ee=="symbol")return!0;if(!ee||typeof ee!="object"||!$)return!1;try{return $.call(ee),!0}catch{}return!1}function be(ee){if(!ee||typeof ee!="object"||!U)return!1;try{return U.call(ee),!0}catch{}return!1}var me=Object.prototype.hasOwnProperty||function(ee){return ee in this};function Ie(ee,te){return me.call(ee,te)}function Me(ee){return y.call(ee)}function ue(ee){if(ee.name)return ee.name;var te=A.call(b.call(ee),/^function\s*([\w$]+)/);return te?te[1]:null}function K(ee,te){if(ee.indexOf)return ee.indexOf(te);for(var yt=0,Nt=ee.length;yt<Nt;yt++)if(ee[yt]===te)return yt;return-1}function D(ee){if(!t||!ee||typeof ee!="object")return!1;try{t.call(ee);try{a.call(ee)}catch{return!0}return ee instanceof Map}catch{}return!1}function S(ee){if(!u||!ee||typeof ee!="object")return!1;try{u.call(ee,u);try{d.call(ee,d)}catch{return!0}return ee instanceof WeakMap}catch{}return!1}function P(ee){if(!g||!ee||typeof ee!="object")return!1;try{return g.call(ee),!0}catch{}return!1}function W(ee){if(!a||!ee||typeof ee!="object")return!1;try{a.call(ee);try{t.call(ee)}catch{return!0}return ee instanceof Set}catch{}return!1}function Se(ee){if(!d||!ee||typeof ee!="object")return!1;try{d.call(ee,d);try{u.call(ee,u)}catch{return!0}return ee instanceof WeakSet}catch{}return!1}function se(ee){return!ee||typeof ee!="object"?!1:typeof HTMLElement<"u"&&ee instanceof HTMLElement?!0:typeof ee.nodeName=="string"&&typeof ee.getAttribute=="function"}function le(ee,te){if(ee.length>te.maxStringLength){var yt=ee.length-te.maxStringLength,Nt="... "+yt+" more character"+(yt>1?"s":"");return le(w.call(ee,0,te.maxStringLength),te)+Nt}var Lt=Te[te.quoteStyle||"single"];Lt.lastIndex=0;var st=x.call(x.call(ee,Lt,"\\$1"),/[\x00-\x1f]/g,xe);return Ce(st,"single",te)}function xe(ee){var te=ee.charCodeAt(0),yt={8:"b",9:"t",10:"n",12:"f",13:"r"}[te];return yt?"\\"+yt:"\\x"+(te<16?"0":"")+N.call(te.toString(16))}function We(ee){return"Object("+ee+")"}function ri(ee){return ee+" { ? }"}function kt(ee,te,yt,Nt){var Lt=Nt?Si(yt,Nt):M.call(yt,", ");return ee+" ("+te+") {"+Lt+"}"}function ft(ee){for(var te=0;te<ee.length;te++)if(K(ee[te],`
`)>=0)return!1;return!0}function Ve(ee,te){var yt;if(ee.indent==="	")yt="	";else if(typeof ee.indent=="number"&&ee.indent>0)yt=M.call(Array(ee.indent+1)," ");else return null;return{base:yt,prev:M.call(Array(te+1),yt)}}function Si(ee,te){if(ee.length===0)return"";var yt=`
`+te.prev+te.base;return yt+M.call(ee,","+yt)+`
`+te.prev}function wr(ee,te){var yt=Ue(ee),Nt=[];if(yt){Nt.length=ee.length;for(var Lt=0;Lt<ee.length;Lt++)Nt[Lt]=Ie(ee,Lt)?te(ee[Lt],ee):""}var st=typeof q=="function"?q(ee):[],En;if(Y){En={};for(var jn=0;jn<st.length;jn++)En["$"+st[jn]]=st[jn]}for(var Wi in ee)Ie(ee,Wi)&&(yt&&String(Number(Wi))===Wi&&Wi<ee.length||Y&&En["$"+Wi]instanceof Symbol||(L.call(/[^\w$]/,Wi)?Nt.push(te(Wi,ee)+": "+te(ee[Wi],ee)):Nt.push(Wi+": "+te(ee[Wi],ee))));if(typeof q=="function")for(var An=0;An<st.length;An++)ne.call(ee,st[An])&&Nt.push("["+te(st[An])+"]: "+te(ee[st[An]],ee));return Nt}return Hd}var Kd,Hv;function dI(){if(Hv)return Kd;Hv=1;var n=Cu(),e=qa(),t=function(o,l,u){for(var h=o,d;(d=h.next)!=null;h=d)if(d.key===l)return h.next=d.next,u||(d.next=o.next,o.next=d),d},i=function(o,l){if(o){var u=t(o,l);return u&&u.value}},r=function(o,l,u){var h=t(o,l);h?h.value=u:o.next={key:l,next:o.next,value:u}},s=function(o,l){return o?!!t(o,l):!1},a=function(o,l){if(o)return t(o,l,!0)};return Kd=function(){var l,u={assert:function(h){if(!u.has(h))throw new e("Side channel does not contain "+n(h))},delete:function(h){var d=l&&l.next,p=a(l,h);return p&&d&&d===p&&(l=void 0),!!p},get:function(h){return i(l,h)},has:function(h){return s(l,h)},set:function(h,d){l||(l={next:void 0}),r(l,h,d)}};return u},Kd}var Wd,Kv;function Wv(){return Kv||(Kv=1,Wd=Object),Wd}var Yd,Yv;function fI(){return Yv||(Yv=1,Yd=Error),Yd}var zd,zv;function gI(){return zv||(zv=1,zd=EvalError),zd}var jd,jv;function pI(){return jv||(jv=1,jd=RangeError),jd}var Xd,Xv;function mI(){return Xv||(Xv=1,Xd=ReferenceError),Xd}var Jd,Jv;function yI(){return Jv||(Jv=1,Jd=SyntaxError),Jd}var Qd,Qv;function vI(){return Qv||(Qv=1,Qd=URIError),Qd}var Zd,Zv;function bI(){return Zv||(Zv=1,Zd=Math.abs),Zd}var ef,eb;function EI(){return eb||(eb=1,ef=Math.floor),ef}var tf,tb;function AI(){return tb||(tb=1,tf=Math.max),tf}var rf,ib;function SI(){return ib||(ib=1,rf=Math.min),rf}var nf,rb;function xI(){return rb||(rb=1,nf=Math.pow),nf}var sf,nb;function TI(){return nb||(nb=1,sf=Math.round),sf}var af,sb;function wI(){return sb||(sb=1,af=Number.isNaN||function(e){return e!==e}),af}var of,ab;function DI(){if(ab)return of;ab=1;var n=wI();return of=function(t){return n(t)||t===0?t:t<0?-1:1},of}var lf,ob;function RI(){return ob||(ob=1,lf=Object.getOwnPropertyDescriptor),lf}var uf,lb;function ub(){if(lb)return uf;lb=1;var n=RI();if(n)try{n([],"length")}catch{n=null}return uf=n,uf}var cf,cb;function II(){if(cb)return cf;cb=1;var n=Object.defineProperty||!1;if(n)try{n({},"a",{value:1})}catch{n=!1}return cf=n,cf}var hf,hb;function CI(){return hb||(hb=1,hf=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),i=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(i)!=="[object Symbol]")return!1;var r=42;e[t]=r;for(var s in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var a=Object.getOwnPropertySymbols(e);if(a.length!==1||a[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,t);if(o.value!==r||o.enumerable!==!0)return!1}return!0}),hf}var df,db;function NI(){if(db)return df;db=1;var n=typeof Symbol<"u"&&Symbol,e=CI();return df=function(){return typeof n!="function"||typeof Symbol!="function"||typeof n("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},df}var ff,fb;function gb(){return fb||(fb=1,ff=typeof Reflect<"u"&&Reflect.getPrototypeOf||null),ff}var gf,pb;function mb(){if(pb)return gf;pb=1;var n=Wv();return gf=n.getPrototypeOf||null,gf}var pf,yb;function LI(){if(yb)return pf;yb=1;var n="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,t=Math.max,i="[object Function]",r=function(l,u){for(var h=[],d=0;d<l.length;d+=1)h[d]=l[d];for(var p=0;p<u.length;p+=1)h[p+l.length]=u[p];return h},s=function(l,u){for(var h=[],d=u,p=0;d<l.length;d+=1,p+=1)h[p]=l[d];return h},a=function(o,l){for(var u="",h=0;h<o.length;h+=1)u+=o[h],h+1<o.length&&(u+=l);return u};return pf=function(l){var u=this;if(typeof u!="function"||e.apply(u)!==i)throw new TypeError(n+u);for(var h=s(arguments,1),d,p=function(){if(this instanceof d){var A=u.apply(this,r(h,arguments));return Object(A)===A?A:this}return u.apply(l,r(h,arguments))},g=t(0,u.length-h.length),m=[],y=0;y<g;y++)m[y]="$"+y;if(d=Function("binder","return function ("+a(m,",")+"){ return binder.apply(this,arguments); }")(p),u.prototype){var b=function(){};b.prototype=u.prototype,d.prototype=new b,b.prototype=null}return d},pf}var mf,vb;function Nu(){if(vb)return mf;vb=1;var n=LI();return mf=Function.prototype.bind||n,mf}var yf,bb;function vf(){return bb||(bb=1,yf=Function.prototype.call),yf}var bf,Eb;function Ab(){return Eb||(Eb=1,bf=Function.prototype.apply),bf}var Ef,Sb;function _I(){return Sb||(Sb=1,Ef=typeof Reflect<"u"&&Reflect&&Reflect.apply),Ef}var Af,xb;function MI(){if(xb)return Af;xb=1;var n=Nu(),e=Ab(),t=vf(),i=_I();return Af=i||n.call(t,e),Af}var Sf,Tb;function wb(){if(Tb)return Sf;Tb=1;var n=Nu(),e=qa(),t=vf(),i=MI();return Sf=function(s){if(s.length<1||typeof s[0]!="function")throw new e("a function is required");return i(n,t,s)},Sf}var xf,Db;function kI(){if(Db)return xf;Db=1;var n=wb(),e=ub(),t;try{t=[].__proto__===Array.prototype}catch(a){if(!a||typeof a!="object"||!("code"in a)||a.code!=="ERR_PROTO_ACCESS")throw a}var i=!!t&&e&&e(Object.prototype,"__proto__"),r=Object,s=r.getPrototypeOf;return xf=i&&typeof i.get=="function"?n([i.get]):typeof s=="function"?function(o){return s(o==null?o:r(o))}:!1,xf}var Tf,Rb;function PI(){if(Rb)return Tf;Rb=1;var n=gb(),e=mb(),t=kI();return Tf=n?function(r){return n(r)}:e?function(r){if(!r||typeof r!="object"&&typeof r!="function")throw new TypeError("getProto: not an object");return e(r)}:t?function(r){return t(r)}:null,Tf}var wf,Ib;function OI(){if(Ib)return wf;Ib=1;var n=Function.prototype.call,e=Object.prototype.hasOwnProperty,t=Nu();return wf=t.call(n,e),wf}var Df,Cb;function Rf(){if(Cb)return Df;Cb=1;var n,e=Wv(),t=fI(),i=gI(),r=pI(),s=mI(),a=yI(),o=qa(),l=vI(),u=bI(),h=EI(),d=AI(),p=SI(),g=xI(),m=TI(),y=DI(),b=Function,A=function(Ze){try{return b('"use strict"; return ('+Ze+").constructor;")()}catch{}},w=ub(),x=II(),N=function(){throw new o},F=w?function(){try{return arguments.callee,N}catch{try{return w(arguments,"callee").get}catch{return N}}}():N,L=NI()(),C=PI(),M=mb(),_=gb(),R=Ab(),U=vf(),q={},$=typeof Uint8Array>"u"||!C?n:C(Uint8Array),Y={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?n:ArrayBuffer,"%ArrayIteratorPrototype%":L&&C?C([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":q,"%AsyncGenerator%":q,"%AsyncGeneratorFunction%":q,"%AsyncIteratorPrototype%":q,"%Atomics%":typeof Atomics>"u"?n:Atomics,"%BigInt%":typeof BigInt>"u"?n:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?n:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?n:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":t,"%eval%":eval,"%EvalError%":i,"%Float16Array%":typeof Float16Array>"u"?n:Float16Array,"%Float32Array%":typeof Float32Array>"u"?n:Float32Array,"%Float64Array%":typeof Float64Array>"u"?n:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?n:FinalizationRegistry,"%Function%":b,"%GeneratorFunction%":q,"%Int8Array%":typeof Int8Array>"u"?n:Int8Array,"%Int16Array%":typeof Int16Array>"u"?n:Int16Array,"%Int32Array%":typeof Int32Array>"u"?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":L&&C?C(C([][Symbol.iterator]())):n,"%JSON%":typeof JSON=="object"?JSON:n,"%Map%":typeof Map>"u"?n:Map,"%MapIteratorPrototype%":typeof Map>"u"||!L||!C?n:C(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":e,"%Object.getOwnPropertyDescriptor%":w,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?n:Promise,"%Proxy%":typeof Proxy>"u"?n:Proxy,"%RangeError%":r,"%ReferenceError%":s,"%Reflect%":typeof Reflect>"u"?n:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?n:Set,"%SetIteratorPrototype%":typeof Set>"u"||!L||!C?n:C(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":L&&C?C(""[Symbol.iterator]()):n,"%Symbol%":L?Symbol:n,"%SyntaxError%":a,"%ThrowTypeError%":F,"%TypedArray%":$,"%TypeError%":o,"%Uint8Array%":typeof Uint8Array>"u"?n:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?n:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?n:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?n:Uint32Array,"%URIError%":l,"%WeakMap%":typeof WeakMap>"u"?n:WeakMap,"%WeakRef%":typeof WeakRef>"u"?n:WeakRef,"%WeakSet%":typeof WeakSet>"u"?n:WeakSet,"%Function.prototype.call%":U,"%Function.prototype.apply%":R,"%Object.defineProperty%":x,"%Object.getPrototypeOf%":M,"%Math.abs%":u,"%Math.floor%":h,"%Math.max%":d,"%Math.min%":p,"%Math.pow%":g,"%Math.round%":m,"%Math.sign%":y,"%Reflect.getPrototypeOf%":_};if(C)try{null.error}catch(Ze){var ae=C(C(Ze));Y["%Error.prototype%"]=ae}var ne=function Ze(qe){var nt;if(qe==="%AsyncFunction%")nt=A("async function () {}");else if(qe==="%GeneratorFunction%")nt=A("function* () {}");else if(qe==="%AsyncGeneratorFunction%")nt=A("async function* () {}");else if(qe==="%AsyncGenerator%"){var B=Ze("%AsyncGeneratorFunction%");B&&(nt=B.prototype)}else if(qe==="%AsyncIteratorPrototype%"){var oe=Ze("%AsyncGenerator%");oe&&C&&(nt=C(oe.prototype))}return Y[qe]=nt,nt},ce={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},re=Nu(),V=OI(),J=re.call(U,Array.prototype.concat),ve=re.call(R,Array.prototype.splice),pe=re.call(U,String.prototype.replace),Te=re.call(U,String.prototype.slice),Ce=re.call(U,RegExp.prototype.exec),Re=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Be=/\\(\\)?/g,Ue=function(qe){var nt=Te(qe,0,1),B=Te(qe,-1);if(nt==="%"&&B!=="%")throw new a("invalid intrinsic syntax, expected closing `%`");if(B==="%"&&nt!=="%")throw new a("invalid intrinsic syntax, expected opening `%`");var oe=[];return pe(qe,Re,function(Ae,be,me,Ie){oe[oe.length]=me?pe(Ie,Be,"$1"):be||Ae}),oe},Qe=function(qe,nt){var B=qe,oe;if(V(ce,B)&&(oe=ce[B],B="%"+oe[0]+"%"),V(Y,B)){var Ae=Y[B];if(Ae===q&&(Ae=ne(B)),typeof Ae>"u"&&!nt)throw new o("intrinsic "+qe+" exists, but is not available. Please file an issue!");return{alias:oe,name:B,value:Ae}}throw new a("intrinsic "+qe+" does not exist!")};return Df=function(qe,nt){if(typeof qe!="string"||qe.length===0)throw new o("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof nt!="boolean")throw new o('"allowMissing" argument must be a boolean');if(Ce(/^%?[^%]*%?$/,qe)===null)throw new a("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var B=Ue(qe),oe=B.length>0?B[0]:"",Ae=Qe("%"+oe+"%",nt),be=Ae.name,me=Ae.value,Ie=!1,Me=Ae.alias;Me&&(oe=Me[0],ve(B,J([0,1],Me)));for(var ue=1,K=!0;ue<B.length;ue+=1){var D=B[ue],S=Te(D,0,1),P=Te(D,-1);if((S==='"'||S==="'"||S==="`"||P==='"'||P==="'"||P==="`")&&S!==P)throw new a("property names with quotes must have matching quotes");if((D==="constructor"||!K)&&(Ie=!0),oe+="."+D,be="%"+oe+"%",V(Y,be))me=Y[be];else if(me!=null){if(!(D in me)){if(!nt)throw new o("base intrinsic for "+qe+" exists, but the property is not available.");return}if(w&&ue+1>=B.length){var W=w(me,D);K=!!W,K&&"get"in W&&!("originalValue"in W.get)?me=W.get:me=me[D]}else K=V(me,D),me=me[D];K&&!Ie&&(Y[be]=me)}}return me},Df}var If,Nb;function Lb(){if(Nb)return If;Nb=1;var n=Rf(),e=wb(),t=e([n("%String.prototype.indexOf%")]);return If=function(r,s){var a=n(r,!!s);return typeof a=="function"&&t(r,".prototype.")>-1?e([a]):a},If}var Cf,_b;function Mb(){if(_b)return Cf;_b=1;var n=Rf(),e=Lb(),t=Cu(),i=qa(),r=n("%Map%",!0),s=e("Map.prototype.get",!0),a=e("Map.prototype.set",!0),o=e("Map.prototype.has",!0),l=e("Map.prototype.delete",!0),u=e("Map.prototype.size",!0);return Cf=!!r&&function(){var d,p={assert:function(g){if(!p.has(g))throw new i("Side channel does not contain "+t(g))},delete:function(g){if(d){var m=l(d,g);return u(d)===0&&(d=void 0),m}return!1},get:function(g){if(d)return s(d,g)},has:function(g){return d?o(d,g):!1},set:function(g,m){d||(d=new r),a(d,g,m)}};return p},Cf}var Nf,kb;function FI(){if(kb)return Nf;kb=1;var n=Rf(),e=Lb(),t=Cu(),i=Mb(),r=qa(),s=n("%WeakMap%",!0),a=e("WeakMap.prototype.get",!0),o=e("WeakMap.prototype.set",!0),l=e("WeakMap.prototype.has",!0),u=e("WeakMap.prototype.delete",!0);return Nf=s?function(){var d,p,g={assert:function(m){if(!g.has(m))throw new r("Side channel does not contain "+t(m))},delete:function(m){if(s&&m&&(typeof m=="object"||typeof m=="function")){if(d)return u(d,m)}else if(i&&p)return p.delete(m);return!1},get:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&d?a(d,m):p&&p.get(m)},has:function(m){return s&&m&&(typeof m=="object"||typeof m=="function")&&d?l(d,m):!!p&&p.has(m)},set:function(m,y){s&&m&&(typeof m=="object"||typeof m=="function")?(d||(d=new s),o(d,m,y)):i&&(p||(p=i()),p.set(m,y))}};return g}:i,Nf}var Lf,Pb;function BI(){if(Pb)return Lf;Pb=1;var n=qa(),e=Cu(),t=dI(),i=Mb(),r=FI(),s=r||i||t;return Lf=function(){var o,l={assert:function(u){if(!l.has(u))throw new n("Side channel does not contain "+e(u))},delete:function(u){return!!o&&o.delete(u)},get:function(u){return o&&o.get(u)},has:function(u){return!!o&&o.has(u)},set:function(u,h){o||(o=s()),o.set(u,h)}};return l},Lf}var _f,Ob;function Mf(){if(Ob)return _f;Ob=1;var n=String.prototype.replace,e=/%20/g,t={RFC1738:"RFC1738",RFC3986:"RFC3986"};return _f={default:t.RFC3986,formatters:{RFC1738:function(i){return n.call(i,e,"+")},RFC3986:function(i){return String(i)}},RFC1738:t.RFC1738,RFC3986:t.RFC3986},_f}var kf,Fb;function Bb(){if(Fb)return kf;Fb=1;var n=Mf(),e=Object.prototype.hasOwnProperty,t=Array.isArray,i=function(){for(var b=[],A=0;A<256;++A)b.push("%"+((A<16?"0":"")+A.toString(16)).toUpperCase());return b}(),r=function(A){for(;A.length>1;){var w=A.pop(),x=w.obj[w.prop];if(t(x)){for(var N=[],F=0;F<x.length;++F)typeof x[F]<"u"&&N.push(x[F]);w.obj[w.prop]=N}}},s=function(A,w){for(var x=w&&w.plainObjects?{__proto__:null}:{},N=0;N<A.length;++N)typeof A[N]<"u"&&(x[N]=A[N]);return x},a=function b(A,w,x){if(!w)return A;if(typeof w!="object"&&typeof w!="function"){if(t(A))A.push(w);else if(A&&typeof A=="object")(x&&(x.plainObjects||x.allowPrototypes)||!e.call(Object.prototype,w))&&(A[w]=!0);else return[A,w];return A}if(!A||typeof A!="object")return[A].concat(w);var N=A;return t(A)&&!t(w)&&(N=s(A,x)),t(A)&&t(w)?(w.forEach(function(F,L){if(e.call(A,L)){var C=A[L];C&&typeof C=="object"&&F&&typeof F=="object"?A[L]=b(C,F,x):A.push(F)}else A[L]=F}),A):Object.keys(w).reduce(function(F,L){var C=w[L];return e.call(F,L)?F[L]=b(F[L],C,x):F[L]=C,F},N)},o=function(A,w){return Object.keys(w).reduce(function(x,N){return x[N]=w[N],x},A)},l=function(b,A,w){var x=b.replace(/\+/g," ");if(w==="iso-8859-1")return x.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(x)}catch{return x}},u=1024,h=function(A,w,x,N,F){if(A.length===0)return A;var L=A;if(typeof A=="symbol"?L=Symbol.prototype.toString.call(A):typeof A!="string"&&(L=String(A)),x==="iso-8859-1")return escape(L).replace(/%u[0-9a-f]{4}/gi,function($){return"%26%23"+parseInt($.slice(2),16)+"%3B"});for(var C="",M=0;M<L.length;M+=u){for(var _=L.length>=u?L.slice(M,M+u):L,R=[],U=0;U<_.length;++U){var q=_.charCodeAt(U);if(q===45||q===46||q===95||q===126||q>=48&&q<=57||q>=65&&q<=90||q>=97&&q<=122||F===n.RFC1738&&(q===40||q===41)){R[R.length]=_.charAt(U);continue}if(q<128){R[R.length]=i[q];continue}if(q<2048){R[R.length]=i[192|q>>6]+i[128|q&63];continue}if(q<55296||q>=57344){R[R.length]=i[224|q>>12]+i[128|q>>6&63]+i[128|q&63];continue}U+=1,q=65536+((q&1023)<<10|_.charCodeAt(U)&1023),R[R.length]=i[240|q>>18]+i[128|q>>12&63]+i[128|q>>6&63]+i[128|q&63]}C+=R.join("")}return C},d=function(A){for(var w=[{obj:{o:A},prop:"o"}],x=[],N=0;N<w.length;++N)for(var F=w[N],L=F.obj[F.prop],C=Object.keys(L),M=0;M<C.length;++M){var _=C[M],R=L[_];typeof R=="object"&&R!==null&&x.indexOf(R)===-1&&(w.push({obj:L,prop:_}),x.push(R))}return r(w),A},p=function(A){return Object.prototype.toString.call(A)==="[object RegExp]"},g=function(A){return!A||typeof A!="object"?!1:!!(A.constructor&&A.constructor.isBuffer&&A.constructor.isBuffer(A))},m=function(A,w){return[].concat(A,w)},y=function(A,w){if(t(A)){for(var x=[],N=0;N<A.length;N+=1)x.push(w(A[N]));return x}return w(A)};return kf={arrayToObject:s,assign:o,combine:m,compact:d,decode:l,encode:h,isBuffer:g,isRegExp:p,maybeMap:y,merge:a},kf}var Pf,Ub;function UI(){if(Ub)return Pf;Ub=1;var n=BI(),e=Bb(),t=Mf(),i=Object.prototype.hasOwnProperty,r={brackets:function(b){return b+"[]"},comma:"comma",indices:function(b,A){return b+"["+A+"]"},repeat:function(b){return b}},s=Array.isArray,a=Array.prototype.push,o=function(y,b){a.apply(y,s(b)?b:[b])},l=Date.prototype.toISOString,u=t.default,h={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,commaRoundTrip:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:e.encode,encodeValuesOnly:!1,filter:void 0,format:u,formatter:t.formatters[u],indices:!1,serializeDate:function(b){return l.call(b)},skipNulls:!1,strictNullHandling:!1},d=function(b){return typeof b=="string"||typeof b=="number"||typeof b=="boolean"||typeof b=="symbol"||typeof b=="bigint"},p={},g=function y(b,A,w,x,N,F,L,C,M,_,R,U,q,$,Y,ae,ne,ce){for(var re=b,V=ce,J=0,ve=!1;(V=V.get(p))!==void 0&&!ve;){var pe=V.get(b);if(J+=1,typeof pe<"u"){if(pe===J)throw new RangeError("Cyclic object value");ve=!0}typeof V.get(p)>"u"&&(J=0)}if(typeof _=="function"?re=_(A,re):re instanceof Date?re=q(re):w==="comma"&&s(re)&&(re=e.maybeMap(re,function(be){return be instanceof Date?q(be):be})),re===null){if(F)return M&&!ae?M(A,h.encoder,ne,"key",$):A;re=""}if(d(re)||e.isBuffer(re)){if(M){var Te=ae?A:M(A,h.encoder,ne,"key",$);return[Y(Te)+"="+Y(M(re,h.encoder,ne,"value",$))]}return[Y(A)+"="+Y(String(re))]}var Ce=[];if(typeof re>"u")return Ce;var Re;if(w==="comma"&&s(re))ae&&M&&(re=e.maybeMap(re,M)),Re=[{value:re.length>0?re.join(",")||null:void 0}];else if(s(_))Re=_;else{var Be=Object.keys(re);Re=R?Be.sort(R):Be}var Ue=C?String(A).replace(/\./g,"%2E"):String(A),Qe=x&&s(re)&&re.length===1?Ue+"[]":Ue;if(N&&s(re)&&re.length===0)return Qe+"[]";for(var Ze=0;Ze<Re.length;++Ze){var qe=Re[Ze],nt=typeof qe=="object"&&qe&&typeof qe.value<"u"?qe.value:re[qe];if(!(L&&nt===null)){var B=U&&C?String(qe).replace(/\./g,"%2E"):String(qe),oe=s(re)?typeof w=="function"?w(Qe,B):Qe:Qe+(U?"."+B:"["+B+"]");ce.set(b,J);var Ae=n();Ae.set(p,ce),o(Ce,y(nt,oe,w,x,N,F,L,C,w==="comma"&&ae&&s(re)?null:M,_,R,U,q,$,Y,ae,ne,Ae))}}return Ce},m=function(b){if(!b)return h;if(typeof b.allowEmptyArrays<"u"&&typeof b.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof b.encodeDotInKeys<"u"&&typeof b.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(b.encoder!==null&&typeof b.encoder<"u"&&typeof b.encoder!="function")throw new TypeError("Encoder has to be a function.");var A=b.charset||h.charset;if(typeof b.charset<"u"&&b.charset!=="utf-8"&&b.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var w=t.default;if(typeof b.format<"u"){if(!i.call(t.formatters,b.format))throw new TypeError("Unknown format option provided.");w=b.format}var x=t.formatters[w],N=h.filter;(typeof b.filter=="function"||s(b.filter))&&(N=b.filter);var F;if(b.arrayFormat in r?F=b.arrayFormat:"indices"in b?F=b.indices?"indices":"repeat":F=h.arrayFormat,"commaRoundTrip"in b&&typeof b.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var L=typeof b.allowDots>"u"?b.encodeDotInKeys===!0?!0:h.allowDots:!!b.allowDots;return{addQueryPrefix:typeof b.addQueryPrefix=="boolean"?b.addQueryPrefix:h.addQueryPrefix,allowDots:L,allowEmptyArrays:typeof b.allowEmptyArrays=="boolean"?!!b.allowEmptyArrays:h.allowEmptyArrays,arrayFormat:F,charset:A,charsetSentinel:typeof b.charsetSentinel=="boolean"?b.charsetSentinel:h.charsetSentinel,commaRoundTrip:!!b.commaRoundTrip,delimiter:typeof b.delimiter>"u"?h.delimiter:b.delimiter,encode:typeof b.encode=="boolean"?b.encode:h.encode,encodeDotInKeys:typeof b.encodeDotInKeys=="boolean"?b.encodeDotInKeys:h.encodeDotInKeys,encoder:typeof b.encoder=="function"?b.encoder:h.encoder,encodeValuesOnly:typeof b.encodeValuesOnly=="boolean"?b.encodeValuesOnly:h.encodeValuesOnly,filter:N,format:w,formatter:x,serializeDate:typeof b.serializeDate=="function"?b.serializeDate:h.serializeDate,skipNulls:typeof b.skipNulls=="boolean"?b.skipNulls:h.skipNulls,sort:typeof b.sort=="function"?b.sort:null,strictNullHandling:typeof b.strictNullHandling=="boolean"?b.strictNullHandling:h.strictNullHandling}};return Pf=function(y,b){var A=y,w=m(b),x,N;typeof w.filter=="function"?(N=w.filter,A=N("",A)):s(w.filter)&&(N=w.filter,x=N);var F=[];if(typeof A!="object"||A===null)return"";var L=r[w.arrayFormat],C=L==="comma"&&w.commaRoundTrip;x||(x=Object.keys(A)),w.sort&&x.sort(w.sort);for(var M=n(),_=0;_<x.length;++_){var R=x[_],U=A[R];w.skipNulls&&U===null||o(F,g(U,R,L,C,w.allowEmptyArrays,w.strictNullHandling,w.skipNulls,w.encodeDotInKeys,w.encode?w.encoder:null,w.filter,w.sort,w.allowDots,w.serializeDate,w.format,w.formatter,w.encodeValuesOnly,w.charset,M))}var q=F.join(w.delimiter),$=w.addQueryPrefix===!0?"?":"";return w.charsetSentinel&&(w.charset==="iso-8859-1"?$+="utf8=%26%2310003%3B&":$+="utf8=%E2%9C%93&"),q.length>0?$+q:""},Pf}var Of,$b;function $I(){if($b)return Of;$b=1;var n=Bb(),e=Object.prototype.hasOwnProperty,t=Array.isArray,i={allowDots:!1,allowEmptyArrays:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decodeDotInKeys:!1,decoder:n.decode,delimiter:"&",depth:5,duplicates:"combine",ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictDepth:!1,strictNullHandling:!1,throwOnLimitExceeded:!1},r=function(p){return p.replace(/&#(\d+);/g,function(g,m){return String.fromCharCode(parseInt(m,10))})},s=function(p,g,m){if(p&&typeof p=="string"&&g.comma&&p.indexOf(",")>-1)return p.split(",");if(g.throwOnLimitExceeded&&m>=g.arrayLimit)throw new RangeError("Array limit exceeded. Only "+g.arrayLimit+" element"+(g.arrayLimit===1?"":"s")+" allowed in an array.");return p},a="utf8=%26%2310003%3B",o="utf8=%E2%9C%93",l=function(g,m){var y={__proto__:null},b=m.ignoreQueryPrefix?g.replace(/^\?/,""):g;b=b.replace(/%5B/gi,"[").replace(/%5D/gi,"]");var A=m.parameterLimit===1/0?void 0:m.parameterLimit,w=b.split(m.delimiter,m.throwOnLimitExceeded?A+1:A);if(m.throwOnLimitExceeded&&w.length>A)throw new RangeError("Parameter limit exceeded. Only "+A+" parameter"+(A===1?"":"s")+" allowed.");var x=-1,N,F=m.charset;if(m.charsetSentinel)for(N=0;N<w.length;++N)w[N].indexOf("utf8=")===0&&(w[N]===o?F="utf-8":w[N]===a&&(F="iso-8859-1"),x=N,N=w.length);for(N=0;N<w.length;++N)if(N!==x){var L=w[N],C=L.indexOf("]="),M=C===-1?L.indexOf("="):C+1,_,R;M===-1?(_=m.decoder(L,i.decoder,F,"key"),R=m.strictNullHandling?null:""):(_=m.decoder(L.slice(0,M),i.decoder,F,"key"),R=n.maybeMap(s(L.slice(M+1),m,t(y[_])?y[_].length:0),function(q){return m.decoder(q,i.decoder,F,"value")})),R&&m.interpretNumericEntities&&F==="iso-8859-1"&&(R=r(String(R))),L.indexOf("[]=")>-1&&(R=t(R)?[R]:R);var U=e.call(y,_);U&&m.duplicates==="combine"?y[_]=n.combine(y[_],R):(!U||m.duplicates==="last")&&(y[_]=R)}return y},u=function(p,g,m,y){var b=0;if(p.length>0&&p[p.length-1]==="[]"){var A=p.slice(0,-1).join("");b=Array.isArray(g)&&g[A]?g[A].length:0}for(var w=y?g:s(g,m,b),x=p.length-1;x>=0;--x){var N,F=p[x];if(F==="[]"&&m.parseArrays)N=m.allowEmptyArrays&&(w===""||m.strictNullHandling&&w===null)?[]:n.combine([],w);else{N=m.plainObjects?{__proto__:null}:{};var L=F.charAt(0)==="["&&F.charAt(F.length-1)==="]"?F.slice(1,-1):F,C=m.decodeDotInKeys?L.replace(/%2E/g,"."):L,M=parseInt(C,10);!m.parseArrays&&C===""?N={0:w}:!isNaN(M)&&F!==C&&String(M)===C&&M>=0&&m.parseArrays&&M<=m.arrayLimit?(N=[],N[M]=w):C!=="__proto__"&&(N[C]=w)}w=N}return w},h=function(g,m,y,b){if(g){var A=y.allowDots?g.replace(/\.([^.[]+)/g,"[$1]"):g,w=/(\[[^[\]]*])/,x=/(\[[^[\]]*])/g,N=y.depth>0&&w.exec(A),F=N?A.slice(0,N.index):A,L=[];if(F){if(!y.plainObjects&&e.call(Object.prototype,F)&&!y.allowPrototypes)return;L.push(F)}for(var C=0;y.depth>0&&(N=x.exec(A))!==null&&C<y.depth;){if(C+=1,!y.plainObjects&&e.call(Object.prototype,N[1].slice(1,-1))&&!y.allowPrototypes)return;L.push(N[1])}if(N){if(y.strictDepth===!0)throw new RangeError("Input depth exceeded depth option of "+y.depth+" and strictDepth is true");L.push("["+A.slice(N.index)+"]")}return u(L,m,y,b)}},d=function(g){if(!g)return i;if(typeof g.allowEmptyArrays<"u"&&typeof g.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof g.decodeDotInKeys<"u"&&typeof g.decodeDotInKeys!="boolean")throw new TypeError("`decodeDotInKeys` option can only be `true` or `false`, when provided");if(g.decoder!==null&&typeof g.decoder<"u"&&typeof g.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof g.charset<"u"&&g.charset!=="utf-8"&&g.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");if(typeof g.throwOnLimitExceeded<"u"&&typeof g.throwOnLimitExceeded!="boolean")throw new TypeError("`throwOnLimitExceeded` option must be a boolean");var m=typeof g.charset>"u"?i.charset:g.charset,y=typeof g.duplicates>"u"?i.duplicates:g.duplicates;if(y!=="combine"&&y!=="first"&&y!=="last")throw new TypeError("The duplicates option must be either combine, first, or last");var b=typeof g.allowDots>"u"?g.decodeDotInKeys===!0?!0:i.allowDots:!!g.allowDots;return{allowDots:b,allowEmptyArrays:typeof g.allowEmptyArrays=="boolean"?!!g.allowEmptyArrays:i.allowEmptyArrays,allowPrototypes:typeof g.allowPrototypes=="boolean"?g.allowPrototypes:i.allowPrototypes,allowSparse:typeof g.allowSparse=="boolean"?g.allowSparse:i.allowSparse,arrayLimit:typeof g.arrayLimit=="number"?g.arrayLimit:i.arrayLimit,charset:m,charsetSentinel:typeof g.charsetSentinel=="boolean"?g.charsetSentinel:i.charsetSentinel,comma:typeof g.comma=="boolean"?g.comma:i.comma,decodeDotInKeys:typeof g.decodeDotInKeys=="boolean"?g.decodeDotInKeys:i.decodeDotInKeys,decoder:typeof g.decoder=="function"?g.decoder:i.decoder,delimiter:typeof g.delimiter=="string"||n.isRegExp(g.delimiter)?g.delimiter:i.delimiter,depth:typeof g.depth=="number"||g.depth===!1?+g.depth:i.depth,duplicates:y,ignoreQueryPrefix:g.ignoreQueryPrefix===!0,interpretNumericEntities:typeof g.interpretNumericEntities=="boolean"?g.interpretNumericEntities:i.interpretNumericEntities,parameterLimit:typeof g.parameterLimit=="number"?g.parameterLimit:i.parameterLimit,parseArrays:g.parseArrays!==!1,plainObjects:typeof g.plainObjects=="boolean"?g.plainObjects:i.plainObjects,strictDepth:typeof g.strictDepth=="boolean"?!!g.strictDepth:i.strictDepth,strictNullHandling:typeof g.strictNullHandling=="boolean"?g.strictNullHandling:i.strictNullHandling,throwOnLimitExceeded:typeof g.throwOnLimitExceeded=="boolean"?g.throwOnLimitExceeded:!1}};return Of=function(p,g){var m=d(g);if(p===""||p===null||typeof p>"u")return m.plainObjects?{__proto__:null}:{};for(var y=typeof p=="string"?l(p,m):p,b=m.plainObjects?{__proto__:null}:{},A=Object.keys(y),w=0;w<A.length;++w){var x=A[w],N=h(x,y[x],m,typeof p=="string");b=n.merge(b,N,m)}return m.allowSparse===!0?b:n.compact(b)},Of}var Ff,Gb;function GI(){if(Gb)return Ff;Gb=1;var n=UI(),e=$I(),t=Mf();return Ff={formats:t,parse:e,stringify:n},Ff}var qb=GI();const qI=ms(qb);class Va{buildVideoId(e,t){if(e.buildType==="join"){if(e.buildParams)return e.prefix!==void 0?e.prefix+t.join(e.buildParams[0]):t.join(e.buildParams[0]);throw new Error("ID extraction rule is configured with join method, but no separator is configured in buildParams")}else return e.prefix!==void 0?e.prefix+t.join(""):t.join("")}}class VI extends Va{getVideoId(e,t){if(_t.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");let i=t.getParam("matchUrl")??window.location.href;const r=t.computeParsedQsIfAbsent(()=>qb.parse(new URL(i).search.substring(1))),s=sr.of(e.values).map(a=>r[a]??e.defaultValue).toArray();return this.buildVideoId(e,s)}}var ln={},Vb;function HI(){if(Vb)return ln;Vb=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.TokenData=void 0,ln.parse=d,ln.compile=p,ln.match=y,ln.pathToRegexp=b,ln.stringify=N;const n="/",e=C=>C,t=/^[$_\p{ID_Start}]$/u,i=/^[$\u200c\u200d\p{ID_Continue}]$/u,r="https://git.new/pathToRegexpError",s={"{":"{","}":"}","(":"(",")":")","[":"[","]":"]","+":"+","?":"?","!":"!"};function a(C){return C.replace(/[{}()\[\]+?!:*]/g,"\\$&")}function o(C){return C.replace(/[.+*?^${}()[\]|/\\]/g,"\\$&")}function*l(C){const M=[...C];let _=0;function R(){let U="";if(t.test(M[++_]))for(U+=M[_];i.test(M[++_]);)U+=M[_];else if(M[_]==='"'){let q=_;for(;_<M.length;){if(M[++_]==='"'){_++,q=0;break}M[_]==="\\"?U+=M[++_]:U+=M[_]}if(q)throw new TypeError(`Unterminated quote at ${q}: ${r}`)}if(!U)throw new TypeError(`Missing parameter name at ${_}: ${r}`);return U}for(;_<M.length;){const U=M[_],q=s[U];if(q)yield{type:q,index:_++,value:U};else if(U==="\\")yield{type:"ESCAPED",index:_++,value:M[_++]};else if(U===":"){const $=R();yield{type:"PARAM",index:_,value:$}}else if(U==="*"){const $=R();yield{type:"WILDCARD",index:_,value:$}}else yield{type:"CHAR",index:_,value:M[_++]}}return{type:"END",index:_,value:""}}class u{constructor(M){this.tokens=M}peek(){if(!this._peek){const M=this.tokens.next();this._peek=M.value}return this._peek}tryConsume(M){const _=this.peek();if(_.type===M)return this._peek=void 0,_.value}consume(M){const _=this.tryConsume(M);if(_!==void 0)return _;const{type:R,index:U}=this.peek();throw new TypeError(`Unexpected ${R} at ${U}, expected ${M}: ${r}`)}text(){let M="",_;for(;_=this.tryConsume("CHAR")||this.tryConsume("ESCAPED");)M+=_;return M}}class h{constructor(M){this.tokens=M}}ln.TokenData=h;function d(C,M={}){const{encodePath:_=e}=M,R=new u(l(C));function U($){const Y=[];for(;;){const ae=R.text();ae&&Y.push({type:"text",value:_(ae)});const ne=R.tryConsume("PARAM");if(ne){Y.push({type:"param",name:ne});continue}const ce=R.tryConsume("WILDCARD");if(ce){Y.push({type:"wildcard",name:ce});continue}if(R.tryConsume("{")){Y.push({type:"group",tokens:U("}")});continue}return R.consume($),Y}}const q=U("END");return new h(q)}function p(C,M={}){const{encode:_=encodeURIComponent,delimiter:R=n}=M,U=C instanceof h?C:d(C,M),q=g(U.tokens,R,_);return function(Y={}){const[ae,...ne]=q(Y);if(ne.length)throw new TypeError(`Missing parameters: ${ne.join(", ")}`);return ae}}function g(C,M,_){const R=C.map(U=>m(U,M,_));return U=>{const q=[""];for(const $ of R){const[Y,...ae]=$(U);q[0]+=Y,q.push(...ae)}return q}}function m(C,M,_){if(C.type==="text")return()=>[C.value];if(C.type==="group"){const U=g(C.tokens,M,_);return q=>{const[$,...Y]=U(q);return Y.length?[""]:[$]}}const R=_||e;return C.type==="wildcard"&&_!==!1?U=>{const q=U[C.name];if(q==null)return["",C.name];if(!Array.isArray(q)||q.length===0)throw new TypeError(`Expected "${C.name}" to be a non-empty array`);return[q.map(($,Y)=>{if(typeof $!="string")throw new TypeError(`Expected "${C.name}/${Y}" to be a string`);return R($)}).join(M)]}:U=>{const q=U[C.name];if(q==null)return["",C.name];if(typeof q!="string")throw new TypeError(`Expected "${C.name}" to be a string`);return[R(q)]}}function y(C,M={}){const{decode:_=decodeURIComponent,delimiter:R=n}=M,{regexp:U,keys:q}=b(C,M),$=q.map(Y=>_===!1?e:Y.type==="param"?_:ae=>ae.split(R).map(_));return function(ae){const ne=U.exec(ae);if(!ne)return!1;const ce=ne[0],re=Object.create(null);for(let V=1;V<ne.length;V++){if(ne[V]===void 0)continue;const J=q[V-1],ve=$[V-1];re[J.name]=ve(ne[V])}return{path:ce,params:re}}}function b(C,M={}){const{delimiter:_=n,end:R=!0,sensitive:U=!1,trailing:q=!0}=M,$=[],Y=[],ae=U?"":"i",ce=(Array.isArray(C)?C:[C]).map(J=>J instanceof h?J:d(J,M));for(const{tokens:J}of ce)for(const ve of A(J,0,[])){const pe=w(ve,_,$);Y.push(pe)}let re=`^(?:${Y.join("|")})`;return q&&(re+=`(?:${o(_)}$)?`),re+=R?"$":`(?=${o(_)}|$)`,{regexp:new RegExp(re,ae),keys:$}}function*A(C,M,_){if(M===C.length)return yield _;const R=C[M];if(R.type==="group"){const U=_.slice();for(const q of A(R.tokens,0,U))yield*A(C,M+1,q)}else _.push(R);yield*A(C,M+1,_)}function w(C,M,_){let R="",U="",q=!0;for(let $=0;$<C.length;$++){const Y=C[$];if(Y.type==="text"){R+=o(Y.value),U+=Y.value,q||(q=Y.value.includes(M));continue}if(Y.type==="param"||Y.type==="wildcard"){if(!q&&!U)throw new TypeError(`Missing text after "${Y.name}": ${r}`);Y.type==="param"?R+=`(${x(M,q?"":U)}+)`:R+="([\\s\\S]+)",_.push(Y),U="",q=!1;continue}}return R}function x(C,M){return M.length<2?C.length<2?`[^${o(C+M)}]`:`(?:(?!${o(C)})[^${o(M)}])`:C.length<2?`(?:(?!${o(M)})[^${o(C)}])`:`(?:(?!${o(M)}|${o(C)})[\\s\\S])`}function N(C){return C.tokens.map(function M(_,R,U){if(_.type==="text")return a(_.value);if(_.type==="group")return`{${_.tokens.map(M).join("")}}`;const $=F(_.name)&&L(U[R+1])?_.name:JSON.stringify(_.name);if(_.type==="param")return`:${$}`;if(_.type==="wildcard")return`*${$}`;throw new TypeError(`Unexpected token: ${_}`)}).join("")}function F(C){const[M,..._]=C;return t.test(M)?_.every(R=>i.test(R)):!1}function L(C){return(C==null?void 0:C.type)!=="text"?!0:!i.test(C.value[0])}return ln}var Bf=HI();class KI extends Va{getVideoId(e,t){if(_t.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const i=t.computeUrlMatchResultIfAbsent(()=>{const r=Bf.match(e.values[0]);let s=t.getParam("matchUrl")??window.location.href;return r(new URL(s).pathname)});if(!i)throw console.error("Video ID extraction rule configuration error for current URL:",e),new Error("Video ID extraction rule configuration error for current URL");return this.extractedVideoId(e,i)}extractedVideoId(e,t){const i=sr.of(e.values).slice(1).map(r=>t.params[r]).toArray();return this.buildVideoId(e,i)}}class WI extends Va{getVideoId(e,t){if(t.data===void 0)throw console.error("Context vo object is missing, unable to extract video ID using JSONPath",t),new Error("Context vo object is missing, unable to extract video ID using JSONPath");if(_t.isEmpty(e.values))throw console.error("Video ID extraction rule missing JSONPath values property",e),new Error("Video ID extraction rule missing JSONPath values property");let i=sr.of(e.values).map(r=>on(t.data,r)).flatten().toArray();return this.buildVideoId(e,i)}}const Hb={"en-IE":{0:["Emily"],1:["Connor"]},"ar-KW":{0:["Noura"],1:["Fahed"]},"sw-TZ":{0:["Rehema"],1:["Daudi"]},"ms-MY":{0:["Yasmin"],1:["Osman"]},"en-IN":{0:["Neerja"],1:["Prabhat"]},"es-BO":{0:["Sofia"],1:["Marcelo"]},"ar-SY":{0:["Amany"],1:["Laith"]},"en-ZA":{0:["Leah"],1:["Luke"]},"ta-IN":{0:["Pallavi"],1:["Valluvar"]},"el-GR":{0:["Athina"],1:["Nestoras"]},"nl-NL":{0:["Fenna","Colette"],1:["Maarten"]},"zu-ZA":{0:["Thando"],1:["Themba"]},"ar-LB":{0:["Layla"],1:["Rami"]},"en-AU":{0:["Natasha"],1:["William"]},"he-IL":{0:["Hila"],1:["Avri"]},"mk-MK":{0:["Marija"],1:["Aleksandar"]},"ar-TN":{0:["Reem"],1:["Hedi"]},"ar-LY":{0:["Iman"],1:["Omar"]},"hu-HU":{0:["Noemi"],1:["Tamas"]},"ml-IN":{0:["Sobhana"],1:["Midhun"]},"es-SV":{0:["Lorena"],1:["Rodrigo"]},"es-CR":{0:["Maria"],1:["Juan"]},"es-CL":{0:["Catalina"],1:["Lorenzo"]},"fr-CA":{0:["Sylvie"],1:["Antoine","Jean"]},"es-CO":{0:["Salome"],1:["Gonzalo"]},"jv-ID":{0:["Siti"],1:["Dimas"]},"pl-PL":{0:["Zofia"],1:["Marek"]},"pt-PT":{0:["Raquel"],1:["Duarte"]},"ar-EG":{0:["Salma"],1:["Shakir"]},"es-CU":{0:["Belkys"],1:["Manuel"]},"fr-BE":{0:["Charline"],1:["Gerard"]},"ga-IE":{0:["Orla"],1:["Colm"]},"cy-GB":{0:["Nia"],1:["Aled"]},"ar-DZ":{0:["Amina"],1:["Ismael"]},"en-SG":{0:["Luna"],1:["Wayne"]},"ar-MA":{0:["Mouna"],1:["Jamal"]},"fil-PH":{0:["Blessica"],1:["Angelo"]},"ta-SG":{0:["Venba"],1:["Anbu"]},"en-KE":{0:["Asilia"],1:["Chilemba"]},"es-HN":{0:["Karla"],1:["Carlos"]},"nb-NO":{0:["Pernille"],1:["Finn"]},"hr-HR":{0:["Gabrijela"],1:["Srecko"]},"es-PR":{0:["Karina"],1:["Victor"]},"af-ZA":{0:["Adri"],1:["Willem"]},"gl-ES":{0:["Sabela"],1:["Roi"]},"es-PY":{0:["Tania"],1:["Mario"]},"de-AT":{0:["Ingrid"],1:["Jonas"]},"ta-LK":{0:["Saranya"],1:["Kumar"]},"is-IS":{0:["Gudrun"],1:["Gunnar"]},"my-MM":{0:["Nilar"],1:["Thiha"]},"bg-BG":{0:["Kalina"],1:["Borislav"]},"cs-CZ":{0:["Vlasta"],1:["Antonin"]},"en-PH":{0:["Rosa"],1:["James"]},"uz-UZ":{0:["Madina"],1:["Sardor"]},"zh-TW":{0:["HsiaoYu","HsiaoChen"],1:["YunJhe"]},"en-HK":{0:["Yan"],1:["Sam"]},"ko-KR":{0:["SunHi"],1:["InJoon"]},"sk-SK":{0:["Viktoria"],1:["Lukas"]},"ps-AF":{0:["Latifa"],1:["GulNawaz"]},"ar-OM":{0:["Aysha"],1:["Abdullah"]},"ru-RU":{0:["Svetlana"],1:["Dmitry"]},"sq-AL":{0:["Anila"],1:["Ilir"]},"es-AR":{0:["Elena"],1:["Tomas"]},"sv-SE":{0:["Sofie"],1:["Mattias"]},"am-ET":{0:["Mekdes"],1:["Ameha"]},"mr-IN":{0:["Aarohi"],1:["Manohar"]},"da-DK":{0:["Christel"],1:["Jeppe"]},"mn-MN":{0:["Yesui"],1:["Bataa"]},"uk-UA":{0:["Polina"],1:["Ostap"]},"en-US":{0:["Michelle","Ana","Aria","Jenny"],1:["Roger","Christopher","Eric","Steffan","Guy"]},"ta-MY":{0:["Kani"],1:["Surya"]},"gu-IN":{0:["Dhwani"],1:["Niranjan"]},"lv-LV":{0:["Everita"],1:["Nils"]},"nl-BE":{0:["Dena"],1:["Arnaud"]},"zh-CN":{0:["Xiaoxiao","Xiaoyi"],1:["Yunyang","Yunxia","Yunxi","Yunjian"]},"ur-PK":{0:["Uzma"],1:["Asad"]},"te-IN":{0:["Shruti"],1:["Mohan"]},"hi-IN":{0:["Swara"],1:["Madhur"]},"en-NG":{0:["Ezinne"],1:["Abeo"]},"de-CH":{0:["Leni"],1:["Jan"]},"ja-JP":{0:["Nanami"],1:["Keita"]},"bs-BA":{0:["Vesna"],1:["Goran"]},"ar-YE":{0:["Maryam"],1:["Saleh"]},"ne-NP":{0:["Hemkala"],1:["Sagar"]},"ka-GE":{0:["Eka"],1:["Giorgi"]},"ar-QA":{0:["Amal"],1:["Moaz"]},"es-GT":{0:["Marta"],1:["Andres"]},"es-GQ":{0:["Teresa"],1:["Javier"]},"es-PE":{0:["Camila"],1:["Alex"]},"en-NZ":{0:["Molly"],1:["Mitchell"]},"fa-IR":{0:["Dilara"],1:["Farid"]},"es-PA":{0:["Margarita"],1:["Roberto"]},"ro-RO":{0:["Alina"],1:["Emil"]},"mt-MT":{0:["Grace"],1:["Joseph"]},"et-EE":{0:["Anu"],1:["Kert"]},"tr-TR":{0:["Emel"],1:["Ahmet"]},"fr-FR":{0:["Denise","Eloise"],1:["Henri"]},"vi-VN":{0:["HoaiMy"],1:["NamMinh"]},"en-GB":{0:["Maisie","Libby","Sonia"],1:["Thomas","Ryan"]},"km-KH":{0:["Sreymom"],1:["Piseth"]},"fi-FI":{0:["Noora"],1:["Harri"]},"az-AZ":{0:["Banu"],1:["Babek"]},"en-CA":{0:["Clara"],1:["Liam"]},"lt-LT":{0:["Ona"],1:["Leonas"]},"ar-AE":{0:["Fatima"],1:["Hamdan"]},"sl-SI":{0:["Petra"],1:["Rok"]},"es-DO":{0:["Ramona"],1:["Emilio"]},"ar-IQ":{0:["Rana"],1:["Bassel"]},"bn-IN":{0:["Tanishaa"],1:["Bashkar"]},"si-LK":{0:["Thilini"],1:["Sameera"]},"fr-CH":{0:["Ariane"],1:["Fabrice"]},"es-EC":{0:["Andrea"],1:["Luis"]},"es-US":{0:["Paloma"],1:["Alonso"]},"kn-IN":{0:["Sapna"],1:["Gagan"]},"lo-LA":{0:["Keomany"],1:["Chanthavong"]},"ar-SA":{0:["Zariyah"],1:["Hamed"]},"ca-ES":{0:["Joana"],1:["Enric"]},"de-DE":{0:["Katja","Amala"],1:["Conrad","Killian"]},"zh-HK":{0:["HiuGaai","HiuMaan"],1:["WanLung"]},"pt-BR":{0:["Francisca"],1:["Antonio"]},"sr-RS":{0:["Sophie"],1:["Nicholas"]},"es-UY":{0:["Valentina"],1:["Mateo"]},"sw-KE":{0:["Zuri"],1:["Rafiki"]},"ar-BH":{0:["Laila"],1:["Ali"]},"es-ES":{0:["Elvira"],1:["Alvaro"]},"kk-KZ":{0:["Aigul"],1:["Daulet"]},"ar-JO":{0:["Sana"],1:["Taim"]},"es-VE":{0:["Paola"],1:["Sebastian"]},"so-SO":{0:["Ubax"],1:["Muuse"]},"en-TZ":{0:["Imani"],1:["Elimu"]},"su-ID":{0:["Tuti"],1:["Jajang"]},"es-MX":{0:["Dalia"],1:["Jorge"]},"it-IT":{0:["Elsa","Isabella"],1:["Diego"]},"ur-IN":{0:["Gul"],1:["Salman"]},"bn-BD":{0:["Nabanita"],1:["Pradeep"]},"id-ID":{0:["Gadis"],1:["Ardi"]},"es-NI":{0:["Yolanda"],1:["Federico"]},"th-TH":{0:["Premwadee"],1:["Niwat"]}},Lu={AvaMultilingual:{code:"en-US-AvaMultilingualNeural",language:"en-US",displayName:"Ava Multilingual",localName:"Ava Multilingual"},EmmaMultilingual:{code:"en-US-EmmaMultilingualNeural",language:"en-US",displayName:"Emma Multilingual",localName:"Emma Multilingual"},AndrewMultilingual:{code:"en-US-AndrewMultilingualNeural",language:"en-US",displayName:"Andrew Multilingual",localName:"Andrew Multilingual"},BrianMultilingual:{code:"en-US-BrianMultilingualNeural",language:"en-US",displayName:"Brian Multilingual",localName:"Brian Multilingual"},JennyMultilingual:{code:"en-US-JennyMultilingualNeural",language:"en-US",displayName:"Jenny Multilingual",localName:"Jenny Multilingual"},RyanMultilingual:{code:"en-US-RyanMultilingualNeural",language:"en-US",displayName:"Ryan Multilingual",localName:"Ryan Multilingual"},SeraphinaMultilingual:{code:"de-DE-SeraphinaMultilingualNeural",language:"de-DE",displayName:"Seraphina Multilingual",localName:"Seraphina Mehrsprachig"},FlorianMultilingual:{code:"de-DE-FlorianMultilingualNeural",language:"de-DE",displayName:"Florian Multilingual",localName:"Florian Mehrsprachig"},VivienneMultilingual:{code:"fr-FR-VivienneMultilingualNeural",language:"fr-FR",displayName:"Vivienne Multilingual",localName:"Vivienne Multilingue"},RemyMultilingual:{code:"fr-FR-RemyMultilingualNeural",language:"fr-FR",displayName:"Remy Multilingual",localName:"Rémy Multilingue"},MasaruMultilingual:{code:"ja-JP-MasaruMultilingualNeural",language:"ja-JP",displayName:"Masaru Multilingual",localName:"勝 多言語"},YunyiMultilingual:{code:"zh-CN-YunyiMultilingualNeural",language:"zh-CN",displayName:"Yunyi Multilingual",localName:"云逸 多语言"},XiaoxiaoMultilingual:{code:"zh-CN-XiaoxiaoMultilingualNeural",language:"zh-CN",displayName:"Xiaoxiao Multilingual",localName:"晓晓 多语言"},XiaochenMultilingual:{code:"zh-CN-XiaochenMultilingualNeural",language:"zh-CN",displayName:"Xiaochen Multilingual",localName:"晓辰 多语言"},XiaoyuMultilingual:{code:"zh-CN-XiaoyuMultilingualNeural",language:"zh-CN",displayName:"Xiaoyu Multilingual",localName:"晓雨 多语言"},"Xiaochen:DragonHDLatestNeural":{code:"zh-CN-Xiaochen:DragonHDLatestNeural",language:"zh-CN",displayName:"Xiaochen:DragonHDLatestNeural",localName:"晓辰(龙)"},"Seraphina:DragonHDLatestNeural":{code:"de-DE-Seraphina:DragonHDLatestNeural",language:"de-DE",displayName:"Seraphina:DragonHDLatest",localName:"Seraphina:DragonHD"},"Aria:DragonHDLatestNeural":{code:"en-US-Aria:DragonHDLatestNeural",language:"en-US",displayName:"Aria:DragonHDLatest",localName:"Aria:DragonHD"},"Ava:DragonHDLatestNeural":{code:"en-US-Ava:DragonHDLatestNeural",language:"en-US",displayName:"Ava:DragonHDLatest",localName:"Ava:DragonHD"},"Emma:DragonHDLatestNeural":{code:"en-US-Emma:DragonHDLatestNeural",language:"en-US",displayName:"Emma:DragonHDLatest",localName:"Emma:DragonHD"},"Emma2:DragonHDLatestNeural":{code:"en-US-Emma2:DragonHDLatestNeural",language:"en-US",displayName:"Emma2:DragonHDLatest",localName:"Emma2:DragonHD"},"Jenny:DragonHDLatestNeural":{code:"en-US-Jenny:DragonHDLatestNeural",language:"en-US",displayName:"Jenny:DragonHDLatest",localName:"Jenny:DragonHD"},"Andrew:DragonHDLatestNeural":{code:"en-US-Andrew:DragonHDLatestNeural",language:"en-US",displayName:"Andrew:DragonHDLatest",localName:"Andrew:DragonHD"},"Andrew2:DragonHDLatestNeural":{code:"en-US-Andrew2:DragonHDLatestNeural",language:"en-US",displayName:"Andrew2:DragonHDLatest",localName:"Andrew2:DragonHD"},"Davis:DragonHDLatestNeural":{code:"en-US-Davis:DragonHDLatestNeural",language:"en-US",displayName:"Davis:DragonHDLatest",localName:"Davis:DragonHD"},"Steffan:DragonHDLatestNeural":{code:"en-US-Steffan:DragonHDLatestNeural",language:"en-US",displayName:"Steffan:DragonHDLatest",localName:"Steffan:DragonHD"},"Masaru:DragonHDLatestNeural":{code:"ja-JP-Masaru:DragonHDLatestNeural",language:"ja-JP",displayName:"Masaru:DragonHDLatest",localName:"Masaru:DragonHD"},Alba:{code:"ca-ES-AlbaNeural",language:"ca-ES",displayName:"Alba",localName:"Alba"},Gisela:{code:"de-DE-GiselaNeural",language:"de-DE",displayName:"Gisela",localName:"Gisela"},Elke:{code:"de-DE-ElkeNeural",language:"de-DE",displayName:"Elke",localName:"Elke"},Klarissa:{code:"de-DE-KlarissaNeural",language:"de-DE",displayName:"Klarissa",localName:"Klarissa"},Louisa:{code:"de-DE-LouisaNeural",language:"de-DE",displayName:"Louisa",localName:"Louisa"},Maja:{code:"de-DE-MajaNeural",language:"de-DE",displayName:"Maja",localName:"Maja"},Tanja:{code:"de-DE-TanjaNeural",language:"de-DE",displayName:"Tanja",localName:"Tanja"},Bernd:{code:"de-DE-BerndNeural",language:"de-DE",displayName:"Bernd",localName:"Bernd"},Kasper:{code:"de-DE-KasperNeural",language:"de-DE",displayName:"Kasper",localName:"Kasper"},Christoph:{code:"de-DE-ChristophNeural",language:"de-DE",displayName:"Christoph",localName:"Christoph"},Klaus:{code:"de-DE-KlausNeural",language:"de-DE",displayName:"Klaus",localName:"Klaus"},Ralf:{code:"de-DE-RalfNeural",language:"de-DE",displayName:"Ralf",localName:"Ralf"},Annette:{code:"en-AU-AnnetteNeural",language:"en-AU",displayName:"Annette",localName:"Annette"},Carly:{code:"en-AU-CarlyNeural",language:"en-AU",displayName:"Carly",localName:"Carly"},Elsie:{code:"en-AU-ElsieNeural",language:"en-AU",displayName:"Elsie",localName:"Elsie"},Freya:{code:"en-AU-FreyaNeural",language:"en-AU",displayName:"Freya",localName:"Freya"},Joanne:{code:"en-AU-JoanneNeural",language:"en-AU",displayName:"Joanne",localName:"Joanne"},Kim:{code:"en-AU-KimNeural",language:"en-AU",displayName:"Kim",localName:"Kim"},Tina:{code:"en-AU-TinaNeural",language:"en-AU",displayName:"Tina",localName:"Tina"},Darren:{code:"en-AU-DarrenNeural",language:"en-AU",displayName:"Darren",localName:"Darren"},Duncan:{code:"en-AU-DuncanNeural",language:"en-AU",displayName:"Duncan",localName:"Duncan"},Ken:{code:"en-AU-KenNeural",language:"en-AU",displayName:"Ken",localName:"Ken"},Neil:{code:"en-AU-NeilNeural",language:"en-AU",displayName:"Neil",localName:"Neil"},Tim:{code:"en-AU-TimNeural",language:"en-AU",displayName:"Tim",localName:"Tim"},Abbi:{code:"en-GB-AbbiNeural",language:"en-GB",displayName:"Abbi",localName:"Abbi"},Bella:{code:"en-GB-BellaNeural",language:"en-GB",displayName:"Bella",localName:"Bella"},Hollie:{code:"en-GB-HollieNeural",language:"en-GB",displayName:"Hollie",localName:"Hollie"},Maisie:{code:"en-GB-MaisieNeural",language:"en-GB",displayName:"Maisie",localName:"Maisie"},Olivia:{code:"en-GB-OliviaNeural",language:"en-GB",displayName:"Olivia",localName:"Olivia"},Mia:{code:"en-GB-MiaNeural",language:"en-GB",displayName:"Mia",localName:"Mia"},Alfie:{code:"en-GB-AlfieNeural",language:"en-GB",displayName:"Alfie",localName:"Alfie"},Elliot:{code:"en-GB-ElliotNeural",language:"en-GB",displayName:"Elliot",localName:"Elliot"},Ethan:{code:"en-GB-EthanNeural",language:"en-GB",displayName:"Ethan",localName:"Ethan"},Noah:{code:"en-GB-NoahNeural",language:"en-GB",displayName:"Noah",localName:"Noah"},Oliver:{code:"en-GB-OliverNeural",language:"en-GB",displayName:"Oliver",localName:"Oliver"},Aashi:{code:"en-IN-AashiNeural",language:"en-IN",displayName:"Aashi",localName:"Aashi"},Ananya:{code:"en-IN-AnanyaNeural",language:"en-IN",displayName:"Ananya",localName:"Ananya"},Kavya:{code:"en-IN-KavyaNeural",language:"en-IN",displayName:"Kavya",localName:"Kavya"},Jane:{code:"en-US-JaneNeural",language:"en-US",displayName:"Jane",localName:"Jane"},Sara:{code:"en-US-SaraNeural",language:"en-US",displayName:"Sara",localName:"Sara"},Nancy:{code:"en-US-NancyNeural",language:"en-US",displayName:"Nancy",localName:"Nancy"},Amber:{code:"en-US-AmberNeural",language:"en-US",displayName:"Amber",localName:"Amber"},Ashley:{code:"en-US-AshleyNeural",language:"en-US",displayName:"Ashley",localName:"Ashley"},Cora:{code:"en-US-CoraNeural",language:"en-US",displayName:"Cora",localName:"Cora"},Elizabeth:{code:"en-US-ElizabethNeural",language:"en-US",displayName:"Elizabeth",localName:"Elizabeth"},Michelle:{code:"en-US-MichelleNeural",language:"en-US",displayName:"Michelle",localName:"Michelle"},Monica:{code:"en-US-MonicaNeural",language:"en-US",displayName:"Monica",localName:"Monica"},AIGenerate2:{code:"en-US-AIGenerate2Neural",language:"en-US",displayName:"AIGenerate2",localName:"AIGenerate2"},Blue:{code:"en-US-BlueNeural",language:"en-US",displayName:"Blue",localName:"Blue"},Davis:{code:"en-US-DavisNeural",language:"en-US",displayName:"Davis",localName:"Davis"},Jason:{code:"en-US-JasonNeural",language:"en-US",displayName:"Jason",localName:"Jason"},Tony:{code:"en-US-TonyNeural",language:"en-US",displayName:"Tony",localName:"Tony"},Brandon:{code:"en-US-BrandonNeural",language:"en-US",displayName:"Brandon",localName:"Brandon"},Jacob:{code:"en-US-JacobNeural",language:"en-US",displayName:"Jacob",localName:"Jacob"},AIGenerate1:{code:"en-US-AIGenerate1Neural",language:"en-US",displayName:"AIGenerate1",localName:"AIGenerate1"},Abril:{code:"es-ES-AbrilNeural",language:"es-ES",displayName:"Abril",localName:"Abril"},Estrella:{code:"es-ES-EstrellaNeural",language:"es-ES",displayName:"Estrella",localName:"Estrella"},Irene:{code:"es-ES-IreneNeural",language:"es-ES",displayName:"Irene",localName:"Irene"},Laia:{code:"es-ES-LaiaNeural",language:"es-ES",displayName:"Laia",localName:"Laia"},Lia:{code:"es-ES-LiaNeural",language:"es-ES",displayName:"Lia",localName:"Lia"},Triana:{code:"es-ES-TrianaNeural",language:"es-ES",displayName:"Triana",localName:"Triana"},Vera:{code:"es-ES-VeraNeural",language:"es-ES",displayName:"Vera",localName:"Vera"},Ximena:{code:"es-ES-XimenaNeural",language:"es-ES",displayName:"Ximena",localName:"Ximena"},Arnau:{code:"es-ES-ArnauNeural",language:"es-ES",displayName:"Arnau",localName:"Arnau"},Dario:{code:"es-ES-DarioNeural",language:"es-ES",displayName:"Dario",localName:"Dario"},Elias:{code:"es-ES-EliasNeural",language:"es-ES",displayName:"Elias",localName:"Elias"},Nil:{code:"es-ES-NilNeural",language:"es-ES",displayName:"Nil",localName:"Nil"},Saul:{code:"es-ES-SaulNeural",language:"es-ES",displayName:"Saul",localName:"Saul"},Teo:{code:"es-ES-TeoNeural",language:"es-ES",displayName:"Teo",localName:"Teo"},Beatriz:{code:"es-MX-BeatrizNeural",language:"es-MX",displayName:"Beatriz",localName:"Beatriz"},Candela:{code:"es-MX-CandelaNeural",language:"es-MX",displayName:"Candela",localName:"Candela"},Carlota:{code:"es-MX-CarlotaNeural",language:"es-MX",displayName:"Carlota",localName:"Carlota"},Larissa:{code:"es-MX-LarissaNeural",language:"es-MX",displayName:"Larissa",localName:"Larissa"},Marina:{code:"es-MX-MarinaNeural",language:"es-MX",displayName:"Marina",localName:"Marina"},Nuria:{code:"es-MX-NuriaNeural",language:"es-MX",displayName:"Nuria",localName:"Nuria"},Renata:{code:"es-MX-RenataNeural",language:"es-MX",displayName:"Renata",localName:"Renata"},Cecilio:{code:"es-MX-CecilioNeural",language:"es-MX",displayName:"Cecilio",localName:"Cecilio"},Gerardo:{code:"es-MX-GerardoNeural",language:"es-MX",displayName:"Gerardo",localName:"Gerardo"},Liberto:{code:"es-MX-LibertoNeural",language:"es-MX",displayName:"Liberto",localName:"Liberto"},Luciano:{code:"es-MX-LucianoNeural",language:"es-MX",displayName:"Luciano",localName:"Luciano"},Pelayo:{code:"es-MX-PelayoNeural",language:"es-MX",displayName:"Pelayo",localName:"Pelayo"},Yago:{code:"es-MX-YagoNeural",language:"es-MX",displayName:"Yago",localName:"Yago"},Selma:{code:"fi-FI-SelmaNeural",language:"fi-FI",displayName:"Selma",localName:"Selma"},Thierry:{code:"fr-CA-ThierryNeural",language:"fr-CA",displayName:"Thierry",localName:"Thierry"},Jacqueline:{code:"fr-FR-JacquelineNeural",language:"fr-FR",displayName:"Jacqueline",localName:"Jacqueline"},Josephine:{code:"fr-FR-JosephineNeural",language:"fr-FR",displayName:"Josephine",localName:"Josephine"},Brigitte:{code:"fr-FR-BrigitteNeural",language:"fr-FR",displayName:"Brigitte",localName:"Brigitte"},Coralie:{code:"fr-FR-CoralieNeural",language:"fr-FR",displayName:"Coralie",localName:"Coralie"},Celeste:{code:"fr-FR-CelesteNeural",language:"fr-FR",displayName:"Celeste",localName:"Celeste"},Yvette:{code:"fr-FR-YvetteNeural",language:"fr-FR",displayName:"Yvette",localName:"Yvette"},Claude:{code:"fr-FR-ClaudeNeural",language:"fr-FR",displayName:"Claude",localName:"Claude"},Alain:{code:"fr-FR-AlainNeural",language:"fr-FR",displayName:"Alain",localName:"Alain"},Jerome:{code:"fr-FR-JeromeNeural",language:"fr-FR",displayName:"Jerome",localName:"Jerome"},Maurice:{code:"fr-FR-MauriceNeural",language:"fr-FR",displayName:"Maurice",localName:"Maurice"},Yves:{code:"fr-FR-YvesNeural",language:"fr-FR",displayName:"Yves",localName:"Yves"},"Ananya-hi":{code:"hi-IN-AnanyaNeural",language:"hi-IN",displayName:"Ananya",localName:"अनन्या"},"Kavya-hi":{code:"hi-IN-KavyaNeural",language:"hi-IN",displayName:"Kavya",localName:"काव्या"},Fabiola:{code:"it-IT-FabiolaNeural",language:"it-IT",displayName:"Fabiola",localName:"Fabiola"},Fiamma:{code:"it-IT-FiammaNeural",language:"it-IT",displayName:"Fiamma",localName:"Fiamma"},Imelda:{code:"it-IT-ImeldaNeural",language:"it-IT",displayName:"Imelda",localName:"Imelda"},Irma:{code:"it-IT-IrmaNeural",language:"it-IT",displayName:"Irma",localName:"Irma"},Palmira:{code:"it-IT-PalmiraNeural",language:"it-IT",displayName:"Palmira",localName:"Palmira"},Pierina:{code:"it-IT-PierinaNeural",language:"it-IT",displayName:"Pierina",localName:"Pierina"},Benigno:{code:"it-IT-BenignoNeural",language:"it-IT",displayName:"Benigno",localName:"Benigno"},Calimero:{code:"it-IT-CalimeroNeural",language:"it-IT",displayName:"Calimero",localName:"Calimero"},Cataldo:{code:"it-IT-CataldoNeural",language:"it-IT",displayName:"Cataldo",localName:"Cataldo"},Gianni:{code:"it-IT-GianniNeural",language:"it-IT",displayName:"Gianni",localName:"Gianni"},Giuseppe:{code:"it-IT-GiuseppeNeural",language:"it-IT",displayName:"Giuseppe",localName:"Giuseppe"},Lisandro:{code:"it-IT-LisandroNeural",language:"it-IT",displayName:"Lisandro",localName:"Lisandro"},Rinaldo:{code:"it-IT-RinaldoNeural",language:"it-IT",displayName:"Rinaldo",localName:"Rinaldo"},Shiori:{code:"ja-JP-ShioriNeural",language:"ja-JP",displayName:"Shiori",localName:"志織"},Mayu:{code:"ja-JP-MayuNeural",language:"ja-JP",displayName:"Mayu",localName:"真夕"},Aoi:{code:"ja-JP-AoiNeural",language:"ja-JP",displayName:"Aoi",localName:"碧衣"},Naoki:{code:"ja-JP-NaokiNeural",language:"ja-JP",displayName:"Naoki",localName:"直紀"},Daichi:{code:"ja-JP-DaichiNeural",language:"ja-JP",displayName:"Daichi",localName:"大智"},JiMin:{code:"ko-KR-JiMinNeural",language:"ko-KR",displayName:"JiMin",localName:"지민"},SeoHyeon:{code:"ko-KR-SeoHyeonNeural",language:"ko-KR",displayName:"SeoHyeon",localName:"서현"},SoonBok:{code:"ko-KR-SoonBokNeural",language:"ko-KR",displayName:"SoonBok",localName:"순복"},YuJin:{code:"ko-KR-YuJinNeural",language:"ko-KR",displayName:"YuJin",localName:"유진"},BongJin:{code:"ko-KR-BongJinNeural",language:"ko-KR",displayName:"BongJin",localName:"봉진"},GookMin:{code:"ko-KR-GookMinNeural",language:"ko-KR",displayName:"GookMin",localName:"국민"},Hyunsu:{code:"ko-KR-HyunsuNeural",language:"ko-KR",displayName:"Hyunsu",localName:"현수"},Nilar:{code:"my-MM-NilarNeural",language:"my-MM",displayName:"Nilar",localName:"နီလာ"},Thiha:{code:"my-MM-ThihaNeural",language:"my-MM",displayName:"Thiha",localName:"သီဟ"},Iselin:{code:"nb-NO-IselinNeural",language:"nb-NO",displayName:"Iselin",localName:"Iselin"},Agnieszka:{code:"pl-PL-AgnieszkaNeural",language:"pl-PL",displayName:"Agnieszka",localName:"Agnieszka"},Giovanna:{code:"pt-BR-GiovannaNeural",language:"pt-BR",displayName:"Giovanna",localName:"Giovanna"},Leila:{code:"pt-BR-LeilaNeural",language:"pt-BR",displayName:"Leila",localName:"Leila"},Leticia:{code:"pt-BR-LeticiaNeural",language:"pt-BR",displayName:"Leticia",localName:"Leticia"},Yara:{code:"pt-BR-YaraNeural",language:"pt-BR",displayName:"Yara",localName:"Yara"},Manuela:{code:"pt-BR-ManuelaNeural",language:"pt-BR",displayName:"Manuela",localName:"Manuela"},Thalita:{code:"pt-BR-ThalitaNeural",language:"pt-BR",displayName:"Thalita",localName:"Thalita"},Elza:{code:"pt-BR-ElzaNeural",language:"pt-BR",displayName:"Elza",localName:"Elza"},Brenda:{code:"pt-BR-BrendaNeural",language:"pt-BR",displayName:"Brenda",localName:"Brenda"},Julio:{code:"pt-BR-JulioNeural",language:"pt-BR",displayName:"Julio",localName:"Julio"},Humberto:{code:"pt-BR-HumbertoNeural",language:"pt-BR",displayName:"Humberto",localName:"Humberto"},Nicolau:{code:"pt-BR-NicolauNeural",language:"pt-BR",displayName:"Nicolau",localName:"Nicolau"},Valerio:{code:"pt-BR-ValerioNeural",language:"pt-BR",displayName:"Valerio",localName:"Valerio"},Fabio:{code:"pt-BR-FabioNeural",language:"pt-BR",displayName:"Fabio",localName:"Fabio"},Donato:{code:"pt-BR-DonatoNeural",language:"pt-BR",displayName:"Donato",localName:"Donato"},Fernanda:{code:"pt-PT-FernandaNeural",language:"pt-PT",displayName:"Fernanda",localName:"Fernanda"},Dariya:{code:"ru-RU-DariyaNeural",language:"ru-RU",displayName:"Dariya",localName:"Дария"},Nicholas:{code:"sr-RS-NicholasNeural",language:"sr-RS",displayName:"Nicholas",localName:"Никола"},Sophie:{code:"sr-RS-SophieNeural",language:"sr-RS",displayName:"Sophie",localName:"Софија"},Hillevi:{code:"sv-SE-HilleviNeural",language:"sv-SE",displayName:"Hillevi",localName:"Hillevi"},Achara:{code:"th-TH-AcharaNeural",language:"th-TH",displayName:"Achara",localName:"อัจฉรา"},Xiaohan:{code:"zh-CN-XiaohanNeural",language:"zh-CN",displayName:"Xiaohan",localName:"晓涵"},Xiaomeng:{code:"zh-CN-XiaomengNeural",language:"zh-CN",displayName:"Xiaomeng",localName:"晓梦"},Xiaomo:{code:"zh-CN-XiaomoNeural",language:"zh-CN",displayName:"Xiaomo",localName:"晓莫"},Xiaoqiu:{code:"zh-CN-XiaoqiuNeural",language:"zh-CN",displayName:"Xiaoqiu",localName:"晓秋"},Xiaorui:{code:"zh-CN-XiaoruiNeural",language:"zh-CN",displayName:"Xiaorui",localName:"晓睿"},Xiaoshuang:{code:"zh-CN-XiaoshuangNeural",language:"zh-CN",displayName:"Xiaoshuang",localName:"晓双"},Xiaoyan:{code:"zh-CN-XiaoyanNeural",language:"zh-CN",displayName:"Xiaoyan",localName:"晓颜"},Xiaoxuan:{code:"zh-CN-XiaoxuanNeural",language:"zh-CN",displayName:"Xiaoxuan",localName:"晓萱"},Xiaoyou:{code:"zh-CN-XiaoyouNeural",language:"zh-CN",displayName:"Xiaoyou",localName:"晓悠"},Xiaozhen:{code:"zh-CN-XiaozhenNeural",language:"zh-CN",displayName:"Xiaozhen",localName:"晓甄"},Xiaorou:{code:"zh-CN-XiaorouNeural",language:"zh-CN",displayName:"Xiaorou",localName:"晓柔"},Xiaotong:{code:"wuu-CN-XiaotongNeural",language:"zh-CN",displayName:"Xiaotong",localName:"晓彤"},XiaoMin:{code:"yue-CN-XiaoMinNeural",language:"zh-CN",displayName:"XiaoMin",localName:"晓敏"},Xiaobei:{code:"zh-CN-liaoning-XiaobeiNeural",language:"zh-CN",displayName:"Xiaobei",localName:"晓北 辽宁"},Xiaoni:{code:"zh-CN-shaanxi-XiaoniNeural",language:"zh-CN",displayName:"Xiaoni",localName:"晓妮 陕西"},Yunfeng:{code:"zh-CN-yunfengNeural",language:"zh-CN",displayName:"Yunfeng",localName:"云枫"},Yunhao:{code:"zh-CN-yunhaoNeural",language:"zh-CN",displayName:"Yunhao",localName:"云皓"},Yunjie:{code:"zh-CN-yunjieNeural",language:"zh-CN",displayName:"Yunjie",localName:"云杰"},Yunye:{code:"zh-CN-yunyeNeural",language:"zh-CN",displayName:"Yunye",localName:"云野"},Yunze:{code:"zh-CN-yunzeNeural",language:"zh-CN",displayName:"Yunze",localName:"云泽"},Yunzhe:{code:"wuu-CN-YunzheNeural",language:"zh-CN",displayName:"Yunzhe",localName:"云哲"},YunSong:{code:"yue-CN-YunSongNeural",language:"zh-CN",displayName:"YunSong",localName:"云松"},Yunqi:{code:"zh-CN-guangxi-YunqiNeural",language:"zh-CN",displayName:"Yunqi",localName:"云奇 广西"},Yundeng:{code:"zh-CN-henan-YundengNeural",language:"zh-CN",displayName:"Yundeng",localName:"云登 河南"},Yunbiao:{code:"zh-CN-liaoning-YunbiaoNeural",language:"zh-CN",displayName:"Yunbiao",localName:"云彪 辽宁"},Yunxiang:{code:"zh-CN-shandong-YunxiangNeural",language:"zh-CN",displayName:"Yunxiang",localName:"云翔 山东"},"Yunxi-SiChuan":{code:"zh-CN-sichuan-YunxiNeural",language:"zh-CN",displayName:"Yunxi",localName:"云希 四川"},Emily:{code:"en-IE-EmilyNeural",language:"en-IE",displayName:"Emily",localName:"Emily"},Connor:{code:"en-IE-ConnorNeural",language:"en-IE",displayName:"Connor",localName:"Connor"},Noura:{code:"ar-KW-NouraNeural",language:"ar-KW",displayName:"Noura",localName:"نورا"},Fahed:{code:"ar-KW-FahedNeural",language:"ar-KW",displayName:"Fahed",localName:"فهد"},Rehema:{code:"sw-TZ-RehemaNeural",language:"sw-TZ",displayName:"Rehema",localName:"Rehema"},Daudi:{code:"sw-TZ-DaudiNeural",language:"sw-TZ",displayName:"Daudi",localName:"Daudi"},Yasmin:{code:"ms-MY-YasminNeural",language:"ms-MY",displayName:"Yasmin",localName:"Yasmin"},Osman:{code:"ms-MY-OsmanNeural",language:"ms-MY",displayName:"Osman",localName:"Osman"},Neerja:{code:"en-IN-NeerjaNeural",language:"en-IN",displayName:"Neerja",localName:"Neerja"},Prabhat:{code:"en-IN-PrabhatNeural",language:"en-IN",displayName:"Prabhat",localName:"Prabhat"},Sofia:{code:"es-BO-SofiaNeural",language:"es-BO",displayName:"Sofia",localName:"Sofia"},Marcelo:{code:"es-BO-MarceloNeural",language:"es-BO",displayName:"Marcelo",localName:"Marcelo"},Amany:{code:"ar-SY-AmanyNeural",language:"ar-SY",displayName:"Amany",localName:"أماني"},Laith:{code:"ar-SY-LaithNeural",language:"ar-SY",displayName:"Laith",localName:"ليث"},Leah:{code:"en-ZA-LeahNeural",language:"en-ZA",displayName:"Leah",localName:"Leah"},Luke:{code:"en-ZA-LukeNeural",language:"en-ZA",displayName:"Luke",localName:"Luke"},Pallavi:{code:"ta-IN-PallaviNeural",language:"ta-IN",displayName:"Pallavi",localName:"பல்லவி"},Valluvar:{code:"ta-IN-ValluvarNeural",language:"ta-IN",displayName:"Valluvar",localName:"வள்ளுவர்"},Athina:{code:"el-GR-AthinaNeural",language:"el-GR",displayName:"Athina",localName:"Αθηνά"},Nestoras:{code:"el-GR-NestorasNeural",language:"el-GR",displayName:"Nestoras",localName:"Νέστορας"},Fenna:{code:"nl-NL-FennaNeural",language:"nl-NL",displayName:"Fenna",localName:"Fenna"},Colette:{code:"nl-NL-ColetteNeural",language:"nl-NL",displayName:"Colette",localName:"Colette"},Maarten:{code:"nl-NL-MaartenNeural",language:"nl-NL",displayName:"Maarten",localName:"Maarten"},Thando:{code:"zu-ZA-ThandoNeural",language:"zu-ZA",displayName:"Thando",localName:"Thando"},Themba:{code:"zu-ZA-ThembaNeural",language:"zu-ZA",displayName:"Themba",localName:"Themba"},Layla:{code:"ar-LB-LaylaNeural",language:"ar-LB",displayName:"Layla",localName:"ليلى"},Rami:{code:"ar-LB-RamiNeural",language:"ar-LB",displayName:"Rami",localName:"رامي"},Natasha:{code:"en-AU-NatashaNeural",language:"en-AU",displayName:"Natasha",localName:"Natasha"},William:{code:"en-AU-WilliamNeural",language:"en-AU",displayName:"William",localName:"William"},Hila:{code:"he-IL-HilaNeural",language:"he-IL",displayName:"Hila",localName:"הילה"},Avri:{code:"he-IL-AvriNeural",language:"he-IL",displayName:"Avri",localName:"אברי"},Marija:{code:"mk-MK-MarijaNeural",language:"mk-MK",displayName:"Marija",localName:"Марија"},Aleksandar:{code:"mk-MK-AleksandarNeural",language:"mk-MK",displayName:"Aleksandar",localName:"Александар"},Reem:{code:"ar-TN-ReemNeural",language:"ar-TN",displayName:"Reem",localName:"ريم"},Hedi:{code:"ar-TN-HediNeural",language:"ar-TN",displayName:"Hedi",localName:"هادي"},Iman:{code:"ar-LY-ImanNeural",language:"ar-LY",displayName:"Iman",localName:"إيمان"},Omar:{code:"ar-LY-OmarNeural",language:"ar-LY",displayName:"Omar",localName:"أحمد"},Noemi:{code:"hu-HU-NoemiNeural",language:"hu-HU",displayName:"Noemi",localName:"Noémi"},Tamas:{code:"hu-HU-TamasNeural",language:"hu-HU",displayName:"Tamas",localName:"Tamás"},Sobhana:{code:"ml-IN-SobhanaNeural",language:"ml-IN",displayName:"Sobhana",localName:"ശോഭന"},Midhun:{code:"ml-IN-MidhunNeural",language:"ml-IN",displayName:"Midhun",localName:"മിഥുൻ"},Lorena:{code:"es-SV-LorenaNeural",language:"es-SV",displayName:"Lorena",localName:"Lorena"},Rodrigo:{code:"es-SV-RodrigoNeural",language:"es-SV",displayName:"Rodrigo",localName:"Rodrigo"},Maria:{code:"es-CR-MariaNeural",language:"es-CR",displayName:"Maria",localName:"María"},Juan:{code:"es-CR-JuanNeural",language:"es-CR",displayName:"Juan",localName:"Juan"},Catalina:{code:"es-CL-CatalinaNeural",language:"es-CL",displayName:"Catalina",localName:"Catalina"},Lorenzo:{code:"es-CL-LorenzoNeural",language:"es-CL",displayName:"Lorenzo",localName:"Lorenzo"},Sylvie:{code:"fr-CA-SylvieNeural",language:"fr-CA",displayName:"Sylvie",localName:"Sylvie"},Antoine:{code:"fr-CA-AntoineNeural",language:"fr-CA",displayName:"Antoine",localName:"Antoine"},Jean:{code:"fr-CA-JeanNeural",language:"fr-CA",displayName:"Jean",localName:"Jean"},Salome:{code:"es-CO-SalomeNeural",language:"es-CO",displayName:"Salome",localName:"Salome"},Gonzalo:{code:"es-CO-GonzaloNeural",language:"es-CO",displayName:"Gonzalo",localName:"Gonzalo"},Siti:{code:"jv-ID-SitiNeural",language:"jv-ID",displayName:"Siti",localName:"Siti"},Dimas:{code:"jv-ID-DimasNeural",language:"jv-ID",displayName:"Dimas",localName:"Dimas"},Zofia:{code:"pl-PL-ZofiaNeural",language:"pl-PL",displayName:"Zofia",localName:"Zofia"},Marek:{code:"pl-PL-MarekNeural",language:"pl-PL",displayName:"Marek",localName:"Marek"},Raquel:{code:"pt-PT-RaquelNeural",language:"pt-PT",displayName:"Raquel",localName:"Raquel"},Duarte:{code:"pt-PT-DuarteNeural",language:"pt-PT",displayName:"Duarte",localName:"Duarte"},Salma:{code:"ar-EG-SalmaNeural",language:"ar-EG",displayName:"Salma",localName:"سلمى"},Shakir:{code:"ar-EG-ShakirNeural",language:"ar-EG",displayName:"Shakir",localName:"شاكر"},Belkys:{code:"es-CU-BelkysNeural",language:"es-CU",displayName:"Belkys",localName:"Belkys"},Manuel:{code:"es-CU-ManuelNeural",language:"es-CU",displayName:"Manuel",localName:"Manuel"},Charline:{code:"fr-BE-CharlineNeural",language:"fr-BE",displayName:"Charline",localName:"Charline"},Gerard:{code:"fr-BE-GerardNeural",language:"fr-BE",displayName:"Gerard",localName:"Gerard"},Orla:{code:"ga-IE-OrlaNeural",language:"ga-IE",displayName:"Orla",localName:"Orla"},Colm:{code:"ga-IE-ColmNeural",language:"ga-IE",displayName:"Colm",localName:"Colm"},Nia:{code:"cy-GB-NiaNeural",language:"cy-GB",displayName:"Nia",localName:"Nia"},Aled:{code:"cy-GB-AledNeural",language:"cy-GB",displayName:"Aled",localName:"Aled"},Amina:{code:"ar-DZ-AminaNeural",language:"ar-DZ",displayName:"Amina",localName:"أمينة"},Ismael:{code:"ar-DZ-IsmaelNeural",language:"ar-DZ",displayName:"Ismael",localName:"إسماعيل"},Luna:{code:"en-SG-LunaNeural",language:"en-SG",displayName:"Luna",localName:"Luna"},Wayne:{code:"en-SG-WayneNeural",language:"en-SG",displayName:"Wayne",localName:"Wayne"},Mouna:{code:"ar-MA-MounaNeural",language:"ar-MA",displayName:"Mouna",localName:"منى"},Jamal:{code:"ar-MA-JamalNeural",language:"ar-MA",displayName:"Jamal",localName:"جمال"},Blessica:{code:"fil-PH-BlessicaNeural",language:"fil-PH",displayName:"Blessica",localName:"Blessica"},Angelo:{code:"fil-PH-AngeloNeural",language:"fil-PH",displayName:"Angelo",localName:"Angelo"},Venba:{code:"ta-SG-VenbaNeural",language:"ta-SG",displayName:"Venba",localName:"வெண்பா"},Anbu:{code:"ta-SG-AnbuNeural",language:"ta-SG",displayName:"Anbu",localName:"அன்பு"},Asilia:{code:"en-KE-AsiliaNeural",language:"en-KE",displayName:"Asilia",localName:"Asilia"},Chilemba:{code:"en-KE-ChilembaNeural",language:"en-KE",displayName:"Chilemba",localName:"Chilemba"},Karla:{code:"es-HN-KarlaNeural",language:"es-HN",displayName:"Karla",localName:"Karla"},Carlos:{code:"es-HN-CarlosNeural",language:"es-HN",displayName:"Carlos",localName:"Carlos"},Pernille:{code:"nb-NO-PernilleNeural",language:"nb-NO",displayName:"Pernille",localName:"Pernille"},Finn:{code:"nb-NO-FinnNeural",language:"nb-NO",displayName:"Finn",localName:"Finn"},Gabrijela:{code:"hr-HR-GabrijelaNeural",language:"hr-HR",displayName:"Gabrijela",localName:"Gabrijela"},Srecko:{code:"hr-HR-SreckoNeural",language:"hr-HR",displayName:"Srecko",localName:"Srecko"},Karina:{code:"es-PR-KarinaNeural",language:"es-PR",displayName:"Karina",localName:"Karina"},Victor:{code:"es-PR-VictorNeural",language:"es-PR",displayName:"Victor",localName:"Victor"},Adri:{code:"af-ZA-AdriNeural",language:"af-ZA",displayName:"Adri",localName:"Adri"},Willem:{code:"af-ZA-WillemNeural",language:"af-ZA",displayName:"Willem",localName:"Willem"},Sabela:{code:"gl-ES-SabelaNeural",language:"gl-ES",displayName:"Sabela",localName:"Sabela"},Roi:{code:"gl-ES-RoiNeural",language:"gl-ES",displayName:"Roi",localName:"Roi"},Tania:{code:"es-PY-TaniaNeural",language:"es-PY",displayName:"Tania",localName:"Tania"},Mario:{code:"es-PY-MarioNeural",language:"es-PY",displayName:"Mario",localName:"Mario"},Ingrid:{code:"de-AT-IngridNeural",language:"de-AT",displayName:"Ingrid",localName:"Ingrid"},Jonas:{code:"de-AT-JonasNeural",language:"de-AT",displayName:"Jonas",localName:"Jonas"},Saranya:{code:"ta-LK-SaranyaNeural",language:"ta-LK",displayName:"Saranya",localName:"சரண்யா"},Kumar:{code:"ta-LK-KumarNeural",language:"ta-LK",displayName:"Kumar",localName:"குமார்"},Gudrun:{code:"is-IS-GudrunNeural",language:"is-IS",displayName:"Gudrun",localName:"Guðrún"},Gunnar:{code:"is-IS-GunnarNeural",language:"is-IS",displayName:"Gunnar",localName:"Gunnar"},Kalina:{code:"bg-BG-KalinaNeural",language:"bg-BG",displayName:"Kalina",localName:"Калина"},Borislav:{code:"bg-BG-BorislavNeural",language:"bg-BG",displayName:"Borislav",localName:"Борислав"},Vlasta:{code:"cs-CZ-VlastaNeural",language:"cs-CZ",displayName:"Vlasta",localName:"Vlasta"},Antonin:{code:"cs-CZ-AntoninNeural",language:"cs-CZ",displayName:"Antonin",localName:"Antonin"},Rosa:{code:"en-PH-RosaNeural",language:"en-PH",displayName:"Rosa",localName:"Rosa"},James:{code:"en-PH-JamesNeural",language:"en-PH",displayName:"James",localName:"James"},Madina:{code:"uz-UZ-MadinaNeural",language:"uz-UZ",displayName:"Madina",localName:"Madina"},Sardor:{code:"uz-UZ-SardorNeural",language:"uz-UZ",displayName:"Sardor",localName:"Сардор"},HsiaoYu:{code:"zh-TW-HsiaoYuNeural",language:"zh-TW",displayName:"HsiaoYu",localName:"曉雨"},HsiaoChen:{code:"zh-TW-HsiaoChenNeural",language:"zh-TW",displayName:"HsiaoChen",localName:"曉臻"},YunJhe:{code:"zh-TW-YunJheNeural",language:"zh-TW",displayName:"YunJhe",localName:"雲哲"},Yan:{code:"en-HK-YanNeural",language:"en-HK",displayName:"Yan",localName:"Yan"},Sam:{code:"en-HK-SamNeural",language:"en-HK",displayName:"Sam",localName:"Sam"},SunHi:{code:"ko-KR-SunHiNeural",language:"ko-KR",displayName:"SunHi",localName:"선히"},InJoon:{code:"ko-KR-InJoonNeural",language:"ko-KR",displayName:"InJoon",localName:"인준"},Viktoria:{code:"sk-SK-ViktoriaNeural",language:"sk-SK",displayName:"Viktoria",localName:"Viktória"},Lukas:{code:"sk-SK-LukasNeural",language:"sk-SK",displayName:"Lukas",localName:"Lukáš"},Latifa:{code:"ps-AF-LatifaNeural",language:"ps-AF",displayName:"Latifa",localName:"لطيفه"},GulNawaz:{code:"ps-AF-GulNawazNeural",language:"ps-AF",displayName:"Gul Nawaz",localName:" ګل نواز"},Aysha:{code:"ar-OM-AyshaNeural",language:"ar-OM",displayName:"Aysha",localName:"عائشة"},Abdullah:{code:"ar-OM-AbdullahNeural",language:"ar-OM",displayName:"Abdullah",localName:"عبدالله"},Svetlana:{code:"ru-RU-SvetlanaNeural",language:"ru-RU",displayName:"Svetlana",localName:"Светлана"},Dmitry:{code:"ru-RU-DmitryNeural",language:"ru-RU",displayName:"Dmitry",localName:"Дмитрий"},Anila:{code:"sq-AL-AnilaNeural",language:"sq-AL",displayName:"Anila",localName:"Anila"},Ilir:{code:"sq-AL-IlirNeural",language:"sq-AL",displayName:"Ilir",localName:"Ilir"},Elena:{code:"es-AR-ElenaNeural",language:"es-AR",displayName:"Elena",localName:"Elena"},Tomas:{code:"es-AR-TomasNeural",language:"es-AR",displayName:"Tomas",localName:"Tomas"},Sofie:{code:"sv-SE-SofieNeural",language:"sv-SE",displayName:"Sofie",localName:"Sofie"},Mattias:{code:"sv-SE-MattiasNeural",language:"sv-SE",displayName:"Mattias",localName:"Mattias"},Mekdes:{code:"am-ET-MekdesNeural",language:"am-ET",displayName:"Mekdes",localName:"መቅደስ"},Ameha:{code:"am-ET-AmehaNeural",language:"am-ET",displayName:"Ameha",localName:"አምሀ"},Aarohi:{code:"mr-IN-AarohiNeural",language:"mr-IN",displayName:"Aarohi",localName:"आरोही"},Manohar:{code:"mr-IN-ManoharNeural",language:"mr-IN",displayName:"Manohar",localName:"मनोहर"},Christel:{code:"da-DK-ChristelNeural",language:"da-DK",displayName:"Christel",localName:"Christel"},Jeppe:{code:"da-DK-JeppeNeural",language:"da-DK",displayName:"Jeppe",localName:"Jeppe"},Yesui:{code:"mn-MN-YesuiNeural",language:"mn-MN",displayName:"Yesui",localName:"Есүй"},Bataa:{code:"mn-MN-BataaNeural",language:"mn-MN",displayName:"Bataa",localName:"Батаа"},Polina:{code:"uk-UA-PolinaNeural",language:"uk-UA",displayName:"Polina",localName:"Поліна"},Ostap:{code:"uk-UA-OstapNeural",language:"uk-UA",displayName:"Ostap",localName:"Остап"},Ana:{code:"en-US-AnaNeural",language:"en-US",displayName:"Ana",localName:"Ana"},Aria:{code:"en-US-AriaNeural",language:"en-US",displayName:"Aria",localName:"Aria"},Jenny:{code:"en-US-JennyNeural",language:"en-US",displayName:"Jenny",localName:"Jenny"},Roger:{code:"en-US-RogerNeural",language:"en-US",displayName:"Roger",localName:"Roger"},Christopher:{code:"en-US-ChristopherNeural",language:"en-US",displayName:"Christopher",localName:"Christopher"},Eric:{code:"en-US-EricNeural",language:"en-US",displayName:"Eric",localName:"Eric"},Steffan:{code:"en-US-SteffanNeural",language:"en-US",displayName:"Steffan",localName:"Steffan"},Guy:{code:"en-US-GuyNeural",language:"en-US",displayName:"Guy",localName:"Guy"},Kani:{code:"ta-MY-KaniNeural",language:"ta-MY",displayName:"Kani",localName:"கனி"},Surya:{code:"ta-MY-SuryaNeural",language:"ta-MY",displayName:"Surya",localName:"சூர்யா"},Dhwani:{code:"gu-IN-DhwaniNeural",language:"gu-IN",displayName:"Dhwani",localName:"ધ્વની"},Niranjan:{code:"gu-IN-NiranjanNeural",language:"gu-IN",displayName:"Niranjan",localName:"નિરંજન"},Everita:{code:"lv-LV-EveritaNeural",language:"lv-LV",displayName:"Everita",localName:"Everita"},Nils:{code:"lv-LV-NilsNeural",language:"lv-LV",displayName:"Nils",localName:"Nils"},Dena:{code:"nl-BE-DenaNeural",language:"nl-BE",displayName:"Dena",localName:"Dena"},Arnaud:{code:"nl-BE-ArnaudNeural",language:"nl-BE",displayName:"Arnaud",localName:"Arnaud"},Xiaoyi:{code:"zh-CN-XiaoyiNeural",language:"zh-CN",displayName:"Xiaoyi",localName:"晓伊"},Xiaoxiao:{code:"zh-CN-XiaoxiaoNeural",language:"zh-CN",displayName:"Xiaoxiao",localName:"晓晓"},Yunyang:{code:"zh-CN-YunyangNeural",language:"zh-CN",displayName:"Yunyang",localName:"云扬"},Yunxia:{code:"zh-CN-YunxiaNeural",language:"zh-CN",displayName:"Yunxia",localName:"云夏"},Yunxi:{code:"zh-CN-YunxiNeural",language:"zh-CN",displayName:"Yunxi",localName:"云希"},Yunjian:{code:"zh-CN-YunjianNeural",language:"zh-CN",displayName:"Yunjian",localName:"云健"},Uzma:{code:"ur-PK-UzmaNeural",language:"ur-PK",displayName:"Uzma",localName:"عظمیٰ"},Asad:{code:"ur-PK-AsadNeural",language:"ur-PK",displayName:"Asad",localName:"اسد"},Shruti:{code:"te-IN-ShrutiNeural",language:"te-IN",displayName:"Shruti",localName:"శ్రుతి"},Mohan:{code:"te-IN-MohanNeural",language:"te-IN",displayName:"Mohan",localName:"మోహన్"},Swara:{code:"hi-IN-SwaraNeural",language:"hi-IN",displayName:"Swara",localName:"स्वरा"},Madhur:{code:"hi-IN-MadhurNeural",language:"hi-IN",displayName:"Madhur",localName:"मधुर"},Ezinne:{code:"en-NG-EzinneNeural",language:"en-NG",displayName:"Ezinne",localName:"Ezinne"},Abeo:{code:"en-NG-AbeoNeural",language:"en-NG",displayName:"Abeo",localName:"Abeo"},Leni:{code:"de-CH-LeniNeural",language:"de-CH",displayName:"Leni",localName:"Leni"},Jan:{code:"de-CH-JanNeural",language:"de-CH",displayName:"Jan",localName:"Jan"},Nanami:{code:"ja-JP-NanamiNeural",language:"ja-JP",displayName:"Nanami",localName:"七海"},Keita:{code:"ja-JP-KeitaNeural",language:"ja-JP",displayName:"Keita",localName:"圭太"},Vesna:{code:"bs-BA-VesnaNeural",language:"bs-BA",displayName:"Vesna",localName:"Vesna"},Goran:{code:"bs-BA-GoranNeural",language:"bs-BA",displayName:"Goran",localName:"Goran"},Maryam:{code:"ar-YE-MaryamNeural",language:"ar-YE",displayName:"Maryam",localName:"مريم"},Saleh:{code:"ar-YE-SalehNeural",language:"ar-YE",displayName:"Saleh",localName:"صالح"},Hemkala:{code:"ne-NP-HemkalaNeural",language:"ne-NP",displayName:"Hemkala",localName:"हेमकला"},Sagar:{code:"ne-NP-SagarNeural",language:"ne-NP",displayName:"Sagar",localName:"सागर"},Eka:{code:"ka-GE-EkaNeural",language:"ka-GE",displayName:"Eka",localName:"ეკა"},Giorgi:{code:"ka-GE-GiorgiNeural",language:"ka-GE",displayName:"Giorgi",localName:"გიორგი"},Amal:{code:"ar-QA-AmalNeural",language:"ar-QA",displayName:"Amal",localName:"أمل"},Moaz:{code:"ar-QA-MoazNeural",language:"ar-QA",displayName:"Moaz",localName:"معاذ"},Marta:{code:"es-GT-MartaNeural",language:"es-GT",displayName:"Marta",localName:"Marta"},Andres:{code:"es-GT-AndresNeural",language:"es-GT",displayName:"Andres",localName:"Ándres"},Teresa:{code:"es-GQ-TeresaNeural",language:"es-GQ",displayName:"Teresa",localName:"Teresa"},Javier:{code:"es-GQ-JavierNeural",language:"es-GQ",displayName:"Javier",localName:"Javier"},Camila:{code:"es-PE-CamilaNeural",language:"es-PE",displayName:"Camila",localName:"Camila"},Alex:{code:"es-PE-AlexNeural",language:"es-PE",displayName:"Alex",localName:"Álex"},Molly:{code:"en-NZ-MollyNeural",language:"en-NZ",displayName:"Molly",localName:"Molly"},Mitchell:{code:"en-NZ-MitchellNeural",language:"en-NZ",displayName:"Mitchell",localName:"Mitchell"},Dilara:{code:"fa-IR-DilaraNeural",language:"fa-IR",displayName:"Dilara",localName:"دلارا"},Farid:{code:"fa-IR-FaridNeural",language:"fa-IR",displayName:"Farid",localName:"فرید"},Margarita:{code:"es-PA-MargaritaNeural",language:"es-PA",displayName:"Margarita",localName:"Margarita"},Roberto:{code:"es-PA-RobertoNeural",language:"es-PA",displayName:"Roberto",localName:"Roberto"},Alina:{code:"ro-RO-AlinaNeural",language:"ro-RO",displayName:"Alina",localName:"Alina"},Emil:{code:"ro-RO-EmilNeural",language:"ro-RO",displayName:"Emil",localName:"Emil"},Grace:{code:"mt-MT-GraceNeural",language:"mt-MT",displayName:"Grace",localName:"Grace"},Joseph:{code:"mt-MT-JosephNeural",language:"mt-MT",displayName:"Joseph",localName:"Joseph"},Anu:{code:"et-EE-AnuNeural",language:"et-EE",displayName:"Anu",localName:"Anu"},Kert:{code:"et-EE-KertNeural",language:"et-EE",displayName:"Kert",localName:"Kert"},Emel:{code:"tr-TR-EmelNeural",language:"tr-TR",displayName:"Emel",localName:"Emel"},Ahmet:{code:"tr-TR-AhmetNeural",language:"tr-TR",displayName:"Ahmet",localName:"Ahmet"},Denise:{code:"fr-FR-DeniseNeural",language:"fr-FR",displayName:"Denise",localName:"Denise"},Eloise:{code:"fr-FR-EloiseNeural",language:"fr-FR",displayName:"Eloise",localName:"Eloise"},Henri:{code:"fr-FR-HenriNeural",language:"fr-FR",displayName:"Henri",localName:"Henri"},HoaiMy:{code:"vi-VN-HoaiMyNeural",language:"vi-VN",displayName:"HoaiMy",localName:"Hoài My"},NamMinh:{code:"vi-VN-NamMinhNeural",language:"vi-VN",displayName:"NamMinh",localName:"Nam Minh"},Libby:{code:"en-GB-LibbyNeural",language:"en-GB",displayName:"Libby",localName:"Libby"},Sonia:{code:"en-GB-SoniaNeural",language:"en-GB",displayName:"Sonia",localName:"Sonia"},Thomas:{code:"en-GB-ThomasNeural",language:"en-GB",displayName:"Thomas",localName:"Thomas"},Ryan:{code:"en-GB-RyanNeural",language:"en-GB",displayName:"Ryan",localName:"Ryan"},Sreymom:{code:"km-KH-SreymomNeural",language:"km-KH",displayName:"Sreymom",localName:"ស្រីមុំ"},Piseth:{code:"km-KH-PisethNeural",language:"km-KH",displayName:"Piseth",localName:"ពិសិដ្ឋ"},Noora:{code:"fi-FI-NooraNeural",language:"fi-FI",displayName:"Noora",localName:"Noora"},Harri:{code:"fi-FI-HarriNeural",language:"fi-FI",displayName:"Harri",localName:"Harri"},Banu:{code:"az-AZ-BanuNeural",language:"az-AZ",displayName:"Banu",localName:"Banu"},Babek:{code:"az-AZ-BabekNeural",language:"az-AZ",displayName:"Babek",localName:"Babək"},Clara:{code:"en-CA-ClaraNeural",language:"en-CA",displayName:"Clara",localName:"Clara"},Liam:{code:"en-CA-LiamNeural",language:"en-CA",displayName:"Liam",localName:"Liam"},Ona:{code:"lt-LT-OnaNeural",language:"lt-LT",displayName:"Ona",localName:"Ona"},Leonas:{code:"lt-LT-LeonasNeural",language:"lt-LT",displayName:"Leonas",localName:"Leonas"},Fatima:{code:"ar-AE-FatimaNeural",language:"ar-AE",displayName:"Fatima",localName:"فاطمة"},Hamdan:{code:"ar-AE-HamdanNeural",language:"ar-AE",displayName:"Hamdan",localName:"حمدان"},Petra:{code:"sl-SI-PetraNeural",language:"sl-SI",displayName:"Petra",localName:"Petra"},Rok:{code:"sl-SI-RokNeural",language:"sl-SI",displayName:"Rok",localName:"Rok"},Ramona:{code:"es-DO-RamonaNeural",language:"es-DO",displayName:"Ramona",localName:"Ramona"},Emilio:{code:"es-DO-EmilioNeural",language:"es-DO",displayName:"Emilio",localName:"Emilio"},Rana:{code:"ar-IQ-RanaNeural",language:"ar-IQ",displayName:"Rana",localName:"رنا"},Bassel:{code:"ar-IQ-BasselNeural",language:"ar-IQ",displayName:"Bassel",localName:"باسل"},Tanishaa:{code:"bn-IN-TanishaaNeural",language:"bn-IN",displayName:"Tanishaa",localName:"তানিশা"},Bashkar:{code:"bn-IN-BashkarNeural",language:"bn-IN",displayName:"Bashkar",localName:"ভাস্কর"},Thilini:{code:"si-LK-ThiliniNeural",language:"si-LK",displayName:"Thilini",localName:"තිළිණි"},Sameera:{code:"si-LK-SameeraNeural",language:"si-LK",displayName:"Sameera",localName:"සමීර"},Ariane:{code:"fr-CH-ArianeNeural",language:"fr-CH",displayName:"Ariane",localName:"Ariane"},Fabrice:{code:"fr-CH-FabriceNeural",language:"fr-CH",displayName:"Fabrice",localName:"Fabrice"},Andrea:{code:"es-EC-AndreaNeural",language:"es-EC",displayName:"Andrea",localName:"Andrea"},Luis:{code:"es-EC-LuisNeural",language:"es-EC",displayName:"Luis",localName:"Luis"},Paloma:{code:"es-US-PalomaNeural",language:"es-US",displayName:"Paloma",localName:"Paloma"},Alonso:{code:"es-US-AlonsoNeural",language:"es-US",displayName:"Alonso",localName:"Alonso"},Sapna:{code:"kn-IN-SapnaNeural",language:"kn-IN",displayName:"Sapna",localName:"ಸಪ್ನಾ"},Gagan:{code:"kn-IN-GaganNeural",language:"kn-IN",displayName:"Gagan",localName:"ಗಗನ್"},Keomany:{code:"lo-LA-KeomanyNeural",language:"lo-LA",displayName:"Keomany",localName:"ແກ້ວມະນີ"},Chanthavong:{code:"lo-LA-ChanthavongNeural",language:"lo-LA",displayName:"Chanthavong",localName:"ຈັນທະວົງ"},Zariyah:{code:"ar-SA-ZariyahNeural",language:"ar-SA",displayName:"Zariyah",localName:"زارية"},Hamed:{code:"ar-SA-HamedNeural",language:"ar-SA",displayName:"Hamed",localName:"حامد"},Joana:{code:"ca-ES-JoanaNeural",language:"ca-ES",displayName:"Joana",localName:"Joana"},Enric:{code:"ca-ES-EnricNeural",language:"ca-ES",displayName:"Enric",localName:"Enric"},Katja:{code:"de-DE-KatjaNeural",language:"de-DE",displayName:"Katja",localName:"Katja"},Amala:{code:"de-DE-AmalaNeural",language:"de-DE",displayName:"Amala",localName:"Amala"},Conrad:{code:"de-DE-ConradNeural",language:"de-DE",displayName:"Conrad",localName:"Conrad"},Killian:{code:"de-DE-KillianNeural",language:"de-DE",displayName:"Killian",localName:"Killian"},HiuGaai:{code:"zh-HK-HiuGaaiNeural",language:"zh-HK",displayName:"HiuGaai",localName:"曉佳"},HiuMaan:{code:"zh-HK-HiuMaanNeural",language:"zh-HK",displayName:"HiuMaan",localName:"曉曼"},WanLung:{code:"zh-HK-WanLungNeural",language:"zh-HK",displayName:"WanLung",localName:"雲龍"},Francisca:{code:"pt-BR-FranciscaNeural",language:"pt-BR",displayName:"Francisca",localName:"Francisca"},Antonio:{code:"pt-BR-AntonioNeural",language:"pt-BR",displayName:"Antonio",localName:"Antonio"},Valentina:{code:"es-UY-ValentinaNeural",language:"es-UY",displayName:"Valentina",localName:"Valentina"},Mateo:{code:"es-UY-MateoNeural",language:"es-UY",displayName:"Mateo",localName:"Mateo"},Zuri:{code:"sw-KE-ZuriNeural",language:"sw-KE",displayName:"Zuri",localName:"Zuri"},Rafiki:{code:"sw-KE-RafikiNeural",language:"sw-KE",displayName:"Rafiki",localName:"Rafiki"},Laila:{code:"ar-BH-LailaNeural",language:"ar-BH",displayName:"Laila",localName:"ليلى"},Ali:{code:"ar-BH-AliNeural",language:"ar-BH",displayName:"Ali",localName:"علي"},Elvira:{code:"es-ES-ElviraNeural",language:"es-ES",displayName:"Elvira",localName:"Elvira"},Alvaro:{code:"es-ES-AlvaroNeural",language:"es-ES",displayName:"Alvaro",localName:"Alvaro"},Aigul:{code:"kk-KZ-AigulNeural",language:"kk-KZ",displayName:"Aigul",localName:"Айгүл"},Daulet:{code:"kk-KZ-DauletNeural",language:"kk-KZ",displayName:"Daulet",localName:"Дәулет"},Sana:{code:"ar-JO-SanaNeural",language:"ar-JO",displayName:"Sana",localName:"سناء"},Taim:{code:"ar-JO-TaimNeural",language:"ar-JO",displayName:"Taim",localName:"تيم"},Paola:{code:"es-VE-PaolaNeural",language:"es-VE",displayName:"Paola",localName:"Paola"},Sebastian:{code:"es-VE-SebastianNeural",language:"es-VE",displayName:"Sebastian",localName:"Sebastián"},Ubax:{code:"so-SO-UbaxNeural",language:"so-SO",displayName:"Ubax",localName:"Ubax"},Muuse:{code:"so-SO-MuuseNeural",language:"so-SO",displayName:"Muuse",localName:"Muuse"},Imani:{code:"en-TZ-ImaniNeural",language:"en-TZ",displayName:"Imani",localName:"Imani"},Elimu:{code:"en-TZ-ElimuNeural",language:"en-TZ",displayName:"Elimu",localName:"Elimu"},Tuti:{code:"su-ID-TutiNeural",language:"su-ID",displayName:"Tuti",localName:"Tuti"},Jajang:{code:"su-ID-JajangNeural",language:"su-ID",displayName:"Jajang",localName:"Jajang"},Dalia:{code:"es-MX-DaliaNeural",language:"es-MX",displayName:"Dalia",localName:"Dalia"},Jorge:{code:"es-MX-JorgeNeural",language:"es-MX",displayName:"Jorge",localName:"Jorge"},Elsa:{code:"it-IT-ElsaNeural",language:"it-IT",displayName:"Elsa",localName:"Elsa"},Isabella:{code:"it-IT-IsabellaNeural",language:"it-IT",displayName:"Isabella",localName:"Isabella"},Diego:{code:"it-IT-DiegoNeural",language:"it-IT",displayName:"Diego",localName:"Diego"},Gul:{code:"ur-IN-GulNeural",language:"ur-IN",displayName:"Gul",localName:"گل"},Salman:{code:"ur-IN-SalmanNeural",language:"ur-IN",displayName:"Salman",localName:"سلمان"},Nabanita:{code:"bn-BD-NabanitaNeural",language:"bn-BD",displayName:"Nabanita",localName:"নবনীতা"},Pradeep:{code:"bn-BD-PradeepNeural",language:"bn-BD",displayName:"Pradeep",localName:"প্রদ্বীপ"},Gadis:{code:"id-ID-GadisNeural",language:"id-ID",displayName:"Gadis",localName:"Gadis"},Ardi:{code:"id-ID-ArdiNeural",language:"id-ID",displayName:"Ardi",localName:"Ardi"},Yolanda:{code:"es-NI-YolandaNeural",language:"es-NI",displayName:"Yolanda",localName:"Yolanda"},Federico:{code:"es-NI-FedericoNeural",language:"es-NI",displayName:"Federico",localName:"Federico"},Premwadee:{code:"th-TH-PremwadeeNeural",language:"th-TH",displayName:"Premwadee",localName:"เปรมวดี"},Niwat:{code:"th-TH-NiwatNeural",language:"th-TH",displayName:"Niwat",localName:"นิวัฒน์"}},Kb={"af-ZA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"am-ET":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-AE":{0:[],1:[]},"ar-BH":{0:[],1:[]},"ar-DZ":{0:[],1:[]},"ar-EG":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-IQ":{0:[],1:[]},"ar-JO":{0:[],1:[]},"ar-KW":{0:[],1:[]},"ar-LB":{0:[],1:[]},"ar-LY":{0:[],1:[]},"ar-MA":{0:[],1:[]},"ar-OM":{0:[],1:[]},"ar-QA":{0:[],1:[]},"ar-SA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ar-SY":{0:[],1:[]},"ar-TN":{0:[],1:[]},"ar-YE":{0:[],1:[]},"az-AZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bg-BG":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bn-BD":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bn-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"bs-BA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ca-ES":{0:["Alba","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"cs-CZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"cy-GB":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"da-DK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-AT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-CH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"de-DE":{0:["Seraphina:DragonHDLatestNeural","Gisela","Elke","Klarissa","Louisa","Maja","Tanja","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Bernd","Kasper","Christoph","Klaus","Ralf","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"el-GR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-AU":{0:["Annette","Carly","Elsie","Freya","Joanne","Kim","Tina","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Darren","Duncan","Ken","Neil","Tim","AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-CA":{0:["AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-GB":{0:["Abbi","Bella","Hollie","Olivia","Mia","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Alfie","Elliot","Ethan","Noah","Oliver","RyanMultilingual","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-HK":{0:["JennyMultilingual"],1:["RyanMultilingual"]},"en-IE":{0:["AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-IN":{0:["Aashi","Ananya","Kavya","AvaMultilingual","EmmaMultilingual","JennyMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"en-KE":{0:[],1:[]},"en-NG":{0:[],1:[]},"en-NZ":{0:[],1:[]},"en-PH":{0:[],1:[]},"en-SG":{0:[],1:[]},"en-TZ":{0:[],1:[]},"en-US":{0:["Aria:DragonHDLatestNeural","Ava:DragonHDLatestNeural","Emma:DragonHDLatestNeural","Emma2:DragonHDLatestNeural","Jenny:DragonHDLatestNeural","Jane","Sara","Nancy","Amber","Ashley","Cora","Elizabeth","Monica","AIGenerate2","Blue","JennyMultilingual","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Andrew:DragonHDLatestNeural","Andrew2:DragonHDLatestNeural","Davis:DragonHDLatestNeural","Steffan:DragonHDLatestNeural","Davis","Jason","Tony","Brandon","Jacob","AIGenerate1","Blue","AndrewMultilingual","BrianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual","FlorianMultilingual"]},"en-ZA":{0:[],1:[]},"es-AR":{0:[],1:[]},"es-BO":{0:[],1:[]},"es-CL":{0:[],1:[]},"es-CO":{0:[],1:[]},"es-CR":{0:[],1:[]},"es-CU":{0:[],1:[]},"es-DO":{0:[],1:[]},"es-EC":{0:[],1:[]},"es-ES":{0:["Abril","Estrella","Irene","Laia","Lia","Triana","Vera","Ximena","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Arnau","Dario","Elias","Nil","Saul","Teo","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"es-GQ":{0:[],1:[]},"es-GT":{0:[],1:[]},"es-HN":{0:[],1:[]},"es-MX":{0:["Beatriz","Candela","Carlota","Larissa","Marina","Nuria","Renata","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Cecilio","Gerardo","Liberto","Luciano","Pelayo","Yago","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"es-NI":{0:[],1:[]},"es-PA":{0:[],1:[]},"es-PE":{0:[],1:[]},"es-PR":{0:[],1:[]},"es-PY":{0:[],1:[]},"es-SV":{0:[],1:[]},"es-US":{0:[],1:[]},"es-UY":{0:[],1:[]},"es-VE":{0:[],1:[]},"et-EE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"eu-ES":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fa-IR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fi-FI":{0:["Selma","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fil-PH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","RyanMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-BE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-CA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Thierry","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-CH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"fr-FR":{0:["Jacqueline","Josephine","Brigitte","Coralie","Celeste","Yvette","AvaMultilingual","EmmaMultilingual","VivienneMultilingual","SeraphinaMultilingual","JennyMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Claude","Alain","Jerome","Maurice","Yves","AndrewMultilingual","BrianMultilingual","RemyMultilingual","FlorianMultilingual","RyanMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ga-IE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"gl-ES":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"gu-IN":{0:[],1:[]},"he-IL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hi-IN":{0:["Ananya-hi","Kavya-hi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hr-HR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hu-HU":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"hy-AM":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"id-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"is-IS":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"it-IT":{0:["Fabiola","Fiamma","Imelda","Irma","Palmira","Pierina","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Benigno","Calimero","Cataldo","Gianni","Giuseppe","Lisandro","Rinaldo","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ja-JP":{0:["Shiori","Mayu","Aoi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Masaru:DragonHDLatestNeural","Naoki","Daichi","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"jv-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ka-GE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"kk-KZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"km-KH":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"kn-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ko-KR":{0:["JiMin","SeoHyeon","SoonBok","YuJin","SeraphinaMultilingual","AvaMultilingual","EmmaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["BongJin","GookMin","Hyunsu","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lo-LA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lt-LT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"lv-LV":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mk-MK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ml-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mn-MN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mr-IN":{0:[],1:[]},"ms-MY":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"mt-MT":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"my-MM":{0:["Nilar","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Thiha","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nb-NO":{0:["Iselin","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ne-NP":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nl-BE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"nl-NL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pl-PL":{0:["Agnieszka","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ps-AF":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pt-BR":{0:["Giovanna","Leila","Leticia","Yara","Manuela","Thalita","Elza","Brenda","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["Julio","Humberto","Nicolau","Valerio","Fabio","Donato","AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"pt-PT":{0:["Fernanda","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ro-RO":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ru-RU":{0:["Dariya","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"si-LK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sk-SK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sl-SI":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"so-SO":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sq-AL":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sr-RS":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"su-ID":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sv-SE":{0:["Hillevi","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sw-KE":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"sw-TZ":{0:[],1:[]},"ta-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ta-LK":{0:[],1:[]},"ta-MY":{0:[],1:[]},"ta-SG":{0:[],1:[]},"te-IN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"th-TH":{0:["Achara","AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"tr-TR":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"uk-UA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"ur-IN":{0:[],1:[]},"ur-PK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"uz-UZ":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"vi-VN":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zh-CN":{0:["Xiaochen:DragonHDLatestNeural","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual","Xiaohan","Xiaomeng","Xiaomo","Xiaoqiu","Xiaorui","Xiaoshuang","Xiaoyan","Xiaoxuan","Xiaoyou","Xiaozhen","Xiaorou","Xiaotong","XiaoMin","Xiaobei","Xiaoni"],1:["YunyiMultilingual","Yunfeng","Yunhao","Yunjie","Yunye","Yunze","Yunzhe","YunSong","Yunqi","Yundeng","Yunbiao","Yunxiang","Yunxi-SiChuan"]},"zh-HK":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zh-TW":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","JennyMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RyanMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]},"zu-ZA":{0:["AvaMultilingual","EmmaMultilingual","SeraphinaMultilingual","VivienneMultilingual","XiaoxiaoMultilingual","XiaochenMultilingual","XiaoyuMultilingual"],1:["AndrewMultilingual","BrianMultilingual","FlorianMultilingual","RemyMultilingual","MasaruMultilingual","YunyiMultilingual"]}};class Wb{static isEdgeVoice(e){let t=Hb[hi.toLanguage][0];if(_t.isArray(t)){for(let r of t)if(Lu[r].code===e)return!0}let i=Hb[hi.toLanguage][1];if(_t.isArray(i)){for(let r of i)if(Lu[r].code===e)return!0}return!1}static isAzureVoice(e){let t=Kb[hi.toLanguage][0];if(_t.isArray(t)){for(let r of t)if(Lu[r].code===e)return!0}let i=Kb[hi.toLanguage][1];if(_t.isArray(i)){for(let r of i)if(Lu[r].code===e)return!0}return!1}}class Yb{static isMobile(){return"ontouchstart"in document.documentElement}}const $t=class $t{static get fromLanguage(){return this._fromLanguage}static set fromLanguage(e){this._fromLanguage=e}static get toLanguage(){return this._toLanguage}static set toLanguage(e){this._toLanguage=e}static get gender(){return this._gender}static set gender(e){this._gender=e}static get voice(){return this._voice}static set voice(e){this._voice=e}static get originalVolume(){return this._originalVolume}static set originalVolume(e){this._originalVolume=e}static get translationVolume(){return this._translationVolume}static set translationVolume(e){this._translationVolume=e}static get adjustmentModel(){return this._adjustmentModel}static set adjustmentModel(e){this._adjustmentModel=e}static get loadingContainerDiv(){return this._loadingContainerDiv}static set loadingContainerDiv(e){this._loadingContainerDiv=e}static get translateEngine(){return this._translateEngine}static set translateEngine(e){this._translateEngine=e}static set voicesType(e){this._voicesType=e}static get voicesType(){return this._voicesType}static set videoVolumeControlModel(e){this._videoVolumeControlModel=e}static get videoVolumeControlModel(){return this._videoVolumeControlModel}static set iosOpenOriginVolume(e){this._iosOpenOriginVolume=e}static get iosOpenOriginVolume(){return this._iosOpenOriginVolume}static set showSubtitle(e){this._showSubtitle=e}static get showSubtitle(){return this._showSubtitle}static set floatingBall(e){this._floatingBall=e}static get floatingBall(){return this._floatingBall}static set multiSpeaker(e){this._multiSpeaker=e}static get multiSpeaker(){return this._multiSpeaker}static hasMultipleSpeakers(){return this._multiSpeaker&&this._multiSpeaker.length>1}static set subtitleSize(e){this._subtitleSize=e}static get subtitleSize(){return this._subtitleSize}static isVoiceTypeMatchMultiVoice(){let e=$t.multiSpeaker[0];return $t.isUseFreeVoiceType()?Wb.isEdgeVoice(e):Wb.isAzureVoice(e)}static isUseFreeVoiceType(){return!$t.voicesType||$t.voicesType==="free"}static matchFromLanguage(e){let t=this._fromLanguage.toLowerCase(),i=e.toLowerCase();return t==="zh-cn"?i==="zh-hans"||i==="zh-cn"||i==="cn"?!0:t.startsWith(e):t==="zh-hk"||t==="zh-tw"?i==="zh-hant"||i==="zh-hk"||i==="zh-tw"||i==="tw"||i==="hk"?!0:t.startsWith(e):i===t?!0:i.length>t.length?i.startsWith(t):t.startsWith(i)}static get segmentationStrategy(){return this._segmentationStrategy}static set segmentationStrategy(e){this._segmentationStrategy=e}static get enableSmartSegmentation(){return this._enableSmartSegmentation}static set enableSmartSegmentation(e){this._enableSmartSegmentation=e}static get longSubtitleThreshold(){return this._longSubtitleThreshold}static set longSubtitleThreshold(e){this._longSubtitleThreshold=e}};X($t,"_fromLanguage","en-US"),X($t,"_toLanguage","zh_CN"),X($t,"_gender","1"),X($t,"_voice",""),X($t,"_originalVolume",0),X($t,"_translationVolume",1),X($t,"_videoVolumeControlModel",!1),X($t,"_adjustmentModel",!0),X($t,"_loadingContainerDiv"),X($t,"_translateEngine","google"),X($t,"_voicesType","free"),X($t,"_iosOpenOriginVolume",!1),X($t,"_showSubtitle",!1),X($t,"_floatingBall",Yb.isMobile()),X($t,"_multiSpeaker",[]),X($t,"_subtitleSize",20),X($t,"_segmentationStrategy","reverse"),X($t,"_enableSmartSegmentation",!0),X($t,"_longSubtitleThreshold",60);let hi=$t;class Ha{getBestSubtitle(e,t){const i=this.getSubtitles(e,t),r=this.selectBestSubtitle(i);return this.postProcessSubtitle(r,t)}selectBestSubtitle(e){if(!(!e||_t.isEmpty(e))){if(e.length===1)return e[0];{let t=_t.groupBy(e,r=>r.isAsr);const i=t.false;return _t.isEmpty(i)?this.selectBestSubtitleByLanguage(t.true):this.selectBestSubtitleByLanguage(i)}}}selectBestSubtitleByLanguage(e){if(e.length===1)return e[0];try{return sr.of(e).filter(t=>hi.matchFromLanguage(t.language)).toFirst()}catch{return e[0]}}postProcessSubtitle(e,t){return e}}class Qi{static completeUrl(e){return e.startsWith("//")?window.location.protocol+e:e.startsWith("/")?window.location.origin+e:e}static resolveUrl(e,t){try{return new URL(e).href}catch{try{return new URL(e,t).href}catch{return e}}}static extractVideoId(e,t){const i=Bf.match(t),r=new URL(e).pathname,s=i(r);if(s)return s.params.videoId}static endsWith(e,t){try{return new URL(e).pathname.endsWith(t)}catch{return!1}}static addParam(e,t,i){try{const r=new URL(e);return r.searchParams.set(t,i),r.toString()}catch{const s=e.includes("?")?"&":"?";return`${e}${s}${encodeURIComponent(t)}=${encodeURIComponent(i)}`}}static replaceParam(e,t,i){try{const r=new URL(e);return r.searchParams.has(t)?(r.searchParams.set(t,i),r.toString()):e}catch{try{const s=e.indexOf("#"),a=s>=0?e.substring(s):"",o=s>=0?e.substring(0,s):e,l=o.indexOf("?");if(l===-1)return e;const u=o.substring(0,l),d=o.substring(l+1).split("&");let p=!1;const g=d.map(m=>{if(!m)return m;const y=m.indexOf("="),b=y>=0?m.substring(0,y):m;return decodeURIComponent(b)===t?(p=!0,`${b}=${encodeURIComponent(i)}`):m});return p?`${u}?${g.join("&")}${a}`:e}catch{return e}}}static removeQueryParams(e){try{const t=new URL(e);return t.search="",t.toString()}catch{return e}}}class zb extends Ha{getSubtitles(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract subtitles using JSONPath"),Error("Context vo object is missing, unable to extract subtitles using JSONPath");if(!e.subtitleListJsonPath)throw console.error("Subtitle extraction configuration is missing subtitleListJsonPath property",e),new Error("Subtitle extraction configuration is missing subtitleListJsonPath property");const i=on(t.data,e.subtitleListJsonPath);return _t.isEmpty(i)?[]:sr.of(i).map(r=>this.buildSubtitleMetaData(r,e)).toArray()}buildSubtitleMetaData(e,t){const i=this.isAsr(e,t);return{url:Qi.completeUrl(e[t.subtitleUrlName]),language:e[t.subtitleLanguageName],isAsr:i,hasPunctuation:!i}}isAsr(e,t){return!t.subtitleAsrName||!t.subtitleAsrValue?!1:String(e[t.subtitleAsrName])===t.subtitleAsrValue}}class YI{getVideoLanguage(e,t){const i=e.subtitleExtract,r=new zb().getSubtitles(i,t);if(!_t.isEmpty(r)){for(const s of r)if(s.isAsr)return s.language}}}class zI{getTitle(e,t){if(t.data===void 0)throw console.error("Context does not contain vo object, unable to extract video title"),new Error("Context vo is undefined, cannot extract title");if(!e.values||_t.isEmpty(e.values))throw console.error("Title extraction configuration is missing jsonPath expressions",e),new Error("ExtractTitleConfig values are empty or undefined");return sr.of(e.values).map(r=>on(t.data,r)).flatten().toArray()[0]}}class jI{getTitle(e,t){if(!e.values||_t.isEmpty(e.values))throw console.error("Title extraction rule missing values property",e),new Error("Title extraction rule missing values property");const i=t.computeUrlMatchResultIfAbsent(()=>Bf.match(e.values[0],{decode:decodeURIComponent})(window.location.href));if(!i)throw console.error("Title extraction rule configuration error for current URL",e),new Error("Title extraction rule configuration error for current URL");return i.params[e.values[1]]}}const Pn=document,_u=window,jb=Pn.documentElement,Zs=Pn.createElement.bind(Pn),Xb=Zs("div"),Uf=Zs("table"),XI=Zs("tbody"),Jb=Zs("tr"),{isArray:Mu,prototype:Qb}=Array,{concat:JI,filter:$f,indexOf:Zb,map:e1,push:QI,slice:t1,some:Gf,splice:ZI}=Qb,eC=/^#(?:[\w-]|\\.|[^\x00-\xa0])*$/,tC=/^\.(?:[\w-]|\\.|[^\x00-\xa0])*$/,iC=/<.+>/,rC=/^\w+$/;function qf(n,e){const t=nC(e);return!n||!t&&!ea(e)&&!vi(e)?[]:!t&&tC.test(n)?e.getElementsByClassName(n.slice(1).replace(/\\/g,"")):!t&&rC.test(n)?e.getElementsByTagName(n):e.querySelectorAll(n)}class ku{constructor(e,t){if(!e)return;if(Vf(e))return e;let i=e;if(Vi(e)){const r=t||Pn;if(i=eC.test(e)&&ea(r)?r.getElementById(e.slice(1).replace(/\\/g,"")):iC.test(e)?o1(e):Vf(r)?r.find(e):Vi(r)?Le(r).find(e):qf(e,r),!i)return}else if(ta(e))return this.ready(e);(i.nodeType||i===_u)&&(i=[i]),this.length=i.length;for(let r=0,s=this.length;r<s;r++)this[r]=i[r]}init(e,t){return new ku(e,t)}}const De=ku.prototype,Le=De.init;Le.fn=Le.prototype=De,De.length=0,De.splice=ZI,typeof Symbol=="function"&&(De[Symbol.iterator]=Qb[Symbol.iterator]);function Vf(n){return n instanceof ku}function Ka(n){return!!n&&n===n.window}function ea(n){return!!n&&n.nodeType===9}function nC(n){return!!n&&n.nodeType===11}function vi(n){return!!n&&n.nodeType===1}function sC(n){return!!n&&n.nodeType===3}function aC(n){return typeof n=="boolean"}function ta(n){return typeof n=="function"}function Vi(n){return typeof n=="string"}function lr(n){return n===void 0}function il(n){return n===null}function i1(n){return!isNaN(parseFloat(n))&&isFinite(n)}function Hf(n){if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return e===null||e===Object.prototype}Le.isWindow=Ka,Le.isFunction=ta,Le.isArray=Mu,Le.isNumeric=i1,Le.isPlainObject=Hf;function wi(n,e,t){if(t){let i=n.length;for(;i--;)if(e.call(n[i],i,n[i])===!1)return n}else if(Hf(n)){const i=Object.keys(n);for(let r=0,s=i.length;r<s;r++){const a=i[r];if(e.call(n[a],a,n[a])===!1)return n}}else for(let i=0,r=n.length;i<r;i++)if(e.call(n[i],i,n[i])===!1)return n;return n}Le.each=wi,De.each=function(n){return wi(this,n)},De.empty=function(){return this.each((n,e)=>{for(;e.firstChild;)e.removeChild(e.firstChild)})};function Pu(...n){const e=aC(n[0])?n.shift():!1,t=n.shift(),i=n.length;if(!t)return{};if(!i)return Pu(e,Le,t);for(let r=0;r<i;r++){const s=n[r];for(const a in s)e&&(Mu(s[a])||Hf(s[a]))?((!t[a]||t[a].constructor!==s[a].constructor)&&(t[a]=new s[a].constructor),Pu(e,t[a],s[a])):t[a]=s[a]}return t}Le.extend=Pu,De.extend=function(n){return Pu(De,n)};const oC=/\S+/g;function Ou(n){return Vi(n)?n.match(oC)||[]:[]}De.toggleClass=function(n,e){const t=Ou(n),i=!lr(e);return this.each((r,s)=>{vi(s)&&wi(t,(a,o)=>{i?e?s.classList.add(o):s.classList.remove(o):s.classList.toggle(o)})})},De.addClass=function(n){return this.toggleClass(n,!0)},De.removeAttr=function(n){const e=Ou(n);return this.each((t,i)=>{vi(i)&&wi(e,(r,s)=>{i.removeAttribute(s)})})};function lC(n,e){if(n){if(Vi(n)){if(arguments.length<2){if(!this[0]||!vi(this[0]))return;const t=this[0].getAttribute(n);return il(t)?void 0:t}return lr(e)?this:il(e)?this.removeAttr(n):this.each((t,i)=>{vi(i)&&i.setAttribute(n,e)})}for(const t in n)this.attr(t,n[t]);return this}}De.attr=lC,De.removeClass=function(n){return arguments.length?this.toggleClass(n,!1):this.attr("class","")},De.hasClass=function(n){return!!n&&Gf.call(this,e=>vi(e)&&e.classList.contains(n))},De.get=function(n){return lr(n)?t1.call(this):(n=Number(n),this[n<0?n+this.length:n])},De.eq=function(n){return Le(this.get(n))},De.first=function(){return this.eq(0)},De.last=function(){return this.eq(-1)};function uC(n){return lr(n)?this.get().map(e=>vi(e)||sC(e)?e.textContent:"").join(""):this.each((e,t)=>{vi(t)&&(t.textContent=n)})}De.text=uC;function On(n,e,t){if(!vi(n))return;const i=_u.getComputedStyle(n,null);return t?i.getPropertyValue(e)||void 0:i[e]||n.style[e]}function un(n,e){return parseInt(On(n,e),10)||0}function r1(n,e){return un(n,`border${e?"Left":"Top"}Width`)+un(n,`padding${e?"Left":"Top"}`)+un(n,`padding${e?"Right":"Bottom"}`)+un(n,`border${e?"Right":"Bottom"}Width`)}const Kf={};function cC(n){if(Kf[n])return Kf[n];const e=Zs(n);Pn.body.insertBefore(e,null);const t=On(e,"display");return Pn.body.removeChild(e),Kf[n]=t!=="none"?t:"block"}function n1(n){return On(n,"display")==="none"}function s1(n,e){const t=n&&(n.matches||n.webkitMatchesSelector||n.msMatchesSelector);return!!t&&!!e&&t.call(n,e)}function Fu(n){return Vi(n)?(e,t)=>s1(t,n):ta(n)?n:Vf(n)?(e,t)=>n.is(t):n?(e,t)=>t===n:()=>!1}De.filter=function(n){const e=Fu(n);return Le($f.call(this,(t,i)=>e.call(t,i,t)))};function ys(n,e){return e?n.filter(e):n}De.detach=function(n){return ys(this,n).each((e,t)=>{t.parentNode&&t.parentNode.removeChild(t)}),this};const hC=/^\s*<(\w+)[^>]*>/,dC=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,a1={"*":Xb,tr:XI,td:Jb,th:Jb,thead:Uf,tbody:Uf,tfoot:Uf};function o1(n){if(!Vi(n))return[];if(dC.test(n))return[Zs(RegExp.$1)];const e=hC.test(n)&&RegExp.$1,t=a1[e]||a1["*"];return t.innerHTML=n,Le(t.childNodes).detach().get()}Le.parseHTML=o1,De.has=function(n){const e=Vi(n)?(t,i)=>qf(n,i).length:(t,i)=>i.contains(n);return this.filter(e)},De.not=function(n){const e=Fu(n);return this.filter((t,i)=>(!Vi(n)||vi(i))&&!e.call(i,t,i))};function Fn(n,e,t,i){const r=[],s=ta(e),a=i&&Fu(i);for(let o=0,l=n.length;o<l;o++)if(s){const u=e(n[o]);u.length&&QI.apply(r,u)}else{let u=n[o][e];for(;u!=null&&!(i&&a(-1,u));)r.push(u),u=t?u[e]:null}return r}function l1(n){return n.multiple&&n.options?Fn($f.call(n.options,e=>e.selected&&!e.disabled&&!e.parentNode.disabled),"value"):n.value||""}function fC(n){return arguments.length?this.each((e,t)=>{const i=t.multiple&&t.options;if(i||b1.test(t.type)){const r=Mu(n)?e1.call(n,String):il(n)?[]:[String(n)];i?wi(t.options,(s,a)=>{a.selected=r.indexOf(a.value)>=0},!0):t.checked=r.indexOf(t.value)>=0}else t.value=lr(n)||il(n)?"":n}):this[0]&&l1(this[0])}De.val=fC,De.is=function(n){const e=Fu(n);return Gf.call(this,(t,i)=>e.call(t,i,t))},Le.guid=1;function cn(n){return n.length>1?$f.call(n,(e,t,i)=>Zb.call(i,e)===t):n}Le.unique=cn,De.add=function(n,e){return Le(cn(this.get().concat(Le(n,e).get())))},De.children=function(n){return ys(Le(cn(Fn(this,e=>e.children))),n)},De.parent=function(n){return ys(Le(cn(Fn(this,"parentNode"))),n)},De.index=function(n){const e=n?Le(n)[0]:this[0],t=n?this:Le(e).parent().children();return Zb.call(t,e)},De.closest=function(n){const e=this.filter(n);if(e.length)return e;const t=this.parent();return t.length?t.closest(n):e},De.siblings=function(n){return ys(Le(cn(Fn(this,e=>Le(e).parent().children().not(e)))),n)},De.find=function(n){return Le(cn(Fn(this,e=>qf(n,e))))};const gC=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,pC=/^$|^module$|\/(java|ecma)script/i,mC=["type","src","nonce","noModule"];function yC(n,e){const t=Le(n);t.filter("script").add(t.find("script")).each((i,r)=>{if(pC.test(r.type)&&jb.contains(r)){const s=Zs("script");s.text=r.textContent.replace(gC,""),wi(mC,(a,o)=>{r[o]&&(s[o]=r[o])}),e.head.insertBefore(s,null),e.head.removeChild(s)}})}function vC(n,e,t,i,r){i?n.insertBefore(e,t?n.firstChild:null):n.nodeName==="HTML"?n.parentNode.replaceChild(e,n):n.parentNode.insertBefore(e,t?n:n.nextSibling),r&&yC(e,n.ownerDocument)}function vs(n,e,t,i,r,s,a,o){return wi(n,(l,u)=>{wi(Le(u),(h,d)=>{wi(Le(e),(p,g)=>{const m=t?d:g,y=t?g:d,b=t?h:p;vC(m,b?y.cloneNode(!0):y,i,r,!b)},o)},a)},s),e}De.after=function(){return vs(arguments,this,!1,!1,!1,!0,!0)},De.append=function(){return vs(arguments,this,!1,!1,!0)};function bC(n){if(!arguments.length)return this[0]&&this[0].innerHTML;if(lr(n))return this;const e=/<script[\s>]/.test(n);return this.each((t,i)=>{vi(i)&&(e?Le(i).empty().append(n):i.innerHTML=n)})}De.html=bC,De.appendTo=function(n){return vs(arguments,this,!0,!1,!0)},De.wrapInner=function(n){return this.each((e,t)=>{const i=Le(t),r=i.contents();r.length?r.wrapAll(n):i.append(n)})},De.before=function(){return vs(arguments,this,!1,!0)},De.wrapAll=function(n){let e=Le(n),t=e[0];for(;t.children.length;)t=t.firstElementChild;return this.first().before(e),this.appendTo(t)},De.wrap=function(n){return this.each((e,t)=>{const i=Le(n)[0];Le(t).wrapAll(e?i.cloneNode(!0):i)})},De.insertAfter=function(n){return vs(arguments,this,!0,!1,!1,!1,!1,!0)},De.insertBefore=function(n){return vs(arguments,this,!0,!0)},De.prepend=function(){return vs(arguments,this,!1,!0,!0,!0,!0)},De.prependTo=function(n){return vs(arguments,this,!0,!0,!0,!1,!1,!0)},De.contents=function(){return Le(cn(Fn(this,n=>n.tagName==="IFRAME"?[n.contentDocument]:n.tagName==="TEMPLATE"?n.content.childNodes:n.childNodes)))},De.next=function(n,e,t){return ys(Le(cn(Fn(this,"nextElementSibling",e,t))),n)},De.nextAll=function(n){return this.next(n,!0)},De.nextUntil=function(n,e){return this.next(e,!0,n)},De.parents=function(n,e){return ys(Le(cn(Fn(this,"parentElement",!0,e))),n)},De.parentsUntil=function(n,e){return this.parents(e,n)},De.prev=function(n,e,t){return ys(Le(cn(Fn(this,"previousElementSibling",e,t))),n)},De.prevAll=function(n){return this.prev(n,!0)},De.prevUntil=function(n,e){return this.prev(e,!0,n)},De.map=function(n){return Le(JI.apply([],e1.call(this,(e,t)=>n.call(e,t,e))))},De.clone=function(){return this.map((n,e)=>e.cloneNode(!0))},De.offsetParent=function(){return this.map((n,e)=>{let t=e.offsetParent;for(;t&&On(t,"position")==="static";)t=t.offsetParent;return t||jb})},De.slice=function(n,e){return Le(t1.call(this,n,e))};const EC=/-([a-z])/g;function Wf(n){return n.replace(EC,(e,t)=>t.toUpperCase())}De.ready=function(n){const e=()=>setTimeout(n,0,Le);return Pn.readyState!=="loading"?e():Pn.addEventListener("DOMContentLoaded",e),this},De.unwrap=function(){return this.parent().each((n,e)=>{if(e.tagName==="BODY")return;const t=Le(e);t.replaceWith(t.children())}),this},De.offset=function(){const n=this[0];if(!n)return;const e=n.getBoundingClientRect();return{top:e.top+_u.pageYOffset,left:e.left+_u.pageXOffset}},De.position=function(){const n=this[0];if(!n)return;const e=On(n,"position")==="fixed",t=e?n.getBoundingClientRect():this.offset();if(!e){const i=n.ownerDocument;let r=n.offsetParent||i.documentElement;for(;(r===i.body||r===i.documentElement)&&On(r,"position")==="static";)r=r.parentNode;if(r!==n&&vi(r)){const s=Le(r).offset();t.top-=s.top+un(r,"borderTopWidth"),t.left-=s.left+un(r,"borderLeftWidth")}}return{top:t.top-un(n,"marginTop"),left:t.left-un(n,"marginLeft")}};const u1={class:"className",contenteditable:"contentEditable",for:"htmlFor",readonly:"readOnly",maxlength:"maxLength",tabindex:"tabIndex",colspan:"colSpan",rowspan:"rowSpan",usemap:"useMap"};De.prop=function(n,e){if(n){if(Vi(n))return n=u1[n]||n,arguments.length<2?this[0]&&this[0][n]:this.each((t,i)=>{i[n]=e});for(const t in n)this.prop(t,n[t]);return this}},De.removeProp=function(n){return this.each((e,t)=>{delete t[u1[n]||n]})};const AC=/^--/;function Yf(n){return AC.test(n)}const zf={},{style:SC}=Xb,xC=["webkit","moz","ms"];function TC(n,e=Yf(n)){if(e)return n;if(!zf[n]){const t=Wf(n),i=`${t[0].toUpperCase()}${t.slice(1)}`,r=`${t} ${xC.join(`${i} `)}${i}`.split(" ");wi(r,(s,a)=>{if(a in SC)return zf[n]=a,!1})}return zf[n]}const wC={animationIterationCount:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0};function c1(n,e,t=Yf(n)){return!t&&!wC[n]&&i1(e)?`${e}px`:e}function DC(n,e){if(Vi(n)){const t=Yf(n);return n=TC(n,t),arguments.length<2?this[0]&&On(this[0],n,t):n?(e=c1(n,e,t),this.each((i,r)=>{vi(r)&&(t?r.style.setProperty(n,e):r.style[n]=e)})):this}for(const t in n)this.css(t,n[t]);return this}De.css=DC;function h1(n,e){try{return n(e)}catch{return e}}const RC=/^\s+|\s+$/;function d1(n,e){const t=n.dataset[e]||n.dataset[Wf(e)];return RC.test(t)?t:h1(JSON.parse,t)}function IC(n,e,t){t=h1(JSON.stringify,t),n.dataset[Wf(e)]=t}function CC(n,e){if(!n){if(!this[0])return;const t={};for(const i in this[0].dataset)t[i]=d1(this[0],i);return t}if(Vi(n))return arguments.length<2?this[0]&&d1(this[0],n):lr(e)?this:this.each((t,i)=>{IC(i,n,e)});for(const t in n)this.data(t,n[t]);return this}De.data=CC;function f1(n,e){const t=n.documentElement;return Math.max(n.body[`scroll${e}`],t[`scroll${e}`],n.body[`offset${e}`],t[`offset${e}`],t[`client${e}`])}wi([!0,!1],(n,e)=>{wi(["Width","Height"],(t,i)=>{const r=`${e?"outer":"inner"}${i}`;De[r]=function(s){if(this[0])return Ka(this[0])?e?this[0][`inner${i}`]:this[0].document.documentElement[`client${i}`]:ea(this[0])?f1(this[0],i):this[0][`${e?"offset":"client"}${i}`]+(s&&e?un(this[0],`margin${t?"Top":"Left"}`)+un(this[0],`margin${t?"Bottom":"Right"}`):0)}})}),wi(["Width","Height"],(n,e)=>{const t=e.toLowerCase();De[t]=function(i){if(!this[0])return lr(i)?void 0:this;if(!arguments.length)return Ka(this[0])?this[0].document.documentElement[`client${e}`]:ea(this[0])?f1(this[0],e):this[0].getBoundingClientRect()[t]-r1(this[0],!n);const r=parseInt(i,10);return this.each((s,a)=>{if(!vi(a))return;const o=On(a,"boxSizing");a.style[t]=c1(t,r+(o==="border-box"?r1(a,!n):0))})}});const g1="___cd";De.toggle=function(n){return this.each((e,t)=>{if(!vi(t))return;const i=n1(t);(lr(n)?i:n)?(t.style.display=t[g1]||"",n1(t)&&(t.style.display=cC(t.tagName))):i||(t[g1]=On(t,"display"),t.style.display="none")})},De.hide=function(){return this.toggle(!1)},De.show=function(){return this.toggle(!0)};const p1="___ce",jf=".",Xf={focus:"focusin",blur:"focusout"},m1={mouseenter:"mouseover",mouseleave:"mouseout"},NC=/^(mouse|pointer|contextmenu|drag|drop|click|dblclick)/i;function Jf(n){return m1[n]||Xf[n]||n}function Qf(n){const e=n.split(jf);return[e[0],e.slice(1).sort()]}De.trigger=function(n,e){if(Vi(n)){const[i,r]=Qf(n),s=Jf(i);if(!s)return this;const a=NC.test(s)?"MouseEvents":"HTMLEvents";n=Pn.createEvent(a),n.initEvent(s,!0,!0),n.namespace=r.join(jf),n.___ot=i}n.___td=e;const t=n.___ot in Xf;return this.each((i,r)=>{t&&ta(r[n.___ot])&&(r[`___i${n.type}`]=!0,r[n.___ot](),r[`___i${n.type}`]=!1),r.dispatchEvent(n)})};function y1(n){return n[p1]=n[p1]||{}}function LC(n,e,t,i,r){const s=y1(n);s[e]=s[e]||[],s[e].push([t,i,r]),n.addEventListener(e,r)}function v1(n,e){return!e||!Gf.call(e,t=>n.indexOf(t)<0)}function Bu(n,e,t,i,r){const s=y1(n);if(e)s[e]&&(s[e]=s[e].filter(([a,o,l])=>{if(r&&l.guid!==r.guid||!v1(a,t)||i&&i!==o)return!0;n.removeEventListener(e,l)}));else for(e in s)Bu(n,e,t,i,r)}De.off=function(n,e,t){if(lr(n))this.each((i,r)=>{!vi(r)&&!ea(r)&&!Ka(r)||Bu(r)});else if(Vi(n))ta(e)&&(t=e,e=""),wi(Ou(n),(i,r)=>{const[s,a]=Qf(r),o=Jf(s);this.each((l,u)=>{!vi(u)&&!ea(u)&&!Ka(u)||Bu(u,o,a,e,t)})});else for(const i in n)this.off(i,n[i]);return this},De.remove=function(n){return ys(this,n).detach().off(),this},De.replaceWith=function(n){return this.before(n).remove()},De.replaceAll=function(n){return Le(n).replaceWith(this),this};function _C(n,e,t,i,r){if(!Vi(n)){for(const s in n)this.on(s,e,t,n[s],r);return this}return Vi(e)||(lr(e)||il(e)?e="":lr(t)?(t=e,e=""):(i=t,t=e,e="")),ta(i)||(i=t,t=void 0),i?(wi(Ou(n),(s,a)=>{const[o,l]=Qf(a),u=Jf(o),h=o in m1,d=o in Xf;u&&this.each((p,g)=>{if(!vi(g)&&!ea(g)&&!Ka(g))return;const m=function(y){if(y.target[`___i${y.type}`])return y.stopImmediatePropagation();if(y.namespace&&!v1(l,y.namespace.split(jf))||!e&&(d&&(y.target!==g||y.___ot===u)||h&&y.relatedTarget&&g.contains(y.relatedTarget)))return;let b=g;if(e){let w=y.target;for(;!s1(w,e);)if(w===g||(w=w.parentNode,!w))return;b=w}Object.defineProperty(y,"currentTarget",{configurable:!0,get(){return b}}),Object.defineProperty(y,"delegateTarget",{configurable:!0,get(){return g}}),Object.defineProperty(y,"data",{configurable:!0,get(){return t}});const A=i.call(b,y,y.___td);r&&Bu(g,u,l,e,m),A===!1&&(y.preventDefault(),y.stopPropagation())};m.guid=i.guid=i.guid||Le.guid++,LC(g,u,l,e,m)})}),this):this}De.on=_C;function MC(n,e,t,i){return this.on(n,e,t,i,!0)}De.one=MC;const kC=/\r?\n/g;function PC(n,e){return`&${encodeURIComponent(n)}=${encodeURIComponent(e.replace(kC,`\r
`))}`}const OC=/file|reset|submit|button|image/i,b1=/radio|checkbox/i;De.serialize=function(){let n="";return this.each((e,t)=>{wi(t.elements||[t],(i,r)=>{if(r.disabled||!r.name||r.tagName==="FIELDSET"||OC.test(r.type)||b1.test(r.type)&&!r.checked)return;const s=l1(r);if(!lr(s)){const a=Mu(s)?s:[s];wi(a,(o,l)=>{n+=PC(r.name,l)})}})}),n.slice(1)};class FC{getTitle(e,t){if(!e.values||_t.isEmpty(e.values))throw console.error("Title extraction configuration is missing CSS selector values",e),new Error("ExtractTitleConfig values are empty or undefined");return Le(e.values[0]).text()}}class BC{getTitle(e,t){if(!e.values||_t.isEmpty(e.values))throw console.error("Title extraction configuration is missing CSS selector values",e),new Error("ExtractTitleConfig values are empty or undefined");if(e.values.length!==2)throw console.error("Title extraction configuration requires exactly 2 values: [cssSelector, attributeName], but got",e.values.length,"values:",e.values),new Error(`ExtractTitleConfig values array must contain exactly 2 elements (cssSelector and attributeName), but got ${e.values.length} elements`);return Le(e.values[0]).attr(e.values[1])}}class UC extends Va{getVideoId(e,t){if(!e.values||_t.isEmpty(e.values))throw console.error("Video ID extraction configuration is missing CSS selector values",e),new Error("ExtractVideoIdConfig values are empty or undefined");if(e.values.length!==2)throw console.error("Video ID extraction configuration requires exactly 2 values: [cssSelector, attributeName], but got",e.values.length,"values:",e.values),new Error(`ExtractVideoIdConfig values array must contain exactly 2 elements (cssSelector and attributeName), but got ${e.values.length} elements`);const i=Le(e.values[0]).attr(e.values[1]);return this.buildVideoId(e,[i])}}var E1=class{constructor(n){if(n==="<all_urls>")this.isAllUrls=!0,this.protocolMatches=[...E1.PROTOCOLS],this.hostnameMatch="*",this.pathnameMatch="*";else{const e=/(.*):\/\/(.*?)(\/.*)/.exec(n);if(e==null)throw new Uu(n,"Incorrect format");const[t,i,r,s]=e;$C(n,i),GC(n,r),this.protocolMatches=i==="*"?["http","https"]:[i],this.hostnameMatch=r,this.pathnameMatch=s}}includes(n){if(this.isAllUrls)return!0;const e=typeof n=="string"?new URL(n):n instanceof Location?new URL(n.href):n;return!!this.protocolMatches.find(t=>{if(t==="http")return this.isHttpMatch(e);if(t==="https")return this.isHttpsMatch(e);if(t==="file")return this.isFileMatch(e);if(t==="ftp")return this.isFtpMatch(e);if(t==="urn")return this.isUrnMatch(e)})}isHttpMatch(n){return n.protocol==="http:"&&this.isHostPathMatch(n)}isHttpsMatch(n){return n.protocol==="https:"&&this.isHostPathMatch(n)}isHostPathMatch(n){if(!this.hostnameMatch||!this.pathnameMatch)return!1;const e=[this.convertPatternToRegex(this.hostnameMatch),this.convertPatternToRegex(this.hostnameMatch.replace(/^\*\./,""))],t=this.convertPatternToRegex(this.pathnameMatch);return!!e.find(i=>i.test(n.hostname))&&t.test(n.pathname)}isFileMatch(n){throw Error("Not implemented: file:// pattern matching. Open a PR to add support")}isFtpMatch(n){throw Error("Not implemented: ftp:// pattern matching. Open a PR to add support")}isUrnMatch(n){throw Error("Not implemented: urn:// pattern matching. Open a PR to add support")}convertPatternToRegex(n){const t=this.escapeForRegex(n).replace(/\\\*/g,".*");return RegExp(`^${t}$`)}escapeForRegex(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}},bi=E1;bi.PROTOCOLS=["http","https","file","ftp","urn"];var Uu=class extends Error{constructor(n,e){super(`Invalid match pattern "${n}": ${e}`)}};function $C(n,e){if(!bi.PROTOCOLS.includes(e)&&e!=="*")throw new Uu(n,`${e} not a valid protocol (${bi.PROTOCOLS.join(", ")})`)}function GC(n,e){if(e.includes(":"))throw new Uu(n,"Hostname cannot include a port");if(e.includes("*")&&e.length>1&&!e.startsWith("*."))throw new Uu(n,"If using a wildcard (*), it must go at the start of the hostname")}class qC{constructor(){this.keyToValue=new Map,this.valueToKey=new Map}set(e,t){this.keyToValue.set(e,t),this.valueToKey.set(t,e)}getByKey(e){return this.keyToValue.get(e)}getByValue(e){return this.valueToKey.get(e)}clear(){this.keyToValue.clear(),this.valueToKey.clear()}}class A1{constructor(e){this.generateIdentifier=e,this.kv=new qC}register(e,t){this.kv.getByValue(e)||(t||(t=this.generateIdentifier(e)),this.kv.set(t,e))}clear(){this.kv.clear()}getIdentifier(e){return this.kv.getByValue(e)}getValue(e){return this.kv.getByKey(e)}}class VC extends A1{constructor(){super(e=>e.name),this.classToAllowedProps=new Map}register(e,t){typeof t=="object"?(t.allowProps&&this.classToAllowedProps.set(e,t.allowProps),super.register(e,t.identifier)):super.register(e,t)}getAllowedProps(e){return this.classToAllowedProps.get(e)}}function HC(n){if("values"in Object)return Object.values(n);const e=[];for(const t in n)n.hasOwnProperty(t)&&e.push(n[t]);return e}function KC(n,e){const t=HC(n);if("find"in t)return t.find(e);const i=t;for(let r=0;r<i.length;r++){const s=i[r];if(e(s))return s}}function Wa(n,e){Object.entries(n).forEach(([t,i])=>e(i,t))}function $u(n,e){return n.indexOf(e)!==-1}function S1(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(e(i))return i}}class WC{constructor(){this.transfomers={}}register(e){this.transfomers[e.name]=e}findApplicable(e){return KC(this.transfomers,t=>t.isApplicable(e))}findByName(e){return this.transfomers[e]}}const YC=n=>Object.prototype.toString.call(n).slice(8,-1),x1=n=>typeof n>"u",zC=n=>n===null,rl=n=>typeof n!="object"||n===null||n===Object.prototype?!1:Object.getPrototypeOf(n)===null?!0:Object.getPrototypeOf(n)===Object.prototype,Zf=n=>rl(n)&&Object.keys(n).length===0,bs=n=>Array.isArray(n),jC=n=>typeof n=="string",XC=n=>typeof n=="number"&&!isNaN(n),JC=n=>typeof n=="boolean",QC=n=>n instanceof RegExp,nl=n=>n instanceof Map,sl=n=>n instanceof Set,T1=n=>YC(n)==="Symbol",ZC=n=>n instanceof Date&&!isNaN(n.valueOf()),eN=n=>n instanceof Error,w1=n=>typeof n=="number"&&isNaN(n),tN=n=>JC(n)||zC(n)||x1(n)||XC(n)||jC(n)||T1(n),iN=n=>typeof n=="bigint",rN=n=>n===1/0||n===-1/0,nN=n=>ArrayBuffer.isView(n)&&!(n instanceof DataView),sN=n=>n instanceof URL,D1=n=>n.replace(/\./g,"\\."),eg=n=>n.map(String).map(D1).join("."),al=n=>{const e=[];let t="";for(let r=0;r<n.length;r++){let s=n.charAt(r);if(s==="\\"&&n.charAt(r+1)==="."){t+=".",r++;continue}if(s==="."){e.push(t),t="";continue}t+=s}const i=t;return e.push(i),e};function hn(n,e,t,i){return{isApplicable:n,annotation:e,transform:t,untransform:i}}const R1=[hn(x1,"undefined",()=>null,()=>{}),hn(iN,"bigint",n=>n.toString(),n=>typeof BigInt<"u"?BigInt(n):(console.error("Please add a BigInt polyfill."),n)),hn(ZC,"Date",n=>n.toISOString(),n=>new Date(n)),hn(eN,"Error",(n,e)=>{const t={name:n.name,message:n.message};return e.allowedErrorProps.forEach(i=>{t[i]=n[i]}),t},(n,e)=>{const t=new Error(n.message);return t.name=n.name,t.stack=n.stack,e.allowedErrorProps.forEach(i=>{t[i]=n[i]}),t}),hn(QC,"regexp",n=>""+n,n=>{const e=n.slice(1,n.lastIndexOf("/")),t=n.slice(n.lastIndexOf("/")+1);return new RegExp(e,t)}),hn(sl,"set",n=>[...n.values()],n=>new Set(n)),hn(nl,"map",n=>[...n.entries()],n=>new Map(n)),hn(n=>w1(n)||rN(n),"number",n=>w1(n)?"NaN":n>0?"Infinity":"-Infinity",Number),hn(n=>n===0&&1/n===-1/0,"number",()=>"-0",Number),hn(sN,"URL",n=>n.toString(),n=>new URL(n))];function Gu(n,e,t,i){return{isApplicable:n,annotation:e,transform:t,untransform:i}}const I1=Gu((n,e)=>T1(n)?!!e.symbolRegistry.getIdentifier(n):!1,(n,e)=>["symbol",e.symbolRegistry.getIdentifier(n)],n=>n.description,(n,e,t)=>{const i=t.symbolRegistry.getValue(e[1]);if(!i)throw new Error("Trying to deserialize unknown symbol");return i}),aN=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce((n,e)=>(n[e.name]=e,n),{}),C1=Gu(nN,n=>["typed-array",n.constructor.name],n=>[...n],(n,e)=>{const t=aN[e[1]];if(!t)throw new Error("Trying to deserialize unknown typed array");return new t(n)});function N1(n,e){return n!=null&&n.constructor?!!e.classRegistry.getIdentifier(n.constructor):!1}const L1=Gu(N1,(n,e)=>["class",e.classRegistry.getIdentifier(n.constructor)],(n,e)=>{const t=e.classRegistry.getAllowedProps(n.constructor);if(!t)return{...n};const i={};return t.forEach(r=>{i[r]=n[r]}),i},(n,e,t)=>{const i=t.classRegistry.getValue(e[1]);if(!i)throw new Error(`Trying to deserialize unknown class '${e[1]}' - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564`);return Object.assign(Object.create(i.prototype),n)}),_1=Gu((n,e)=>!!e.customTransformerRegistry.findApplicable(n),(n,e)=>["custom",e.customTransformerRegistry.findApplicable(n).name],(n,e)=>e.customTransformerRegistry.findApplicable(n).serialize(n),(n,e,t)=>{const i=t.customTransformerRegistry.findByName(e[1]);if(!i)throw new Error("Trying to deserialize unknown custom value");return i.deserialize(n)}),oN=[L1,I1,_1,C1],M1=(n,e)=>{const t=S1(oN,r=>r.isApplicable(n,e));if(t)return{value:t.transform(n,e),type:t.annotation(n,e)};const i=S1(R1,r=>r.isApplicable(n,e));if(i)return{value:i.transform(n,e),type:i.annotation}},k1={};R1.forEach(n=>{k1[n.annotation]=n});const lN=(n,e,t)=>{if(bs(e))switch(e[0]){case"symbol":return I1.untransform(n,e,t);case"class":return L1.untransform(n,e,t);case"custom":return _1.untransform(n,e,t);case"typed-array":return C1.untransform(n,e,t);default:throw new Error("Unknown transformation: "+e)}else{const i=k1[e];if(!i)throw new Error("Unknown transformation: "+e);return i.untransform(n,t)}},Ya=(n,e)=>{if(e>n.size)throw new Error("index out of bounds");const t=n.keys();for(;e>0;)t.next(),e--;return t.next().value};function P1(n){if($u(n,"__proto__"))throw new Error("__proto__ is not allowed as a property");if($u(n,"prototype"))throw new Error("prototype is not allowed as a property");if($u(n,"constructor"))throw new Error("constructor is not allowed as a property")}const uN=(n,e)=>{P1(e);for(let t=0;t<e.length;t++){const i=e[t];if(sl(n))n=Ya(n,+i);else if(nl(n)){const r=+i,s=+e[++t]==0?"key":"value",a=Ya(n,r);switch(s){case"key":n=a;break;case"value":n=n.get(a);break}}else n=n[i]}return n},tg=(n,e,t)=>{if(P1(e),e.length===0)return t(n);let i=n;for(let s=0;s<e.length-1;s++){const a=e[s];if(bs(i)){const o=+a;i=i[o]}else if(rl(i))i=i[a];else if(sl(i)){const o=+a;i=Ya(i,o)}else if(nl(i)){if(s===e.length-2)break;const l=+a,u=+e[++s]==0?"key":"value",h=Ya(i,l);switch(u){case"key":i=h;break;case"value":i=i.get(h);break}}}const r=e[e.length-1];if(bs(i)?i[+r]=t(i[+r]):rl(i)&&(i[r]=t(i[r])),sl(i)){const s=Ya(i,+r),a=t(s);s!==a&&(i.delete(s),i.add(a))}if(nl(i)){const s=+e[e.length-2],a=Ya(i,s);switch(+r==0?"key":"value"){case"key":{const l=t(a);i.set(l,i.get(a)),l!==a&&i.delete(a);break}case"value":{i.set(a,t(i.get(a)));break}}}return n};function ig(n,e,t=[]){if(!n)return;if(!bs(n)){Wa(n,(s,a)=>ig(s,e,[...t,...al(a)]));return}const[i,r]=n;r&&Wa(r,(s,a)=>{ig(s,e,[...t,...al(a)])}),e(i,t)}function cN(n,e,t){return ig(e,(i,r)=>{n=tg(n,r,s=>lN(s,i,t))}),n}function hN(n,e){function t(i,r){const s=uN(n,al(r));i.map(al).forEach(a=>{n=tg(n,a,()=>s)})}if(bs(e)){const[i,r]=e;i.forEach(s=>{n=tg(n,al(s),()=>n)}),r&&Wa(r,t)}else Wa(e,t);return n}const dN=(n,e)=>rl(n)||bs(n)||nl(n)||sl(n)||N1(n,e);function fN(n,e,t){const i=t.get(n);i?i.push(e):t.set(n,[e])}function gN(n,e){const t={};let i;return n.forEach(r=>{if(r.length<=1)return;e||(r=r.map(o=>o.map(String)).sort((o,l)=>o.length-l.length));const[s,...a]=r;s.length===0?i=a.map(eg):t[eg(s)]=a.map(eg)}),i?Zf(t)?[i]:[i,t]:Zf(t)?void 0:t}const O1=(n,e,t,i,r=[],s=[],a=new Map)=>{const o=tN(n);if(!o){fN(n,r,e);const g=a.get(n);if(g)return i?{transformedValue:null}:g}if(!dN(n,t)){const g=M1(n,t),m=g?{transformedValue:g.value,annotations:[g.type]}:{transformedValue:n};return o||a.set(n,m),m}if($u(s,n))return{transformedValue:null};const l=M1(n,t),u=(l==null?void 0:l.value)??n,h=bs(u)?[]:{},d={};Wa(u,(g,m)=>{if(m==="__proto__"||m==="constructor"||m==="prototype")throw new Error(`Detected property ${m}. This is a prototype pollution risk, please remove it from your object.`);const y=O1(g,e,t,i,[...r,m],[...s,n],a);h[m]=y.transformedValue,bs(y.annotations)?d[m]=y.annotations:rl(y.annotations)&&Wa(y.annotations,(b,A)=>{d[D1(m)+"."+A]=b})});const p=Zf(d)?{transformedValue:h,annotations:l?[l.type]:void 0}:{transformedValue:h,annotations:l?[l.type,d]:d};return o||a.set(n,p),p};function F1(n){return Object.prototype.toString.call(n).slice(8,-1)}function B1(n){return F1(n)==="Array"}function pN(n){if(F1(n)!=="Object")return!1;const e=Object.getPrototypeOf(n);return!!e&&e.constructor===Object&&e===Object.prototype}function mN(n,e,t,i,r){const s={}.propertyIsEnumerable.call(i,e)?"enumerable":"nonenumerable";s==="enumerable"&&(n[e]=t),r&&s==="nonenumerable"&&Object.defineProperty(n,e,{value:t,enumerable:!1,writable:!0,configurable:!0})}function rg(n,e={}){if(B1(n))return n.map(r=>rg(r,e));if(!pN(n))return n;const t=Object.getOwnPropertyNames(n),i=Object.getOwnPropertySymbols(n);return[...t,...i].reduce((r,s)=>{if(B1(e.props)&&!e.props.includes(s))return r;const a=n[s],o=rg(a,e);return mN(r,s,o,n,e.nonenumerable),r},{})}class ot{constructor({dedupe:e=!1}={}){this.classRegistry=new VC,this.symbolRegistry=new A1(t=>t.description??""),this.customTransformerRegistry=new WC,this.allowedErrorProps=[],this.dedupe=e}serialize(e){const t=new Map,i=O1(e,t,this,this.dedupe),r={json:i.transformedValue};i.annotations&&(r.meta={...r.meta,values:i.annotations});const s=gN(t,this.dedupe);return s&&(r.meta={...r.meta,referentialEqualities:s}),r}deserialize(e){const{json:t,meta:i}=e;let r=rg(t);return i!=null&&i.values&&(r=cN(r,i.values,this)),i!=null&&i.referentialEqualities&&(r=hN(r,i.referentialEqualities)),r}stringify(e){return JSON.stringify(this.serialize(e))}parse(e){return this.deserialize(JSON.parse(e))}registerClass(e,t){this.classRegistry.register(e,t)}registerSymbol(e,t){this.symbolRegistry.register(e,t)}registerCustom(e,t){this.customTransformerRegistry.register({name:t,...e})}allowErrorProps(...e){this.allowedErrorProps.push(...e)}}ot.defaultInstance=new ot,ot.serialize=ot.defaultInstance.serialize.bind(ot.defaultInstance),ot.deserialize=ot.defaultInstance.deserialize.bind(ot.defaultInstance),ot.stringify=ot.defaultInstance.stringify.bind(ot.defaultInstance),ot.parse=ot.defaultInstance.parse.bind(ot.defaultInstance),ot.registerClass=ot.defaultInstance.registerClass.bind(ot.defaultInstance),ot.registerSymbol=ot.defaultInstance.registerSymbol.bind(ot.defaultInstance),ot.registerCustom=ot.defaultInstance.registerCustom.bind(ot.defaultInstance),ot.allowErrorProps=ot.defaultInstance.allowErrorProps.bind(ot.defaultInstance),ot.serialize,ot.deserialize,ot.stringify,ot.parse,ot.registerClass,ot.registerCustom,ot.registerSymbol,ot.allowErrorProps;class yN extends Va{getVideoId(e,t){if(_t.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const i=ot.parse(e.values[0]);for(const[r,s]of i.configMap.entries())if(new bi(r).includes(window.location.href))return Yt.extractVideoId(s,t);throw new Error("No matching URL pattern found for current URL: "+window.location.href)}}class vN extends Va{getVideoId(e,t){if(_t.isEmpty(e.values))throw console.error("Video ID extraction rule missing values property",e),new Error("Video ID extraction rule missing values property");const i=ot.parse(e.values[0]);return this.buildVideoId(e,i.configList.map(r=>Yt.extractVideoId(r,t)))}}class Yt{static extractBooleanByJsonPath(e,t,i){const r=sr.of(e);return Bo(t).with("all",()=>r.allMatch(s=>on(i,s))).with("any",()=>r.anyMatch(s=>on(i,s))).exhaustive()}static extractVideoId(e,t){return Bo(e.type).with("urlQueryParam",()=>new VI().getVideoId(e,t)).with("urlPath",()=>new KI().getVideoId(e,t)).with("jsonPath",()=>new WI().getVideoId(e,t)).with("attr",()=>new UC().getVideoId(e,t)).with("multi-pattern",()=>new yN().getVideoId(e,t)).with("multi-type",()=>new vN().getVideoId(e,t)).with("undefined",()=>"undefined").with("universal",()=>"universal").with("twitter",()=>"twitter").with("tiktok",()=>"tiktok").with("douyin",()=>"douyin").exhaustive()}static extractTitle(e,t){return Bo(e.type).with("tab",()=>t.tabTitle).with("jsonPath",()=>new zI().getTitle(e,t)).with("urlPath",()=>new jI().getTitle(e,t)).with("selector",()=>new FC().getTitle(e,t)).with("attr",()=>new BC().getTitle(e,t)).exhaustive()}static extractVideoLanguage(e,t){return e.videoLanguageExtract?Bo(e.videoLanguageExtract.type).with("asr",()=>new YI().getVideoLanguage(e,t)).exhaustive()??hi.fromLanguage:hi.fromLanguage}}class U1 extends Ha{getSubtitles(e,t){const i=e.domKind?'track[kind="'+e.domKind+'"]':'track[kind="captions"], track[kind="subtitles"]';return sr.of(this.findTracks(t,i)).map(r=>this.buildSubtitleMediaData(r,e)).toArray()}findTracks(e,t){return Le(e.media).find(t)}buildSubtitleMediaData(e,t){const i=Le(e);return{url:Qi.completeUrl(i.prop("src")),language:i.prop(t.subtitleLanguageName).replaceAll("-x-autogen",""),isAsr:!1,hasPunctuation:!0}}}const _e=Number.isFinite||function(n){return typeof n=="number"&&isFinite(n)},bN=Number.isSafeInteger||function(n){return typeof n=="number"&&Math.abs(n)<=EN},EN=Number.MAX_SAFE_INTEGER||9007199254740991;let $e=function(n){return n.NETWORK_ERROR="networkError",n.MEDIA_ERROR="mediaError",n.KEY_SYSTEM_ERROR="keySystemError",n.MUX_ERROR="muxError",n.OTHER_ERROR="otherError",n}({}),Z=function(n){return n.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",n.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",n.KEY_SYSTEM_NO_SESSION="keySystemNoSession",n.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",n.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",n.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",n.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",n.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",n.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",n.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",n.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",n.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",n.MANIFEST_LOAD_ERROR="manifestLoadError",n.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",n.MANIFEST_PARSING_ERROR="manifestParsingError",n.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",n.LEVEL_EMPTY_ERROR="levelEmptyError",n.LEVEL_LOAD_ERROR="levelLoadError",n.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",n.LEVEL_PARSING_ERROR="levelParsingError",n.LEVEL_SWITCH_ERROR="levelSwitchError",n.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",n.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",n.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",n.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",n.FRAG_LOAD_ERROR="fragLoadError",n.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",n.FRAG_DECRYPT_ERROR="fragDecryptError",n.FRAG_PARSING_ERROR="fragParsingError",n.FRAG_GAP="fragGap",n.REMUX_ALLOC_ERROR="remuxAllocError",n.KEY_LOAD_ERROR="keyLoadError",n.KEY_LOAD_TIMEOUT="keyLoadTimeOut",n.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",n.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",n.BUFFER_APPEND_ERROR="bufferAppendError",n.BUFFER_APPENDING_ERROR="bufferAppendingError",n.BUFFER_STALLED_ERROR="bufferStalledError",n.BUFFER_FULL_ERROR="bufferFullError",n.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",n.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",n.ASSET_LIST_LOAD_ERROR="assetListLoadError",n.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",n.ASSET_LIST_PARSING_ERROR="assetListParsingError",n.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",n.INTERNAL_EXCEPTION="internalException",n.INTERNAL_ABORTED="aborted",n.ATTACH_MEDIA_ERROR="attachMediaError",n.UNKNOWN="unknown",n}({}),T=function(n){return n.MEDIA_ATTACHING="hlsMediaAttaching",n.MEDIA_ATTACHED="hlsMediaAttached",n.MEDIA_DETACHING="hlsMediaDetaching",n.MEDIA_DETACHED="hlsMediaDetached",n.MEDIA_ENDED="hlsMediaEnded",n.STALL_RESOLVED="hlsStallResolved",n.BUFFER_RESET="hlsBufferReset",n.BUFFER_CODECS="hlsBufferCodecs",n.BUFFER_CREATED="hlsBufferCreated",n.BUFFER_APPENDING="hlsBufferAppending",n.BUFFER_APPENDED="hlsBufferAppended",n.BUFFER_EOS="hlsBufferEos",n.BUFFERED_TO_END="hlsBufferedToEnd",n.BUFFER_FLUSHING="hlsBufferFlushing",n.BUFFER_FLUSHED="hlsBufferFlushed",n.MANIFEST_LOADING="hlsManifestLoading",n.MANIFEST_LOADED="hlsManifestLoaded",n.MANIFEST_PARSED="hlsManifestParsed",n.LEVEL_SWITCHING="hlsLevelSwitching",n.LEVEL_SWITCHED="hlsLevelSwitched",n.LEVEL_LOADING="hlsLevelLoading",n.LEVEL_LOADED="hlsLevelLoaded",n.LEVEL_UPDATED="hlsLevelUpdated",n.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",n.LEVELS_UPDATED="hlsLevelsUpdated",n.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",n.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",n.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",n.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",n.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",n.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",n.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",n.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",n.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",n.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",n.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",n.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",n.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",n.CUES_PARSED="hlsCuesParsed",n.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",n.INIT_PTS_FOUND="hlsInitPtsFound",n.FRAG_LOADING="hlsFragLoading",n.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",n.FRAG_LOADED="hlsFragLoaded",n.FRAG_DECRYPTED="hlsFragDecrypted",n.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",n.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",n.FRAG_PARSING_METADATA="hlsFragParsingMetadata",n.FRAG_PARSED="hlsFragParsed",n.FRAG_BUFFERED="hlsFragBuffered",n.FRAG_CHANGED="hlsFragChanged",n.FPS_DROP="hlsFpsDrop",n.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",n.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",n.ERROR="hlsError",n.DESTROYING="hlsDestroying",n.KEY_LOADING="hlsKeyLoading",n.KEY_LOADED="hlsKeyLoaded",n.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",n.BACK_BUFFER_REACHED="hlsBackBufferReached",n.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",n.ASSET_LIST_LOADING="hlsAssetListLoading",n.ASSET_LIST_LOADED="hlsAssetListLoaded",n.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",n.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",n.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",n.INTERSTITIAL_STARTED="hlsInterstitialStarted",n.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",n.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",n.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",n.INTERSTITIAL_ENDED="hlsInterstitialEnded",n.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",n.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",n.EVENT_CUE_ENTER="hlsEventCueEnter",n}({});var ct={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},Oe={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class za{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class AN{constructor(e,t,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new za(e),this.fast_=new za(t),this.defaultTTFB_=r,this.ttfb_=new za(e)}update(e,t){const{slow_:i,fast_:r,ttfb_:s}=this;i.halfLife!==e&&(this.slow_=new za(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.fast_=new za(t,r.getEstimate(),r.getTotalWeight())),s.halfLife!==e&&(this.ttfb_=new za(e,s.getEstimate(),s.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);const i=8*t,r=e/1e3,s=i/r;this.fast_.sample(r,s),this.slow_.sample(r,s)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function SN(n,e,t){return(e=TN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Rt(){return Rt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},Rt.apply(null,arguments)}function $1(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,i)}return t}function xt(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?$1(Object(t),!0).forEach(function(i){SN(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):$1(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function xN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function TN(n){var e=xN(n,"string");return typeof e=="symbol"?e:e+""}class Bn{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${e}]:`;this.trace=Es,this.debug=t.debug.bind(null,i),this.log=t.log.bind(null,i),this.warn=t.warn.bind(null,i),this.info=t.info.bind(null,i),this.error=t.error.bind(null,i)}}const Es=function(){},wN={trace:Es,debug:Es,log:Es,warn:Es,info:Es,error:Es};function ng(){return Rt({},wN)}function DN(n,e){const t=self.console[n];return t?t.bind(self.console,`${e?"["+e+"] ":""}[${n}] >`):Es}function G1(n,e,t){return e[n]?e[n].bind(e):DN(n,t)}const sg=ng();function RN(n,e,t){const i=ng();if(typeof console=="object"&&n===!0||typeof n=="object"){const r=["debug","log","info","warn","error"];r.forEach(s=>{i[s]=G1(s,n,t)});try{i.log(`Debug logs enabled for "${e}" in hls.js version 1.6.5`)}catch{return ng()}r.forEach(s=>{sg[s]=G1(s,n)})}else Rt(sg,i);return i}const Et=sg;function As(n=!0){return typeof self>"u"?void 0:(n||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function IN(n){return typeof self<"u"&&n===self.ManagedMediaSource}function q1(n,e){const t=Object.keys(n),i=Object.keys(e),r=t.length,s=i.length;return!r||!s||r===s&&!t.some(a=>i.indexOf(a)===-1)}function ur(n,e=!1){if(typeof TextDecoder<"u"){const u=new TextDecoder("utf-8").decode(n);if(e){const h=u.indexOf("\0");return h!==-1?u.substring(0,h):u}return u.replace(/\0/g,"")}const t=n.length;let i,r,s,a="",o=0;for(;o<t;){if(i=n[o++],i===0&&e)return a;if(i===0||i===3)continue;switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(i);break;case 12:case 13:r=n[o++],a+=String.fromCharCode((i&31)<<6|r&63);break;case 14:r=n[o++],s=n[o++],a+=String.fromCharCode((i&15)<<12|(r&63)<<6|(s&63)<<0);break}}return a}const dn={hexDump:function(n){let e="";for(let t=0;t<n.length;t++){let i=n[t].toString(16);i.length<2&&(i="0"+i),e+=i}return e}};function CN(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var ag={exports:{}},V1;function NN(){return V1||(V1=1,function(n,e){(function(t){var i=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,r=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,o={buildAbsoluteURL:function(l,u,h){if(h=h||{},l=l.trim(),u=u.trim(),!u){if(!h.alwaysNormalize)return l;var d=o.parseURL(l);if(!d)throw new Error("Error trying to parse base URL.");return d.path=o.normalizePath(d.path),o.buildURLFromParts(d)}var p=o.parseURL(u);if(!p)throw new Error("Error trying to parse relative URL.");if(p.scheme)return h.alwaysNormalize?(p.path=o.normalizePath(p.path),o.buildURLFromParts(p)):u;var g=o.parseURL(l);if(!g)throw new Error("Error trying to parse base URL.");if(!g.netLoc&&g.path&&g.path[0]!=="/"){var m=r.exec(g.path);g.netLoc=m[1],g.path=m[2]}g.netLoc&&!g.path&&(g.path="/");var y={scheme:g.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(y.netLoc=g.netLoc,p.path[0]!=="/"))if(!p.path)y.path=g.path,p.params||(y.params=g.params,p.query||(y.query=g.query));else{var b=g.path,A=b.substring(0,b.lastIndexOf("/")+1)+p.path;y.path=o.normalizePath(A)}return y.path===null&&(y.path=h.alwaysNormalize?o.normalizePath(p.path):p.path),o.buildURLFromParts(y)},parseURL:function(l){var u=i.exec(l);return u?{scheme:u[1]||"",netLoc:u[2]||"",path:u[3]||"",params:u[4]||"",query:u[5]||"",fragment:u[6]||""}:null},normalizePath:function(l){for(l=l.split("").reverse().join("").replace(s,"");l.length!==(l=l.replace(a,"")).length;);return l.split("").reverse().join("")},buildURLFromParts:function(l){return l.scheme+l.netLoc+l.path+l.params+l.query+l.fragment}};n.exports=o})()}(ag)),ag.exports}var og=NN();class lg{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Mt={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class H1{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,_N(this,"stats")}setByteRange(e,t){const i=e.split("@",2);let r;i.length===1?r=(t==null?void 0:t.byteRangeEndOffset)||0:r=parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[Mt.AUDIO]:null,[Mt.VIDEO]:null,[Mt.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new lg),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=og.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Mt.AUDIO]=null,e[Mt.VIDEO]=null,e[Mt.AUDIOVIDEO]=null}}function Ei(n){return n.sn!=="initSegment"}class ug extends H1{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(_e(e)&&_e(t))return t-e}return null}get bitrate(){return this.byteLength?this.byteLength*8/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{const i=Object.keys(this.levelkeys);if(i.length===1)return this._decryptdata=this.levelkeys[i[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;const e=_e(this.duration)?this.duration:0;return this.programDateTime+e*1e3}get encrypted(){var e;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){const t=Object.keys(this.levelkeys),i=t.length;if(i>1||i===1&&this.levelkeys[t[0]].encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!_e(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return Ei(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,i,r,s,a=!1){const{elementaryStreams:o}=this,l=o[e];if(!l){o[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:s,partial:a};return}l.startPTS=Math.min(l.startPTS,t),l.endPTS=Math.max(l.endPTS,i),l.startDTS=Math.min(l.startDTS,r),l.endDTS=Math.max(l.endDTS,s)}}class LN extends H1{constructor(e,t,i,r,s){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;const a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,s),s&&(this.fragOffset=s.fragOffset+s.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function K1(n,e){const t=Object.getPrototypeOf(n);if(t){const i=Object.getOwnPropertyDescriptor(t,e);return i||K1(t,e)}}function _N(n,e){const t=K1(n,e);t&&(t.enumerable=!0,Object.defineProperty(n,e,t))}const qu=Math.pow(2,32)-1,MN=[].push,W1={video:1,audio:2,id3:3,text:4};function di(n){return String.fromCharCode.apply(null,n)}function Y1(n,e){const t=n[e]<<8|n[e+1];return t<0?65536+t:t}function Ke(n,e){const t=j1(n,e);return t<0?4294967296+t:t}function z1(n,e){let t=Ke(n,e);return t*=Math.pow(2,32),t+=Ke(n,e+4),t}function j1(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]}function cg(n,e,t){n[e]=t>>24,n[e+1]=t>>16&255,n[e+2]=t>>8&255,n[e+3]=t&255}function kN(n){const e=n.byteLength;for(let t=0;t<e;){const i=Ke(n,t);if(i>8&&n[t+4]===109&&n[t+5]===111&&n[t+6]===111&&n[t+7]===102)return!0;t=i>1?t+i:e}return!1}function rt(n,e){const t=[];if(!e.length)return t;const i=n.byteLength;for(let r=0;r<i;){const s=Ke(n,r),a=di(n.subarray(r+4,r+8)),o=s>1?r+s:i;if(a===e[0])if(e.length===1)t.push(n.subarray(r+8,o));else{const l=rt(n.subarray(r+8,o),e.slice(1));l.length&&MN.apply(t,l)}r=o}return t}function PN(n){const e=[],t=n[0];let i=8;const r=Ke(n,i);i+=4;let s=0,a=0;t===0?(s=Ke(n,i),a=Ke(n,i+4),i+=8):(s=z1(n,i),a=z1(n,i+8),i+=16),i+=2;let o=n.length+a;const l=Y1(n,i);i+=2;for(let u=0;u<l;u++){let h=i;const d=Ke(n,h);h+=4;const p=d&2147483647;if((d&2147483648)>>>31===1)return Et.warn("SIDX has hierarchical references (not supported)"),null;const m=Ke(n,h);h+=4,e.push({referenceSize:p,subsegmentDuration:m,info:{duration:m/r,start:o,end:o+p-1}}),o+=p,h+=4,i=h}return{earliestPresentationTime:s,timescale:r,version:t,referencesCount:l,references:e}}function X1(n){const e=[],t=rt(n,["moov","trak"]);for(let r=0;r<t.length;r++){const s=t[r],a=rt(s,["tkhd"])[0];if(a){let o=a[0];const l=Ke(a,o===0?12:20),u=rt(s,["mdia","mdhd"])[0];if(u){o=u[0];const h=Ke(u,o===0?12:20),d=rt(s,["mdia","hdlr"])[0];if(d){const p=di(d.subarray(8,12)),g={soun:Mt.AUDIO,vide:Mt.VIDEO}[p],m=rt(s,["mdia","minf","stbl","stsd"])[0],y=ON(m);g?(e[l]={timescale:h,type:g,stsd:y},e[g]=xt({timescale:h,id:l},y)):e[l]={timescale:h,type:p,stsd:y}}}}}return rt(n,["moov","mvex","trex"]).forEach(r=>{const s=Ke(r,4),a=e[s];a&&(a.default={duration:Ke(r,12),flags:Ke(r,20)})}),e}function ON(n){const e=n.subarray(8),t=e.subarray(86),i=di(e.subarray(4,8));let r=i,s;const a=i==="enca"||i==="encv";if(a){const u=rt(e,[i])[0].subarray(i==="enca"?28:78);rt(u,["sinf"]).forEach(d=>{const p=rt(d,["schm"])[0];if(p){const g=di(p.subarray(4,8));if(g==="cbcs"||g==="cenc"){const m=rt(d,["frma"])[0];m&&(r=di(m))}}})}const o=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const l=rt(t,["avcC"])[0];l&&l.length>3&&(r+="."+Hu(l[1])+Hu(l[2])+Hu(l[3]),s=Vu(o==="avc1"?"dva1":"dvav",t));break}case"mp4a":{const l=rt(e,[i])[0],u=rt(l.subarray(28),["esds"])[0];if(u&&u.length>7){let h=4;if(u[h++]!==3)break;h=hg(u,h),h+=2;const d=u[h++];if(d&128&&(h+=2),d&64&&(h+=u[h++]),u[h++]!==4)break;h=hg(u,h);const p=u[h++];if(p===64)r+="."+Hu(p);else break;if(h+=12,u[h++]!==5)break;h=hg(u,h);const g=u[h++];let m=(g&248)>>3;m===31&&(m+=1+((g&7)<<3)+((u[h]&224)>>5)),r+="."+m}break}case"hvc1":case"hev1":{const l=rt(t,["hvcC"])[0];if(l&&l.length>12){const u=l[1],h=["","A","B","C"][u>>6],d=u&31,p=Ke(l,2),g=(u&32)>>5?"H":"L",m=l[12],y=l.subarray(6,12);r+="."+h+d,r+="."+FN(p).toString(16).toUpperCase(),r+="."+g+m;let b="";for(let A=y.length;A--;){const w=y[A];(w||b)&&(b="."+w.toString(16).toUpperCase()+b)}r+=b}s=Vu(o=="hev1"?"dvhe":"dvh1",t);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":{r=Vu(r,t)||r;break}case"vp09":{const l=rt(t,["vpcC"])[0];if(l&&l.length>6){const u=l[4],h=l[5],d=l[6]>>4&15;r+="."+fn(u)+"."+fn(h)+"."+fn(d)}break}case"av01":{const l=rt(t,["av1C"])[0];if(l&&l.length>2){const u=l[1]>>>5,h=l[1]&31,d=l[2]>>>7?"H":"M",p=(l[2]&64)>>6,g=(l[2]&32)>>5,m=u===2&&p?g?12:10:p?10:8,y=(l[2]&16)>>4,b=(l[2]&8)>>3,A=(l[2]&4)>>2,w=l[2]&3;r+="."+u+"."+fn(h)+d+"."+fn(m)+"."+y+"."+b+A+w+"."+fn(1)+"."+fn(1)+"."+fn(1)+"."+0,s=Vu("dav1",t)}break}}return{codec:r,encrypted:a,supplemental:s}}function Vu(n,e){const t=rt(e,["dvvC"]),i=t.length?t[0]:rt(e,["dvcC"])[0];if(i){const r=i[2]>>1&127,s=i[2]<<5&32|i[3]>>3&31;return n+"."+fn(r)+"."+fn(s)}}function FN(n){let e=0;for(let t=0;t<32;t++)e|=(n>>t&1)<<31-t;return e>>>0}function hg(n,e){const t=e+5;for(;n[e++]&128&&e<t;);return e}function Hu(n){return("0"+n.toString(16).toUpperCase()).slice(-2)}function fn(n){return(n<10?"0":"")+n}function BN(n,e){if(!n||!e)return n;const t=e.keyId;return t&&e.isCommonEncryption&&rt(n,["moov","trak"]).forEach(r=>{const a=rt(r,["mdia","minf","stbl","stsd"])[0].subarray(8);let o=rt(a,["enca"]);const l=o.length>0;l||(o=rt(a,["encv"])),o.forEach(u=>{const h=l?u.subarray(28):u.subarray(78);rt(h,["sinf"]).forEach(p=>{const g=J1(p);if(g){const m=g.subarray(8,24);m.some(y=>y!==0)||(Et.log(`[eme] Patching keyId in 'enc${l?"a":"v"}>sinf>>tenc' box: ${dn.hexDump(m)} -> ${dn.hexDump(t)}`),g.set(t,8))}})})}),n}function J1(n){const e=rt(n,["schm"])[0];if(e){const t=di(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return rt(n,["schi","tenc"])[0]}return null}function UN(n,e,t){const i={},r=rt(n,["moof","traf"]);for(let s=0;s<r.length;s++){const a=r[s],o=rt(a,["tfhd"])[0],l=Ke(o,4),u=e[l];if(!u)continue;const h=i[l]||(i[l]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type}),d=rt(a,["tfdt"])[0];if(d){const x=d[0];let N=Ke(d,4);x===1&&(N===qu?t.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(N*=qu+1,N+=Ke(d,8))),_e(N)&&(!_e(h.start)||N<h.start)&&(h.start=N)}const p=u.default,g=Ke(o,0)|(p==null?void 0:p.flags);let m=(p==null?void 0:p.duration)||0;g&8&&(g&2?m=Ke(o,12):m=Ke(o,8));const y=rt(a,["trun"]);let b=h.start||0,A=0,w=m;for(let x=0;x<y.length;x++){const N=y[x],F=Ke(N,4),L=h.sampleCount;h.sampleCount+=F;const C=N[3]&1,M=N[3]&4,_=N[2]&1,R=N[2]&2,U=N[2]&4,q=N[2]&8;let $=8,Y=F;for(C&&($+=4),M&&F&&(!(N[$+1]&1)&&h.keyFrameIndex===void 0&&(h.keyFrameIndex=L),$+=4,_?(w=Ke(N,$),$+=4):w=m,R&&($+=4),q&&($+=4),b+=w,A+=w,Y--);Y--;)_?(w=Ke(N,$),$+=4):w=m,R&&($+=4),U&&(N[$+1]&1||h.keyFrameIndex===void 0&&(h.keyFrameIndex=h.sampleCount-(Y+1),h.keyFrameStart=b),$+=4),q&&($+=4),b+=w,A+=w;!A&&m&&(A+=m*F)}h.duration+=A}if(!Object.keys(i).some(s=>i[s].duration)){let s=1/0,a=0;const o=rt(n,["sidx"]);for(let l=0;l<o.length;l++){const u=PN(o[l]);if(u!=null&&u.references){s=Math.min(s,u.earliestPresentationTime/u.timescale);const h=u.references.reduce((d,p)=>d+p.info.duration||0,0);a=Math.max(a,h+u.earliestPresentationTime/u.timescale)}}a&&_e(a)&&Object.keys(i).forEach(l=>{i[l].duration||(i[l].duration=a*i[l].timescale-i[l].start)})}return i}function $N(n,e,t){rt(e,["moof","traf"]).forEach(i=>{rt(i,["tfhd"]).forEach(r=>{const s=Ke(r,4),a=n[s];if(!a)return;const o=a.timescale||9e4;rt(i,["tfdt"]).forEach(l=>{const u=l[0],h=t*o;if(h){let d=Ke(l,4);if(u===0)d-=h,d=Math.max(d,0),cg(l,4,d);else{d*=Math.pow(2,32),d+=Ke(l,8),d-=h,d=Math.max(d,0);const p=Math.floor(d/(qu+1)),g=Math.floor(d%(qu+1));cg(l,4,p),cg(l,8,g)}}})})})}function GN(n){const e={valid:null,remainder:null},t=rt(n,["moof"]);if(t.length<2)return e.remainder=n,e;const i=t[t.length-1];return e.valid=n.slice(0,i.byteOffset-8),e.remainder=n.slice(i.byteOffset-8),e}function Ar(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function Q1(n,e){const t=[],i=e.samples,r=e.timescale,s=e.id;let a=!1;return rt(i,["moof"]).map(l=>{const u=l.byteOffset-8;rt(l,["traf"]).map(d=>{const p=rt(d,["tfdt"]).map(g=>{const m=g[0];let y=Ke(g,4);return m===1&&(y*=Math.pow(2,32),y+=Ke(g,8)),y/r})[0];return p!==void 0&&(n=p),rt(d,["tfhd"]).map(g=>{const m=Ke(g,4),y=Ke(g,0)&16777215,b=(y&1)!==0,A=(y&2)!==0,w=(y&8)!==0;let x=0;const N=(y&16)!==0;let F=0;const L=(y&32)!==0;let C=8;m===s&&(b&&(C+=8),A&&(C+=4),w&&(x=Ke(g,C),C+=4),N&&(F=Ke(g,C),C+=4),L&&(C+=4),e.type==="video"&&(a=Ku(e.codec)),rt(d,["trun"]).map(M=>{const _=M[0],R=Ke(M,0)&16777215,U=(R&1)!==0;let q=0;const $=(R&4)!==0,Y=(R&256)!==0;let ae=0;const ne=(R&512)!==0;let ce=0;const re=(R&1024)!==0,V=(R&2048)!==0;let J=0;const ve=Ke(M,4);let pe=8;U&&(q=Ke(M,pe),pe+=4),$&&(pe+=4);let Te=q+u;for(let Ce=0;Ce<ve;Ce++){if(Y?(ae=Ke(M,pe),pe+=4):ae=x,ne?(ce=Ke(M,pe),pe+=4):ce=F,re&&(pe+=4),V&&(_===0?J=Ke(M,pe):J=j1(M,pe),pe+=4),e.type===Mt.VIDEO){let Re=0;for(;Re<ce;){const Be=Ke(i,Te);if(Te+=4,qN(a,i[Te])){const Ue=i.subarray(Te,Te+Be);dg(Ue,a?2:1,n+J/r,t)}Te+=Be,Re+=Be+4}}n+=ae/r}}))})})}),t}function Ku(n){if(!n)return!1;const e=n.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function qN(n,e){if(n){const t=e>>1&63;return t===39||t===40}else return(e&31)===6}function dg(n,e,t,i){const r=Z1(n);let s=0;s+=e;let a=0,o=0,l=0;for(;s<r.length;){a=0;do{if(s>=r.length)break;l=r[s++],a+=l}while(l===255);o=0;do{if(s>=r.length)break;l=r[s++],o+=l}while(l===255);const u=r.length-s;let h=s;if(o<u)s+=o;else if(o>u){Et.error(`Malformed SEI payload. ${o} is too small, only ${u} bytes left to parse.`);break}if(a===4){if(r[h++]===181){const p=Y1(r,h);if(h+=2,p===49){const g=Ke(r,h);if(h+=4,g===1195456820){const m=r[h++];if(m===3){const y=r[h++],b=31&y,A=64&y,w=A?2+b*3:0,x=new Uint8Array(w);if(A){x[0]=y;for(let N=1;N<w;N++)x[N]=r[h++]}i.push({type:m,payloadType:a,pts:t,bytes:x})}}}}}else if(a===5&&o>16){const d=[];for(let m=0;m<16;m++){const y=r[h++].toString(16);d.push(y.length==1?"0"+y:y),(m===3||m===5||m===7||m===9)&&d.push("-")}const p=o-16,g=new Uint8Array(p);for(let m=0;m<p;m++)g[m]=r[h++];i.push({payloadType:a,pts:t,uuid:d.join(""),userData:ur(g),userDataBytes:g})}}}function Z1(n){const e=n.byteLength,t=[];let i=1;for(;i<e-2;)n[i]===0&&n[i+1]===0&&n[i+2]===3?(t.push(i+2),i+=2):i++;if(t.length===0)return n;const r=e-t.length,s=new Uint8Array(r);let a=0;for(i=0;i<r;a++,i++)a===t[0]&&(a++,t.shift()),s[i]=n[a];return s}function VN(n){const e=n[0];let t="",i="",r=0,s=0,a=0,o=0,l=0,u=0;if(e===0){for(;di(n.subarray(u,u+1))!=="\0";)t+=di(n.subarray(u,u+1)),u+=1;for(t+=di(n.subarray(u,u+1)),u+=1;di(n.subarray(u,u+1))!=="\0";)i+=di(n.subarray(u,u+1)),u+=1;i+=di(n.subarray(u,u+1)),u+=1,r=Ke(n,12),s=Ke(n,16),o=Ke(n,20),l=Ke(n,24),u=28}else if(e===1){u+=4,r=Ke(n,u),u+=4;const d=Ke(n,u);u+=4;const p=Ke(n,u);for(u+=4,a=4294967296*d+p,bN(a)||(a=Number.MAX_SAFE_INTEGER,Et.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=Ke(n,u),u+=4,l=Ke(n,u),u+=4;di(n.subarray(u,u+1))!=="\0";)t+=di(n.subarray(u,u+1)),u+=1;for(t+=di(n.subarray(u,u+1)),u+=1;di(n.subarray(u,u+1))!=="\0";)i+=di(n.subarray(u,u+1)),u+=1;i+=di(n.subarray(u,u+1)),u+=1}const h=n.subarray(u,n.byteLength);return{schemeIdUri:t,value:i,timeScale:r,presentationTime:a,presentationTimeDelta:s,eventDuration:o,id:l,payload:h}}function HN(n,...e){const t=e.length;let i=8,r=t;for(;r--;)i+=e[r].byteLength;const s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=i&255,s.set(n,4),r=0,i=8;r<t;r++)s.set(e[r],i),i+=e[r].byteLength;return s}function KN(n,e,t){if(n.byteLength!==16)throw new RangeError("Invalid system id");let i,r;i=0,r=new Uint8Array;let s;i>0?(s=new Uint8Array(4),e.length>0&&new DataView(s.buffer).setUint32(0,e.length,!1)):s=new Uint8Array;const a=new Uint8Array(4);return t&&t.byteLength>0&&new DataView(a.buffer).setUint32(0,t.byteLength,!1),HN([112,115,115,104],new Uint8Array([i,0,0,0]),n,s,r,a,t||new Uint8Array)}function WN(n){const e=[];if(n instanceof ArrayBuffer){const t=n.byteLength;let i=0;for(;i+32<t;){const r=new DataView(n,i),s=YN(r);e.push(s),i+=s.size}}return e}function YN(n){const e=n.getUint32(0),t=n.byteOffset,i=n.byteLength;if(i<e)return{offset:t,size:i};if(n.getUint32(4)!==1886614376)return{offset:t,size:e};const s=n.getUint32(8)>>>24;if(s!==0&&s!==1)return{offset:t,size:e};const a=n.buffer,o=dn.hexDump(new Uint8Array(a,t+12,16)),l=n.getUint32(28);let u=null,h=null;if(s===0){if(e-32<l||l<22)return{offset:t,size:e};h=new Uint8Array(a,t+32,l)}else if(s===1){if(!l||i<t+32+l*16+16)return{offset:t,size:e};u=[];for(let d=0;d<l;d++)u.push(new Uint8Array(a,t+32+d*16,16))}return{version:s,systemId:o,kids:u,data:h,offset:t,size:e}}const eE=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),ja={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function tE(n,e){const t=ja[e];return!!t&&!!t[n.slice(0,4)]}function fg(n,e,t=!0){return!n.split(",").some(i=>!iE(i,e,t))}function iE(n,e,t=!0){var i;const r=As(t);return(i=r==null?void 0:r.isTypeSupported(ol(n,e)))!=null?i:!1}function ol(n,e){return`${e}/mp4;codecs=${n}`}function rE(n){if(n){const e=n.substring(0,4);return ja.video[e]}return 2}function Wu(n){const e=eE();return n.split(",").reduce((t,i)=>{const s=e&&Ku(i)?9:ja.video[i];return s?(s*2+t)/(t?3:2):(ja.audio[i]+t)/(t?2:1)},0)}const gg={};function zN(n,e=!0){if(gg[n])return gg[n];const t={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[n];for(let r=0;r<t.length;r++){var i;if(iE(t[r],"audio",e))return gg[n]=t[r],t[r];if(t[r]==="mp3"&&(i=As(e))!=null&&i.isTypeSupported("audio/mpeg"))return""}return n}const jN=/flac|opus|mp4a\.40\.34/i;function Yu(n,e=!0){return n.replace(jN,t=>zN(t.toLowerCase(),e))}function XN(n,e){const t=[];if(n){const i=n.split(",");for(let r=0;r<i.length;r++)tE(i[r],"video")||t.push(i[r])}return e&&t.push(e),t.join(",")}function zu(n,e){if(n&&(n.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(n)!==-1))return n;if(e){const t=e.split(",");if(t.length>1){if(n){for(let i=t.length;i--;)if(t[i].substring(0,4)===n.substring(0,4))return t[i]}return t[0]}}return e||n}function JN(n){const e=n.split(",");for(let t=0;t<e.length;t++){const i=e[t].split(".");i.length>2&&i[0]==="avc1"&&(e[t]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return e.join(",")}function QN(n){if(n.startsWith("av01.")){const e=n.split("."),t=["0","111","01","01","01","0"];for(let i=e.length;i>4&&i<10;i++)e[i]=t[i-4];return e.join(".")}return n}function nE(n){const e=As(n)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function sE(n){return n.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const aE={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function oE(n,e){return{supported:!1,configurations:e,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:n}}const lE={};function ZN(n,e,t,i,r,s){const a=n.audioCodec?n.audioGroups:null,o=s==null?void 0:s.audioCodec,l=s==null?void 0:s.channels,u=l?parseInt(l):o?1/0:2;let h=null;if(a!=null&&a.length)try{a.length===1&&a[0]?h=e.groups[a[0]].channels:h=a.reduce((d,p)=>{if(p){const g=e.groups[p];if(!g)throw new Error(`Audio track group ${p} not found`);Object.keys(g.channels).forEach(m=>{d[m]=(d[m]||0)+g.channels[m]})}return d},{2:0})}catch{return!0}return n.videoCodec!==void 0&&(n.width>1920&&n.height>1088||n.height>1920&&n.width>1088||n.frameRate>Math.max(i,30)||n.videoRange!=="SDR"&&n.videoRange!==t||n.bitrate>Math.max(r,8e6))||!!h&&_e(u)&&Object.keys(h).some(d=>parseInt(d)>u)}function uE(n,e,t){const i=n.videoCodec,r=n.audioCodec;if(!i&&!r||!t)return Promise.resolve(aE);const s=[];if(i){const a={width:n.width,height:n.height,bitrate:Math.ceil(Math.max(n.bitrate*.9,n.averageBitrate)),framerate:n.frameRate||30},o=n.videoRange;o!=="SDR"&&(a.transferFunction=o.toLowerCase());const l=i.split(","),u=navigator.userAgent;if(l.some(h=>Ku(h))&&eE())return Promise.resolve(oE(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${u})`),s));s.push.apply(s,l.map(h=>({type:"media-source",video:xt(xt({},a),{},{contentType:ol(QN(h),"video")})})))}return r&&n.audioGroups&&n.audioGroups.forEach(a=>{var o;a&&((o=e.groups[a])==null||o.tracks.forEach(l=>{if(l.groupId===a){const u=l.channels||"",h=parseFloat(u);_e(h)&&h>2&&s.push.apply(s,r.split(",").map(d=>({type:"media-source",audio:{contentType:ol(d,"audio"),channels:""+h}})))}}))}),Promise.all(s.map(a=>{const o=eL(a);return lE[o]||(lE[o]=t.decodingInfo(a))})).then(a=>({supported:!a.some(o=>!o.supported),configurations:s,decodingInfoResults:a})).catch(a=>({supported:!1,configurations:s,decodingInfoResults:[],error:a}))}function eL(n){const{audio:e,video:t}=n,i=t||e;if(i){const r=sE(i.contentType);if(t)return`r${t.height}x${t.width}f${Math.ceil(t.framerate)}${t.transferFunction||"sd"}_${r}_${Math.ceil(t.bitrate/1e5)}`;if(e)return`c${e.channels}${e.spatialRendering?"s":"n"}_${r}`}return""}const pg=["NONE","TYPE-0","TYPE-1",null];function tL(n){return pg.indexOf(n)>-1}const ju=["SDR","PQ","HLG"];function iL(n){return!!n&&ju.indexOf(n)>-1}var Xu={No:"",Yes:"YES",v2:"v2"};function cE(n){const{canSkipUntil:e,canSkipDateRanges:t,age:i}=n,r=i<e/2;return e&&r?t?Xu.v2:Xu.Yes:Xu.No}class hE{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class ll{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(i=>!!i).map(i=>i.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const i=(t=e.supplemental)==null?void 0:t.videoCodec;i&&i!==e.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return dE(this._audioGroups,e)}hasSubtitleGroup(e){return dE(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let i=this._audioGroups;i||(i=this._audioGroups=[]),i.indexOf(t)===-1&&i.push(t)}else if(e==="text"){let i=this._subtitleGroups;i||(i=this._subtitleGroups=[]),i.indexOf(t)===-1&&i.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function dE(n,e){return!e||!n?!1:n.indexOf(e)!==-1}function rL(){if(typeof matchMedia=="function"){const n=matchMedia("(dynamic-range: high)"),e=matchMedia("bad query");if(n.media!==e.media)return n.matches===!0}return!1}function nL(n,e){let t=!1,i=[];if(n&&(t=n!=="SDR",i=[n]),e){i=e.allowedVideoRanges||ju.slice(0);const r=i.join("")!=="SDR"&&!e.videoCodec;t=e.preferHDR!==void 0?e.preferHDR:r&&rL(),t||(i=["SDR"])}return{preferHDR:t,allowedVideoRanges:i}}const sL=n=>{const e=new WeakSet;return(t,i)=>{if(n&&(i=n(t,i)),typeof i=="object"&&i!==null){if(e.has(i))return;e.add(i)}return i}},zt=(n,e)=>JSON.stringify(n,sL(e));function aL(n,e,t,i,r){const s=Object.keys(n),a=i==null?void 0:i.channels,o=i==null?void 0:i.audioCodec,l=r==null?void 0:r.videoCodec,u=a&&parseInt(a)===2;let h=!1,d=!1,p=1/0,g=1/0,m=1/0,y=1/0,b=0,A=[];const{preferHDR:w,allowedVideoRanges:x}=nL(e,r);for(let M=s.length;M--;){const _=n[s[M]];h||(h=_.channels[2]>0),p=Math.min(p,_.minHeight),g=Math.min(g,_.minFramerate),m=Math.min(m,_.minBitrate),x.filter(U=>_.videoRanges[U]>0).length>0&&(d=!0)}p=_e(p)?p:0,g=_e(g)?g:0;const N=Math.max(1080,p),F=Math.max(30,g);m=_e(m)?m:t,t=Math.max(m,t),d||(e=void 0);const L=s.length>1;return{codecSet:s.reduce((M,_)=>{const R=n[_];if(_===M)return M;if(A=d?x.filter(U=>R.videoRanges[U]>0):[],L){if(R.minBitrate>t)return gn(_,`min bitrate of ${R.minBitrate} > current estimate of ${t}`),M;if(!R.hasDefaultAudio)return gn(_,"no renditions with default or auto-select sound found"),M;if(o&&_.indexOf(o.substring(0,4))%5!==0)return gn(_,`audio codec preference "${o}" not found`),M;if(a&&!u){if(!R.channels[a])return gn(_,`no renditions with ${a} channel sound found (channels options: ${Object.keys(R.channels)})`),M}else if((!o||u)&&h&&R.channels[2]===0)return gn(_,"no renditions with stereo sound found"),M;if(R.minHeight>N)return gn(_,`min resolution of ${R.minHeight} > maximum of ${N}`),M;if(R.minFramerate>F)return gn(_,`min framerate of ${R.minFramerate} > maximum of ${F}`),M;if(!A.some(U=>R.videoRanges[U]>0))return gn(_,`no variants with VIDEO-RANGE of ${zt(A)} found`),M;if(l&&_.indexOf(l.substring(0,4))%5!==0)return gn(_,`video codec preference "${l}" not found`),M;if(R.maxScore<b)return gn(_,`max score of ${R.maxScore} < selected max of ${b}`),M}return M&&(Wu(_)>=Wu(M)||R.fragmentError>n[M].fragmentError)?M:(y=R.minIndex,b=R.maxScore,_)},void 0),videoRanges:A,preferHDR:w,minFramerate:g,minBitrate:m,minIndex:y}}function gn(n,e){Et.log(`[abr] start candidates with "${n}" ignored because ${e}`)}function fE(n){return n.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const r=t.channels||"2";return i.channels[r]=(i.channels[r]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function oL(n,e,t,i){return n.slice(t,i+1).reduce((r,s,a)=>{if(!s.codecSet)return r;const o=s.audioGroups;let l=r[s.codecSet];l||(r[s.codecSet]=l={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:a,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!o,fragmentError:0}),l.minBitrate=Math.min(l.minBitrate,s.bitrate);const u=Math.min(s.height,s.width);return l.minHeight=Math.min(l.minHeight,u),l.minFramerate=Math.min(l.minFramerate,s.frameRate),l.minIndex=Math.min(l.minIndex,a),l.maxScore=Math.max(l.maxScore,s.score),l.fragmentError+=s.fragmentError,l.videoRanges[s.videoRange]=(l.videoRanges[s.videoRange]||0)+1,o&&o.forEach(h=>{if(!h)return;const d=e.groups[h];d&&(l.hasDefaultAudio=l.hasDefaultAudio||e.hasDefaultAudio?d.hasDefault:d.hasAutoSelect||!e.hasDefaultAudio&&!e.hasAutoSelectAudio,Object.keys(d.channels).forEach(p=>{l.channels[p]=(l.channels[p]||0)+d.channels[p]}))}),r},{})}function gE(n){if(!n)return n;const{lang:e,assocLang:t,characteristics:i,channels:r,audioCodec:s}=n;return{lang:e,assocLang:t,characteristics:i,channels:r,audioCodec:s}}function pn(n,e,t){if("attrs"in n){const i=e.indexOf(n);if(i!==-1)return i}for(let i=0;i<e.length;i++){const r=e[i];if(ia(n,r,t))return i}return-1}function ia(n,e,t){const{groupId:i,name:r,lang:s,assocLang:a,default:o}=n,l=n.forced;return(i===void 0||e.groupId===i)&&(r===void 0||e.name===r)&&(s===void 0||lL(s,e.lang))&&(s===void 0||e.assocLang===a)&&(o===void 0||e.default===o)&&(l===void 0||e.forced===l)&&(!("characteristics"in n)||uL(n.characteristics||"",e.characteristics))&&(t===void 0||t(n,e))}function lL(n,e="--"){return n.length===e.length?n===e:n.startsWith(e)||e.startsWith(n)}function uL(n,e=""){const t=n.split(","),i=e.split(",");return t.length===i.length&&!t.some(r=>i.indexOf(r)===-1)}function ra(n,e){const{audioCodec:t,channels:i}=n;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(i===void 0||i===(e.channels||"2"))}function cL(n,e,t,i,r){const s=e[i],o=e.reduce((p,g,m)=>{const y=g.uri;return(p[y]||(p[y]=[])).push(m),p},{})[s.uri];o.length>1&&(i=Math.max.apply(Math,o));const l=s.videoRange,u=s.frameRate,h=s.codecSet.substring(0,4),d=pE(e,i,p=>{if(p.videoRange!==l||p.frameRate!==u||p.codecSet.substring(0,4)!==h)return!1;const g=p.audioGroups,m=t.filter(y=>!g||g.indexOf(y.groupId)!==-1);return pn(n,m,r)>-1});return d>-1?d:pE(e,i,p=>{const g=p.audioGroups,m=t.filter(y=>!g||g.indexOf(y.groupId)!==-1);return pn(n,m,r)>-1})}function pE(n,e,t){for(let i=e;i>-1;i--)if(t(n[i]))return i;for(let i=e+1;i<n.length;i++)if(t(n[i]))return i;return-1}function Ju(n,e){var t;return!!n&&n!==((t=e.loadLevelObj)==null?void 0:t.uri)}class hL extends Bn{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var i;const{fragCurrent:r,partCurrent:s,hls:a}=this,{autoLevelEnabled:o,media:l}=a;if(!r||!l)return;const u=performance.now(),h=s?s.stats:r.stats,d=s?s.duration:r.duration,p=u-h.loading.start,g=a.minAutoLevel,m=r.level,y=this._nextAutoLevel;if(h.aborted||h.loaded&&h.loaded===h.total||m<=g){this.clearTimer(),this._nextAutoLevel=-1;return}if(!o)return;const b=y>-1&&y!==m,A=!!t||b;if(!A&&(l.paused||!l.playbackRate||!l.readyState))return;const w=a.mainForwardBufferInfo;if(!A&&w===null)return;const x=this.bwEstimator.getEstimateTTFB(),N=Math.abs(l.playbackRate);if(p<=Math.max(x,1e3*(d/(N*2))))return;const F=w?w.len/N:0,L=h.loading.first?h.loading.first-h.loading.start:-1,C=h.loaded&&L>-1,M=this.getBwEstimate(),_=a.levels,R=_[m],U=Math.max(h.loaded,Math.round(d*(r.bitrate||R.averageBitrate)/8));let q=C?p-L:p;q<1&&C&&(q=Math.min(p,h.loaded*8/M));const $=C?h.loaded*1e3/q:0,Y=x/1e3,ae=$?(U-h.loaded)/$:U*8/M+Y;if(ae<=F)return;const ne=$?$*8:M,ce=((i=(t==null?void 0:t.details)||this.hls.latestLevelDetails)==null?void 0:i.live)===!0,re=this.hls.config.abrBandWidthUpFactor;let V=Number.POSITIVE_INFINITY,J;for(J=m-1;J>g;J--){const Ce=_[J].maxBitrate,Re=!_[J].details||ce;if(V=this.getTimeToLoadFrag(Y,ne,d*Ce,Re),V<Math.min(F,d+Y))break}if(V>=ae||V>d*10)return;C?this.bwEstimator.sample(p-Math.min(x,L),h.loaded):this.bwEstimator.sampleTTFB(p);const ve=_[J].maxBitrate;this.getBwEstimate()*re>ve&&this.resetEstimator(ve);const pe=this.findBestLevel(ve,g,J,0,F,1,1);pe>-1&&(J=pe),this.warn(`Fragment ${r.sn}${s?" part "+s.index:""} of level ${m} is loading too slowly;
      Fragment duration: ${r.duration.toFixed(3)}
      Time to underbuffer: ${F.toFixed(3)} s
      Estimated load time for current fragment: ${ae.toFixed(3)} s
      Estimated load time for down switch fragment: ${V.toFixed(3)} s
      TTFB estimate: ${L|0} ms
      Current BW estimate: ${_e(M)?M|0:"Unknown"} bps
      New BW estimate: ${this.getBwEstimate()|0} bps
      Switching to level ${J} @ ${ve|0} bps`),a.nextLoadLevel=a.nextAutoLevel=J,this.clearTimer();const Te=()=>{if(this.clearTimer(),this.fragCurrent===r&&this.hls.loadLevel===J&&J>0){const Ce=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${J>0?"and switching down":""}
      Fragment duration: ${r.duration.toFixed(3)} s
      Time to underbuffer: ${Ce.toFixed(3)} s`),r.abortRequests(),this.fragCurrent=this.partCurrent=null,J>g){let Re=this.findBestLevel(this.hls.levels[g].bitrate,g,J,0,Ce,1,1);Re===-1&&(Re=g),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Re,this.resetEstimator(this.hls.levels[Re].bitrate)}}};b||ae>V*2?Te():this.timer=self.setInterval(Te,V*1e3),a.trigger(T.FRAG_LOAD_EMERGENCY_ABORTED,{frag:r,part:s,stats:h})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new AN(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(T.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){if(!i.bitrateTest){var r;this.fragCurrent=i,this.partCurrent=(r=t.part)!=null?r:null}this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case Z.BUFFER_ADD_CODEC_ERROR:case Z.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Z.FRAG_LOAD_TIMEOUT:{const i=t.frag,{fragCurrent:r,partCurrent:s}=this;if(i&&r&&i.sn===r.sn&&i.level===r.level){const a=performance.now(),o=s?s.stats:i.stats,l=a-o.loading.start,u=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&u>-1){const d=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(l-Math.min(d,u),o.loaded)}else this.bwEstimator.sampleTTFB(l)}break}}}getTimeToLoadFrag(e,t,i,r){const s=e+i/t,a=r?e+this.lastLevelLoadSec:0;return s+a}onLevelLoaded(e,t){const i=this.hls.config,{loading:r}=t.stats,s=r.end-r.first;_e(s)&&(this.lastLevelLoadSec=s/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:i}){const r=i?i.stats:t.stats;if(t.type===Oe.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const s=i?i.duration:t.duration,a=this.hls.levels[t.level],o=(a.loaded?a.loaded.bytes:0)+r.loaded,l=(a.loaded?a.loaded.duration:0)+s;a.loaded={bytes:o,duration:l},a.realBitrate=Math.round(8*o/l)}if(t.bitrateTest){const s={stats:r,frag:t,part:i,id:t.type};this.onFragBuffered(T.FRAG_BUFFERED,s),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:r}=t,s=r!=null&&r.stats.loaded?r.stats:i.stats;if(s.aborted||this.ignoreFragment(i))return;const a=s.parsing.end-s.loading.start-Math.min(s.loading.first-s.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,s.loaded),s.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Oe.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),r=this.hls.config.maxStarvationDelay,s=this.findBestLevel(i,t,e,0,r,1,1);if(s>-1)return s;const a=this.hls.firstLevel,o=Math.min(Math.max(a,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${a} clamped to ${o}`),o}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,i=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!i||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;const s=i&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){const a=this.hls.levels;if(a.length>Math.max(e,s)&&a[e].loadError<=a[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:r,config:s,minAutoLevel:a}=i,o=t?t.duration:e?e.duration:0,l=this.getBwEstimate(),u=this.getStarvationDelay();let h=s.abrBandWidthFactor,d=s.abrBandWidthUpFactor;if(u){const b=this.findBestLevel(l,a,r,u,0,h,d);if(b>=0)return this.rebufferNotice=-1,b}let p=o?Math.min(o,s.maxStarvationDelay):s.maxStarvationDelay;if(!u){const b=this.bitrateTestDelay;b&&(p=(o?Math.min(o,s.maxLoadingDelay):s.maxLoadingDelay)-b,this.info(`bitrate test took ${Math.round(1e3*b)}ms, set first fragment max fetchDuration to ${Math.round(1e3*p)} ms`),h=d=1)}const g=this.findBestLevel(l,a,r,u,p,h,d);if(this.rebufferNotice!==g&&(this.rebufferNotice=g,this.info(`${u?"rebuffering expected":"buffer is empty"}, optimal quality level ${g}`)),g>-1)return g;const m=i.levels[a],y=i.loadLevelObj;return y&&(m==null?void 0:m.bitrate)<y.bitrate?a:i.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const i=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,r=e.mainForwardBufferInfo;return(r?r.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,r,s,a,o){var l;const u=r+s,h=this.lastLoadedFragLevel,d=h===-1?this.hls.firstLevel:h,{fragCurrent:p,partCurrent:g}=this,{levels:m,allAudioTracks:y,loadLevel:b,config:A}=this.hls;if(m.length===1)return 0;const w=m[d],x=!!((l=this.hls.latestLevelDetails)!=null&&l.live),N=b===-1||h===-1;let F,L="SDR",C=(w==null?void 0:w.frameRate)||0;const{audioPreference:M,videoPreference:_}=A,R=this.audioTracksByGroup||(this.audioTracksByGroup=fE(y));let U=-1;if(N){if(this.firstSelection!==-1)return this.firstSelection;const ne=this.codecTiers||(this.codecTiers=oL(m,R,t,i)),ce=aL(ne,L,e,M,_),{codecSet:re,videoRanges:V,minFramerate:J,minBitrate:ve,minIndex:pe,preferHDR:Te}=ce;U=pe,F=re,L=Te?V[V.length-1]:V[0],C=J,e=Math.max(e,ve),this.log(`picked start tier ${zt(ce)}`)}else F=w==null?void 0:w.codecSet,L=w==null?void 0:w.videoRange;const q=g?g.duration:p?p.duration:0,$=this.bwEstimator.getEstimateTTFB()/1e3,Y=[];for(let ne=i;ne>=t;ne--){var ae;const ce=m[ne],re=ne>d;if(!ce)continue;if(A.useMediaCapabilities&&!ce.supportedResult&&!ce.supportedPromise){const Re=navigator.mediaCapabilities;typeof(Re==null?void 0:Re.decodingInfo)=="function"&&(ZN(ce,R,L,C,e,M)||Ku(ce.videoCodec))?(ce.supportedPromise=uE(ce,R,Re),ce.supportedPromise.then(Be=>{if(!this.hls)return;ce.supportedResult=Be;const Ue=this.hls.levels,Qe=Ue.indexOf(ce);Be.error?this.warn(`MediaCapabilities decodingInfo error: "${Be.error}" for level ${Qe} ${zt(Be)}`):Be.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${Qe} ${zt(Be)}`),Qe>-1&&Ue.length>1&&(this.log(`Removing unsupported level ${Qe}`),this.hls.removeLevel(Qe),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))})):ce.supportedResult=aE}if((F&&ce.codecSet!==F||L&&ce.videoRange!==L||re&&C>ce.frameRate||!re&&C>0&&C<ce.frameRate||ce.supportedResult&&!((ae=ce.supportedResult.decodingInfoResults)!=null&&ae[0].smooth))&&(!N||ne!==U)){Y.push(ne);continue}const V=ce.details,J=(g?V==null?void 0:V.partTarget:V==null?void 0:V.averagetargetduration)||q;let ve;re?ve=o*e:ve=a*e;const pe=q&&r>=q*2&&s===0?ce.averageBitrate:ce.maxBitrate,Te=this.getTimeToLoadFrag($,ve,pe*J,V===void 0);if(ve>=pe&&(ne===h||ce.loadError===0&&ce.fragmentError===0)&&(Te<=$||!_e(Te)||x&&!this.bitrateTestDelay||Te<u)){const Re=this.forcedAutoLevel;return ne!==b&&(Re===-1||Re!==b)&&(Y.length&&this.trace(`Skipped level(s) ${Y.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${m[Y[0]].codecs}" ${m[Y[0]].videoRange}; not compatible with "${F}" ${L}`),this.info(`switch candidate:${d}->${ne} adjustedbw(${Math.round(ve)})-bitrate=${Math.round(ve-pe)} ttfb:${$.toFixed(1)} avgDuration:${J.toFixed(1)} maxFetchDuration:${u.toFixed(1)} fetchDuration:${Te.toFixed(1)} firstSelection:${N} codecSet:${ce.codecSet} videoRange:${ce.videoRange} hls.loadLevel:${b}`)),N&&(this.firstSelection=ne),ne}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:i}=this.hls;return Math.min(Math.max(e,i),t)}}const mE={search:function(n,e){let t=0,i=n.length-1,r=null,s=null;for(;t<=i;){r=(t+i)/2|0,s=n[r];const a=e(s);if(a>0)t=r+1;else if(a<0)i=r-1;else return s}return null}};function dL(n,e,t){if(e===null||!Array.isArray(n)||!n.length||!_e(e))return null;const i=n[0].programDateTime;if(e<(i||0))return null;const r=n[n.length-1].endProgramDateTime;if(e>=(r||0))return null;for(let s=0;s<n.length;++s){const a=n[s];if(gL(e,t,a))return a}return null}function na(n,e,t=0,i=0,r=.005){let s=null;if(n){s=e[1+n.sn-e[0].sn]||null;const o=n.endDTS-t;o>0&&o<15e-7&&(t+=15e-7),s&&n.level!==s.level&&s.end<=n.end&&(s=e[2+n.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(s=e[0]);if(s&&((!n||n.level===s.level)&&yE(t,i,s)===0||fL(s,n,Math.min(r,i))))return s;const a=mE.search(e,yE.bind(null,t,i));return a&&(a!==n||!s)?a:s}function fL(n,e,t){if(e&&e.start===0&&e.level<n.level&&(e.endPTS||0)>0){const i=e.tagList.reduce((r,s)=>(s[0]==="INF"&&(r+=parseFloat(s[1])),r),t);return n.start<=i}return!1}function yE(n=0,e=0,t){if(t.start<=n&&t.start+t.duration>n)return 0;const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-i<=n?1:t.start-i>n&&t.start?-1:0}function gL(n,e,t){const i=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0))*1e3;return(t.endProgramDateTime||0)-i>n}function vE(n,e,t){if(n&&n.startCC<=e&&n.endCC>=e){let i=n.fragments;const{fragmentHint:r}=n;r&&(i=i.concat(r));let s;return mE.search(i,a=>a.cc<e?1:a.cc>e?-1:(s=a,a.end<=t?1:a.start>t?-1:0)),s||null}return null}function Qu(n){switch(n.details){case Z.FRAG_LOAD_TIMEOUT:case Z.KEY_LOAD_TIMEOUT:case Z.LEVEL_LOAD_TIMEOUT:case Z.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function bE(n,e){const t=Qu(e);return n.default[`${t?"timeout":"error"}Retry`]}function mg(n,e){const t=n.backoff==="linear"?1:Math.pow(2,e);return Math.min(t*n.retryDelayMs,n.maxRetryDelayMs)}function EE(n){return xt(xt({},n),{errorRetry:null,timeoutRetry:null})}function Zu(n,e,t,i){if(!n)return!1;const r=i==null?void 0:i.code,s=e<n.maxNumRetry&&(pL(r)||!!t);return n.shouldRetry?n.shouldRetry(n,e,t,i,s):s}function pL(n){return n===0&&navigator.onLine===!1||!!n&&(n<400||n>499)}var _i={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},Fr={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class mL extends Bn{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.ERROR,this.onError,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.ERROR,this.onError,this),e.off(T.ERROR,this.onErrorOut,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(e==null?void 0:e.type)===Oe.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i;if(t.fatal)return;const r=this.hls,s=t.context;switch(t.details){case Z.FRAG_LOAD_ERROR:case Z.FRAG_LOAD_TIMEOUT:case Z.KEY_LOAD_ERROR:case Z.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case Z.FRAG_PARSING_ERROR:if((i=t.frag)!=null&&i.gap){t.errorAction=ul();return}case Z.FRAG_GAP:case Z.FRAG_DECRYPT_ERROR:{t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=_i.SendAlternateToPenaltyBox;return}case Z.LEVEL_EMPTY_ERROR:case Z.LEVEL_PARSING_ERROR:{var a,o;const u=t.parent===Oe.MAIN?t.level:r.loadLevel;t.details===Z.LEVEL_EMPTY_ERROR&&((a=t.context)!=null&&(o=a.levelDetails)!=null&&o.live)?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,u):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,u))}return;case Z.LEVEL_LOAD_ERROR:case Z.LEVEL_LOAD_TIMEOUT:typeof(s==null?void 0:s.level)=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.level));return;case Z.AUDIO_TRACK_LOAD_ERROR:case Z.AUDIO_TRACK_LOAD_TIMEOUT:case Z.SUBTITLE_LOAD_ERROR:case Z.SUBTITLE_TRACK_LOAD_TIMEOUT:if(s){const u=r.loadLevelObj;if(u&&(s.type===ct.AUDIO_TRACK&&u.hasAudioGroup(s.groupId)||s.type===ct.SUBTITLE_TRACK&&u.hasSubtitleGroup(s.groupId))){t.errorAction=this.getPlaylistRetryOrSwitchAction(t,r.loadLevel),t.errorAction.action=_i.SendAlternateToPenaltyBox,t.errorAction.flags=Fr.MoveAllAlternatesMatchingHost;return}}return;case Z.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const u=r.loadLevelObj,h=u==null?void 0:u.attrs["HDCP-LEVEL"];h?t.errorAction={action:_i.SendAlternateToPenaltyBox,flags:Fr.MoveAllAlternatesMatchingHDCP,hdcpLevel:h}:this.keySystemError(t)}return;case Z.BUFFER_ADD_CODEC_ERROR:case Z.REMUX_ALLOC_ERROR:case Z.BUFFER_APPEND_ERROR:if(!t.errorAction){var l;t.errorAction=this.getLevelSwitchAction(t,(l=t.level)!=null?l:r.loadLevel)}return;case Z.INTERNAL_EXCEPTION:case Z.BUFFER_APPENDING_ERROR:case Z.BUFFER_FULL_ERROR:case Z.LEVEL_SWITCH_ERROR:case Z.BUFFER_STALLED_ERROR:case Z.BUFFER_SEEK_OVER_HOLE:case Z.BUFFER_NUDGE_ON_STALL:t.errorAction=ul();return}t.type===$e.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const i=this.hls,r=bE(i.config.playlistLoadPolicy,e),s=this.playlistError++;if(Zu(r,s,Qu(e),e.response))return{action:_i.RetryRequest,flags:Fr.None,retryConfig:r,retryCount:s};const o=this.getLevelSwitchAction(e,t);return r&&(o.retryConfig=r,o.retryCount=s),o}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),r=t.levels[i],{fragLoadPolicy:s,keyLoadPolicy:a}=t.config,o=bE(e.details.startsWith("key")?a:s,e),l=t.levels.reduce((h,d)=>h+d.fragmentError,0);if(r&&(e.details!==Z.FRAG_GAP&&r.fragmentError++,Zu(o,l,Qu(e),e.response)))return{action:_i.RetryRequest,flags:Fr.None,retryConfig:o,retryCount:l};const u=this.getLevelSwitchAction(e,i);return o&&(u.retryConfig=o,u.retryCount=l),u}getLevelSwitchAction(e,t){const i=this.hls;t==null&&(t=i.loadLevel);const r=this.hls.levels[t];if(r){var s,a;const u=e.details;r.loadError++,u===Z.BUFFER_APPEND_ERROR&&r.fragmentError++;let h=-1;const{levels:d,loadLevel:p,minAutoLevel:g,maxAutoLevel:m}=i;!i.autoLevelEnabled&&!i.config.preserveManualLevelOnError&&(i.loadLevel=-1);const y=(s=e.frag)==null?void 0:s.type,A=(y===Oe.AUDIO&&u===Z.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(u===Z.BUFFER_ADD_CODEC_ERROR||u===Z.BUFFER_APPEND_ERROR))&&d.some(({audioCodec:L})=>r.audioCodec!==L),x=e.sourceBufferName==="video"&&(u===Z.BUFFER_ADD_CODEC_ERROR||u===Z.BUFFER_APPEND_ERROR)&&d.some(({codecSet:L,audioCodec:C})=>r.codecSet!==L&&r.audioCodec===C),{type:N,groupId:F}=(a=e.context)!=null?a:{};for(let L=d.length;L--;){const C=(L+p)%d.length;if(C!==p&&C>=g&&C<=m&&d[C].loadError===0){var o,l;const M=d[C];if(u===Z.FRAG_GAP&&y===Oe.MAIN&&e.frag){const _=d[C].details;if(_){const R=na(e.frag,_.fragments,e.frag.start);if(R!=null&&R.gap)continue}}else{if(N===ct.AUDIO_TRACK&&M.hasAudioGroup(F)||N===ct.SUBTITLE_TRACK&&M.hasSubtitleGroup(F))continue;if(y===Oe.AUDIO&&(o=r.audioGroups)!=null&&o.some(_=>M.hasAudioGroup(_))||y===Oe.SUBTITLE&&(l=r.subtitleGroups)!=null&&l.some(_=>M.hasSubtitleGroup(_))||A&&r.audioCodec===M.audioCodec||!A&&r.audioCodec!==M.audioCodec||x&&r.codecSet===M.codecSet)continue}h=C;break}}if(h>-1&&i.loadLevel!==h)return e.levelRetry=!0,this.playlistError=0,{action:_i.SendAlternateToPenaltyBox,flags:Fr.None,nextAutoLevel:h}}return{action:_i.SendAlternateToPenaltyBox,flags:Fr.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch((i=t.errorAction)==null?void 0:i.action){case _i.DoNothing:break;case _i.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),!t.errorAction.resolved&&t.details!==Z.FRAG_GAP?t.fatal=!0:/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError());break}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:r,hdcpLevel:s,nextAutoLevel:a}=i;switch(r){case Fr.None:this.switchLevel(e,a);break;case Fr.MoveAllAlternatesMatchingHDCP:s&&(t.maxHdcpLevel=pg[pg.indexOf(s)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}i.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Z.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){const i=sE(e.mimeType),r=this.hls.levels;for(let s=r.length;s--;)r[s][`${e.sourceBufferName}Codec`]===i&&this.hls.removeLevel(s)}}}function ul(n){const e={action:_i.DoNothing,flags:Fr.None};return n&&(e.resolved=!0),e}var fi={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class yL{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.BUFFER_APPENDED,this.onBufferAppended,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.BUFFER_APPENDED,this.onBufferAppended,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let r=i.length;r--;){const s=i[r];if(!s)break;const a=s.end;if(s.start<=e&&a!==null&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,i){const{fragments:r}=this,s=Object.keys(r);for(let a=s.length;a--;){const o=r[s[a]];if((o==null?void 0:o.body.type)===t&&(!i||o.buffered)){const l=o.body;if(l.start<=e&&e<=l.end)return l}}return null}detectEvictedFragments(e,t,i,r,s){this.timeRanges&&(this.timeRanges[e]=t);const a=(r==null?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(o=>{const l=this.fragments[o];if(!l||a>=l.body.sn)return;if(!l.buffered&&(!l.loaded||s)){l.body.type===i&&this.removeFragment(l.body);return}const u=l.range[e];if(u){if(u.time.length===0){this.removeFragment(l.body);return}u.time.some(h=>{const d=!this.isTimeBuffered(h.startPTS,h.endPTS,t);return d&&this.removeFragment(l.body),d})}})}detectPartialFragments(e){const t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;const i=e.frag,r=Xa(i),s=this.fragments[r];if(!s||s.buffered&&i.gap)return;const a=!i.relurl;Object.keys(t).forEach(o=>{const l=i.elementaryStreams[o];if(!l)return;const u=t[o],h=a||l.partial===!0;s.range[o]=this.getBufferedTimes(i,e.part,h,u)}),s.loaded=null,Object.keys(s.range).length?(s.buffered=!0,(s.body.endList=i.endList||s.body.endList)&&(this.endListFragments[s.body.type]=s),ec(s)||this.removeParts(i.sn-1,i.type)):this.removeFragment(s.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=AE(i,r=>r.fragment.sn>=e))}fragBuffered(e,t){const i=Xa(e);let r=this.fragments[i];!r&&t&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,i,r){const s={time:[],partial:i},a=e.start,o=e.end,l=e.minEndPTS||o,u=e.maxStartPTS||a;for(let h=0;h<r.length;h++){const d=r.start(h)-this.bufferPadding,p=r.end(h)+this.bufferPadding;if(u>=d&&l<=p){s.time.push({startPTS:Math.max(a,r.start(h)),endPTS:Math.min(o,r.end(h))});break}else if(a<p&&o>d){const g=Math.max(a,r.start(h)),m=Math.min(o,r.end(h));m>g&&(s.partial=!0,s.time.push({startPTS:g,endPTS:m}))}else if(o<=d)break}return s}getPartialFragment(e){let t=null,i,r,s,a=0;const{bufferPadding:o,fragments:l}=this;return Object.keys(l).forEach(u=>{const h=l[u];h&&ec(h)&&(r=h.body.start-o,s=h.body.end+o,e>=r&&e<=s&&(i=Math.min(e-r,s-e),a<=i&&(t=h.body,a=i)))}),t}isEndListAppended(e){const t=this.endListFragments[e];return t!==void 0&&(t.buffered||ec(t))}getState(e){const t=Xa(e),i=this.fragments[t];return i?i.buffered?ec(i)?fi.PARTIAL:fi.OK:fi.APPENDING:fi.NOT_LOADED}isTimeBuffered(e,t,i){let r,s;for(let a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,s=i.end(a)+this.bufferPadding,e>=r&&t<=s)return!0;if(t<=r)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;const i=t.frag,r=t.part?null:t,s=Xa(i);this.fragments[s]={body:i,appendedPTS:null,loaded:r,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:r,timeRanges:s,type:a}=t;if(i.sn==="initSegment")return;const o=i.type;if(r){let u=this.activePartLists[o];u||(this.activePartLists[o]=u=[]),u.push(r)}this.timeRanges=s;const l=s[a];this.detectEvictedFragments(a,l,o,r)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Xa(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,i=Object.keys(t);if(!e)return i.length>0;for(let r=i.length;r--;){const s=t[i[r]];if((s==null?void 0:s.body.type)===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,i,r,s){r&&!this.hasGaps||Object.keys(this.fragments).forEach(a=>{const o=this.fragments[a];if(!o)return;const l=o.body;l.type!==i||r&&!l.gap||l.start<t&&l.end>e&&(o.buffered||s)&&this.removeFragment(l)})}removeFragment(e){const t=Xa(e);e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const r=e.sn;this.activePartLists[e.type]=AE(i,s=>s.fragment.sn!==r)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const i=(e=this.hls)==null||(t=e.latestLevelDetails)==null?void 0:t.partList;i&&i.forEach(r=>r.clearElementaryStreamInfo())}}function ec(n){var e,t,i;return n.buffered&&(n.body.gap||((e=n.range.video)==null?void 0:e.partial)||((t=n.range.audio)==null?void 0:t.partial)||((i=n.range.audiovideo)==null?void 0:i.partial))}function Xa(n){return`${n.type}_${n.level}_${n.sn}`}function AE(n,e){return n.filter(t=>{const i=e(t);return i||t.clearElementaryStreamInfo(),i})}var Ss={cbc:0,ctr:1};class vL{constructor(e,t,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=i}decrypt(e,t){switch(this.aesMode){case Ss.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Ss.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}function bL(n){const e=n.byteLength,t=e&&new DataView(n.buffer).getUint8(e-1);return t?n.slice(0,e-t):n}class EL{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let r=0;r<4;r++)i[r]=t.getUint32(r*4);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],s=i[1],a=i[2],o=i[3],l=this.invSubMix,u=l[0],h=l[1],d=l[2],p=l[3],g=new Uint32Array(256);let m=0,y=0,b=0;for(b=0;b<256;b++)b<128?g[b]=b<<1:g[b]=b<<1^283;for(b=0;b<256;b++){let A=y^y<<1^y<<2^y<<3^y<<4;A=A>>>8^A&255^99,e[m]=A,t[A]=m;const w=g[m],x=g[w],N=g[x];let F=g[A]*257^A*16843008;r[m]=F<<24|F>>>8,s[m]=F<<16|F>>>16,a[m]=F<<8|F>>>24,o[m]=F,F=N*16843009^x*65537^w*257^m*16843008,u[A]=F<<24|F>>>8,h[A]=F<<16|F>>>16,d[A]=F<<8|F>>>24,p[A]=F,m?(m=w^g[g[g[N^w]]],y^=g[g[y]]):m=y=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,r=0;for(;r<t.length&&i;)i=t[r]===this.key[r],r++;if(i)return;this.key=t;const s=this.keySize=t.length;if(s!==4&&s!==6&&s!==8)throw new Error("Invalid aes key size="+s);const a=this.ksRows=(s+6+1)*4;let o,l;const u=this.keySchedule=new Uint32Array(a),h=this.invKeySchedule=new Uint32Array(a),d=this.sBox,p=this.rcon,g=this.invSubMix,m=g[0],y=g[1],b=g[2],A=g[3];let w,x;for(o=0;o<a;o++){if(o<s){w=u[o]=t[o];continue}x=w,o%s===0?(x=x<<8|x>>>24,x=d[x>>>24]<<24|d[x>>>16&255]<<16|d[x>>>8&255]<<8|d[x&255],x^=p[o/s|0]<<24):s>6&&o%s===4&&(x=d[x>>>24]<<24|d[x>>>16&255]<<16|d[x>>>8&255]<<8|d[x&255]),u[o]=w=(u[o-s]^x)>>>0}for(l=0;l<a;l++)o=a-l,l&3?x=u[o]:x=u[o-4],l<4||o<=4?h[l]=x:h[l]=m[d[x>>>24]]^y[d[x>>>16&255]]^b[d[x>>>8&255]]^A[d[x&255]],h[l]=h[l]>>>0}networkToHostOrderSwap(e){return e<<24|(e&65280)<<8|(e&16711680)>>8|e>>>24}decrypt(e,t,i){const r=this.keySize+6,s=this.invKeySchedule,a=this.invSBox,o=this.invSubMix,l=o[0],u=o[1],h=o[2],d=o[3],p=this.uint8ArrayToUint32Array_(i);let g=p[0],m=p[1],y=p[2],b=p[3];const A=new Int32Array(e),w=new Int32Array(A.length);let x,N,F,L,C,M,_,R,U,q,$,Y,ae,ne;const ce=this.networkToHostOrderSwap;for(;t<A.length;){for(U=ce(A[t]),q=ce(A[t+1]),$=ce(A[t+2]),Y=ce(A[t+3]),C=U^s[0],M=Y^s[1],_=$^s[2],R=q^s[3],ae=4,ne=1;ne<r;ne++)x=l[C>>>24]^u[M>>16&255]^h[_>>8&255]^d[R&255]^s[ae],N=l[M>>>24]^u[_>>16&255]^h[R>>8&255]^d[C&255]^s[ae+1],F=l[_>>>24]^u[R>>16&255]^h[C>>8&255]^d[M&255]^s[ae+2],L=l[R>>>24]^u[C>>16&255]^h[M>>8&255]^d[_&255]^s[ae+3],C=x,M=N,_=F,R=L,ae=ae+4;x=a[C>>>24]<<24^a[M>>16&255]<<16^a[_>>8&255]<<8^a[R&255]^s[ae],N=a[M>>>24]<<24^a[_>>16&255]<<16^a[R>>8&255]<<8^a[C&255]^s[ae+1],F=a[_>>>24]<<24^a[R>>16&255]<<16^a[C>>8&255]<<8^a[M&255]^s[ae+2],L=a[R>>>24]<<24^a[C>>16&255]<<16^a[M>>8&255]<<8^a[_&255]^s[ae+3],w[t]=ce(x^g),w[t+1]=ce(L^m),w[t+2]=ce(F^y),w[t+3]=ce(N^b),g=U,m=q,y=$,b=Y,t=t+4}return w.buffer}}class AL{constructor(e,t,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=i}expandKey(){const e=SL(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}function SL(n){switch(n){case Ss.cbc:return"AES-CBC";case Ss.ctr:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${n}`)}}const xL=16;class yg{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const i=self.crypto;i&&(this.subtle=i.subtle||i.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?bL(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i,r){return this.useSoftware?new Promise((s,a)=>{const o=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(o,t,i,r);const l=this.flush();l?s(l.buffer):a(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i,r)}softwareDecrypt(e,t,i,r){const{currentIV:s,currentResult:a,remainderData:o}=this;if(r!==Ss.cbc||t.byteLength!==16)return Et.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=Ar(o,e),this.remainderData=null);const l=this.getValidChunk(e);if(!l.length)return null;s&&(i=s);let u=this.softwareDecrypter;u||(u=this.softwareDecrypter=new EL),u.expandKey(t);const h=a;return this.currentResult=u.decrypt(l.buffer,0,i),this.currentIV=l.slice(-16).buffer,h||null}webCryptoDecrypt(e,t,i,r){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,i,r));this.key=t,this.fastAesKey=new AL(this.subtle,t,r)}return this.fastAesKey.expandKey().then(s=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new vL(this.subtle,new Uint8Array(i),r).decrypt(e.buffer,s)):Promise.reject(new Error("web crypto not initialized"))).catch(s=>(Et.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${s.name}: ${s.message}`),this.onWebCryptoError(e,t,i,r)))}onWebCryptoError(e,t,i,r){const s=this.enableSoftwareAES;if(s){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i,r);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(s?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%xL;return i!==e.length&&(t=e.slice(0,i),this.remainderData=e.slice(i)),t}logOnce(e){this.logEnabled&&(Et.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const SE=Math.pow(2,17);class TL{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new Un({type:$e.NETWORK_ERROR,details:Z.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap)if(e.tagList.some(m=>m[0]==="GAP")){l(TE(e));return}else e.gap=!1;const u=this.loader=s?new s(r):new a(r),h=xE(e);e.loader=u;const d=EE(r.fragLoadPolicy.default),p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:SE};e.stats=u.stats;const g={onSuccess:(m,y,b,A)=>{this.resetLoader(e,u);let w=m.data;b.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(w.slice(0,16)),w=w.slice(16)),o({frag:e,part:null,payload:w,networkDetails:A})},onError:(m,y,b,A)=>{this.resetLoader(e,u),l(new Un({type:$e.NETWORK_ERROR,details:Z.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:xt({url:i,data:void 0},m),error:new Error(`HTTP Error ${m.code} ${m.text}`),networkDetails:b,stats:A}))},onAbort:(m,y,b)=>{this.resetLoader(e,u),l(new Un({type:$e.NETWORK_ERROR,details:Z.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:b,stats:m}))},onTimeout:(m,y,b)=>{this.resetLoader(e,u),l(new Un({type:$e.NETWORK_ERROR,details:Z.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:b,stats:m}))}};t&&(g.onProgress=(m,y,b,A)=>t({frag:e,part:null,payload:b,networkDetails:A})),u.load(h,p,g)})}loadPart(e,t,i){this.abort();const r=this.config,s=r.fLoader,a=r.loader;return new Promise((o,l)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){l(TE(e,t));return}const u=this.loader=s?new s(r):new a(r),h=xE(e,t);e.loader=u;const d=EE(r.fragLoadPolicy.default),p={loadPolicy:d,timeout:d.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:SE};t.stats=u.stats,u.load(h,p,{onSuccess:(g,m,y,b)=>{this.resetLoader(e,u),this.updateStatsFromPart(e,t);const A={frag:e,part:t,payload:g.data,networkDetails:b};i(A),o(A)},onError:(g,m,y,b)=>{this.resetLoader(e,u),l(new Un({type:$e.NETWORK_ERROR,details:Z.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:xt({url:h.url,data:void 0},g),error:new Error(`HTTP Error ${g.code} ${g.text}`),networkDetails:y,stats:b}))},onAbort:(g,m,y)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,u),l(new Un({type:$e.NETWORK_ERROR,details:Z.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:y,stats:g}))},onTimeout:(g,m,y)=>{this.resetLoader(e,u),l(new Un({type:$e.NETWORK_ERROR,details:Z.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${p.timeout}ms`),networkDetails:y,stats:g}))}})})}updateStatsFromPart(e,t){const i=e.stats,r=t.stats,s=r.total;if(i.loaded+=r.loaded,s){const l=Math.round(e.duration/t.duration),u=Math.min(Math.round(i.loaded/s),l),d=(l-u)*Math.round(i.loaded/u);i.total=i.loaded+d}else i.total=Math.max(i.loaded,i.total);const a=i.loading,o=r.loading;a.start?a.first+=o.first-o.start:(a.start=o.start,a.first=o.first),a.end=o.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function xE(n,e=null){const t=e||n,i={frag:n,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},r=t.byteRangeStartOffset,s=t.byteRangeEndOffset;if(_e(r)&&_e(s)){var a;let o=r,l=s;if(n.sn==="initSegment"&&wL((a=n.decryptdata)==null?void 0:a.method)){const u=s-r;u%16&&(l=s+(16-u%16)),r!==0&&(i.resetIV=!0,o=r-16)}i.rangeStart=o,i.rangeEnd=l}return i}function TE(n,e){const t=new Error(`GAP ${n.gap?"tag":"attribute"} found`),i={type:$e.MEDIA_ERROR,details:Z.FRAG_GAP,fatal:!1,frag:n,error:t,networkDetails:null};return e&&(i.part=e),(e||n).stats.aborted=!0,new Un(i)}function wL(n){return n==="AES-128"||n==="AES-256"}class Un extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class wE extends Bn{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return this._tickInterval?!1:(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1}clearNextTick(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class vg{constructor(e,t,i,r=0,s=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=tc(),this.buffering={audio:tc(),video:tc(),audiovideo:tc()},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=s,this.partial=a}}function tc(){return{start:0,executeStart:0,executeEnd:0,end:0}}const DE={length:0,start:()=>0,end:()=>0};class Je{static isBuffered(e,t){if(e){const i=Je.getBuffered(e);for(let r=i.length;r--;)if(t>=i.start(r)&&t<=i.end(r))return!0}return!1}static bufferedRanges(e){if(e){const t=Je.getBuffered(e);return Je.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}static bufferInfo(e,t,i){if(e){const r=Je.bufferedRanges(e);if(r.length)return Je.bufferedInfo(r,t,i)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.length>1&&e.sort((h,d)=>h.start-d.start||d.end-h.end);let r=-1,s=[];if(i)for(let h=0;h<e.length;h++){t>=e[h].start&&t<=e[h].end&&(r=h);const d=s.length;if(d){const p=s[d-1].end;e[h].start-p<i?e[h].end>p&&(s[d-1].end=e[h].end):s.push(e[h])}else s.push(e[h])}else s=e;let a=0,o,l=t,u=t;for(let h=0;h<s.length;h++){const d=s[h].start,p=s[h].end;if(r===-1&&t>=d&&t<=p&&(r=h),t+i>=d&&t<p)l=d,u=p,a=u-t;else if(t+i<d){o=d;break}}return{len:a,start:l||0,end:u||0,nextStart:o,buffered:e,bufferedIndex:r}}static getBuffered(e){try{return e.buffered||DE}catch(t){return Et.log("failed to get media.buffered",t),DE}}}const RE=/\{\$([a-zA-Z0-9-_]+)\}/g;function IE(n){return RE.test(n)}function bg(n,e){if(n.variableList!==null||n.hasVariableRefs){const t=n.variableList;return e.replace(RE,i=>{const r=i.substring(2,i.length-1),s=t==null?void 0:t[r];return s===void 0?(n.playlistParsingError||(n.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),i):s})}return e}function CE(n,e,t){let i=n.variableList;i||(n.variableList=i={});let r,s;if("QUERYPARAM"in e){r=e.QUERYPARAM;try{const a=new self.URL(t).searchParams;if(a.has(r))s=a.get(r);else throw new Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(a){n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${a.message}`))}}else r=e.NAME,s=e.VALUE;r in i?n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):i[r]=s||""}function DL(n,e,t){const i=e.IMPORT;if(t&&i in t){let r=n.variableList;r||(n.variableList=r={}),r[i]=t[i]}else n.playlistParsingError||(n.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${i}"`))}const RL=/^(\d+)x(\d+)$/,NE=/(.+?)=(".*?"|.*?)(?:,|$)/g;class Jt{constructor(e,t){typeof e=="string"&&(e=Jt.parseAttrList(e,t)),Rt(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(t.length&1?"0":"")+t;const i=new Uint8Array(t.length/2);for(let r=0;r<t.length/2;r++)i[r]=parseInt(t.slice(r*2,r*2+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const i=this[e];return(i?i.split(/[ ,]+/):[]).reduce((r,s)=>(r[s.toLowerCase()]=!0,r),t)}bool(e){return this[e]==="YES"}decimalResolution(e){const t=RL.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let i;const r={},s='"';for(NE.lastIndex=0;(i=NE.exec(e))!==null;){const a=i[1].trim();let o=i[2];const l=o.indexOf(s)===0&&o.lastIndexOf(s)===o.length-1;let u=!1;if(l)o=o.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":u=!0}if(t&&(l||u))o=bg(t,o);else if(!u&&!l)switch(a){case"CLOSED-CAPTIONS":if(o==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Et.warn(`${e}: attribute ${a} is missing quotes`)}r[a]=o}return r}}const IL="com.apple.hls.interstitial";function CL(n){return n!=="ID"&&n!=="CLASS"&&n!=="CUE"&&n!=="START-DATE"&&n!=="DURATION"&&n!=="END-DATE"&&n!=="END-ON-NEXT"}function NL(n){return n==="SCTE35-OUT"||n==="SCTE35-IN"||n==="SCTE35-CMD"}class LE{constructor(e,t,i=0){var r;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(t==null?void 0:t.tagAnchor)||null,this.tagOrder=(r=t==null?void 0:t.tagOrder)!=null?r:i,t){const s=t.attr;for(const a in s)if(Object.prototype.hasOwnProperty.call(e,a)&&e[a]!==s[a]){Et.warn(`DATERANGE tag attribute: "${a}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=a;break}e=Rt(new Jt({}),s,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const s=(t==null?void 0:t.endDate)||new Date(this.attr["END-DATE"]);_e(s.getTime())&&(this._endDate=s)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return e===null||e.programDateTime===null?(Et.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+t*1e3):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(_e(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class===IL}get isValid(){return!!this.id&&!this._badValueForSameId&&_e(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}const LL=10;class _L{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&i>0,this.updated||this.advanced?this.misses=Math.floor(e.misses*.6):this.misses=e.misses+1}get hasProgramDateTime(){return this.fragments.length?_e(this.fragments[this.fragments.length-1].programDateTime):!1}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||LL}get drift(){const e=this.driftEndTime-this.driftStartTime;return e>0?(this.driftEnd-this.driftStart)*1e3/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return(e=this.fragments)!=null&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(t!==-1){for(let i=e.length;i--;)if(e[i].index>t)return e[i].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function Ja(n){return n==="AES-128"||n==="AES-256"||n==="AES-256-CTR"}function Eg(n){switch(n){case"AES-128":case"AES-256":return Ss.cbc;case"AES-256-CTR":return Ss.ctr;default:throw new Error(`invalid full segment method ${n}`)}}function Ag(n){return Uint8Array.from(atob(n),e=>e.charCodeAt(0))}function Sg(n){return Uint8Array.from(unescape(encodeURIComponent(n)),e=>e.charCodeAt(0))}function ML(n){const e=Sg(n).subarray(0,16),t=new Uint8Array(16);return t.set(e,16-e.length),t}function kL(n){const e=function(i,r,s){const a=i[r];i[r]=i[s],i[s]=a};e(n,0,3),e(n,1,2),e(n,4,5),e(n,6,7)}function PL(n){const e=n.split(":");let t=null;if(e[0]==="data"&&e.length===2){const i=e[1].split(";"),r=i[i.length-1].split(",");if(r.length===2){const s=r[0]==="base64",a=r[1];s?(i.splice(-1,1),t=Ag(a)):t=ML(a)}}return t}const ic=typeof self<"u"?self:void 0;var Tt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Zi={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function rc(n){switch(n){case Zi.FAIRPLAY:return Tt.FAIRPLAY;case Zi.PLAYREADY:return Tt.PLAYREADY;case Zi.WIDEVINE:return Tt.WIDEVINE;case Zi.CLEARKEY:return Tt.CLEARKEY}}var nc={CENC:"1077efecc0b24d02ace33c1e52e2fb4b",CLEARKEY:"e2719d58a985b3c9781ab030af78d30e",PLAYREADY:"9a04f07998404286ab92e65be0885f95",WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function xg(n){if(n===nc.WIDEVINE)return Tt.WIDEVINE;if(n===nc.PLAYREADY)return Tt.PLAYREADY;if(n===nc.CENC||n===nc.CLEARKEY)return Tt.CLEARKEY}function sc(n){switch(n){case Tt.FAIRPLAY:return Zi.FAIRPLAY;case Tt.PLAYREADY:return Zi.PLAYREADY;case Tt.WIDEVINE:return Zi.WIDEVINE;case Tt.CLEARKEY:return Zi.CLEARKEY}}function cl(n){const{drmSystems:e,widevineLicenseUrl:t}=n,i=e?[Tt.FAIRPLAY,Tt.WIDEVINE,Tt.PLAYREADY,Tt.CLEARKEY].filter(r=>!!e[r]):[];return!i[Tt.WIDEVINE]&&t&&i.push(Tt.WIDEVINE),i}const _E=function(n){return ic!=null&&(n=ic.navigator)!=null&&n.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}();function OL(n,e,t,i){let r;switch(n){case Tt.FAIRPLAY:r=["cenc","sinf"];break;case Tt.WIDEVINE:case Tt.PLAYREADY:r=["cenc"];break;case Tt.CLEARKEY:r=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${n}`)}return FL(r,e,t,i)}function FL(n,e,t,i){return[{initDataTypes:n,persistentState:i.persistentState||"optional",distinctiveIdentifier:i.distinctiveIdentifier||"optional",sessionTypes:i.sessionTypes||[i.sessionType||"temporary"],audioCapabilities:e.map(s=>({contentType:`audio/mp4; codecs=${s}`,robustness:i.audioRobustness||"",encryptionScheme:i.audioEncryptionScheme||null})),videoCapabilities:t.map(s=>({contentType:`video/mp4; codecs=${s}`,robustness:i.videoRobustness||"",encryptionScheme:i.videoEncryptionScheme||null}))}]}function BL(n){var e;return n.sessionType==="persistent-license"||!!((e=n.sessionTypes)!=null&&e.some(t=>t==="persistent-license"))}function ME(n){const e=new Uint16Array(n.buffer,n.byteOffset,n.byteLength/2),t=String.fromCharCode.apply(null,Array.from(e)),i=t.substring(t.indexOf("<"),t.length),a=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("KID")[0];if(a){const o=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(o){const l=Ag(o).subarray(0,16);return kL(l),l}}return null}let ac={};class hl{static clearKeyUriToKeyIdMap(){ac={}}constructor(e,t,i,r=[1],s=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=r,this.iv=s,this.encrypted=e?e!=="NONE":!1,this.isCommonEncryption=this.encrypted&&!Ja(e)}isSupported(){if(this.method){if(Ja(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Zi.FAIRPLAY:case Zi.WIDEVINE:case Zi.PLAYREADY:case Zi.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(Ja(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(Et.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const i=UL(e);return new hl(this.method,this.uri,"identity",this.keyFormatVersions,i)}const t=PL(this.uri);if(t)switch(this.keyFormat){case Zi.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Zi.PLAYREADY:{const i=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=KN(i,null,t),this.keyId=ME(t);break}default:{let i=t.subarray(0,16);if(i.length!==16){const r=new Uint8Array(16);r.set(i,16-i.length),i=r}this.keyId=i;break}}if(!this.keyId||this.keyId.byteLength!==16){let i=ac[this.uri];if(!i){const r=Object.keys(ac).length%Number.MAX_SAFE_INTEGER;i=new Uint8Array(16),new DataView(i.buffer,12,4).setUint32(0,r),ac[this.uri]=i}this.keyId=i}return this}}function UL(n){const e=new Uint8Array(16);for(let t=12;t<16;t++)e[t]=n>>8*(15-t)&255;return e}const kE=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,PE=/#EXT-X-MEDIA:(.*)/g,$L=/^#EXT(?:INF|-X-TARGETDURATION):/m,Tg=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),GL=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class mn{static findGroup(e,t){for(let i=0;i<e.length;i++){const r=e[i];if(r.id===t)return r}}static resolve(e,t){return og.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return $L.test(e)}static parseMasterPlaylist(e,t){const i=IE(e),r={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:i},s=[];kE.lastIndex=0;let a;for(;(a=kE.exec(e))!=null;)if(a[1]){var o;const u=new Jt(a[1],r),h=bg(r,a[2]),d={attrs:u,bitrate:u.decimalInteger("BANDWIDTH")||u.decimalInteger("AVERAGE-BANDWIDTH"),name:u.NAME,url:mn.resolve(h,t)},p=u.decimalResolution("RESOLUTION");p&&(d.width=p.width,d.height=p.height),UE(u.CODECS,d);const g=u["SUPPLEMENTAL-CODECS"];g&&(d.supplemental={},UE(g,d.supplemental)),(o=d.unknownCodecs)!=null&&o.length||s.push(d),r.levels.push(d)}else if(a[3]){const u=a[3],h=a[4];switch(u){case"SESSION-DATA":{const d=new Jt(h,r),p=d["DATA-ID"];p&&(r.sessionData===null&&(r.sessionData={}),r.sessionData[p]=d);break}case"SESSION-KEY":{const d=FE(h,t,r);d.encrypted&&d.isSupported()?(r.sessionKeys===null&&(r.sessionKeys=[]),r.sessionKeys.push(d)):Et.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${h}"`);break}case"DEFINE":{{const d=new Jt(h,r);CE(r,d,t)}break}case"CONTENT-STEERING":{const d=new Jt(h,r);r.contentSteering={uri:mn.resolve(d["SERVER-URI"],t),pathwayId:d["PATHWAY-ID"]||"."};break}case"START":{r.startTimeOffset=BE(h);break}}}const l=s.length>0&&s.length<r.levels.length;return r.levels=l?s:r.levels,r.levels.length===0&&(r.playlistParsingError=new Error("no levels found in manifest")),r}static parseMasterPlaylistMedia(e,t,i){let r;const s={},a=i.levels,o={AUDIO:a.map(u=>({id:u.attrs.AUDIO,audioCodec:u.audioCodec})),SUBTITLES:a.map(u=>({id:u.attrs.SUBTITLES,textCodec:u.textCodec})),"CLOSED-CAPTIONS":[]};let l=0;for(PE.lastIndex=0;(r=PE.exec(e))!==null;){const u=new Jt(r[1],i),h=u.TYPE;if(h){const d=o[h],p=s[h]||[];s[h]=p;const g=u.LANGUAGE,m=u["ASSOC-LANGUAGE"],y=u.CHANNELS,b=u.CHARACTERISTICS,A=u["INSTREAM-ID"],w={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||g||"",type:h,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:g,url:u.URI?mn.resolve(u.URI,t):""};if(m&&(w.assocLang=m),y&&(w.channels=y),b&&(w.characteristics=b),A&&(w.instreamId=A),d!=null&&d.length){const x=mn.findGroup(d,w.groupId)||d[0];$E(w,x,"audioCodec"),$E(w,x,"textCodec")}p.push(w)}}return s}static parseLevelPlaylist(e,t,i,r,s,a){var o;const l={url:t},u=new _L(t),h=u.fragments,d=[];let p=null,g=0,m=0,y=0,b=0,A=0,w=null,x=new ug(r,l),N,F,L,C=-1,M=!1,_=null,R;if(Tg.lastIndex=0,u.m3u8=e,u.hasVariableRefs=IE(e),((o=Tg.exec(e))==null?void 0:o[0])!=="#EXTM3U")return u.playlistParsingError=new Error("Missing format identifier #EXTM3U"),u;for(;(N=Tg.exec(e))!==null;){M&&(M=!1,x=new ug(r,l),x.playlistOffset=y,x.start=y,x.sn=g,x.cc=b,A&&(x.bitrate=A),x.level=i,p&&(x.initSegment=p,p.rawProgramDateTime&&(x.rawProgramDateTime=p.rawProgramDateTime,p.rawProgramDateTime=null),_&&(x.setByteRange(_),_=null)));const Y=N[1];if(Y){x.duration=parseFloat(Y);const ae=(" "+N[2]).slice(1);x.title=ae||null,x.tagList.push(ae?["INF",Y,ae]:["INF",Y])}else if(N[3]){if(_e(x.duration)){x.playlistOffset=y,x.start=y,L&&qE(x,L,u),x.sn=g,x.level=i,x.cc=b,h.push(x);const ae=(" "+N[3]).slice(1);x.relurl=bg(u,ae),wg(x,w,d),w=x,y+=x.duration,g++,m=0,M=!0}}else{if(N=N[0].match(GL),!N){Et.warn("No matches on slow regex match for level playlist!");continue}for(F=1;F<N.length&&N[F]===void 0;F++);const ae=(" "+N[F]).slice(1),ne=(" "+N[F+1]).slice(1),ce=N[F+2]?(" "+N[F+2]).slice(1):null;switch(ae){case"BYTERANGE":w?x.setByteRange(ne,w):x.setByteRange(ne);break;case"PROGRAM-DATE-TIME":x.rawProgramDateTime=ne,x.tagList.push(["PROGRAM-DATE-TIME",ne]),C===-1&&(C=h.length);break;case"PLAYLIST-TYPE":u.type&&$n(u,ae,N),u.type=ne.toUpperCase();break;case"MEDIA-SEQUENCE":u.startSN!==0?$n(u,ae,N):h.length>0&&VE(u,ae,N),g=u.startSN=parseInt(ne);break;case"SKIP":{u.skippedSegments&&$n(u,ae,N);const re=new Jt(ne,u),V=re.decimalInteger("SKIPPED-SEGMENTS");if(_e(V)){u.skippedSegments+=V;for(let ve=V;ve--;)h.push(null);g+=V}const J=re.enumeratedString("RECENTLY-REMOVED-DATERANGES");J&&(u.recentlyRemovedDateranges=(u.recentlyRemovedDateranges||[]).concat(J.split("	")));break}case"TARGETDURATION":u.targetduration!==0&&$n(u,ae,N),u.targetduration=Math.max(parseInt(ne),1);break;case"VERSION":u.version!==null&&$n(u,ae,N),u.version=parseInt(ne);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":u.live||$n(u,ae,N),u.live=!1;break;case"#":(ne||ce)&&x.tagList.push(ce?[ne,ce]:[ne]);break;case"DISCONTINUITY":b++,x.tagList.push(["DIS"]);break;case"GAP":x.gap=!0,x.tagList.push([ae]);break;case"BITRATE":x.tagList.push([ae,ne]),A=parseInt(ne)*1e3,_e(A)?x.bitrate=A:A=0;break;case"DATERANGE":{const re=new Jt(ne,u),V=new LE(re,u.dateRanges[re.ID],u.dateRangeTagCount);u.dateRangeTagCount++,V.isValid||u.skippedSegments?u.dateRanges[V.id]=V:Et.warn(`Ignoring invalid DATERANGE tag: "${ne}"`),x.tagList.push(["EXT-X-DATERANGE",ne]);break}case"DEFINE":{{const re=new Jt(ne,u);"IMPORT"in re?DL(u,re,a):CE(u,re,t)}break}case"DISCONTINUITY-SEQUENCE":u.startCC!==0?$n(u,ae,N):h.length>0&&VE(u,ae,N),u.startCC=b=parseInt(ne);break;case"KEY":{const re=FE(ne,t,u);if(re.isSupported()){if(re.method==="NONE"){L=void 0;break}L||(L={}),L[re.keyFormat]&&(L=Rt({},L)),L[re.keyFormat]=re}else Et.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${ne}"`);break}case"START":u.startTimeOffset=BE(ne);break;case"MAP":{const re=new Jt(ne,u);if(x.duration){const V=new ug(r,l);GE(V,re,i,L),p=V,x.initSegment=p,p.rawProgramDateTime&&!x.rawProgramDateTime&&(x.rawProgramDateTime=p.rawProgramDateTime)}else{const V=x.byteRangeEndOffset;if(V){const J=x.byteRangeStartOffset;_=`${V-J}@${J}`}else _=null;GE(x,re,i,L),p=x,M=!0}p.cc=b;break}case"SERVER-CONTROL":{R&&$n(u,ae,N),R=new Jt(ne),u.canBlockReload=R.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=R.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&R.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=R.optionalFloat("PART-HOLD-BACK",0),u.holdBack=R.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{u.partTarget&&$n(u,ae,N);const re=new Jt(ne);u.partTarget=re.decimalFloatingPoint("PART-TARGET");break}case"PART":{let re=u.partList;re||(re=u.partList=[]);const V=m>0?re[re.length-1]:void 0,J=m++,ve=new Jt(ne,u),pe=new LN(ve,x,l,J,V);re.push(pe),x.duration+=pe.duration;break}case"PRELOAD-HINT":{const re=new Jt(ne,u);u.preloadHint=re;break}case"RENDITION-REPORT":{const re=new Jt(ne,u);u.renditionReports=u.renditionReports||[],u.renditionReports.push(re);break}default:Et.warn(`line parsed but not handled: ${N}`);break}}}w&&!w.relurl?(h.pop(),y-=w.duration,u.partList&&(u.fragmentHint=w)):u.partList&&(wg(x,w,d),x.cc=b,u.fragmentHint=x,L&&qE(x,L,u)),u.targetduration||(u.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const U=h.length,q=h[0],$=h[U-1];if(y+=u.skippedSegments*u.targetduration,y>0&&U&&$){u.averagetargetduration=y/U;const Y=$.sn;u.endSN=Y!=="initSegment"?Y:0,u.live||($.endList=!0),q&&u.startCC===void 0&&(u.startCC=q.cc),C>0&&(VL(h,C),q&&d.unshift(q))}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(y+=u.fragmentHint.duration),u.totalduration=y,d.length&&u.dateRangeTagCount&&q&&OE(d,u),u.endCC=b,u}}function OE(n,e){const t=n.length;if(!t)return;const i=n[t-1],r=e.live?1/0:e.totalduration,s=Object.keys(e.dateRanges);for(let a=s.length;a--;){const o=e.dateRanges[s[a]],l=o.startDate.getTime();o.tagAnchor=i.ref;for(let u=t;u--;){const h=qL(e,l,n,u,r);if(h!==-1){o.tagAnchor=e.fragments[h].ref;break}}}}function qL(n,e,t,i,r){const s=t[i];if(s){const o=s.programDateTime;if(e>=o||i===0){var a;const l=(((a=t[i+1])==null?void 0:a.start)||r)-s.start;if(e<=o+l*1e3){const u=t[i].sn-n.startSN,h=n.fragments;if(h.length>t.length){const p=(t[i+1]||h[h.length-1]).sn-n.startSN;for(let g=p;g>u;g--){const m=h[g].programDateTime;if(e>=m&&e<m+h[g].duration*1e3)return g}}return u}}}return-1}function FE(n,e,t){var i,r;const s=new Jt(n,t),a=(i=s.METHOD)!=null?i:"",o=s.URI,l=s.hexadecimalInteger("IV"),u=s.KEYFORMATVERSIONS,h=(r=s.KEYFORMAT)!=null?r:"identity";o&&s.IV&&!l&&Et.error(`Invalid IV: ${s.IV}`);const d=o?mn.resolve(o,e):"",p=(u||"1").split("/").map(Number).filter(Number.isFinite);return new hl(a,d,h,p,l)}function BE(n){const t=new Jt(n).decimalFloatingPoint("TIME-OFFSET");return _e(t)?t:null}function UE(n,e){let t=(n||"").split(/[ ,]+/).filter(i=>i);["video","audio","text"].forEach(i=>{const r=t.filter(s=>tE(s,i));r.length&&(e[`${i}Codec`]=r.map(s=>s.split("/")[0]).join(","),t=t.filter(s=>r.indexOf(s)===-1))}),e.unknownCodecs=t}function $E(n,e,t){const i=e[t];i&&(n[t]=i)}function VL(n,e){let t=n[e];for(let i=e;i--;){const r=n[i];if(!r)return;r.programDateTime=t.programDateTime-r.duration*1e3,t=r}}function wg(n,e,t){n.rawProgramDateTime?t.push(n):e!=null&&e.programDateTime&&(n.programDateTime=e.endProgramDateTime)}function GE(n,e,t,i){n.relurl=e.URI,e.BYTERANGE&&n.setByteRange(e.BYTERANGE),n.level=t,n.sn="initSegment",i&&(n.levelkeys=i),n.initSegment=null}function qE(n,e,t){n.levelkeys=e;const{encryptedFragments:i}=t;(!i.length||i[i.length-1].levelkeys!==e)&&Object.keys(e).some(r=>e[r].isCommonEncryption)&&i.push(n)}function $n(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function VE(n,e,t){n.playlistParsingError=new Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Dg(n,e){const t=e.startPTS;if(_e(t)){let i=0,r;e.sn>n.sn?(i=t-n.start,r=n):(i=n.start-t,r=e),r.duration!==i&&r.setDuration(i)}else e.sn>n.sn?n.cc===e.cc&&n.minEndPTS?e.setStart(n.start+(n.minEndPTS-n.start)):e.setStart(n.start+n.duration):e.setStart(Math.max(n.start-e.duration,0))}function HE(n,e,t,i,r,s){i-t<=0&&(Et.warn("Fragment should have a positive duration",e),i=t+e.duration,s=r+e.duration);let o=t,l=i;const u=e.startPTS,h=e.endPTS;if(_e(u)){const b=Math.abs(u-t);_e(e.deltaPTS)?e.deltaPTS=Math.max(b,e.deltaPTS):e.deltaPTS=b,o=Math.max(t,u),t=Math.min(t,u),r=Math.min(r,e.startDTS),l=Math.min(i,h),i=Math.max(i,h),s=Math.max(s,e.endDTS)}const d=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(i-e.start),e.startPTS=t,e.maxStartPTS=o,e.startDTS=r,e.endPTS=i,e.minEndPTS=l,e.endDTS=s;const p=e.sn;if(!n||p<n.startSN||p>n.endSN)return 0;let g;const m=p-n.startSN,y=n.fragments;for(y[m]=e,g=m;g>0;g--)Dg(y[g],y[g-1]);for(g=m;g<y.length-1;g++)Dg(y[g],y[g+1]);return n.fragmentHint&&Dg(y[y.length-1],n.fragmentHint),n.PTSKnown=n.alignedSliding=!0,d}function HL(n,e){if(n===e)return;let t=null;const i=n.fragments;for(let u=i.length-1;u>=0;u--){const h=i[u].initSegment;if(h){t=h;break}}n.fragmentHint&&delete n.fragmentHint.endPTS;let r;YL(n,e,(u,h,d,p)=>{if((!e.startCC||e.skippedSegments)&&h.cc!==u.cc){const g=u.cc-h.cc;for(let m=d;m<p.length;m++)p[m].cc+=g;e.endCC=p[p.length-1].cc}_e(u.startPTS)&&_e(u.endPTS)&&(h.setStart(h.startPTS=u.startPTS),h.startDTS=u.startDTS,h.maxStartPTS=u.maxStartPTS,h.endPTS=u.endPTS,h.endDTS=u.endDTS,h.minEndPTS=u.minEndPTS,h.setDuration(u.endPTS-u.startPTS),h.duration&&(r=h),e.PTSKnown=e.alignedSliding=!0),u.hasStreams&&(h.elementaryStreams=u.elementaryStreams),h.loader=u.loader,u.hasStats&&(h.stats=u.stats),u.initSegment&&(h.initSegment=u.initSegment,t=u.initSegment)});const s=e.fragments,a=e.fragmentHint?s.concat(e.fragmentHint):s;if(t&&a.forEach(u=>{var h;u&&(!u.initSegment||u.initSegment.relurl===((h=t)==null?void 0:h.relurl))&&(u.initSegment=t)}),e.skippedSegments){if(e.deltaUpdateFailed=s.some(u=>!u),e.deltaUpdateFailed){Et.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let u=e.skippedSegments;u--;)s.shift();e.startSN=s[0].sn}else{e.canSkipDateRanges&&(e.dateRanges=KL(n.dateRanges,e));const u=n.fragments.filter(h=>h.rawProgramDateTime);if(n.hasProgramDateTime&&!e.hasProgramDateTime)for(let h=1;h<a.length;h++)a[h].programDateTime===null&&wg(a[h],a[h-1],u);OE(u,e)}e.endCC=s[s.length-1].cc}if(!e.startCC){var o;const u=zE(n,e.startSN-1);e.startCC=(o=u==null?void 0:u.cc)!=null?o:s[0].cc}WL(n.partList,e.partList,(u,h)=>{h.elementaryStreams=u.elementaryStreams,h.stats=u.stats}),r?HE(e,r,r.startPTS,r.endPTS,r.startDTS,r.endDTS):WE(n,e),s.length&&(e.totalduration=e.edge-s[0].start),e.driftStartTime=n.driftStartTime,e.driftStart=n.driftStart;const l=e.advancedDateTime;if(e.advanced&&l){const u=e.edge;e.driftStart||(e.driftStartTime=l,e.driftStart=u),e.driftEndTime=l,e.driftEnd=u}else e.driftEndTime=n.driftEndTime,e.driftEnd=n.driftEnd,e.advancedDateTime=n.advancedDateTime;e.requestScheduled===-1&&(e.requestScheduled=n.requestScheduled)}function KL(n,e){const{dateRanges:t,recentlyRemovedDateranges:i}=e,r=Rt({},n);i&&i.forEach(o=>{delete r[o]});const a=Object.keys(r).length;return a&&Object.keys(t).forEach(o=>{const l=r[o],u=new LE(t[o].attr,l);u.isValid?(r[o]=u,l||(u.tagOrder+=a)):Et.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${zt(t[o].attr)}"`)}),r}function WL(n,e,t){if(n&&e){let i=0;for(let r=0,s=n.length;r<=s;r++){const a=n[r],o=e[r+i];a&&o&&a.index===o.index&&a.fragment.sn===o.fragment.sn?t(a,o):i--}}}function YL(n,e,t){const i=e.skippedSegments,r=Math.max(n.startSN,e.startSN)-e.startSN,s=(n.fragmentHint?1:0)+(i?e.endSN:Math.min(n.endSN,e.endSN))-e.startSN,a=e.startSN-n.startSN,o=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,l=n.fragmentHint?n.fragments.concat(n.fragmentHint):n.fragments;for(let u=r;u<=s;u++){const h=l[a+u];let d=o[u];if(i&&!d&&h&&(d=e.fragments[u]=h),h&&d){if(t(h,d,u,o),h.url&&h.url!==d.url){e.playlistParsingError=KE(`media sequence mismatch ${d.sn}:`,n,e,h,d);return}else if(h.cc!==d.cc){e.playlistParsingError=KE(`discontinuity sequence mismatch (${h.cc}!=${d.cc})`,n,e,h,d);return}}}}function KE(n,e,t,i,r){return new Error(`${n} ${r.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function WE(n,e,t=!0){const i=e.startSN+e.skippedSegments-n.startSN,r=n.fragments,s=i>=0;let a=0;if(s&&i<r.length)a=r[i].start;else if(s&&e.startSN===n.endSN+1)a=n.fragmentEnd;else if(s&&t)a=n.fragmentStart+i*e.levelTargetDuration;else if(!e.skippedSegments&&e.fragmentStart===0)a=n.fragmentStart;else return;Rg(e,a)}function Rg(n,e){if(e){const t=n.fragments;for(let i=n.skippedSegments;i<t.length;i++)t[i].addStart(e);n.fragmentHint&&n.fragmentHint.addStart(e)}}function YE(n,e=1/0){let t=1e3*n.targetduration;if(n.updated){const i=n.fragments;if(i.length&&t*4>e){const s=i[i.length-1].duration*1e3;s<t&&(t=s)}}else t/=2;return Math.round(t)}function zE(n,e,t){if(!n)return null;let i=n.fragments[e-n.startSN];return i||(i=n.fragmentHint,i&&i.sn===e)?i:e<n.startSN&&t&&t.sn===e?t:null}function jE(n,e,t){return n?XE(n.partList,e,t):null}function XE(n,e,t){if(n)for(let i=n.length;i--;){const r=n[i];if(r.index===t&&r.fragment.sn===e)return r}return null}function JE(n){n.forEach((e,t)=>{var i;(i=e.details)==null||i.fragments.forEach(r=>{r.level=t,r.initSegment&&(r.initSegment.level=t)})})}function dl(n,e){for(let i=0,r=n.length;i<r;i++){var t;if(((t=n[i])==null?void 0:t.cc)===e)return n[i]}return null}function zL(n,e){return!!(n&&e.startCC<n.endCC&&e.endCC>n.startCC)}function QE(n,e){if(n){const t=n.start+e;n.start=n.startPTS=t,n.endPTS=t+n.duration}}function ZE(n,e){const t=e.fragments;for(let i=0,r=t.length;i<r;i++)QE(t[i],n);e.fragmentHint&&QE(e.fragmentHint,n),e.alignedSliding=!0}function jL(n,e){n&&(eA(e,n),!e.alignedSliding&&n&&oc(e,n),!e.alignedSliding&&n&&!e.skippedSegments&&WE(n,e,!1))}function eA(n,e){if(!zL(e,n))return;const t=Math.min(e.endCC,n.endCC),i=dl(e.fragments,t),r=dl(n.fragments,t);if(!i||!r)return;Et.log(`Aligning playlist at start of dicontinuity sequence ${t}`);const s=i.start-r.start;ZE(s,n)}function oc(n,e){if(!n.hasProgramDateTime||!e.hasProgramDateTime)return;const t=n.fragments,i=e.fragments;if(!t.length||!i.length)return;let r,s;const a=Math.min(e.endCC,n.endCC);e.startCC<a&&n.startCC<a&&(r=dl(i,a),s=dl(t,a)),(!r||!s)&&(r=i[Math.floor(i.length/2)],s=dl(t,r.cc)||t[Math.floor(t.length/2)]);const o=r.programDateTime,l=s.programDateTime;if(!o||!l)return;const u=(l-o)/1e3-(s.start-r.start);ZE(u,n)}const XL={toString:function(n){let e="";const t=n.length;for(let i=0;i<t;i++)e+=`[${n.start(i).toFixed(3)}-${n.end(i).toFixed(3)}]`;return e}},de={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Ig extends wE{constructor(e,t,i,r,s){super(r,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=de.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:a,fragCurrent:o,media:l,mediaBuffer:u,state:h}=this,d=l?l.currentTime:0,p=Je.bufferInfo(u||l,d,a.maxBufferHole);if(this.log(`media seeking to ${_e(d)?d.toFixed(3):d}, state: ${h}`),this.state===de.ENDED)this.resetLoadingState();else if(o){const g=a.maxFragLookUpTolerance,m=o.start-g,y=o.start+o.duration+g;if(!p.len||y<p.start||m>p.end){const b=d>y;(d<m||b)&&(b&&o.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),o.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(l){this.fragmentTracker.removeFragmentsInRange(d,1/0,this.playlistType,!0);const g=this.lastCurrentTime;if(d>g&&(this.lastCurrentTime=d),!this.loadingParts){const m=Math.max(p.end,d),y=this.shouldLoadParts(this.getLevelDetails(),m);y&&(this.log(`LL-Part loading ON after seeking to ${d.toFixed(2)} with buffer @${m.toFixed(2)}`),this.loadingParts=y)}}!this.hls.hasEnoughToStart&&!p.len&&(this.log(`setting startPosition to ${d} because of seek before start`),this.nextLoadPosition=this.startPosition=d),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=s,this.hls=e,this.fragmentLoader=new TL(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new yg(e.config)}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===de.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=de.STOPPED}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const i=e.end||0,r=this.config.timelineOffset||0;if(i<=r)return!1;const s=e.buffered;this.config.maxBufferHole&&s&&s.length>1&&(e=Je.bufferedInfo(s,e.start,0));const a=e.nextStart;if(a&&a>r&&a<t.edge||this.media.currentTime<e.start)return!1;const l=t.partList;if(l!=null&&l.length){const h=l[l.length-1];return Je.isBuffered(this.media,h.start+h.duration/2)}const u=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(u)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null){var e;return(e=this.levelLastLoaded)==null?void 0:e.details}}get timelineOffset(){const e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),i.addEventListener("seeking",this.onMediaSeeking),i.addEventListener("ended",this.onMediaEnded);const r=this.config;this.levels&&r.autoStartLoad&&this.state===de.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(e,t){const i=!!t.transferMedia,r=this.media;if(r!==null){if(r.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),r.removeEventListener("seeking",this.onMediaSeeking),r.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=de.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this.startFragRequested=!0,this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){const r=s=>{const a=s.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${s.part?" part: "+s.part.index:""} of ${this.fragInfo(a,!1,s.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(s)};this._doFragLoad(e,t,i,r).then(s=>{if(!s)return;const a=this.state,o=s.frag;if(this.fragContextChanged(o)){(a===de.FRAG_LOADING||!this.fragCurrent&&a===de.PARSING)&&(this.fragmentTracker.removeFragment(o),this.state=de.IDLE);return}"payload"in s&&(this.log(`Loaded ${o.type} sn: ${o.sn} of ${this.playlistLabel()} ${o.level}`),this.hls.trigger(T.FRAG_LOADED,s)),this._handleFragmentLoadComplete(s)}).catch(s=>{this.state===de.STOPPED||this.state===de.ERROR||(this.warn(`Frag error: ${(s==null?void 0:s.message)||s}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===fi.APPENDING){const s=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,s),o=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)===1||this.reduceMaxBufferLength(o,e.duration))&&i.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===fi.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(t==null?void 0:t.live)&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const r={startOffset:e,endOffset:t,type:i};this.hls.trigger(T.BUFFER_FLUSHING,r)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(i=>{const r=i==null?void 0:i.frag;if(!r||this.fragContextChanged(r)||!this.levels)throw new Error("init load aborted");return i}).then(i=>{const{hls:r}=this,{frag:s,payload:a}=i,o=s.decryptdata;if(a&&a.byteLength>0&&o!=null&&o.key&&o.iv&&Ja(o.method)){const l=self.performance.now();return this.decrypter.decrypt(new Uint8Array(a),o.key.buffer,o.iv.buffer,Eg(o.method)).catch(u=>{throw r.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_DECRYPT_ERROR,fatal:!1,error:u,reason:u.message,frag:s}),u}).then(u=>{const h=self.performance.now();return r.trigger(T.FRAG_DECRYPTED,{frag:s,payload:u,stats:{tstart:l,tdecrypt:h}}),i.payload=u,this.completeInitSegmentLoad(i)})}return this.completeInitSegmentLoad(i)}).catch(i=>{this.state===de.STOPPED||this.state===de.ERROR||(this.warn(i),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state!==de.STOPPED&&(this.state=de.IDLE),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${i?XL.toString(Je.getBuffered(i)):"(detached)"})`),Ei(e)){var r;if(e.type!==Oe.SUBTITLE){const a=e.elementaryStreams;if(!Object.keys(a).some(o=>!!a[o])){this.state=de.IDLE;return}}const s=(r=this.levels)==null?void 0:r[e.level];s!=null&&s.fragmentError&&(this.log(`Resetting level fragment error count of ${s.fragmentError} on frag buffered`),s.fragmentError=0)}this.state=de.IDLE}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:r,partsLoaded:s}=e,a=!s||s.length===0||s.some(l=>!l),o=new vg(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(o)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,r){var s;this.fragCurrent=e;const a=t==null?void 0:t.details;if(!this.levels||!a)throw new Error(`frag load aborted, missing level${a?"":" detail"}s`);let o=null;e.encrypted&&!((s=e.decryptdata)!=null&&s.key)?(this.log(`Loading key for ${e.sn} of [${a.startSN}-${a.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=de.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(d=>{if(!this.fragContextChanged(d.frag))return this.hls.trigger(T.KEY_LOADED,d),this.state===de.KEY_LOADING&&(this.state=de.IDLE),d}),this.hls.trigger(T.KEY_LOADING,{frag:e}),this.fragCurrent===null&&(o=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING")))):e.encrypted||(o=this.keyLoader.loadClear(e,a.encryptedFragments),o&&this.log("[eme] blocking frag load until media-keys acquired"));const l=this.fragPrevious;if(Ei(e)&&(!l||e.sn!==l.sn)){const d=this.shouldLoadParts(t.details,e.end);d!==this.loadingParts&&(this.log(`LL-Part loading ${d?"ON":"OFF"} loading sn ${l==null?void 0:l.sn}->${e.sn}`),this.loadingParts=d)}if(i=Math.max(e.start,i||0),this.loadingParts&&Ei(e)){const d=a.partList;if(d&&r){i>e.end&&a.fragmentHint&&(e=a.fragmentHint);const p=this.getNextPart(d,e,i);if(p>-1){const g=d[p];e=this.fragCurrent=g.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${g.index} (${p}/${d.length-1}) of ${this.fragInfo(e,!1,g)}) cc: ${e.cc} [${a.startSN}-${a.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=g.start+g.duration,this.state=de.FRAG_LOADING;let m;return o?m=o.then(y=>!y||this.fragContextChanged(y.frag)?null:this.doFragPartsLoad(e,g,t,r)).catch(y=>this.handleFragLoadError(y)):m=this.doFragPartsLoad(e,g,t,r).catch(y=>this.handleFragLoadError(y)),this.hls.trigger(T.FRAG_LOADING,{frag:e,part:g,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):m}else if(!e.url||this.loadedEndOfParts(d,i))return Promise.resolve(null)}}if(Ei(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${a?"["+a.startSN+"-"+a.endSN+"]":""}, target: ${parseFloat(i.toFixed(3))}`),_e(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=de.FRAG_LOADING;const u=this.config.progressive;let h;return u&&o?h=o.then(d=>!d||this.fragContextChanged(d==null?void 0:d.frag)?null:this.fragmentLoader.load(e,r)).catch(d=>this.handleFragLoadError(d)):h=Promise.all([this.fragmentLoader.load(e,u?r:void 0),o]).then(([d])=>(!u&&d&&r&&r(d),d)).catch(d=>this.handleFragLoadError(d)),this.hls.trigger(T.FRAG_LOADING,{frag:e,targetBufferTime:i}),this.fragCurrent===null?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):h}doFragPartsLoad(e,t,i,r){return new Promise((s,a)=>{var o;const l=[],u=(o=i.details)==null?void 0:o.partList,h=d=>{this.fragmentLoader.loadPart(e,d,r).then(p=>{l[d.index]=p;const g=p.part;this.hls.trigger(T.FRAG_LOADED,p);const m=jE(i.details,e.sn,d.index+1)||XE(u,e.sn,d.index+1);if(m)h(m);else return s({frag:e,part:g,partsLoaded:l})}).catch(a)};h(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===Z.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(T.ERROR,t)}else this.hls.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==de.PARSING){!this.fragCurrent&&this.state!==de.STOPPED&&this.state!==de.ERROR&&(this.state=de.IDLE);return}const{frag:i,part:r,level:s}=t,a=self.performance.now();i.stats.parsing.end=a,r&&(r.stats.parsing.end=a);const o=this.getLevelDetails(),u=o&&i.sn>o.endSN||this.shouldLoadParts(o,i.end);u!==this.loadingParts&&(this.log(`LL-Part loading ${u?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=u),this.updateLevelTiming(i,r,s,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e!=null&&e.partList){var i;const s=e.partList[0],a=s.end+(((i=e.fragmentHint)==null?void 0:i.duration)||0);if(t>=a){var r;if((this.hls.hasEnoughToStart?((r=this.media)==null?void 0:r.currentTime)||this.lastCurrentTime:this.getLoadPosition())>s.start-s.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:r,sn:s,part:a}=e;if(!(t!=null&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${s} of ${this.playlistLabel()} ${r}. The current chunk will not be buffered.`),null;const o=t[r],l=o.details,u=a>-1?jE(l,s,a):null,h=u?u.fragment:zE(l,s,i);return h?(i&&i!==h&&(h.stats=i.stats),{frag:h,part:u,level:o}):null}bufferFragmentData(e,t,i,r,s){var a;if(!e||this.state!==de.PARSING)return;const{data1:o,data2:l}=e;let u=o;if(o&&l&&(u=Ar(o,l)),!((a=u)!=null&&a.length))return;const h={type:e.type,frag:t,part:i,chunkMeta:r,parent:t.type,data:u};if(this.hls.trigger(T.BUFFER_APPENDING,h),e.dropped&&e.independent&&!i){if(s)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!Je.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}const i=t.currentTime,r=Je.bufferInfo(t,i,0),s=e.duration,a=Math.min(this.config.maxFragLookUpTolerance*2,s*.25),o=Math.max(Math.min(e.start-a,r.end-a),i+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}getFwdBufferInfo(e,t){var i;const r=this.getLoadPosition();if(!_e(r))return null;const a=this.lastCurrentTime>r||(i=this.media)!=null&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,r,t,a)}getFwdBufferInfoAtPos(e,t,i,r){const s=Je.bufferInfo(e,t,r);if(s.len===0&&s.nextStart!==void 0){const a=this.fragmentTracker.getBufferedFrag(t,i);if(a&&(s.nextStart<=a.end||a.gap)){const o=Math.max(Math.min(s.nextStart,a.end)-t,r);return Je.bufferInfo(e,t,o)}}return s}getMaxBufferLength(e){const{config:t}=this;let i;return e?i=Math.max(8*t.maxBufferSize/e,t.maxBufferLength):i=t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const i=this.config,r=Math.max(Math.min(e-t,i.maxBufferLength),t),s=Math.max(e-t*3,i.maxMaxBufferLength/2,r);return s>=r?(i.maxMaxBufferLength=s,this.warn(`Reduce max buffer length to ${s}s`),!0):!1}getAppendedFrag(e,t=Oe.MAIN){var i;const r=(i=this.fragmentTracker)==null?void 0:i.getAppendedFrag(e,t);return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){const i=t.fragments,r=i.length;if(!r)return null;const{config:s}=this,a=i[0].start,o=s.lowLatencyMode&&!!t.partList;let l=null;if(t.live){const d=s.initialLiveManifestSize;if(r<d)return this.warn(`Not enough fragments to start playback (have: ${r}, need: ${d})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<a){var u;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),l=this.getInitialLiveFragment(t);const p=this.hls.startPosition,g=this.hls.liveSyncPosition,m=l?(p!==-1&&p>=a?p:g)||l.start:e;this.log(`Setting startPosition to ${m} to match start frag at live edge. mainStart: ${p} liveSyncPosition: ${g} frag.start: ${(u=l)==null?void 0:u.start}`),this.startPosition=this.nextLoadPosition=m}}else e<=a&&(l=i[0]);if(!l){const d=this.loadingParts?t.partEnd:t.fragmentEnd;l=this.getFragmentAtPosition(e,d,t)}let h=this.filterReplacedPrimary(l,t);if(!h&&l){const d=l.sn-t.startSN;h=this.filterReplacedPrimary(i[d+1]||null,t)}return this.mapToInitFragWhenRequired(h)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===fi.OK||i===fi.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,r,s){let a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t),a&&!a.gap&&i.nextStart)){const o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r,0);if(o!==null&&i.len+o.len>=s){const l=a.sn;return this.loopSn!==l&&(this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${l}`),this.loopSn=l),null}}return this.loopSn=void 0,a}get primaryPrefetch(){if(tA(this.hls.config)){var e,t;if((e=this.hls.interstitialsManager)==null||(t=e.playingItem)==null?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(tA(this.hls.config)&&e.type!==Oe.SUBTITLE){const i=this.hls.interstitialsManager,r=i==null?void 0:i.bufferingItem;if(r){const a=r.event;if(a){if(a.appendInPlace||Math.abs(e.start-r.start)>1||r.start===0)return null}else if(e.end<=r.start&&(t==null?void 0:t.live)===!1||e.start>r.end&&r.nextEvent&&(r.nextEvent.appendInPlace||e.start-r.end>1))return null}const s=i==null?void 0:i.playerQueue;if(s)for(let a=s.length;a--;){const o=s[a].interstitial;if(o.appendInPlace&&e.start>=o.startTime&&e.end<=o.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e!=null&&e.initSegment&&!(e!=null&&e.initSegment.data)&&!this.bitrateTest?e.initSegment:e}getNextPart(e,t,i){let r=-1,s=!1,a=!0;for(let o=0,l=e.length;o<l;o++){const u=e[o];if(a=a&&!u.independent,r>-1&&i<u.start)break;const h=u.loaded;h?r=-1:(s||u.independent||a)&&u.fragment===t&&(r=o),s=h}return r}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e){const t=e.fragments,i=this.fragPrevious;let r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=dL(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){const s=i.sn+1;if(s>=e.startSN&&s<=e.endSN){const a=t[s-e.startSN];i.cc===a.cc&&(r=a,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}r||(r=vE(e,i.cc,i.end),r&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`))}}else{const s=this.hls.liveSyncPosition;s!==null&&(r=this.getFragmentAtPosition(s,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,i){const{config:r}=this;let{fragPrevious:s}=this,{fragments:a,endSN:o}=i;const{fragmentHint:l}=i,{maxFragLookUpTolerance:u}=r,h=i.partList,d=!!(this.loadingParts&&h!=null&&h.length&&l);d&&l&&!this.bitrateTest&&h[h.length-1].fragment.sn===l.sn&&(a=a.concat(l),o=l.sn);let p;if(e<t){var g;const y=e<this.lastCurrentTime||e>t-u||(g=this.media)!=null&&g.paused||!this.startFragRequested?0:u;p=na(s,a,e,y)}else p=a[a.length-1];if(p){const m=p.sn-i.startSN,y=this.fragmentTracker.getState(p);if((y===fi.OK||y===fi.PARTIAL&&p.gap)&&(s=p),s&&p.sn===s.sn&&(!d||h[0].fragment.sn>p.sn||!i.live&&!d)&&s&&p.level===s.level){const A=a[m+1];p.sn<o&&this.fragmentTracker.getState(A)!==fi.OK?p=A:p=null}}return p}alignPlaylists(e,t,i){const r=e.fragments.length;if(!r)return this.warn("No fragments in live playlist"),0;const s=e.fragmentStart,a=!t,o=e.alignedSliding&&_e(s);if(a||!o&&!s){jL(i,e);const l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${r}`),l}return s}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,e.partTarget*3)}setStartPosition(e,t){let i=this.startPosition;i<t&&(i=-1);const r=this.timelineOffset;if(i===-1){const s=this.startTimeOffset!==null,a=s?this.startTimeOffset:e.startTimeOffset;a!==null&&_e(a)?(i=t+a,a<0&&(i+=e.edge),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${a} found in ${s?"multivariant":"media"} playlist`),this.startPosition=i):e.live?(i=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+r}this.nextLoadPosition=i+r}getLoadPosition(){var e;const{media:t}=this;let i=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?i=t.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&Ei(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){(!this.fragCurrent||!this.fragContextChanged(e)&&this.state!==de.FRAG_LOADING_WAITING_RETRY)&&(this.state=de.IDLE)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const m=this.getCurrentContext(t.chunkMeta);m&&(t.frag=m.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;if(this.fragContextChanged(i)){var r;this.warn(`Frag load error must match current frag to retry ${i.url} > ${(r=this.fragCurrent)==null?void 0:r.url}`);return}const s=t.details===Z.FRAG_GAP;s&&this.fragmentTracker.fragBuffered(i,!0);const a=t.errorAction,{action:o,flags:l,retryCount:u=0,retryConfig:h}=a||{},d=!!a&&!!h,p=d&&o===_i.RetryRequest,g=d&&!a.resolved&&l===Fr.MoveAllAlternatesMatchingHost;if(!p&&g&&Ei(i)&&!i.endList)this.resetFragmentErrors(e),this.treatAsGap(i),a.resolved=!0;else if((p||g)&&u<h.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const m=mg(h,u);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${u+1}/${h.maxNumRetry} in ${m}ms`),a.resolved=!0,this.retryDate=self.performance.now()+m,this.state=de.FRAG_LOADING_WAITING_RETRY}else if(h&&a)if(this.resetFragmentErrors(e),u<h.maxNumRetry)!s&&o!==_i.RemoveAlternatePermanently&&(a.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${u})`);return}else o===_i.SendAlternateToPenaltyBox?this.state=de.WAITING_LEVEL:this.state=de.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===de.PARSING||this.state===de.PARSED){const t=e.frag,i=e.parent,r=this.getFwdBufferInfo(this.mediaBuffer,i),s=r&&r.len>.5;s&&this.reduceMaxBufferLength(r.len,(t==null?void 0:t.duration)||10);const a=!s;return a&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${i} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}resetFragmentErrors(e){e===Oe.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==de.STOPPED&&(this.state=de.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;const r=Je.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),this.state===de.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==de.STOPPED&&(this.state=de.IDLE)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,r){const s=i.details;if(!s){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,u)=>{const h=e.elementaryStreams[u];if(h){const d=h.endPTS-h.startPTS;if(d<=0)return this.warn(`Could not parse fragment ${e.sn} ${u} duration reliably (${d})`),l||!1;const p=r?0:HE(s,e,h.startPTS,h.endPTS,h.startDTS,h.endDTS);return this.hls.trigger(T.LEVEL_PTS_UPDATED,{details:s,level:i,drift:p,type:u,frag:e,start:h.startPTS,end:h.endPTS}),!0}return l},!1)){var o;if(i.fragmentError===0&&this.treatAsGap(e,i),((o=this.transmuxer)==null?void 0:o.error)===null){const l=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=de.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(T.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Oe.MAIN?"level":"track"}fragInfo(e,t=!0,i){var r,s;return`${this.playlistLabel()} ${e.level} (${i?"part":"frag"}:[${((r=t&&!i?e.startPTS:(i||e).start)!=null?r:NaN).toFixed(3)}-${((s=t&&!i?e.endPTS:(i||e).end)!=null?s:NaN).toFixed(3)}]${i&&e.type==="main"?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function tA(n){return!!n.interstitialsController&&n.enableInterstitialPlayback!==!1}class iA{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;if(e.length)e.length===1?i=e[0]:i=JL(e,t);else return new Uint8Array(0);return this.reset(),i}reset(){this.chunks.length=0,this.dataLength=0}}function JL(n,e){const t=new Uint8Array(e);let i=0;for(let r=0;r<n.length;r++){const s=n[r];t.set(s,i),i+=s.length}return t}var Cg={exports:{}},rA;function QL(){return rA||(rA=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(t=!1));function r(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function s(l,u,h,d,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var g=new r(h,d||l,p),m=t?t+u:u;return l._events[m]?l._events[m].fn?l._events[m]=[l._events[m],g]:l._events[m].push(g):(l._events[m]=g,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new i:delete l._events[u]}function o(){this._events=new i,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],h,d;if(this._eventsCount===0)return u;for(d in h=this._events)e.call(h,d)&&u.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},o.prototype.listeners=function(u){var h=t?t+u:u,d=this._events[h];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,g=d.length,m=new Array(g);p<g;p++)m[p]=d[p].fn;return m},o.prototype.listenerCount=function(u){var h=t?t+u:u,d=this._events[h];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,h,d,p,g,m){var y=t?t+u:u;if(!this._events[y])return!1;var b=this._events[y],A=arguments.length,w,x;if(b.fn){switch(b.once&&this.removeListener(u,b.fn,void 0,!0),A){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,d),!0;case 4:return b.fn.call(b.context,h,d,p),!0;case 5:return b.fn.call(b.context,h,d,p,g),!0;case 6:return b.fn.call(b.context,h,d,p,g,m),!0}for(x=1,w=new Array(A-1);x<A;x++)w[x-1]=arguments[x];b.fn.apply(b.context,w)}else{var N=b.length,F;for(x=0;x<N;x++)switch(b[x].once&&this.removeListener(u,b[x].fn,void 0,!0),A){case 1:b[x].fn.call(b[x].context);break;case 2:b[x].fn.call(b[x].context,h);break;case 3:b[x].fn.call(b[x].context,h,d);break;case 4:b[x].fn.call(b[x].context,h,d,p);break;default:if(!w)for(F=1,w=new Array(A-1);F<A;F++)w[F-1]=arguments[F];b[x].fn.apply(b[x].context,w)}}return!0},o.prototype.on=function(u,h,d){return s(this,u,h,d,!1)},o.prototype.once=function(u,h,d){return s(this,u,h,d,!0)},o.prototype.removeListener=function(u,h,d,p){var g=t?t+u:u;if(!this._events[g])return this;if(!h)return a(this,g),this;var m=this._events[g];if(m.fn)m.fn===h&&(!p||m.once)&&(!d||m.context===d)&&a(this,g);else{for(var y=0,b=[],A=m.length;y<A;y++)(m[y].fn!==h||p&&!m[y].once||d&&m[y].context!==d)&&b.push(m[y]);b.length?this._events[g]=b.length===1?b[0]:b:a(this,g)}return this},o.prototype.removeAllListeners=function(u){var h;return u?(h=t?t+u:u,this._events[h]&&a(this,h)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o}(Cg)),Cg.exports}var ZL=QL(),Ng=CN(ZL);const fl="1.6.5",Qa={};function e_(){return typeof __HLS_WORKER_BUNDLE__=="function"}function t_(){const n=Qa[fl];if(n)return n.clientCount++,n;const e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),r={worker:new self.Worker(t),objectURL:t,clientCount:1};return Qa[fl]=r,r}function i_(n){const e=Qa[n];if(e)return e.clientCount++,e;const t=new self.URL(n,self.location.href).href,r={worker:new self.Worker(t),scriptURL:t,clientCount:1};return Qa[n]=r,r}function r_(n){const e=Qa[n||fl];if(e&&e.clientCount--===1){const{worker:i,objectURL:r}=e;delete Qa[n||fl],r&&self.URL.revokeObjectURL(r),i.terminate()}}function nA(n,e){return e+10<=n.length&&n[e]===51&&n[e+1]===68&&n[e+2]===73&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function Lg(n,e){return e+10<=n.length&&n[e]===73&&n[e+1]===68&&n[e+2]===51&&n[e+3]<255&&n[e+4]<255&&n[e+6]<128&&n[e+7]<128&&n[e+8]<128&&n[e+9]<128}function lc(n,e){let t=0;return t=(n[e]&127)<<21,t|=(n[e+1]&127)<<14,t|=(n[e+2]&127)<<7,t|=n[e+3]&127,t}function gl(n,e){const t=e;let i=0;for(;Lg(n,e);){i+=10;const r=lc(n,e+6);i+=r,nA(n,e+10)&&(i+=10),e+=i}if(i>0)return n.subarray(t,t+i)}function n_(n,e,t,i){const r=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],s=e[t+2],a=s>>2&15;if(a>12){const g=new Error(`invalid ADTS sampling index:${a}`);n.emit(T.ERROR,T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_PARSING_ERROR,fatal:!0,error:g,reason:g.message});return}const o=(s>>6&3)+1,l=e[t+3]>>6&3|(s&1)<<2,u="mp4a.40."+o,h=r[a];let d=a;(o===5||o===29)&&(d-=3);const p=[o<<3|(d&14)>>1,(d&1)<<7|l<<3];return Et.log(`manifest codec:${i}, parsed codec:${u}, channels:${l}, rate:${h} (ADTS object type:${o} sampling index:${a})`),{config:p,samplerate:h,channelCount:l,codec:u,parsedCodec:u,manifestCodec:i}}function sA(n,e){return n[e]===255&&(n[e+1]&246)===240}function aA(n,e){return n[e+1]&1?7:9}function _g(n,e){return(n[e+3]&3)<<11|n[e+4]<<3|(n[e+5]&224)>>>5}function s_(n,e){return e+5<n.length}function uc(n,e){return e+1<n.length&&sA(n,e)}function a_(n,e){return s_(n,e)&&sA(n,e)&&_g(n,e)<=n.length-e}function o_(n,e){if(uc(n,e)){const t=aA(n,e);if(e+t>=n.length)return!1;const i=_g(n,e);if(i<=t)return!1;const r=e+i;return r===n.length||uc(n,r)}return!1}function oA(n,e,t,i,r){if(!n.samplerate){const s=n_(e,t,i,r);if(!s)return;Rt(n,s)}}function lA(n){return 9216e4/n}function l_(n,e){const t=aA(n,e);if(e+t<=n.length){const i=_g(n,e)-t;if(i>0)return{headerLength:t,frameLength:i}}}function uA(n,e,t,i,r){const s=lA(n.samplerate),a=i+r*s,o=l_(e,t);let l;if(o){const{frameLength:d,headerLength:p}=o,g=p+d,m=Math.max(0,t+g-e.length);m?(l=new Uint8Array(g-p),l.set(e.subarray(t+p,e.length),0)):l=e.subarray(t+p,t+g);const y={unit:l,pts:a};return m||n.samples.push(y),{sample:y,length:g,missing:m}}const u=e.length-t;return l=new Uint8Array(u),l.set(e.subarray(t,e.length),0),{sample:{unit:l,pts:a},length:u,missing:-1}}function u_(n,e){return Lg(n,e)&&lc(n,e+6)+10<=n.length-e}function c_(n){return n instanceof ArrayBuffer?n:n.byteOffset==0&&n.byteLength==n.buffer.byteLength?n.buffer:new Uint8Array(n).buffer}function Mg(n,e=0,t=1/0){return h_(n,e,t,Uint8Array)}function h_(n,e,t,i){const r=d_(n);let s=1;"BYTES_PER_ELEMENT"in i&&(s=i.BYTES_PER_ELEMENT);const a=f_(n)?n.byteOffset:0,o=(a+n.byteLength)/s,l=(a+e)/s,u=Math.floor(Math.max(0,Math.min(l,o))),h=Math.floor(Math.min(u+Math.max(t,0),o));return new i(r,u,h-u)}function d_(n){return n instanceof ArrayBuffer?n:n.buffer}function f_(n){return n&&n.buffer instanceof ArrayBuffer&&n.byteLength!==void 0&&n.byteOffset!==void 0}function g_(n){const e={key:n.type,description:"",data:"",mimeType:null,pictureType:null},t=3;if(n.size<2)return;if(n.data[0]!==t){console.log("Ignore frame with unrecognized character encoding");return}const i=n.data.subarray(1).indexOf(0);if(i===-1)return;const r=ur(Mg(n.data,1,i)),s=n.data[2+i],a=n.data.subarray(3+i).indexOf(0);if(a===-1)return;const o=ur(Mg(n.data,3+i,a));let l;return r==="-->"?l=ur(Mg(n.data,4+i+a)):l=c_(n.data.subarray(4+i+a)),e.mimeType=r,e.pictureType=s,e.description=o,e.data=l,e}function p_(n){if(n.size<2)return;const e=ur(n.data,!0),t=new Uint8Array(n.data.subarray(e.length+1));return{key:n.type,info:e,data:t.buffer}}function m_(n){if(n.size<2)return;if(n.type==="TXXX"){let t=1;const i=ur(n.data.subarray(t),!0);t+=i.length+1;const r=ur(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=ur(n.data.subarray(1));return{key:n.type,info:"",data:e}}function y_(n){if(n.type==="WXXX"){if(n.size<2)return;let t=1;const i=ur(n.data.subarray(t),!0);t+=i.length+1;const r=ur(n.data.subarray(t));return{key:n.type,info:i,data:r}}const e=ur(n.data);return{key:n.type,info:"",data:e}}function v_(n){return n.type==="PRIV"?p_(n):n.type[0]==="W"?y_(n):n.type==="APIC"?g_(n):m_(n)}function b_(n){const e=String.fromCharCode(n[0],n[1],n[2],n[3]),t=lc(n,4),i=10;return{type:e,size:t,data:n.subarray(i,i+t)}}const cc=10,E_=10;function cA(n){let e=0;const t=[];for(;Lg(n,e);){const i=lc(n,e+6);n[e+5]>>6&1&&(e+=cc),e+=cc;const r=e+i;for(;e+E_<r;){const s=b_(n.subarray(e)),a=v_(s);a&&t.push(a),e+=s.size+cc}nA(n,e)&&(e+=cc)}return t}function hA(n){return n&&n.key==="PRIV"&&n.info==="com.apple.streaming.transportStreamTimestamp"}function A_(n){if(n.data.byteLength===8){const e=new Uint8Array(n.data),t=e[3]&1;let i=(e[4]<<23)+(e[5]<<15)+(e[6]<<7)+e[7];return i/=45,t&&(i+=4772185884e-2),Math.round(i)}}function kg(n){const e=cA(n);for(let t=0;t<e.length;t++){const i=e[t];if(hA(i))return A_(i)}}let cr=function(n){return n.audioId3="org.id3",n.dateRange="com.apple.quicktime.HLS",n.emsg="https://aomedia.org/emsg/ID3",n.misbklv="urn:misb:KLV:bin:1910.1",n}({});function yn(n="",e=9e4){return{type:n,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Pg{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=Ar(this.cachedData,e),this.cachedData=null);let i=gl(e,0),r=i?i.length:0,s;const a=this._audioTrack,o=this._id3Track,l=i?kg(i):void 0,u=e.length;for((this.basePTS===null||this.frameIndex===0&&_e(l))&&(this.basePTS=S_(l,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:cr.audioId3,duration:Number.POSITIVE_INFINITY});r<u;){if(this.canParse(e,r)){const h=this.appendFrame(a,e,r);h?(this.frameIndex++,this.lastPTS=h.sample.pts,r+=h.length,s=r):r=u}else u_(e,r)?(i=gl(e,r),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:cr.audioId3,duration:Number.POSITIVE_INFINITY}),r+=i.length,s=r):r++;if(r===u&&s!==u){const h=e.slice(s);this.cachedData?this.cachedData=Ar(this.cachedData,h):this.cachedData=h}}return{audioTrack:a,videoTrack:yn(),id3Track:o,textTrack:yn()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:yn(),id3Track:this._id3Track,textTrack:yn()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const S_=(n,e,t)=>{if(_e(n))return n*90;const i=t?t.baseTime*9e4/t.timescale:0;return e*9e4+i};let hc=null;const x_=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],T_=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],w_=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],D_=[0,1,1,4];function dA(n,e,t,i,r){if(t+24>e.length)return;const s=fA(e,t);if(s&&t+s.frameLength<=e.length){const a=s.samplesPerFrame*9e4/s.sampleRate,o=i+r*a,l={unit:e.subarray(t,t+s.frameLength),pts:o,dts:o};return n.config=[],n.channelCount=s.channelCount,n.samplerate=s.sampleRate,n.samples.push(l),{sample:l,length:s.frameLength,missing:0}}}function fA(n,e){const t=n[e+1]>>3&3,i=n[e+1]>>1&3,r=n[e+2]>>4&15,s=n[e+2]>>2&3;if(t!==1&&r!==0&&r!==15&&s!==3){const a=n[e+2]>>1&1,o=n[e+3]>>6,l=t===3?3-i:i===3?3:4,u=x_[l*14+r-1]*1e3,d=T_[(t===3?0:t===2?1:2)*3+s],p=o===3?1:2,g=w_[t][i],m=D_[i],y=g*8*m,b=Math.floor(g*u/d+a)*m;if(hc===null){const x=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);hc=x?parseInt(x[1]):0}return!!hc&&hc<=87&&i===2&&u>=224e3&&o===0&&(n[e+3]=n[e+3]|128),{sampleRate:d,channelCount:p,frameLength:b,samplesPerFrame:y}}}function Og(n,e){return n[e]===255&&(n[e+1]&224)===224&&(n[e+1]&6)!==0}function gA(n,e){return e+1<n.length&&Og(n,e)}function R_(n,e){return Og(n,e)&&4<=n.length-e}function pA(n,e){if(e+1<n.length&&Og(n,e)){const i=fA(n,e);let r=4;i!=null&&i.frameLength&&(r=i.frameLength);const s=e+r;return s===n.length||gA(n,s)}return!1}class I_ extends Pg{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const i=gl(e,0);let r=(i==null?void 0:i.length)||0;if(pA(e,r))return!1;for(let s=e.length;r<s;r++)if(o_(e,r))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return a_(e,t)}appendFrame(e,t,i){oA(e,this.observer,t,i,e.manifestCodec);const r=uA(e,t,i,this.basePTS,this.frameIndex);if(r&&r.missing===0)return r}}const mA=(n,e)=>{let t=0,i=5;e+=i;const r=new Uint32Array(1),s=new Uint32Array(1),a=new Uint8Array(1);for(;i>0;){a[0]=n[e];const o=Math.min(i,8),l=8-o;s[0]=4278190080>>>24+l<<l,r[0]=(a[0]&s[0])>>l,t=t?t<<o|r[0]:r[0],e+=1,i-=o}return t};class C_ extends Pg{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const r=yA(e,t,i,this.basePTS,this.frameIndex);if(r!==-1)return{sample:e.samples[e.samples.length-1],length:r,missing:0}}static probe(e){if(!e)return!1;const t=gl(e,0);if(!t)return!1;const i=t.length;return e[i]===11&&e[i+1]===119&&kg(t)!==void 0&&mA(e,i)<16}}function yA(n,e,t,i,r){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;const s=e[t+4]>>6;if(s>=3)return-1;const o=[48e3,44100,32e3][s],l=e[t+4]&63,h=[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][l*3+s]*2;if(t+h>e.length)return-1;const d=e[t+6]>>5;let p=0;d===2?p+=2:(d&1&&d!==1&&(p+=2),d&4&&(p+=2));const g=(e[t+6]<<8|e[t+7])>>12-p&1,y=[2,1,2,3,3,4,4,5][d]+g,b=e[t+5]>>3,A=e[t+5]&7,w=new Uint8Array([s<<6|b<<1|A>>2,(A&3)<<6|d<<3|g<<2|l>>4,l<<4&224]),x=1536/o*9e4,N=i+r*x,F=e.subarray(t,t+h);return n.config=w,n.channelCount=y,n.samplerate=o,n.samples.push({unit:F,pts:N}),h}class N_ extends Pg{resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=gl(e,0);let i=(t==null?void 0:t.length)||0;if(t&&e[i]===11&&e[i+1]===119&&kg(t)!==void 0&&mA(e,i)<=16)return!1;for(let r=e.length;i<r;i++)if(pA(e,i))return Et.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return R_(e,t)}appendFrame(e,t,i){if(this.basePTS!==null)return dA(e,t,i,this.basePTS,this.frameIndex)}}const L_=/\/emsg[-/]ID3/i;class __{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,r){const s=this.videoTrack=yn("video",1),a=this.audioTrack=yn("audio",1),o=this.txtTrack=yn("text",1);if(this.id3Track=yn("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;const l=X1(e);if(l.video){const{id:u,timescale:h,codec:d,supplemental:p}=l.video;s.id=u,s.timescale=o.timescale=h,s.codec=d,s.supplemental=p}if(l.audio){const{id:u,timescale:h,codec:d}=l.audio;a.id=u,a.timescale=h,a.codec=d}o.id=W1.text,s.sampleDuration=0,s.duration=a.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return kN(e)}demux(e,t){this.timeOffset=t;let i=e;const r=this.videoTrack,s=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Ar(this.remainderData,e));const o=GN(i);this.remainderData=o.remainder,r.samples=o.valid||new Uint8Array}else r.samples=i;const a=this.extractID3Track(r,t);return s.samples=Q1(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const r=this.extractID3Track(t,this.timeOffset);return i.samples=Q1(e,t),{videoTrack:t,audioTrack:yn(),id3Track:r,textTrack:yn()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const r=rt(e.samples,["emsg"]);r&&r.forEach(s=>{const a=VN(s);if(L_.test(a.schemeIdUri)){const o=vA(a,t);let l=a.eventDuration===4294967295?Number.POSITIVE_INFINITY:a.eventDuration/a.timeScale;l<=.001&&(l=Number.POSITIVE_INFINITY);const u=a.payload;i.samples.push({data:u,len:u.byteLength,dts:o,pts:o,type:cr.emsg,duration:l})}else if(this.config.enableEmsgKLVMetadata&&a.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const o=vA(a,t);i.samples.push({data:a.payload,len:a.payload.byteLength,dts:o,pts:o,type:cr.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function vA(n,e){return _e(n.presentationTime)?n.presentationTime/n.timeScale:e+n.presentationTimeDelta/n.timeScale}class M_{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new yg(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Ss.cbc)}decryptAacSample(e,t,i){const r=e[t].unit;if(r.length<=16)return;const s=r.subarray(16,r.length-r.length%16),a=s.buffer.slice(s.byteOffset,s.byteOffset+s.length);this.decryptBuffer(a).then(o=>{const l=new Uint8Array(o);r.set(l,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=Math.floor((e.length-48)/160)*16+16,i=new Int8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)i.set(e.subarray(s,s+16),r);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let r=0;for(let s=32;s<e.length-16;s+=160,r+=16)e.set(i.subarray(r,r+16),s);return e}decryptAvcSample(e,t,i,r,s){const a=Z1(s.data),o=this.getAvcEncryptedData(a);this.decryptBuffer(o.buffer).then(l=>{s.data=this.getAvcDecryptedUnit(a,l),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,r)})}decryptAvcSamples(e,t,i,r){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){r();return}const s=e[t].units;for(;!(i>=s.length);i++){const a=s[i];if(!(a.data.length<=48||a.type!==1&&a.type!==5)&&(this.decryptAvcSample(e,t,i,r,a),!this.decrypter.isSync()))return}}}}class bA{constructor(){this.VideoSample=null}createVideoSample(e,t,i){return{key:e,frame:!1,pts:t,dts:i,units:[],length:0}}getLastNalUnit(e){var t;let i=this.VideoSample,r;if((!i||i.units.length===0)&&(i=e[e.length-1]),(t=i)!=null&&t.units){const s=i.units;r=s[s.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){const i=t.samples,r=i.length;if(r){const s=i[r-1];e.pts=s.pts,e.dts=s.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,i){const r=t.byteLength;let s=e.naluState||0;const a=s,o=[];let l=0,u,h,d,p=-1,g=0;for(s===-1&&(p=0,g=this.getNALuType(t,0),s=0,l=1);l<r;){if(u=t[l++],!s){s=u?0:1;continue}if(s===1){s=u?0:2;continue}if(!u)s=3;else if(u===1){if(h=l-s-1,p>=0){const m={data:t.subarray(p,h),type:g};o.push(m)}else{const m=this.getLastNalUnit(e.samples);m&&(a&&l<=4-a&&m.state&&(m.data=m.data.subarray(0,m.data.byteLength-a)),h>0&&(m.data=Ar(m.data,t.subarray(0,h)),m.state=0))}l<r?(d=this.getNALuType(t,l),p=l,g=d,s=0):s=-1}else s=0}if(p>=0&&s>=0){const m={data:t.subarray(p,r),type:g,state:s};o.push(m)}if(o.length===0){const m=this.getLastNalUnit(e.samples);m&&(m.data=Ar(m.data,t))}return e.naluState=s,o}}class pl{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),s=Math.min(4,t);if(s===0)throw new Error("no bytes available");r.set(e.subarray(i,i+s)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=s*8,this.bytesAvailable-=s}skipBits(e){let t;e=Math.min(e,this.bytesAvailable*8+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&Et.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw new Error("no bits available");return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!==0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class EA extends bA{parsePES(e,t,i,r){const s=this.parseNALu(e,i.data,r);let a=this.VideoSample,o,l=!1;i.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),s.forEach(u=>{var h,d;switch(u.type){case 1:{let y=!1;o=!0;const b=u.data;if(l&&b.length>4){const A=this.readSliceType(b);(A===2||A===4||A===7||A===9)&&(y=!0)}if(y){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.frame=!0,a.key=y;break}case 5:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 6:{o=!0,dg(u.data,1,i.pts,t.samples);break}case 7:{var g,m;o=!0,l=!0;const y=u.data,b=this.readSPS(y);if(!e.sps||e.width!==b.width||e.height!==b.height||((g=e.pixelRatio)==null?void 0:g[0])!==b.pixelRatio[0]||((m=e.pixelRatio)==null?void 0:m[1])!==b.pixelRatio[1]){e.width=b.width,e.height=b.height,e.pixelRatio=b.pixelRatio,e.sps=[y];const A=y.subarray(1,4);let w="avc1.";for(let x=0;x<3;x++){let N=A[x].toString(16);N.length<2&&(N="0"+N),w+=N}e.codec=w}break}case 8:o=!0,e.pps=[u.data];break;case 9:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:o=!0;break;default:o=!1;break}a&&o&&a.units.push(u)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}getNALuType(e,t){return e[t]&31}readSliceType(e){const t=new pl(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let i=8,r=8,s;for(let a=0;a<e;a++)r!==0&&(s=t.readEG(),r=(i+s+256)%256),i=r===0?i:r}readSPS(e){const t=new pl(e);let i=0,r=0,s=0,a=0,o,l,u;const h=t.readUByte.bind(t),d=t.readBits.bind(t),p=t.readUEG.bind(t),g=t.readBoolean.bind(t),m=t.skipBits.bind(t),y=t.skipEG.bind(t),b=t.skipUEG.bind(t),A=this.skipScalingList.bind(this);h();const w=h();if(d(5),m(3),h(),b(),w===100||w===110||w===122||w===244||w===44||w===83||w===86||w===118||w===128){const M=p();if(M===3&&m(1),b(),b(),m(1),g())for(l=M!==3?8:12,u=0;u<l;u++)g()&&(u<6?A(16,t):A(64,t))}b();const x=p();if(x===0)p();else if(x===1)for(m(1),y(),y(),o=p(),u=0;u<o;u++)y();b(),m(1);const N=p(),F=p(),L=d(1);L===0&&m(1),m(1),g()&&(i=p(),r=p(),s=p(),a=p());let C=[1,1];if(g()&&g())switch(h()){case 1:C=[1,1];break;case 2:C=[12,11];break;case 3:C=[10,11];break;case 4:C=[16,11];break;case 5:C=[40,33];break;case 6:C=[24,11];break;case 7:C=[20,11];break;case 8:C=[32,11];break;case 9:C=[80,33];break;case 10:C=[18,11];break;case 11:C=[15,11];break;case 12:C=[64,33];break;case 13:C=[160,99];break;case 14:C=[4,3];break;case 15:C=[3,2];break;case 16:C=[2,1];break;case 255:{C=[h()<<8|h(),h()<<8|h()];break}}return{width:Math.ceil((N+1)*16-i*2-r*2),height:(2-L)*(F+1)*16-(L?2:4)*(s+a),pixelRatio:C}}}class AA extends bA{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,i,r){const s=this.parseNALu(e,i.data,r);let a=this.VideoSample,o,l=!1;i.data=null,a&&s.length&&!e.audFound&&(this.pushAccessUnit(a,e),a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),s.forEach(u=>{var h,d;switch(u.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.frame=!0,o=!0;break;case 16:case 17:case 18:case 21:if(o=!0,l){var p;(p=a)!=null&&p.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null)}a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 19:case 20:o=!0,(h=a)!=null&&h.frame&&!a.key&&(this.pushAccessUnit(a,e),a=this.VideoSample=null),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0,a.frame=!0;break;case 39:o=!0,dg(u.data,2,i.pts,t.samples);break;case 32:o=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=Rt(e.params,this.readVPS(u.data)),this.initVPS=u.data),e.vps=[u.data];break;case 33:if(o=!0,l=!0,e.vps!==void 0&&e.vps[0]!==this.initVPS&&e.sps!==void 0&&!this.matchSPS(e.sps[0],u.data)&&(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const g=this.readSPS(u.data);e.width=g.width,e.height=g.height,e.pixelRatio=g.pixelRatio,e.codec=g.codecString,e.sps=[],typeof e.params!="object"&&(e.params={});for(const m in g.params)e.params[m]=g.params[m]}this.pushParameterSet(e.sps,u.data,e.vps),a||(a=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),a.key=!0;break;case 34:if(o=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];const g=this.readPPS(u.data);for(const m in g)e.params[m]=g[m]}this.pushParameterSet(e.pps,u.data,e.vps)}break;case 35:o=!0,e.audFound=!0,(d=a)!=null&&d.frame&&(this.pushAccessUnit(a,e),a=null),a||(a=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:o=!1;break}a&&o&&a.units.push(u)}),r&&a&&(this.pushAccessUnit(a,e),this.VideoSample=null)}pushParameterSet(e,t,i){(i&&i[0]===this.initVPS||!i&&!e.length)&&e.push(t)}getNALuType(e,t){return(e[t]&126)>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let i=0;for(let r=0;r<e.byteLength;r++)r>=2&&e[r]===3&&e[r-1]===0&&e[r-2]===0||(t[i]=e[r],i++);return new Uint8Array(t.buffer,0,i)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new pl(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);const i=t.readBits(3),r=t.readBoolean();return{numTemporalLayers:i+1,temporalIdNested:r}}readSPS(e){const t=new pl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const i=t.readBits(3);t.readBoolean();const r=t.readBits(2),s=t.readBoolean(),a=t.readBits(5),o=t.readUByte(),l=t.readUByte(),u=t.readUByte(),h=t.readUByte(),d=t.readUByte(),p=t.readUByte(),g=t.readUByte(),m=t.readUByte(),y=t.readUByte(),b=t.readUByte(),A=t.readUByte(),w=[],x=[];for(let me=0;me<i;me++)w.push(t.readBoolean()),x.push(t.readBoolean());if(i>0)for(let me=i;me<8;me++)t.readBits(2);for(let me=0;me<i;me++)w[me]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),x[me]&&t.readUByte();t.readUEG();const N=t.readUEG();N==3&&t.skipBits(1);const F=t.readUEG(),L=t.readUEG(),C=t.readBoolean();let M=0,_=0,R=0,U=0;C&&(M+=t.readUEG(),_+=t.readUEG(),R+=t.readUEG(),U+=t.readUEG());const q=t.readUEG(),$=t.readUEG(),Y=t.readUEG(),ae=t.readBoolean();for(let me=ae?0:i;me<=i;me++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Ie=0;Ie<4;Ie++)for(let Me=0;Me<(Ie===3?2:6);Me++)if(!t.readBoolean())t.readUEG();else{const K=Math.min(64,1<<4+(Ie<<1));Ie>1&&t.readEG();for(let D=0;D<K;D++)t.readEG()}t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const re=t.readUEG();let V=0;for(let me=0;me<re;me++){let Ie=!1;if(me!==0&&(Ie=t.readBoolean()),Ie){me===re&&t.readUEG(),t.readBoolean(),t.readUEG();let Me=0;for(let ue=0;ue<=V;ue++){const K=t.readBoolean();let D=!1;K||(D=t.readBoolean()),(K||D)&&Me++}V=Me}else{const Me=t.readUEG(),ue=t.readUEG();V=Me+ue;for(let K=0;K<Me;K++)t.readUEG(),t.readBoolean();for(let K=0;K<ue;K++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const me=t.readUEG();for(let Ie=0;Ie<me;Ie++){for(let Me=0;Me<Y+4;Me++)t.readBits(1);t.readBits(1)}}let ve=0,pe=1,Te=1,Ce=!0,Re=1,Be=0;t.readBoolean(),t.readBoolean();let Ue=!1;if(t.readBoolean()){if(t.readBoolean()){const S=t.readUByte(),P=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2],W=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1];S>0&&S<16?(pe=P[S-1],Te=W[S-1]):S===255&&(pe=t.readBits(16),Te=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),Ue=t.readBoolean(),Ue&&(M+=t.readUEG(),_+=t.readUEG(),R+=t.readUEG(),U+=t.readUEG()),t.readBoolean()&&(Re=t.readBits(32),Be=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){const W=t.readBoolean(),Se=t.readBoolean();let se=!1;(W||Se)&&(se=t.readBoolean(),se&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),se&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let le=0;le<=i;le++){Ce=t.readBoolean();const xe=Ce||t.readBoolean();let We=!1;xe?t.readEG():We=t.readBoolean();const ri=We?1:t.readUEG()+1;if(W)for(let kt=0;kt<ri;kt++)t.readUEG(),t.readUEG(),se&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(Se)for(let kt=0;kt<ri;kt++)t.readUEG(),t.readUEG(),se&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),ve=t.readUEG())}let Ze=F,qe=L;if(C||Ue){let me=1,Ie=1;N===1?me=Ie=2:N==2&&(me=2),Ze=F-me*_-me*M,qe=L-Ie*U-Ie*R}const nt=r?["A","B","C"][r]:"",B=o<<24|l<<16|u<<8|h;let oe=0;for(let me=0;me<32;me++)oe=(oe|(B>>me&1)<<31-me)>>>0;let Ae=oe.toString(16);return a===1&&Ae==="2"&&(Ae="6"),{codecString:`hvc1.${nt}${a}.${Ae}.${s?"H":"L"}${A}.B0`,params:{general_tier_flag:s,general_profile_idc:a,general_profile_space:r,general_profile_compatibility_flags:[o,l,u,h],general_constraint_indicator_flags:[d,p,g,m,y,b],general_level_idc:A,bit_depth:q+8,bit_depth_luma_minus8:q,bit_depth_chroma_minus8:$,min_spatial_segmentation_idc:ve,chroma_format_idc:N,frame_rate:{fixed:Ce,fps:Be/Re}},width:Ze,height:qe,pixelRatio:[pe,Te]}}readPPS(e){const t=new pl(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const r=t.readBoolean(),s=t.readBoolean();let a=1;return s&&r?a=0:s?a=3:r&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Ai=188;class xs{constructor(e,t,i,r){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=r,this.videoParser=null}static probe(e,t){const i=xs.syncOffset(e);return i>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),i!==-1}static syncOffset(e){const t=e.length;let i=Math.min(Ai*5,t-Ai)+1,r=0;for(;r<i;){let s=!1,a=-1,o=0;for(let l=r;l<t;l+=Ai)if(e[l]===71&&(t-l===Ai||e[l+Ai]===71)){if(o++,a===-1&&(a=l,a!==0&&(i=Math.min(a+Ai*99,e.length-Ai)+1)),s||(s=Fg(e,l)===0),s&&o>1&&(a===0&&o>2||l+Ai>i))return a}else{if(o)return-1;break}r++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:W1[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,i,r){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=xs.createTrack("video"),this._videoTrack.duration=r,this._audioTrack=xs.createTrack("audio",r),this._id3Track=xs.createTrack("id3"),this._txtTrack=xs.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,r=!1){i||(this.sampleAes=null);let s;const a=this._videoTrack,o=this._audioTrack,l=this._id3Track,u=this._txtTrack;let h=a.pid,d=a.pesData,p=o.pid,g=l.pid,m=o.pesData,y=l.pesData,b=null,A=this.pmtParsed,w=this._pmtId,x=e.length;if(this.remainderData&&(e=Ar(this.remainderData,e),x=e.length,this.remainderData=null),x<Ai&&!r)return this.remainderData=e,{audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};const N=Math.max(0,xs.syncOffset(e));x-=(x-N)%Ai,x<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,x,e.buffer.byteLength-x));let F=0;for(let C=N;C<x;C+=Ai)if(e[C]===71){const M=!!(e[C+1]&64),_=Fg(e,C),R=(e[C+3]&48)>>4;let U;if(R>1){if(U=C+5+e[C+4],U===C+Ai)continue}else U=C+4;switch(_){case h:if(M){if(d&&(s=Za(d,this.logger))){if(this.videoParser===null)switch(a.segmentCodec){case"avc":this.videoParser=new EA;break;case"hevc":this.videoParser=new AA;break}this.videoParser!==null&&this.videoParser.parsePES(a,u,s,!1)}d={data:[],size:0}}d&&(d.data.push(e.subarray(U,C+Ai)),d.size+=C+Ai-U);break;case p:if(M){if(m&&(s=Za(m,this.logger)))switch(o.segmentCodec){case"aac":this.parseAACPES(o,s);break;case"mp3":this.parseMPEGPES(o,s);break;case"ac3":this.parseAC3PES(o,s);break}m={data:[],size:0}}m&&(m.data.push(e.subarray(U,C+Ai)),m.size+=C+Ai-U);break;case g:M&&(y&&(s=Za(y,this.logger))&&this.parseID3PES(l,s),y={data:[],size:0}),y&&(y.data.push(e.subarray(U,C+Ai)),y.size+=C+Ai-U);break;case 0:M&&(U+=e[U]+1),w=this._pmtId=k_(e,U);break;case w:{M&&(U+=e[U]+1);const q=P_(e,U,this.typeSupported,i,this.observer,this.logger);h=q.videoPid,h>0&&(a.pid=h,a.segmentCodec=q.segmentVideoCodec),p=q.audioPid,p>0&&(o.pid=p,o.segmentCodec=q.segmentAudioCodec),g=q.id3Pid,g>0&&(l.pid=g),b!==null&&!A&&(this.logger.warn(`MPEG-TS PMT found at ${C} after unknown PID '${b}'. Backtracking to sync byte @${N} to parse all TS packets.`),b=null,C=N-188),A=this.pmtParsed=!0;break}case 17:case 8191:break;default:b=_;break}}else F++;F>0&&Bg(this.observer,new Error(`Found ${F} TS packet/s that do not start with 0x47`),void 0,this.logger),a.pesData=d,o.pesData=m,l.pesData=y;const L={audioTrack:o,videoTrack:a,id3Track:l,textTrack:u};return r&&this.extractRemainingSamples(L),L}flush(){const{remainderData:e}=this;this.remainderData=null;let t;return e?t=this.demux(e,-1,!1,!0):t={videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:r,textTrack:s}=e,a=i.pesData,o=t.pesData,l=r.pesData;let u;if(a&&(u=Za(a,this.logger))){if(this.videoParser===null)switch(i.segmentCodec){case"avc":this.videoParser=new EA;break;case"hevc":this.videoParser=new AA;break}this.videoParser!==null&&(this.videoParser.parsePES(i,s,u,!0),i.pesData=null)}else i.pesData=a;if(o&&(u=Za(o,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,u);break;case"mp3":this.parseMPEGPES(t,u);break;case"ac3":this.parseAC3PES(t,u);break}t.pesData=null}else o!=null&&o.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=o;l&&(u=Za(l,this.logger))?(this.parseID3PES(r,u),r.pesData=null):r.pesData=l}demuxSampleAes(e,t,i){const r=this.demux(e,i,!0,!this.config.progressive),s=this.sampleAes=new M_(this.observer,this.config,t);return this.decrypt(r,s)}decrypt(e,t){return new Promise(i=>{const{audioTrack:r,videoTrack:s}=e;r.samples&&r.segmentCodec==="aac"?t.decryptAacSamples(r.samples,0,()=>{s.samples?t.decryptAvcSamples(s.samples,0,0,()=>{i(e)}):i(e)}):s.samples&&t.decryptAvcSamples(s.samples,0,0,()=>{i(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let i=0;const r=this.aacOverFlow;let s=t.data;if(r){this.aacOverFlow=null;const d=r.missing,p=r.sample.unit.byteLength;if(d===-1)s=Ar(r.sample.unit,s);else{const g=p-d;r.sample.unit.set(s.subarray(0,d),g),e.samples.push(r.sample),i=r.missing}}let a,o;for(a=i,o=s.length;a<o-1&&!uc(s,a);a++);if(a!==i){let d;const p=a<o-1;if(p?d=`AAC PES did not start with ADTS header,offset:${a}`:d="No ADTS header found in AAC PES",Bg(this.observer,new Error(d),p,this.logger),!p)return}oA(e,this.observer,s,a,this.audioCodec);let l;if(t.pts!==void 0)l=t.pts;else if(r){const d=lA(e.samplerate);l=r.sample.pts+d}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0,h;for(;a<o;)if(h=uA(e,s,a,l,u),a+=h.length,h.missing){this.aacOverFlow=h;break}else for(u++;a<o-1&&!uc(s,a);a++);}parseMPEGPES(e,t){const i=t.data,r=i.length;let s=0,a=0;const o=t.pts;if(o===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<r;)if(gA(i,a)){const l=dA(e,i,a,o,s);if(l)a+=l.length,s++;else break}else a++}parseAC3PES(e,t){{const i=t.data,r=t.pts;if(r===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}const s=i.length;let a=0,o=0,l;for(;o<s&&(l=yA(e,i,o,r,a++))>0;)o+=l}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}const i=Rt({},t,{type:this._videoTrack?cr.emsg:cr.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Fg(n,e){return((n[e+1]&31)<<8)+n[e+2]}function k_(n,e){return(n[e+10]&31)<<8|n[e+11]}function P_(n,e,t,i,r,s){const a={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=(n[e+1]&15)<<8|n[e+2],l=e+3+o-4,u=(n[e+10]&15)<<8|n[e+11];for(e+=12+u;e<l;){const h=Fg(n,e),d=(n[e+3]&15)<<8|n[e+4];switch(n[e]){case 207:if(!i){Ug("ADTS AAC",s);break}case 15:a.audioPid===-1&&(a.audioPid=h);break;case 21:a.id3Pid===-1&&(a.id3Pid=h);break;case 219:if(!i){Ug("H.264",s);break}case 27:a.videoPid===-1&&(a.videoPid=h);break;case 3:case 4:!t.mpeg&&!t.mp3?s.log("MPEG audio found, not supported in this browser"):a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="mp3");break;case 193:if(!i){Ug("AC-3",s);break}case 129:t.ac3?a.audioPid===-1&&(a.audioPid=h,a.segmentAudioCodec="ac3"):s.log("AC-3 audio found, not supported in this browser");break;case 6:if(a.audioPid===-1&&d>0){let p=e+5,g=d;for(;g>2;){switch(n[p]){case 106:t.ac3!==!0?s.log("AC-3 audio found, not supported in this browser for now"):(a.audioPid=h,a.segmentAudioCodec="ac3");break}const y=n[p+1]+2;p+=y,g-=y}}break;case 194:case 135:return Bg(r,new Error("Unsupported EC-3 in M2TS found"),void 0,s),a;case 36:a.videoPid===-1&&(a.videoPid=h,a.segmentVideoCodec="hevc",s.log("HEVC in M2TS found"));break}e+=d+5}return a}function Bg(n,e,t,i){i.warn(`parsing error: ${e.message}`),n.emit(T.ERROR,T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function Ug(n,e){e.log(`${n} with AES-128-CBC encryption found in unencrypted stream`)}function Za(n,e){let t=0,i,r,s,a,o;const l=n.data;if(!n||n.size===0)return null;for(;l[0].length<19&&l.length>1;)l[0]=Ar(l[0],l[1]),l.splice(1,1);if(i=l[0],(i[0]<<16)+(i[1]<<8)+i[2]===1){if(r=(i[4]<<8)+i[5],r&&r>n.size-6)return null;const h=i[7];h&192&&(a=(i[9]&14)*536870912+(i[10]&255)*4194304+(i[11]&254)*16384+(i[12]&255)*128+(i[13]&254)/2,h&64?(o=(i[14]&14)*536870912+(i[15]&255)*4194304+(i[16]&254)*16384+(i[17]&255)*128+(i[18]&254)/2,a-o>54e5&&(e.warn(`${Math.round((a-o)/9e4)}s delta between PTS and DTS, align them`),a=o)):o=a),s=i[8];let d=s+9;if(n.size<=d)return null;n.size-=d;const p=new Uint8Array(n.size);for(let g=0,m=l.length;g<m;g++){i=l[g];let y=i.byteLength;if(d)if(d>y){d-=y;continue}else i=i.subarray(d),y-=d,d=0;p.set(i,t),t+=y}return r&&(r-=s+3),{data:p,pts:a,dts:o,len:r}}return null}class O_{static getSilentFrame(e,t){switch(e){case"mp4a.40.2":if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}}}const Ts=Math.pow(2,32)-1;class Q{static init(){Q.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};let e;for(e in Q.types)Q.types.hasOwnProperty(e)&&(Q.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Q.HDLR_TYPES={video:t,audio:i};const r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),s=new Uint8Array([0,0,0,0,0,0,0,0]);Q.STTS=Q.STSC=Q.STCO=s,Q.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Q.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Q.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Q.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const a=new Uint8Array([105,115,111,109]),o=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);Q.FTYP=Q.box(Q.types.ftyp,a,l,a,o),Q.DINF=Q.box(Q.types.dinf,Q.box(Q.types.dref,r))}static box(e,...t){let i=8,r=t.length;const s=r;for(;r--;)i+=t[r].byteLength;const a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=i&255,a.set(e,4),r=0,i=8;r<s;r++)a.set(t[r],i),i+=t[r].byteLength;return a}static hdlr(e){return Q.box(Q.types.hdlr,Q.HDLR_TYPES[e])}static mdat(e){return Q.box(Q.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(Ts+1)),r=Math.floor(t%(Ts+1));return Q.box(Q.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,85,196,0,0]))}static mdia(e){return Q.box(Q.types.mdia,Q.mdhd(e.timescale||0,e.duration||0),Q.hdlr(e.type),Q.minf(e))}static mfhd(e){return Q.box(Q.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,e&255]))}static minf(e){return e.type==="audio"?Q.box(Q.types.minf,Q.box(Q.types.smhd,Q.SMHD),Q.DINF,Q.stbl(e)):Q.box(Q.types.minf,Q.box(Q.types.vmhd,Q.VMHD),Q.DINF,Q.stbl(e))}static moof(e,t,i){return Q.box(Q.types.moof,Q.mfhd(e),Q.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=Q.trak(e[t]);return Q.box.apply(null,[Q.types.moov,Q.mvhd(e[0].timescale||0,e[0].duration||0)].concat(i).concat(Q.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=Q.trex(e[t]);return Q.box.apply(null,[Q.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(Ts+1)),r=Math.floor(t%(Ts+1)),s=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,e&255,i>>24,i>>16&255,i>>8&255,i&255,r>>24,r>>16&255,r>>8&255,r&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Q.box(Q.types.mvhd,s)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let r,s;for(r=0;r<t.length;r++)s=t[r].flags,i[r+4]=s.dependsOn<<4|s.isDependedOn<<2|s.hasRedundancy;return Q.box(Q.types.sdtp,i)}static stbl(e){return Q.box(Q.types.stbl,Q.stsd(e),Q.box(Q.types.stts,Q.STTS),Q.box(Q.types.stsc,Q.STSC),Q.box(Q.types.stsz,Q.STSZ),Q.box(Q.types.stco,Q.STCO))}static avc1(e){let t=[],i=[],r,s,a;for(r=0;r<e.sps.length;r++)s=e.sps[r],a=s.byteLength,t.push(a>>>8&255),t.push(a&255),t=t.concat(Array.prototype.slice.call(s));for(r=0;r<e.pps.length;r++)s=e.pps[r],a=s.byteLength,i.push(a>>>8&255),i.push(a&255),i=i.concat(Array.prototype.slice.call(s));const o=Q.box(Q.types.avcC,new Uint8Array([1,t[3],t[4],t[5],255,224|e.sps.length].concat(t).concat([e.pps.length]).concat(i))),l=e.width,u=e.height,h=e.pixelRatio[0],d=e.pixelRatio[1];return Q.box(Q.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,l&255,u>>8&255,u&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Q.box(Q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Q.box(Q.types.pasp,new Uint8Array([h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,t&255,0,0])}static mp4a(e){return Q.box(Q.types.mp4a,Q.audioStsd(e),Q.box(Q.types.esds,Q.esds(e)))}static mp3(e){return Q.box(Q.types[".mp3"],Q.audioStsd(e))}static ac3(e){return Q.box(Q.types["ac-3"],Q.audioStsd(e),Q.box(Q.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Q.box(Q.types.stsd,Q.STSD,Q.mp4a(e));if(t==="ac3"&&e.config)return Q.box(Q.types.stsd,Q.STSD,Q.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Q.box(Q.types.stsd,Q.STSD,Q.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Q.box(Q.types.stsd,Q.STSD,Q.avc1(e));if(t==="hevc"&&e.vps)return Q.box(Q.types.stsd,Q.STSD,Q.hvc1(e))}else throw new Error("video track missing pps or sps");throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,i=(e.duration||0)*(e.timescale||0),r=e.width||0,s=e.height||0,a=Math.floor(i/(Ts+1)),o=Math.floor(i%(Ts+1));return Q.box(Q.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,t&255,0,0,0,0,a>>24,a>>16&255,a>>8&255,a&255,o>>24,o>>16&255,o>>8&255,o&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,r&255,0,0,s>>8&255,s&255,0,0]))}static traf(e,t){const i=Q.sdtp(e),r=e.id,s=Math.floor(t/(Ts+1)),a=Math.floor(t%(Ts+1));return Q.box(Q.types.traf,Q.box(Q.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,r&255])),Q.box(Q.types.tfdt,new Uint8Array([1,0,0,0,s>>24,s>>16&255,s>>8&255,s&255,a>>24,a>>16&255,a>>8&255,a&255])),Q.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,Q.box(Q.types.trak,Q.tkhd(e),Q.mdia(e))}static trex(e){const t=e.id;return Q.box(Q.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,t&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],r=i.length,s=12+16*r,a=new Uint8Array(s);let o,l,u,h,d,p;for(t+=8+s,a.set([e.type==="video"?1:0,0,15,1,r>>>24&255,r>>>16&255,r>>>8&255,r&255,t>>>24&255,t>>>16&255,t>>>8&255,t&255],0),o=0;o<r;o++)l=i[o],u=l.duration,h=l.size,d=l.flags,p=l.cts,a.set([u>>>24&255,u>>>16&255,u>>>8&255,u&255,h>>>24&255,h>>>16&255,h>>>8&255,h&255,d.isLeading<<2|d.dependsOn,d.isDependedOn<<6|d.hasRedundancy<<4|d.paddingValue<<1|d.isNonSync,d.degradPrio&61440,d.degradPrio&15,p>>>24&255,p>>>16&255,p>>>8&255,p&255],12+16*o);return Q.box(Q.types.trun,a)}static initSegment(e){Q.types||Q.init();const t=Q.moov(e);return Ar(Q.FTYP,t)}static hvc1(e){const t=e.params,i=[e.vps,e.sps,e.pps],r=4,s=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),r-1|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),i.length]);let a=s.length;for(let m=0;m<i.length;m+=1){a+=3;for(let y=0;y<i[m].length;y+=1)a+=2+i[m][y].length}const o=new Uint8Array(a);o.set(s,0),a=s.length;const l=i.length-1;for(let m=0;m<i.length;m+=1){o.set(new Uint8Array([32+m|(m===l?128:0),0,i[m].length]),a),a+=3;for(let y=0;y<i[m].length;y+=1)o.set(new Uint8Array([i[m][y].length>>8,i[m][y].length&255]),a),a+=2,o.set(i[m][y],a),a+=i[m][y].length}const u=Q.box(Q.types.hvcC,o),h=e.width,d=e.height,p=e.pixelRatio[0],g=e.pixelRatio[1];return Q.box(Q.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,h&255,d>>8&255,d&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,Q.box(Q.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Q.box(Q.types.pasp,new Uint8Array([p>>24,p>>16&255,p>>8&255,p&255,g>>24,g>>16&255,g>>8&255,g&255])))}}Q.types=void 0,Q.HDLR_TYPES=void 0,Q.STTS=void 0,Q.STSC=void 0,Q.STCO=void 0,Q.STSZ=void 0,Q.VMHD=void 0,Q.SMHD=void 0,Q.STSD=void 0,Q.FTYP=void 0,Q.DINF=void 0;const SA=9e4;function $g(n,e,t=1,i=!1){const r=n*e*t;return i?Math.round(r):r}function F_(n,e,t=1,i=!1){return $g(n,e,1/t,i)}function ml(n,e=!1){return $g(n,1e3,1/SA,e)}function B_(n,e=1){return $g(n,SA,1/e)}const U_=10*1e3,$_=1024,G_=1152,q_=1536;let eo=null,Gg=null;function xA(n,e,t,i){return{duration:e,size:t,cts:i,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:n?2:1,isNonSync:n?0:1}}}class dc{constructor(e,t,i,r){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=r,this.ISGenerated=!1,eo===null){const a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);eo=a?parseInt(a[1]):0}if(Gg===null){const s=navigator.userAgent.match(/Safari\/(\d+)/i);Gg=s?parseInt(s[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e[0].pts,r=e.reduce((s,a)=>{let o=a.pts,l=o-s;return l<-4294967296&&(t=!0,o=Sr(o,i),l=o-s),l>0?s:o},i);return t&&this.logger.debug("PTS rollover detected"),r}remux(e,t,i,r,s,a,o,l){let u,h,d,p,g,m,y=s,b=s;const A=e.pid>-1,w=t.pid>-1,x=t.samples.length,N=e.samples.length>0,F=o&&x>0||x>1;if((!A||N)&&(!w||F)||this.ISGenerated||o){if(this.ISGenerated){var C,M,_,R;const Y=this.videoTrackConfig;(Y&&(t.width!==Y.width||t.height!==Y.height||((C=t.pixelRatio)==null?void 0:C[0])!==((M=Y.pixelRatio)==null?void 0:M[0])||((_=t.pixelRatio)==null?void 0:_[1])!==((R=Y.pixelRatio)==null?void 0:R[1]))||!Y&&F||this.nextAudioPts===null&&N)&&this.resetInitSegment()}this.ISGenerated||(d=this.generateIS(e,t,s,a));const U=this.isVideoContiguous;let q=-1,$;if(F&&(q=V_(t.samples),!U&&this.config.forceKeyFrameOnDiscontinuity))if(m=!0,q>0){this.logger.warn(`[mp4-remuxer]: Dropped ${q} out of ${x} video samples due to a missing keyframe`);const Y=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(q),t.dropped+=q,b+=(t.samples[0].pts-Y)/t.inputTimeScale,$=b}else q===-1&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${x} video samples`),m=!1);if(this.ISGenerated){if(N&&F){const Y=this.getVideoStartPts(t.samples),ne=(Sr(e.samples[0].pts,Y)-Y)/t.inputTimeScale;y+=Math.max(0,ne),b+=Math.max(0,-ne)}if(N){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),d=this.generateIS(e,t,s,a)),h=this.remuxAudio(e,y,this.isAudioContiguous,a,w||F||l===Oe.AUDIO?b:void 0),F){const Y=h?h.endPTS-h.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),d=this.generateIS(e,t,s,a)),u=this.remuxVideo(t,b,U,Y)}}else F&&(u=this.remuxVideo(t,b,U,0));u&&(u.firstKeyFrame=q,u.independent=q!==-1,u.firstKeyFramePTS=$)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(g=TA(i,s,this._initPTS,this._initDTS)),r.samples.length&&(p=wA(r,s,this._initPTS))),{audio:h,video:u,initSegment:d,independent:m,text:p,id3:g}}generateIS(e,t,i,r){const s=e.samples,a=t.samples,o=this.typeSupported,l={},u=this._initPTS;let h=!u||r,d="audio/mp4",p,g,m,y;if(h&&(p=g=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":o.mpeg?(d="audio/mpeg",e.codec=""):o.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3";break}l.audio={id:"audio",container:d,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&o.mpeg?new Uint8Array(0):Q.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(y=e.id,m=e.inputTimeScale,!u||m!==u.timescale?p=g=s[0].pts-Math.round(m*i):h=!1)}if(t.sps&&t.pps&&a.length){if(t.timescale=t.inputTimeScale,l.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Q.initSegment([t]),metadata:{width:t.width,height:t.height}},h)if(y=t.id,m=t.inputTimeScale,!u||m!==u.timescale){const b=this.getVideoStartPts(a),A=Math.round(m*i);g=Math.min(g,Sr(a[0].dts,b)-A),p=Math.min(p,b-A)}else h=!1;this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(l).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:p,timescale:m},this._initDTS={baseTime:g,timescale:m}):p=m=void 0,{tracks:l,initPTS:p,timescale:m,trackId:y}}remuxVideo(e,t,i,r){const s=e.inputTimeScale,a=e.samples,o=[],l=a.length,u=this._initPTS;let h=this.nextAvcDts,d=8,p=this.videoSampleDuration,g,m,y=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,A=!1;if(!i||h===null){const V=t*s,J=a[0].pts-Sr(a[0].dts,a[0].pts);eo&&h!==null&&Math.abs(V-J-h)<15e3?i=!0:h=V-J}const w=u.baseTime*s/u.timescale;for(let V=0;V<l;V++){const J=a[V];J.pts=Sr(J.pts-w,h),J.dts=Sr(J.dts-w,h),J.dts<a[V>0?V-1:V].dts&&(A=!0)}A&&a.sort(function(V,J){const ve=V.dts-J.dts,pe=V.pts-J.pts;return ve||pe}),g=a[0].dts,m=a[a.length-1].dts;const x=m-g,N=x?Math.round(x/(l-1)):p||e.inputTimeScale/30;if(i){const V=g-h,J=V>N,ve=V<-1;if((J||ve)&&(J?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${ml(V,!0)} ms (${V}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${ml(-V,!0)} ms (${V}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!ve||h>=a[0].pts||eo)){g=h;const pe=a[0].pts-V;if(J)a[0].dts=g,a[0].pts=pe;else{let Te=!0;for(let Ce=0;Ce<a.length&&!(a[Ce].dts>pe&&Te);Ce++){const Re=a[Ce].pts;if(a[Ce].dts-=V,a[Ce].pts-=V,Ce<a.length-1){const Be=a[Ce+1].pts,Ue=a[Ce].pts,Qe=Be<=Ue,Ze=Be<=Re;Te=Qe==Ze}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${ml(pe,!0)}/${ml(g,!0)}, delta: ${ml(V,!0)} ms`)}}g=Math.max(0,g);let F=0,L=0,C=g;for(let V=0;V<l;V++){const J=a[V],ve=J.units,pe=ve.length;let Te=0;for(let Ce=0;Ce<pe;Ce++)Te+=ve[Ce].data.length;L+=Te,F+=pe,J.length=Te,J.dts<C?(J.dts=C,C+=N/4|0||1):C=J.dts,y=Math.min(J.pts,y),b=Math.max(J.pts,b)}m=a[l-1].dts;const M=L+4*F+8;let _;try{_=new Uint8Array(M)}catch(V){this.observer.emit(T.ERROR,T.ERROR,{type:$e.MUX_ERROR,details:Z.REMUX_ALLOC_ERROR,fatal:!1,error:V,bytes:M,reason:`fail allocating video mdat ${M}`});return}const R=new DataView(_.buffer);R.setUint32(0,M),_.set(Q.types.mdat,4);let U=!1,q=Number.POSITIVE_INFINITY,$=Number.POSITIVE_INFINITY,Y=Number.NEGATIVE_INFINITY,ae=Number.NEGATIVE_INFINITY;for(let V=0;V<l;V++){const J=a[V],ve=J.units;let pe=0;for(let Re=0,Be=ve.length;Re<Be;Re++){const Ue=ve[Re],Qe=Ue.data,Ze=Ue.data.byteLength;R.setUint32(d,Ze),d+=4,_.set(Qe,d),d+=Ze,pe+=4+Ze}let Te;if(V<l-1)p=a[V+1].dts-J.dts,Te=a[V+1].pts-J.pts;else{const Re=this.config,Be=V>0?J.dts-a[V-1].dts:N;if(Te=V>0?J.pts-a[V-1].pts:N,Re.stretchShortVideoTrack&&this.nextAudioPts!==null){const Ue=Math.floor(Re.maxBufferHole*s),Qe=(r?y+r*s:this.nextAudioPts)-J.pts;Qe>Ue?(p=Qe-Be,p<0?p=Be:U=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${Qe/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=Be}else p=Be}const Ce=Math.round(J.pts-J.dts);q=Math.min(q,p),Y=Math.max(Y,p),$=Math.min($,Te),ae=Math.max(ae,Te),o.push(xA(J.key,p,pe,Ce))}if(o.length){if(eo){if(eo<70){const V=o[0].flags;V.dependsOn=2,V.isNonSync=0}}else if(Gg&&ae-$<Y-q&&N/Y<.025&&o[0].cts===0){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let V=g;for(let J=0,ve=o.length;J<ve;J++){const pe=V+o[J].duration,Te=V+o[J].cts;if(J<ve-1){const Ce=pe+o[J+1].cts;o[J].duration=Ce-Te}else o[J].duration=J?o[J-1].duration:N;o[J].cts=0,V=pe}}}p=U||!p?N:p,this.nextAvcDts=h=m+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;const re={data1:Q.moof(e.sequenceNumber++,g,Rt(e,{samples:o})),data2:_,startPTS:y/s,endPTS:(b+p)/s,startDTS:g/s,endDTS:h/s,type:"video",hasAudio:!1,hasVideo:!0,nb:o.length,dropped:e.dropped};return e.samples=[],e.dropped=0,re}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return G_;case"ac3":return q_;default:return $_}}remuxAudio(e,t,i,r,s){const a=e.inputTimeScale,o=e.samplerate?e.samplerate:a,l=a/o,u=this.getSamplesPerFrame(e),h=u*l,d=this._initPTS,p=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,g=[],m=s!==void 0;let y=e.samples,b=p?0:8,A=this.nextAudioPts||-1;const w=t*a,x=d.baseTime*a/d.timescale;if(this.isAudioContiguous=i=i||y.length&&A>0&&(r&&Math.abs(w-A)<9e3||Math.abs(Sr(y[0].pts-x,w)-A)<20*h),y.forEach(function(ne){ne.pts=Sr(ne.pts-x,w)}),!i||A<0){if(y=y.filter(ne=>ne.pts>=0),!y.length)return;s===0?A=0:r&&!m?A=Math.max(0,w):A=y[0].pts}if(e.segmentCodec==="aac"){const ne=this.config.maxAudioFramesDrift;for(let ce=0,re=A;ce<y.length;ce++){const V=y[ce],J=V.pts,ve=J-re,pe=Math.abs(1e3*ve/a);if(ve<=-ne*h&&m)ce===0&&(this.logger.warn(`Audio frame @ ${(J/a).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*ve/a)} ms.`),this.nextAudioPts=A=re=J);else if(ve>=ne*h&&pe<U_&&m){let Te=Math.round(ve/h);re=J-Te*h,re<0&&(Te--,re+=h),ce===0&&(this.nextAudioPts=A=re),this.logger.warn(`[mp4-remuxer]: Injecting ${Te} audio frame @ ${(re/a).toFixed(3)}s due to ${Math.round(1e3*ve/a)} ms gap.`);for(let Ce=0;Ce<Te;Ce++){const Re=Math.max(re,0);let Be=O_.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Be||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Be=V.unit.subarray()),y.splice(ce,0,{unit:Be,pts:Re}),re+=h,ce++}}V.pts=re,re+=h}}let N=null,F=null,L,C=0,M=y.length;for(;M--;)C+=y[M].unit.byteLength;for(let ne=0,ce=y.length;ne<ce;ne++){const re=y[ne],V=re.unit;let J=re.pts;if(F!==null){const pe=g[ne-1];pe.duration=Math.round((J-F)/l)}else if(i&&e.segmentCodec==="aac"&&(J=A),N=J,C>0){C+=b;try{L=new Uint8Array(C)}catch(pe){this.observer.emit(T.ERROR,T.ERROR,{type:$e.MUX_ERROR,details:Z.REMUX_ALLOC_ERROR,fatal:!1,error:pe,bytes:C,reason:`fail allocating audio mdat ${C}`});return}p||(new DataView(L.buffer).setUint32(0,C),L.set(Q.types.mdat,4))}else return;L.set(V,b);const ve=V.byteLength;b+=ve,g.push(xA(!0,u,ve,0)),F=J}const _=g.length;if(!_)return;const R=g[g.length-1];this.nextAudioPts=A=F+l*R.duration;const U=p?new Uint8Array(0):Q.moof(e.sequenceNumber++,N/l,Rt({},e,{samples:g}));e.samples=[];const q=N/a,$=A/a,ae={data1:U,data2:L,startPTS:q,endPTS:$,startDTS:q,endDTS:$,type:"audio",hasAudio:!0,hasVideo:!1,nb:_};return this.isAudioContiguous=!0,ae}}function Sr(n,e){let t;if(e===null)return n;for(e<n?t=-8589934592:t=8589934592;Math.abs(n-e)>4294967296;)n+=t;return n}function V_(n){for(let e=0;e<n.length;e++)if(n[e].key)return e;return-1}function TA(n,e,t,i){const r=n.samples.length;if(!r)return;const s=n.inputTimeScale;for(let o=0;o<r;o++){const l=n.samples[o];l.pts=Sr(l.pts-t.baseTime*s/t.timescale,e*s)/s,l.dts=Sr(l.dts-i.baseTime*s/i.timescale,e*s)/s}const a=n.samples;return n.samples=[],{samples:a}}function wA(n,e,t){const i=n.samples.length;if(!i)return;const r=n.inputTimeScale;for(let a=0;a<i;a++){const o=n.samples[a];o.pts=Sr(o.pts-t.baseTime*r/t.timescale,e*r)/r}n.samples.sort((a,o)=>a.pts-o.pts);const s=n.samples;return n.samples=[],{samples:s}}class H_{constructor(e,t,i,r){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=r}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,i,r){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(BN(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}const r=this.initData=X1(e);r.audio&&(t=DA(r.audio,Mt.AUDIO,this.logger)),r.video&&(i=DA(r.video,Mt.VIDEO,this.logger));const s={};r.audio&&r.video?s.audiovideo={container:"video/mp4",codec:t+","+i,supplemental:r.video.supplemental,initSegment:e,id:"main"}:r.audio?s.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?s.video={container:"video/mp4",codec:i,supplemental:r.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=s}remux(e,t,i,r,s,a){var o,l;let{initPTS:u,lastEndTime:h}=this;const d={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};_e(h)||(h=this.lastEndTime=s||0);const p=t.samples;if(!(p!=null&&p.length))return d;const g={initPTS:void 0,timescale:void 0,trackId:void 0};let m=this.initData;if((o=m)!=null&&o.length||(this.generateInitSegment(p),m=this.initData),!((l=m)!=null&&l.length))return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(g.tracks=this.initTracks,this.emitInitSegment=!1);const y=UN(p,m,this.logger),b=m.audio?y[m.audio.id]:null,A=m.video?y[m.video.id]:null,w=fc(A,1/0),x=fc(b,1/0),N=fc(A,0,!0),F=fc(b,0,!0);let L,C=s,M=0;if(b&&(!A||!u&&x<w||u&&u.trackId===m.audio.id)?(g.trackId=m.audio.id,L=b,M=F-x):A&&(g.trackId=m.video.id,L=A,M=N-w),L){const ne=L.timescale;C=L.start/ne,g.timescale=ne,u||(g.initPTS=L.start-s*ne,this.initPTS=u={baseTime:g.initPTS,timescale:ne,trackId:g.trackId})}(a||!u)&&(K_(u,C,s,M)||g.timescale!==u.timescale)&&(g.initPTS=C-s,u&&u.timescale===1&&this.logger.warn(`Adjusting initPTS @${s} from ${u.baseTime/u.timescale} to ${g.initPTS}`),this.initPTS=u={baseTime:g.initPTS,timescale:1});const _=e?C-u.baseTime/u.timescale:h;$N(m,p,u.baseTime/u.timescale);const R=_+M;M>0?this.lastEndTime=R:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const U=!!m.audio,q=!!m.video;let $="";U&&($+="audio"),q&&($+="video");const Y={data1:p,startPTS:_,startDTS:_,endPTS:R,endDTS:R,type:$,hasAudio:U,hasVideo:q,nb:1,dropped:0};d.audio=U&&!q?Y:void 0,d.video=q?Y:void 0;const ae=A==null?void 0:A.sampleCount;if(ae){const ne=A.keyFrameIndex,ce=ne!==-1;Y.nb=ae,Y.dropped=ne===0||this.isVideoContiguous?0:ce?ne:ae,Y.independent=ce,Y.firstKeyFrame=ne,ce&&A.keyFrameStart&&(Y.firstKeyFramePTS=A.keyFrameStart-u.baseTime/u.timescale),this.isVideoContiguous||(d.independent=ce),this.isVideoContiguous||(this.isVideoContiguous=ce),Y.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${ne}/${ae} dropped: ${Y.dropped} pts: ${Y.firstKeyFramePTS||"NA"}`)}return d.initSegment=g,d.id3=TA(i,s,u,u),r.samples.length&&(d.text=wA(r,s,u)),d}}function fc(n,e,t=!1){return(n==null?void 0:n.start)!==void 0?(n.start+(t?n.duration:0))/n.timescale:e}function K_(n,e,t,i){if(n===null)return!0;const r=Math.max(i,1),s=e-n.baseTime/n.timescale;return Math.abs(s-t)>r}function DA(n,e,t){const i=n==null?void 0:n.codec;return i&&i.length>4?i:e===Mt.AUDIO?i==="ec-3"||i==="ac-3"||i==="alac"?i:i==="fLaC"||i==="Opus"?Yu(i,!1):(t.warn(`Unhandled audio codec "${i}" in mp4 MAP`),i||"mp4a"):(t.warn(`Unhandled video codec "${i}" in mp4 MAP`),i||"avc1")}let Gn;try{Gn=self.performance.now.bind(self.performance)}catch{Gn=Date.now}const gc=[{demux:__,remux:H_},{demux:xs,remux:dc},{demux:I_,remux:dc},{demux:N_,remux:dc}];gc.splice(2,0,{demux:C_,remux:dc});class RA{constructor(e,t,i,r,s,a){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.id=s,this.logger=a}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,r){const s=i.transmuxing;s.executeStart=Gn();let a=new Uint8Array(e);const{currentTransmuxState:o,transmuxConfig:l}=this;r&&(this.currentTransmuxState=r);const{contiguous:u,discontinuity:h,trackSwitch:d,accurateTimeOffset:p,timeOffset:g,initSegmentChange:m}=r||o,{audioCodec:y,videoCodec:b,defaultInitPts:A,duration:w,initSegmentData:x}=l,N=W_(a,t);if(N&&Ja(N.method)){const M=this.getDecrypter(),_=Eg(N.method);if(M.isSync()){let R=M.softwareDecrypt(a,N.key.buffer,N.iv.buffer,_);if(i.part>-1){const q=M.flush();R=q&&q.buffer}if(!R)return s.executeEnd=Gn(),qg(i);a=new Uint8Array(R)}else return this.asyncResult=!0,this.decryptionPromise=M.webCryptoDecrypt(a,N.key.buffer,N.iv.buffer,_).then(R=>{const U=this.push(R,null,i);return this.decryptionPromise=null,U}),this.decryptionPromise}const F=this.needsProbing(h,d);if(F){const M=this.configureTransmuxer(a);if(M)return this.logger.warn(`[transmuxer] ${M.message}`),this.observer.emit(T.ERROR,T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_PARSING_ERROR,fatal:!1,error:M,reason:M.message}),s.executeEnd=Gn(),qg(i)}(h||d||m||F)&&this.resetInitSegment(x,y,b,w,t),(h||m||F)&&this.resetInitialTimestamp(A),u||this.resetContiguity();const L=this.transmux(a,N,g,p,i);this.asyncResult=yl(L);const C=this.currentTransmuxState;return C.contiguous=!0,C.discontinuity=!1,C.trackSwitch=!1,s.executeEnd=Gn(),L}flush(e){const t=e.transmuxing;t.executeStart=Gn();const{decrypter:i,currentTransmuxState:r,decryptionPromise:s}=this;if(s)return this.asyncResult=!0,s.then(()=>this.flush(e));const a=[],{timeOffset:o}=r;if(i){const d=i.flush();d&&a.push(this.push(d.buffer,null,e))}const{demuxer:l,remuxer:u}=this;if(!l||!u){t.executeEnd=Gn();const d=[qg(e)];return this.asyncResult?Promise.resolve(d):d}const h=l.flush(o);return yl(h)?(this.asyncResult=!0,h.then(d=>(this.flushRemux(a,d,e),a))):(this.flushRemux(a,h,e),this.asyncResult?Promise.resolve(a):a)}flushRemux(e,t,i){const{audioTrack:r,videoTrack:s,id3Track:a,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===Oe.MAIN?"level":"track"} ${i.level}`);const h=this.remuxer.remux(r,s,a,o,u,l,!0,this.id);e.push({remuxResult:h,chunkMeta:i}),i.transmuxing.executeEnd=Gn()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;!t||!i||(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;!e||!t||(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,r,s){const{demuxer:a,remuxer:o}=this;!a||!o||(a.resetInitSegment(e,t,i,r),o.resetInitSegment(e,t,i,s))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,r,s){let a;return t&&t.method==="SAMPLE-AES"?a=this.transmuxSampleAes(e,t,i,r,s):a=this.transmuxUnencrypted(e,i,r,s),a}transmuxUnencrypted(e,t,i,r){const{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(s,a,o,l,t,i,!1,this.id),chunkMeta:r}}transmuxSampleAes(e,t,i,r,s){return this.demuxer.demuxSampleAes(e,t,i).then(a=>({remuxResult:this.remuxer.remux(a.audioTrack,a.videoTrack,a.id3Track,a.textTrack,i,r,!1,this.id),chunkMeta:s}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:r}=this;let s;for(let d=0,p=gc.length;d<p;d++){var a;if((a=gc[d].demux)!=null&&a.probe(e,this.logger)){s=gc[d];break}}if(!s)return new Error("Failed to find demuxer by probing fragment data");const o=this.demuxer,l=this.remuxer,u=s.remux,h=s.demux;(!l||!(l instanceof u))&&(this.remuxer=new u(i,t,r,this.logger)),(!o||!(o instanceof h))&&(this.demuxer=new h(i,t,r,this.logger),this.probe=h.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new yg(this.config)),e}}function W_(n,e){let t=null;return n.byteLength>0&&(e==null?void 0:e.key)!=null&&e.iv!==null&&e.method!=null&&(t=e),t}const qg=n=>({remuxResult:{},chunkMeta:n});function yl(n){return"then"in n&&n.then instanceof Function}class Y_{constructor(e,t,i,r,s){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=s||null}}class z_{constructor(e,t,i,r,s,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=s,this.initSegmentChange=a}}let IA=0;class CA{constructor(e,t,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=IA++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=l=>{const u=l.data,h=this.hls;if(!(!h||!(u!=null&&u.event)||u.instanceNo!==this.instanceNo))switch(u.event){case"init":{var d;const p=(d=this.workerContext)==null?void 0:d.objectURL;p&&self.URL.revokeObjectURL(p);break}case"transmuxComplete":{this.handleTransmuxComplete(u.data);break}case"flush":{this.onFlush(u.data);break}case"workerLog":{h.logger[u.data.logType]&&h.logger[u.data.logType](u.data.message);break}default:{u.data=u.data||{},u.data.frag=this.frag,u.data.part=this.part,u.data.id=this.id,h.trigger(u.event,u.data);break}}},this.onWorkerError=l=>{if(!this.hls)return;const u=new Error(`${l.message}  (${l.filename}:${l.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:u})};const s=e.config;this.hls=e,this.id=t,this.useWorker=!!s.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;const a=(l,u)=>{u=u||{},u.frag=this.frag||void 0,l===T.ERROR&&(u=u,u.parent=this.id,u.part=this.part,this.error=u.error),this.hls.trigger(l,u)};this.observer=new Ng,this.observer.on(T.FRAG_DECRYPTED,a),this.observer.on(T.ERROR,a);const o=nE(s.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){const l=this.hls.logger;if(s.workerPath||e_()){try{s.workerPath?(l.log(`loading Web Worker ${s.workerPath} for "${t}"`),this.workerContext=i_(s.workerPath)):(l.log(`injecting Web Worker for "${t}"`),this.workerContext=t_());const{worker:h}=this.workerContext;h.addEventListener("message",this.onWorkerMessage),h.addEventListener("error",this.onWorkerError),h.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:o,id:t,config:zt(s)})}catch(h){l.warn(`Error setting up "${t}" Web Worker, fallback to inline`,h),this.terminateWorker(),this.error=null,this.transmuxer=new RA(this.observer,o,s,"",t,e.logger)}return}}this.transmuxer=new RA(this.observer,o,s,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=IA++;const t=this.hls.config,i=nE(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:i,id:this.id,config:zt(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),r_(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,i,r,s,a,o,l,u,h){var d,p;u.transmuxing.start=self.performance.now();const{instanceNo:g,transmuxer:m}=this,y=a?a.start:s.start,b=s.decryptdata,A=this.frag,w=!(A&&s.cc===A.cc),x=!(A&&u.level===A.level),N=A?u.sn-A.sn:-1,F=this.part?u.part-this.part.index:-1,L=N===0&&u.id>1&&u.id===(A==null?void 0:A.stats.chunkCount),C=!x&&(N===1||N===0&&(F===1||L&&F<=0)),M=self.performance.now();(x||N||s.stats.parsing.start===0)&&(s.stats.parsing.start=M),a&&(F||!C)&&(a.stats.parsing.start=M);const _=!(A&&((d=s.initSegment)==null?void 0:d.url)===((p=A.initSegment)==null?void 0:p.url)),R=new z_(w,C,l,x,y,_);if(!C||w||_){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${s.type} sn: ${u.sn}${u.part>-1?" part: "+u.part:""} ${this.id===Oe.MAIN?"level":"track"}: ${u.level} id: ${u.id}
        discontinuity: ${w}
        trackSwitch: ${x}
        contiguous: ${C}
        accurateTimeOffset: ${l}
        timeOffset: ${y}
        initSegmentChange: ${_}`);const U=new Y_(i,r,t,o,h);this.configureTransmuxer(U)}if(this.frag=s,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:g,cmd:"demux",data:e,decryptdata:b,chunkMeta:u,state:R},e instanceof ArrayBuffer?[e]:[]);else if(m){const U=m.push(e,b,u,R);yl(U)?U.then(q=>{this.handleTransmuxComplete(q)}).catch(q=>{this.transmuxerError(q,u,"transmuxer-interface push error")}):this.handleTransmuxComplete(U)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(i){const r=i.flush(e);yl(r)?r.then(s=>{this.handleFlushResult(s,e)}).catch(s=>{this.transmuxerError(s,e,"transmuxer-interface flush error")}):this.handleFlushResult(r,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(i=>{this.handleTransmuxComplete(i)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):i&&i.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}const NA=100;class j_ extends Ig{constructor(e,t,i){super(e,t,i,"audio-stream-controller",Oe.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.BUFFER_RESET,this.onBufferReset,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.BUFFER_RESET,this.onBufferReset,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){if(i===Oe.MAIN){const a=t.cc,o=this.fragCurrent;if(this.initPTS[a]={baseTime:r,timescale:s},this.log(`InitPTS for cc: ${a} found from main: ${r}/${s}`),this.mainAnchor=t,this.state===de.WAITING_INIT_PTS){const l=this.waitingData;(!l&&!this.loadingParts||l&&l.frag.cc!==a)&&this.syncWithAnchor(t,l==null?void 0:l.frag)}else!this.hls.hasEnoughToStart&&o&&o.cc!==a?(o.abortRequests(),this.syncWithAnchor(t,o)):this.state===de.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var i;const r=((i=this.mainFragLoading)==null?void 0:i.frag)||null;if(t&&(r==null?void 0:r.cc)===t.cc)return;const s=(r||e).cc,a=this.getLevelDetails(),o=this.getLoadPosition(),l=vE(a,s,o);l&&(this.log(`Waiting fragment cc (${t==null?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=l.start,this.resetLoadingState(),this.state===de.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=de.STOPPED;return}const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(NA),i>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i,this.state=de.IDLE):this.state=de.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case de.IDLE:this.doTickIdle();break;case de.WAITING_TRACK:{const{levels:t,trackId:i}=this,r=t==null?void 0:t[i],s=r==null?void 0:r.details;if(s&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(s))break;this.state=de.WAITING_INIT_PTS}break}case de.FRAG_LOADING_WAITING_RETRY:{var e;const t=performance.now(),i=this.retryDate;if(!i||t>=i||(e=this.media)!=null&&e.seeking){const{levels:r,trackId:s}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((r==null?void 0:r[s])||null),this.state=de.IDLE}break}case de.WAITING_INIT_PTS:{const t=this.waitingData;if(t){const{frag:i,part:r,cache:s,complete:a}=t,o=this.mainAnchor;if(this.initPTS[i.cc]!==void 0){this.waitingData=null,this.state=de.FRAG_LOADING;const l=s.flush().buffer,u={frag:i,part:r,payload:l,networkDetails:null};this._handleFragmentLoadProgress(u),a&&super._handleFragmentLoadComplete(u)}else o&&o.cc!==t.frag.cc&&this.syncWithAnchor(o,t.frag)}else this.state=de.IDLE}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:i,media:r,trackId:s}=this,a=t.config;if(!this.buffering||!r&&!this.primaryPrefetch&&(this.startFragRequested||!a.startFragPrefetch)||!(i!=null&&i[s]))return;const o=i[s],l=o.details;if(!l||this.waitForLive(o)||this.waitForCdnTuneIn(l)){this.state=de.WAITING_TRACK,this.startFragRequested=!1;return}const u=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&u&&(this.bufferFlushed=!1,this.afterBufferFlushed(u,Mt.AUDIO,Oe.AUDIO));const h=this.getFwdBufferInfo(u,Oe.AUDIO);if(h===null)return;if(!this.switchingTrack&&this._streamEnded(h,l)){t.trigger(T.BUFFER_EOS,{type:"audio"}),this.state=de.ENDED;return}const d=h.len,p=t.maxBufferLength,g=l.fragments,m=g[0].start,y=this.getLoadPosition(),b=this.flushing?y:h.end;if(this.switchingTrack&&r){const x=y;l.PTSKnown&&x<m&&(h.end>m||h.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),r.currentTime=m+.05)}if(d>=p&&!this.switchingTrack&&b<g[g.length-1].start)return;let A=this.getNextFragment(b,l);if(A&&this.isLoopLoading(A,b)&&(A=this.getNextFragmentLoopLoading(A,l,h,Oe.MAIN,p)),!A){this.bufferFlushed=!0;return}let w=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&w&&Ei(A)&&!A.endList&&(!l.live||!this.loadingParts&&b<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(w)===fi.OK&&(this.mainFragLoading=w=null),w&&Ei(w))){if(A.start>w.end){const N=this.fragmentTracker.getFragAtPos(b,Oe.MAIN);N&&N.end>w.end&&(w=N,this.mainFragLoading={frag:N,targetBufferTime:null})}if(A.start>w.end)return}this.loadFragment(A,o,b)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(i=>new ll(i))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==de.STOPPED&&(this.setInterval(NA),this.state=de.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(T.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(e,t){var i;const{levels:r}=this,{details:s,id:a,groupId:o,track:l}=t;if(!r){this.warn(`Audio tracks reset while loading track ${a} "${l.name}" of "${o}"`);return}const u=this.mainDetails;if(!u||s.endCC>u.endCC||u.expired){this.cachedTrackLoadedData=t,this.state!==de.STOPPED&&(this.state=de.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${a} "${l.name}" of "${o}" loaded [${s.startSN},${s.endSN}]${s.lastPartSn?`[part-${s.lastPartSn}-${s.lastPartIndex}]`:""},duration:${s.totalduration}`);const h=r[a];let d=0;if(s.live||(i=h.details)!=null&&i.live){if(this.checkLiveUpdate(s),s.deltaUpdateFailed)return;if(h.details){var p;d=this.alignPlaylists(s,h.details,(p=this.levelLastLoaded)==null?void 0:p.details)}s.alignedSliding||(eA(s,u),s.alignedSliding||oc(s,u),d=s.fragmentStart)}h.details=s,this.levelLastLoaded=h,this.startFragRequested||this.setStartPosition(u,d),this.hls.trigger(T.AUDIO_TRACK_UPDATED,{details:s,id:a,groupId:t.groupId}),this.state===de.WAITING_TRACK&&!this.waitForCdnTuneIn(s)&&(this.state=de.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:r,payload:s}=e,{config:a,trackId:o,levels:l}=this;if(!l){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const u=l[o];if(!u){this.warn("Audio track is undefined on fragment load progress");return}const h=u.details;if(!h){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}const d=a.defaultAudioCodec||u.audioCodec||"mp4a.40.2";let p=this.transmuxer;p||(p=this.transmuxer=new CA(this.hls,Oe.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const g=this.initPTS[i.cc],m=(t=i.initSegment)==null?void 0:t.data;if(g!==void 0){const b=r?r.index:-1,A=b!==-1,w=new vg(i.level,i.sn,i.stats.chunkCount,s.byteLength,b,A);p.push(s,m,d,"",i,r,h.totalduration,!1,w,g)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${h.startSN} ,${h.endSN}],track ${o}`);const{cache:y}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new iA,complete:!1};y.push(new Uint8Array(s)),this.state!==de.STOPPED&&(this.state=de.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Oe.MAIN&&Ei(t.frag)&&(this.mainFragLoading=t,this.state===de.IDLE&&this.tick())}onFragBuffered(e,t){const{frag:i,part:r}=t;if(i.type!==Oe.AUDIO){!this.audioOnly&&i.type===Oe.MAIN&&!i.elementaryStreams.video&&!i.elementaryStreams.audiovideo&&(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(Ei(i)){this.fragPrevious=i;const s=this.switchingTrack;s&&(this.bufferedTrack=s,this.switchingTrack=null,this.hls.trigger(T.AUDIO_TRACK_SWITCHED,xt({},s)))}this.fragBufferedComplete(i,r),this.media&&this.tick()}onError(e,t){var i;if(t.fatal){this.state=de.ERROR;return}switch(t.details){case Z.FRAG_GAP:case Z.FRAG_PARSING_ERROR:case Z.FRAG_DECRYPT_ERROR:case Z.FRAG_LOAD_ERROR:case Z.FRAG_LOAD_TIMEOUT:case Z.KEY_LOAD_ERROR:case Z.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Oe.AUDIO,t);break;case Z.AUDIO_TRACK_LOAD_ERROR:case Z.AUDIO_TRACK_LOAD_TIMEOUT:case Z.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===de.WAITING_TRACK&&((i=t.context)==null?void 0:i.type)===ct.AUDIO_TRACK&&(this.state=de.IDLE);break;case Z.BUFFER_ADD_CODEC_ERROR:case Z.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.resetLoadingState();break;case Z.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case Z.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onBufferFlushing(e,{type:t}){t!==Mt.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Mt.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===de.ENDED&&(this.state=de.IDLE);const i=this.mediaBuffer||this.media;i&&(this.afterBufferFlushed(i,t,Oe.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:h}=o,{details:d}=h,{audio:p,text:g,id3:m,initSegment:y}=s;if(this.fragContextChanged(l)||!d){this.fragmentTracker.removeFragment(l);return}if(this.state=de.PARSING,this.switchingTrack&&p&&this.completeAudioSwitch(this.switchingTrack),y!=null&&y.tracks){const b=l.initSegment||l;this._bufferInitSegment(h,y.tracks,b,a),r.trigger(T.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:i,tracks:y.tracks})}if(p){const{startPTS:b,endPTS:A,startDTS:w,endDTS:x}=p;u&&(u.elementaryStreams[Mt.AUDIO]={startPTS:b,endPTS:A,startDTS:w,endDTS:x}),l.setElementaryStreamInfo(Mt.AUDIO,b,A,w,x),this.bufferFragmentData(p,l,u,a)}if(m!=null&&(t=m.samples)!=null&&t.length){const b=Rt({id:i,frag:l,details:d},m);r.trigger(T.FRAG_PARSING_METADATA,b)}if(g){const b=Rt({id:i,frag:l,details:d},g);r.trigger(T.FRAG_PARSING_USERDATA,b)}}_bufferInitSegment(e,t,i,r){if(this.state!==de.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;const s=t.audio;s.id=Oe.AUDIO;const a=e.audioCodec;this.log(`Init audio buffer, container:${s.container}, codecs[level/parsed]=[${a}/${s.codec}]`),a&&a.split(",").length===1&&(s.levelCodec=a),this.hls.trigger(T.BUFFER_CODECS,t);const o=s.initSegment;if(o!=null&&o.byteLength){const l={type:"audio",frag:i,part:null,chunkMeta:r,parent:i.type,data:o};this.hls.trigger(T.BUFFER_APPENDING,l)}this.tickImmediate()}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);if(this.switchingTrack||r===fi.NOT_LOADED||r===fi.PARTIAL){var s;if(!Ei(e))this._loadInitSegment(e,t);else if((s=t.details)!=null&&s.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=de.WAITING_INIT_PTS;const a=this.mainDetails;a&&a.fragmentStart!==t.details.fragmentStart&&oc(t.details,a)}else super.loadFragment(e,t,i)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o}=this.bufferedTrack;ia({name:t,lang:i,assocLang:r,characteristics:s,audioCodec:a,channels:o},e,ra)||(Ju(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(T.AUDIO_TRACK_SWITCHED,xt({},e))}}class Vg extends Bn{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,i){const r=t==null?void 0:t.renditionReports;if(r){let s=-1;for(let a=0;a<r.length;a++){const o=r[a];let l;try{l=new self.URL(o.URI,t.url).href}catch(u){this.warn(`Could not construct new URL for Rendition Report: ${u}`),l=o.URI||""}if(l===e){s=a;break}else l===e.substring(0,l.length)&&(s=a)}if(s!==-1){const a=r[s],o=parseInt(a["LAST-MSN"])||(t==null?void 0:t.lastPartSn);let l=parseInt(a["LAST-PART"])||(t==null?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const h=Math.min(t.age-t.partTarget,t.targetduration);l>=0&&h>t.partTarget&&(l+=1)}const u=i&&cE(i);return new hE(o,l>=0?l:void 0,u)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(i){this.warn(`Could not construct new URL with HLS Delivery Directives: ${i}`)}return e}playlistLoaded(e,t,i){const{details:r,stats:s}=t,a=self.performance.now(),o=s.loading.first?Math.max(0,a-s.loading.first):0;r.advancedDateTime=Date.now()-o;const l=this.hls.config.timelineOffset;if(l!==r.appliedTimelineOffset){const h=Math.max(l||0,0);r.appliedTimelineOffset=h,r.fragments.forEach(d=>{d.start=d.playlistOffset+h})}if(r.live||i!=null&&i.live){const h="levelInfo"in t?t.levelInfo:t.track;if(r.reloaded(i),i&&r.fragments.length>0){HL(i,r);const w=r.playlistParsingError;if(w){this.warn(w);const x=this.hls;if(!x.config.ignorePlaylistParsingErrors){var u;const{networkDetails:N}=t;x.trigger(T.ERROR,{type:$e.NETWORK_ERROR,details:Z.LEVEL_PARSING_ERROR,fatal:!1,url:r.url,error:w,reason:w.message,level:t.level||void 0,parent:(u=r.fragments[0])==null?void 0:u.type,networkDetails:N,stats:s});return}r.playlistParsingError=null}}r.requestScheduled===-1&&(r.requestScheduled=s.loading.start);const d=this.hls.mainForwardBufferInfo,p=d?d.end-d.len:0,g=(r.edge-p)*1e3,m=YE(r,g);if(r.requestScheduled+m<a?r.requestScheduled=a:r.requestScheduled+=m,this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),!this.canLoad||!r.live)return;let y,b,A;if(r.canBlockReload&&r.endSN&&r.advanced){const w=this.hls.config.lowLatencyMode,x=r.lastPartSn,N=r.endSN,F=r.lastPartIndex,L=F!==-1,C=x===N;L?C?(b=N+1,A=w?0:F):(b=x,A=w?F+1:r.maxPartIndex):b=N+1;const M=r.age,_=M+r.ageHeader;let R=Math.min(_-r.partTarget,r.targetduration*1.5);if(R>0){if(_>r.targetduration*3)this.log(`Playlist last advanced ${M.toFixed(2)}s ago. Omitting segment and part directives.`),b=void 0,A=void 0;else if(i!=null&&i.tuneInGoal&&_-r.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${R} with playlist age: ${r.age}`),R=0;else{const U=Math.floor(R/r.targetduration);if(b+=U,A!==void 0){const q=Math.round(R%r.targetduration/r.partTarget);A+=q}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${M.toFixed(2)}s goal: ${R} skip sn ${U} to part ${A}`)}r.tuneInGoal=R}if(y=this.getDeliveryDirectives(r,t.deliveryDirectives,b,A),w||!C){r.requestScheduled=a,this.loadingPlaylist(h,y);return}}else(r.canBlockReload||r.canSkipUntil)&&(y=this.getDeliveryDirectives(r,t.deliveryDirectives,b,A));y&&b!==void 0&&r.canBlockReload&&(r.requestScheduled=s.loading.first+Math.max(m-o*2,m/2)),this.scheduleLoading(h,y,r)}else this.clearTimer()}scheduleLoading(e,t,i){const r=i||e.details;if(!r){this.loadingPlaylist(e,t);return}const s=self.performance.now(),a=r.requestScheduled;if(s>=a){this.loadingPlaylist(e,t);return}const o=a-s;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(o)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),o)}getDeliveryDirectives(e,t,i,r){let s=cE(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,s=Xu.No),new hE(i,r,s)}checkRetry(e){const t=e.details,i=Qu(e),r=e.errorAction,{action:s,retryCount:a=0,retryConfig:o}=r||{},l=!!r&&!!o&&(s===_i.RetryRequest||!r.resolved&&s===_i.SendAlternateToPenaltyBox);if(l){var u;if(a>=o.maxNumRetry)return!1;if(i&&(u=e.context)!=null&&u.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const h=mg(o,a);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),h),this.warn(`Retrying playlist loading ${a+1}/${o.maxNumRetry} after "${t}" in ${h}ms`)}e.levelRetry=!0,r.resolved=!0}return l}}function LA(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!vl(n[t].attrs,e[t].attrs))return!1;return!0}function vl(n,e,t){const i=n["STABLE-RENDITION-ID"];return i&&!t?i===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(r=>n[r]!==e[r])}function Hg(n,e){return e.label.toLowerCase()===n.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(n.lang||"").toLowerCase())}class X_ extends Vg{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(T.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:r,details:s}=t,a=this.tracksInGroup[i];if(!a||a.groupId!==r){this.warn(`Audio track with id:${i} and group:${r} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Audio track ${i} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(o=>(r==null?void 0:r.indexOf(o))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const o=this.tracks.filter(p=>!i||i.indexOf(p.groupId)!==-1);if(o.length)this.selectDefaultTrack&&!o.some(p=>p.default)&&(this.selectDefaultTrack=!1),o.forEach((p,g)=>{p.id=g});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=o;const l=this.hls.config.audioPreference;if(!s&&l){const p=pn(l,o,ra);if(p>-1)s=o[p];else{const g=pn(l,this.tracks);s=this.tracks[g]}}let u=this.findTrackId(s);u===-1&&s&&(u=this.findTrackId(null));const h={audioTracks:o};this.log(`Updating audio tracks, ${o.length} track(s) found in group(s): ${i==null?void 0:i.join(",")}`),this.hls.trigger(T.AUDIO_TRACKS_UPDATED,h);const d=this.trackId;if(u!==-1&&d===-1)this.setAudioTrack(u);else if(o.length&&d===-1){var a;const p=new Error(`No audio track selected for current audio group-ID(s): ${(a=this.groupIds)==null?void 0:a.join(",")} track count: ${o.length}`);this.warn(p.message),this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:p})}}}onError(e,t){t.fatal||!t.context||t.context.type===ct.AUDIO_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const r=this.currentTrack;if(r&&ia(e,r,ra))return r;const s=pn(e,this.tracksInGroup,ra);if(s>-1){const a=this.tracksInGroup[s];return this.setAudioTrack(s),a}else if(r){let a=t.loadLevel;a===-1&&(a=t.firstAutoLevel);const o=cL(e,t.levels,i,a,ra);if(o===-1)return null;t.nextLoadLevel=o}if(e.channels||e.audioCodec){const a=pn(e,i);if(a>-1)return i[a]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,r=t[e],s=r.details&&!r.details.live;if(e===this.trackId&&r===i&&s||(this.log(`Switching to audio-track ${e} "${r.name}" lang:${r.lang} group:${r.groupId} channels:${r.channels}`),this.trackId=e,this.currentTrack=r,this.hls.trigger(T.AUDIO_TRACK_SWITCHING,xt({},r)),s))return;const a=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(a)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if(!(this.selectDefaultTrack&&!r.default)&&(!e||ia(e,r,ra)))return i}if(e){const{name:i,lang:r,assocLang:s,characteristics:a,audioCodec:o,channels:l}=e;for(let u=0;u<t.length;u++){const h=t[u];if(ia({name:i,lang:r,assocLang:s,characteristics:a,audioCodec:o,channels:l},h,ra))return u}for(let u=0;u<t.length;u++){const h=t[u];if(vl(e.attrs,h.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return u}for(let u=0;u<t.length;u++){const h=t[u];if(vl(e.attrs,h.attrs,["LANGUAGE"]))return u}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&Ju(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,r=e.groupId,s=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading audio-track ${i} "${e.name}" lang:${e.lang} group:${r}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(T.AUDIO_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:t||null,track:e})}}class J_{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,i){if(this.queues===null||this.tracks===null)return;const r=this.queues[t];r.push(e),r.length===1&&!i&&this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const i={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const i={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(i)}})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const i=(t=e[0])==null?void 0:t.label;(i==="async-blocker"||i==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(this.queues===null)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;const t=this.queues[e];if(t.length){const r=t[0];try{r.execute()}catch(s){var i;if(r.onError(s),this.queues===null||this.tracks===null)return;const a=(i=this.tracks[e])==null?void 0:i.buffer;a!=null&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,i;return(t=this.queues)!=null&&t[e]||(i=this.tracks)!=null&&i[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const i=(t=this.tracks)==null?void 0:t[e],r=i==null?void 0:i.buffer;return r?`SourceBuffer${r.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(i=>i.label).join(", "))||""}}const _A=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,MA="HlsJsTrackRemovedError";class Q_ extends Error{constructor(e){super(e),this.name=MA}}class Z_ extends Bn{constructor(e,t){super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var r;this.hls&&((r=this.mediaSource)==null?void 0:r.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{const{media:r,mediaSource:s}=this;i&&this.log("Media source opened"),!(!r||!s)&&(s.removeEventListener("sourceopen",this._onMediaSourceOpen),r.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(T.MEDIA_ATTACHED,{media:r,mediaSource:s}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:i,_objectUrl:r}=this;i!==r&&this.error(`Media element src was set while attaching MediaSource (${r} > ${i})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=IN(As(e.config.preferManagedMediaSource)),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.BUFFER_RESET,this.onBufferReset,this),e.on(T.BUFFER_APPENDING,this.onBufferAppending,this),e.on(T.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T.BUFFER_EOS,this.onBufferEos,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.FRAG_PARSED,this.onFragParsed,this),e.on(T.FRAG_CHANGED,this.onFragChanged,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.BUFFER_RESET,this.onBufferReset,this),e.off(T.BUFFER_APPENDING,this.onBufferAppending,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.BUFFER_EOS,this.onBufferEos,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.FRAG_PARSED,this.onFragParsed,this),e.off(T.FRAG_CHANGED,this.onFragChanged,this),e.off(T.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const i={};if(this.operationQueue){const s=this.isUpdating();s||this.operationQueue.removeBlockers();const a=this.isQueued();(s||a)&&this.warn(`Transfering MediaSource with${a?" operations in queue":""}${s?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const r=this.transferData;return!this.sourceBufferCount&&r&&r.mediaSource===t?Rt(i,r.tracks):this.sourceBuffers.forEach(s=>{const[a]=s;a&&(i[a]=Rt({},this.tracks[a]),this.removeBuffer(a)),s[0]=s[1]=null}),{media:e,mediaSource:t,tracks:i}}initTracks(){const e={};this.sourceBuffers=[[null,null],[null,null]],this.tracks=e,this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var i;let r=2;(t.audio&&!t.video||!t.altAudio)&&(r=1),this.bufferCodecEventsTotal=r,this.log(`${r} bufferCodec event(s) expected.`),(i=this.transferData)!=null&&i.mediaSource&&this.sourceBufferCount&&r&&this.bufferCreated()}onMediaAttaching(e,t){const i=this.media=t.media,r=As(this.appendSource);if(this.transferData=this.overrides=void 0,i&&r){const s=!!t.mediaSource;(s||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new r;if(this.assignMediaSource(a),s)this._objectUrl=i.src,this.attachTransferred();else{const o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{i.removeAttribute("src");const l=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||l&&a instanceof l,kA(i),eM(i,o),i.load()}catch{i.src=o}else i.src=o}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,i;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(i=e.constructor)==null?void 0:i.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const i=this.tracks,r=t.tracks,s=r?Object.keys(r):null,a=s?s.length:0,o=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(r&&s&&a){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${zt(i,(l,u)=>l==="initSegment"?void 0:u)};
transfer tracks: ${zt(r,(l,u)=>l==="initSegment"?void 0:u)}}`),!q1(r,i)){t.mediaSource=null,t.tracks=void 0;const l=e.currentTime,u=this.details,h=Math.max(l,(u==null?void 0:u.fragments[0].start)||0);if(h-l>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${l} -> ${h}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(r)}"->"${Object.keys(i)}") start time: ${h} currentTime: ${l}`),this.onMediaDetaching(T.MEDIA_DETACHING,{}),this.onMediaAttaching(T.MEDIA_ATTACHING,t),e.currentTime=h;return}this.transferData=void 0,s.forEach(l=>{const u=l,h=r[u];if(h){const d=h.buffer;if(d){const p=this.fragmentTracker,g=h.id;if(p.hasFragments(g)||p.hasParts(g)){const b=Je.getBuffered(d);p.detectEvictedFragments(u,b,g,null,!0)}const m=Kg(u),y=[u,d];this.sourceBuffers[m]=y,d.updating&&this.operationQueue&&this.operationQueue.prependBlocker(u),this.trackSourceBuffer(u,h)}}}),o(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),o()}get mediaSourceOpenOrEnded(){var e;const t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){const i=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:r,mediaSource:s,_objectUrl:a}=this;if(s){if(this.log(`media source ${i?"transferring":"detaching"}`),i)this.sourceBuffers.forEach(([o])=>{o&&this.removeBuffer(o)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const o=s.readyState==="open";try{const l=s.sourceBuffers;for(let u=l.length;u--;)o&&l[u].abort(),s.removeSourceBuffer(l[u]);o&&s.endOfStream()}catch(l){this.warn(`onMediaDetaching: ${l.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}s.removeEventListener("sourceopen",this._onMediaSourceOpen),s.removeEventListener("sourceended",this._onMediaSourceEnded),s.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(s.removeEventListener("startstreaming",this._onStartStreaming),s.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}r&&(r.removeEventListener("emptied",this._onMediaEmptied),i||(a&&self.URL.revokeObjectURL(a),this.mediaSrc===a?(r.removeAttribute("src"),this.appendSource&&kA(r),r.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(T.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const i=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),i)try{var r;(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(s){this.warn(`onBufferReset ${e}`,s)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Kg(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new J_(this.tracks)}onBufferCodecs(e,t){const i=this.tracks,r=Object.keys(t);this.log(`BUFFER_CODECS: "${r}" (current SB count ${this.sourceBufferCount})`);const s="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),a=!s&&this.sourceBufferCount&&this.media&&r.some(o=>!i[o]);if(s||a){this.warn(`Unsupported transition between "${Object.keys(i)}" and "${r}" SourceBuffers`);return}r.forEach(o=>{var l,u,h;const d=t[o],{id:p,codec:g,levelCodec:m,container:y,metadata:b,supplemental:A}=d;let w=i[o];const x=(l=this.transferData)==null||(u=l.tracks)==null?void 0:u[o],N=x!=null&&x.buffer?x:w,F=(N==null?void 0:N.pendingCodec)||(N==null?void 0:N.codec),L=N==null?void 0:N.levelCodec;w||(w=i[o]={buffer:void 0,listeners:[],codec:g,supplemental:A,container:y,levelCodec:m,metadata:b,id:p});const C=zu(F,L),M=C==null?void 0:C.replace(_A,"$1");let _=zu(g,m);const R=(h=_)==null?void 0:h.replace(_A,"$1");_&&C&&M!==R&&(o.slice(0,5)==="audio"&&(_=Yu(_,this.appendSource)),this.log(`switching codec ${F} to ${_}`),_!==(w.pendingCodec||w.codec)&&(w.pendingCodec=_),w.container=y,this.appendChangeType(o,y,_))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const i=this.tracks[t];return e[t]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},e},{})}appendChangeType(e,t,i){const r=`${t};codecs=${i}`,s={label:`change-type=${r}`,execute:()=>{const a=this.tracks[e];if(a){const o=a.buffer;o!=null&&o.changeType&&(this.log(`changing ${e} sourceBuffer type to ${r}`),o.changeType(r),a.codec=i,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:a=>{this.warn(`Failed to change ${e} SourceBuffer type`,a)}};this.append(s,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const i=e.start,r=i+e.duration*.05;if(((t=this.fragmentTracker.getAppendedFrag(i,Oe.MAIN))==null?void 0:t.gap)===!0)return;const a={label:"block-audio",execute:()=>{var o;const l=this.tracks.video;(this.lastVideoAppendEnd>r||l!=null&&l.buffer&&Je.isBuffered(l.buffer,r)||((o=this.fragmentTracker.getAppendedFrag(r,Oe.MAIN))==null?void 0:o.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:o=>{this.warn("Error executing block-audio operation",o)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:i}=this,{data:r,type:s,parent:a,frag:o,part:l,chunkMeta:u}=t,h=u.buffering[s],d=o.sn,p=self.performance.now();h.start=p;const g=o.stats.buffering,m=l?l.stats.buffering:null;g.start===0&&(g.start=p),m&&m.start===0&&(m.start=p);const y=i.audio;let b=!1;s==="audio"&&(y==null?void 0:y.container)==="audio/mpeg"&&(b=!this.lastMpegAudioChunk||u.id===1||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);const A=this.tracks.video,w=A==null?void 0:A.buffer;if(w&&d!=="initSegment"){const F=l||o,L=this.blockedAudioAppend;if(s==="audio"&&a!=="main"&&!this.blockedAudioAppend){const M=F.start+F.duration*.05,_=w.buffered,R=this.currentOp("video");!_.length&&!R?this.blockAudio(F):!R&&!Je.isBuffered(w,M)&&this.lastVideoAppendEnd<M&&this.blockAudio(F)}else if(s==="video"){const C=F.end;if(L){const M=L.frag.start;(C>M||C<this.lastVideoAppendEnd||Je.isBuffered(w,M))&&this.unblockAudio()}this.lastVideoAppendEnd=C}}const x=(l||o).start,N={label:`append-${s}`,execute:()=>{if(h.executeStart=self.performance.now(),b){const F=this.tracks[s];if(F){const L=F.buffer;if(L){const C=x-L.timestampOffset;Math.abs(C)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${x} (delta: ${C}) sn: ${d})`),L.timestampOffset=x)}}}this.appendExecutor(r,s)},onStart:()=>{},onComplete:()=>{const F=self.performance.now();h.executeEnd=h.end=F,g.first===0&&(g.first=F),m&&m.first===0&&(m.first=F);const L={};this.sourceBuffers.forEach(([C,M])=>{C&&(L[C]=Je.getBuffered(M))}),this.appendErrors[s]=0,s==="audio"||s==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(T.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:L})},onError:F=>{var L;const C={type:$e.MEDIA_ERROR,parent:o.type,details:Z.BUFFER_APPEND_ERROR,sourceBufferName:s,frag:o,part:l,chunkMeta:u,error:F,err:F,fatal:!1},M=(L=this.media)==null?void 0:L.error;if(F.code===DOMException.QUOTA_EXCEEDED_ERR)C.details=Z.BUFFER_FULL_ERROR;else if(F.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!M)C.errorAction=ul(!0);else if(F.name===MA&&this.sourceBufferCount===0)C.errorAction=ul(!0);else{const _=++this.appendErrors[s];this.warn(`Failed ${_}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${s}" sourceBuffer (${M||"no media error"})`),(_>=this.hls.config.appendErrorMaxRetry||M)&&(C.fatal=!0)}this.hls.trigger(T.ERROR,C)}};this.append(N,s,this.isPending(this.tracks[s]))}getFlushOp(e,t,i){return this.log(`queuing "${e}" remove ${t}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(T.BUFFER_FLUSHED,{type:e})},onError:r=>{this.warn(`Failed to remove ${t}-${i} from "${e}" SourceBuffer`,r)}}}onBufferFlushing(e,t){const{type:i,startOffset:r,endOffset:s}=t;i?this.append(this.getFlushOp(i,r,s),i):this.sourceBuffers.forEach(([a])=>{a&&this.append(this.getFlushOp(a,r,s),a)})}onFragParsed(e,t){const{frag:i,part:r}=t,s=[],a=r?r.elementaryStreams:i.elementaryStreams;a[Mt.AUDIOVIDEO]?s.push("audiovideo"):(a[Mt.AUDIO]&&s.push("audio"),a[Mt.VIDEO]&&s.push("video"));const o=()=>{const l=self.performance.now();i.stats.buffering.end=l,r&&(r.stats.buffering.end=l);const u=r?r.stats:i.stats;this.hls.trigger(T.FRAG_BUFFERED,{frag:i,part:r,stats:u,id:i.type})};s.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(o,s).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,i;return e&&(!((t=this.tracks[e])!=null&&t.ended)||((i=this.tracks[e])==null?void 0:i.ending))})}onBufferEos(e,t){var i;this.sourceBuffers.forEach(([a])=>{if(a){const o=this.tracks[a];(!t.type||t.type===a)&&(o.ending=!0,o.ended||(o.ended=!0,this.log(`${a} buffer reached EOS`)))}});const r=((i=this.overrides)==null?void 0:i.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var o;return a&&!((o=this.tracks[a])!=null&&o.ended)})&&(r?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(T.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(T.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===Z.BUFFER_APPEND_ERROR&&t.frag){var i;const r=(i=t.errorAction)==null?void 0:i.nextAutoLevel;_e(r)&&r!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||t===null||!this.sourceBufferCount)return;const r=e.config,s=i.currentTime,a=t.levelTargetDuration,o=t.live&&r.liveBackBufferLength!==null?r.liveBackBufferLength:r.backBufferLength;if(_e(o)&&o>=0){const l=Math.max(o,a),u=Math.floor(s/a)*a-l;this.flushBackBuffer(s,a,u)}if(_e(r.frontBufferFlushThreshold)&&r.frontBufferFlushThreshold>0){const l=Math.max(r.maxBufferLength,r.frontBufferFlushThreshold),u=Math.max(l,a),h=Math.floor(s/a)*a+u;this.flushFrontBuffer(s,a,h)}}flushBackBuffer(e,t,i){this.sourceBuffers.forEach(([r,s])=>{if(s){const o=Je.getBuffered(s);if(o.length>0&&i>o.start(0)){var a;this.hls.trigger(T.BACK_BUFFER_REACHED,{bufferEnd:i});const l=this.tracks[r];if((a=this.details)!=null&&a.live)this.hls.trigger(T.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(l!=null&&l.ended){this.log(`Cannot flush ${r} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:r})}}})}flushFrontBuffer(e,t,i){this.sourceBuffers.forEach(([r,s])=>{if(s){const a=Je.getBuffered(s),o=a.length;if(o<2)return;const l=a.start(o-1),u=a.end(o-1);if(i>l||e>=l&&e<=u)return;this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:l,endOffset:1/0,type:r})}})}getDurationAndRange(){var e;const{details:t,mediaSource:i}=this;if(!t||!this.media||(i==null?void 0:i.readyState)!=="open")return null;const r=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&i.setLiveSeekableRange){const u=Math.max(0,t.fragmentStart),h=Math.max(u,r);return{duration:1/0,start:u,end:h}}return{duration:1/0}}const s=(e=this.overrides)==null?void 0:e.duration;if(s)return _e(s)?{duration:s}:null;const a=this.media.duration,o=_e(i.duration)?i.duration:0;return r>o&&r>a||!_e(a)?{duration:r}:null}updateMediaSource({duration:e,start:t,end:i}){const r=this.mediaSource;!this.media||!r||r.readyState!=="open"||(r.duration!==e&&(_e(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),r.duration=e),t!==void 0&&i!==void 0&&(this.log(`MediaSource duration is set to ${r.duration}. Setting seekable range to ${t}-${i}.`),r.setLiveSeekableRange(t,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${zt(i)}`),this.tracksReady){var r;const s=(r=this.transferData)==null?void 0:r.tracks;s&&Object.keys(s).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,i])=>{if(t){const r=this.tracks[t];e[t]={buffer:i,container:r.container,codec:r.codec,supplemental:r.supplemental,levelCodec:r.levelCodec,id:r.id,metadata:r.metadata}}}),this.hls.trigger(T.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const s in e){const a=s,o=e[a];if(this.isPending(o)){const l=this.getTrackCodec(o,a),u=`${o.container};codecs=${l}`;o.codec=l,this.log(`creating sourceBuffer(${u})${this.currentOp(a)?" Queued":""} ${zt(o)}`);try{const h=i.addSourceBuffer(u),d=Kg(a),p=[a,h];t[d]=p,o.buffer=h}catch(h){var r;this.error(`error while trying to add sourceBuffer: ${h.message}`),this.shiftAndExecuteNext(a),(r=this.operationQueue)==null||r.removeBlockers(),delete this.tracks[a],this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:h,sourceBufferName:a,mimeType:u,parent:o.id});return}this.trackSourceBuffer(a,o)}}this.bufferCreated()}getTrackCodec(e,t){const i=e.supplemental;let r=e.codec;i&&(t==="video"||t==="audiovideo")&&fg(i,"video")&&(r=XN(r,i));const s=zu(r,e.levelCodec);return s?t.slice(0,5)==="audio"?Yu(s,this.appendSource):s:""}trackSourceBuffer(e,t){const i=t.buffer;if(!i)return;const r=this.getTrackCodec(t,e);this.tracks[e]={buffer:i,codec:r,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(s,a)=>{const o=a.removedRanges;o!=null&&o.length&&this.hls.trigger(T.BUFFER_FLUSHED,{type:s})})}get mediaSrc(){var e,t;const i=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return i==null?void 0:i.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}const i=this.currentOp(e);i&&(i.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var i;const r=new Error(`${e} SourceBuffer error. MediaSource readyState: ${(i=this.mediaSource)==null?void 0:i.readyState}`);this.error(`${r}`,t),this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:r,fatal:!1});const s=this.currentOp(e);s&&s.onError(r)}removeExecutor(e,t,i){const{media:r,mediaSource:s}=this,a=this.tracks[e],o=a==null?void 0:a.buffer;if(!r||!s||!o){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}const l=_e(r.duration)?r.duration:1/0,u=_e(s.duration)?s.duration:1/0,h=Math.max(0,t),d=Math.min(i,l,u);d>h&&(!a.ending||a.ended)?(a.ended=!1,this.log(`Removing [${h},${d}] from the ${e} SourceBuffer`),o.remove(h,d)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.tracks[t],r=i==null?void 0:i.buffer;if(!r)throw new Q_(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,r.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:i}=this,r=t.map(a=>this.appendBlocker(a));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(r).then(a=>{i===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var i;const r=(i=this.tracks[t])==null?void 0:i.buffer;!r||r.updating||this.shiftAndExecuteNext(t)})}append(e,t,i){this.operationQueue&&this.operationQueue.append(e,t,i)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,i){const r=this.tracks[e];if(!r)return;const s=r.buffer;if(!s)return;const a=i.bind(this,e);r.listeners.push({event:t,listener:a}),s.addEventListener(t,a)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const i=t.buffer;i&&(t.listeners.forEach(r=>{i.removeEventListener(r.event,r.listener)}),t.listeners.length=0)}}function kA(n){const e=n.querySelectorAll("source");[].slice.call(e).forEach(t=>{n.removeChild(t)})}function eM(n,e){const t=self.document.createElement("source");t.type="video/mp4",t.src=e,n.appendChild(t)}function Kg(n){return n==="audio"?1:0}class Wg{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(T.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.BUFFER_CODECS,this.onBufferCodecs,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(T.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&_e(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((r,s)=>this.isLevelAllowed(r)&&s<=e);return this.clientRect=null,Wg.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,!t.width&&!t.height&&(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(i=>e.bitrate===i.bitrate&&e.width===i.width&&e.height===i.height)}static getMaxLevelByMediaSize(e,t,i){if(!(e!=null&&e.length))return-1;const r=(o,l)=>l?o.width!==l.width||o.height!==l.height:!0;let s=e.length-1;const a=Math.max(t,i);for(let o=0;o<e.length;o+=1){const l=e[o];if((l.width>=a||l.height>=a)&&r(l,e[o+1])){s=o;break}}return s}}const er={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},tM={HLS:"h"},bl={OBJECT:"CMCD-Object",REQUEST:"CMCD-Request",SESSION:"CMCD-Session",STATUS:"CMCD-Status"},iM={[bl.OBJECT]:["br","d","ot","tb"],[bl.REQUEST]:["bl","dl","mtp","nor","nrr","su"],[bl.SESSION]:["cid","pr","sf","sid","st","v"],[bl.STATUS]:["bs","rtp"]};class to{constructor(e,t){Array.isArray(e)&&(e=e.map(i=>i instanceof to?i:new to(i))),this.value=e,this.params=t}}const rM="Dict";function nM(n){return Array.isArray(n)?JSON.stringify(n):n instanceof Map?"Map{}":n instanceof Set?"Set{}":typeof n=="object"?JSON.stringify(n):String(n)}function sM(n,e,t,i){return new Error(`failed to ${n} "${nM(e)}" as ${t}`,{cause:i})}function vn(n,e,t){return sM("serialize",n,e,t)}class PA{constructor(e){this.description=e}}const OA="Bare Item",aM="Boolean";function oM(n){if(typeof n!="boolean")throw vn(n,aM);return n?"?1":"?0"}function lM(n){return btoa(String.fromCharCode(...n))}const uM="Byte Sequence";function cM(n){if(ArrayBuffer.isView(n)===!1)throw vn(n,uM);return`:${lM(n)}:`}const hM="Integer";function dM(n){return n<-999999999999999||999999999999999<n}function FA(n){if(dM(n))throw vn(n,hM);return n.toString()}function fM(n){return`@${FA(n.getTime()/1e3)}`}function BA(n,e){if(n<0)return-BA(-n,e);const t=Math.pow(10,e);if(Math.abs(n*t%1-.5)<Number.EPSILON){const r=Math.floor(n*t);return(r%2===0?r:r+1)/t}else return Math.round(n*t)/t}const gM="Decimal";function pM(n){const e=BA(n,3);if(Math.floor(Math.abs(e)).toString().length>12)throw vn(n,gM);const t=e.toString();return t.includes(".")?t:`${t}.0`}const mM="String",yM=/[\x00-\x1f\x7f]+/;function vM(n){if(yM.test(n))throw vn(n,mM);return`"${n.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}function bM(n){return n.description||n.toString().slice(7,-1)}const EM="Token";function UA(n){const e=bM(n);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw vn(e,EM);return e}function Yg(n){switch(typeof n){case"number":if(!_e(n))throw vn(n,OA);return Number.isInteger(n)?FA(n):pM(n);case"string":return vM(n);case"symbol":return UA(n);case"boolean":return oM(n);case"object":if(n instanceof Date)return fM(n);if(n instanceof Uint8Array)return cM(n);if(n instanceof PA)return UA(n);default:throw vn(n,OA)}}const AM="Key";function zg(n){if(/^[a-z*][a-z0-9\-_.*]*$/.test(n)===!1)throw vn(n,AM);return n}function jg(n){return n==null?"":Object.entries(n).map(([e,t])=>t===!0?`;${zg(e)}`:`;${zg(e)}=${Yg(t)}`).join("")}function $A(n){return n instanceof to?`${Yg(n.value)}${jg(n.params)}`:Yg(n)}function SM(n){return`(${n.value.map($A).join(" ")})${jg(n.params)}`}function xM(n,e={whitespace:!0}){if(typeof n!="object")throw vn(n,rM);const t=n instanceof Map?n.entries():Object.entries(n),i=e!=null&&e.whitespace?" ":"";return Array.from(t).map(([r,s])=>{s instanceof to||(s=new to(s));let a=zg(r);return s.value===!0?a+=jg(s.params):(a+="=",Array.isArray(s.value)?a+=SM(s):a+=$A(s)),a}).join(`,${i}`)}function TM(n,e){return xM(n,e)}function wM(n){return n==="ot"||n==="sf"||n==="st"}function DM(n){return typeof n=="number"?_e(n):n!=null&&n!==""&&n!==!1}function RM(n,e){const t=new URL(n),i=new URL(e);if(t.origin!==i.origin)return n;const r=t.pathname.split("/").slice(1),s=i.pathname.split("/").slice(1,-1);for(;r[0]===s[0];)r.shift(),s.shift();for(;s.length;)s.shift(),r.unshift("..");return r.join("/")}const pc=n=>Math.round(n),IM=(n,e)=>(e!=null&&e.baseUrl&&(n=RM(n,e.baseUrl)),encodeURIComponent(n)),mc=n=>pc(n/100)*100,CM={br:pc,d:pc,bl:mc,dl:mc,mtp:mc,nor:IM,rtp:mc,tb:pc};function NM(n,e){const t={};if(n==null||typeof n!="object")return t;const i=Object.keys(n).sort(),r=Rt({},CM,e==null?void 0:e.formatters),s=e==null?void 0:e.filter;return i.forEach(a=>{if(s!=null&&s(a))return;let o=n[a];const l=r[a];l&&(o=l(o,e)),!(a==="v"&&o===1)&&(a=="pr"&&o===1||DM(o)&&(wM(a)&&typeof o=="string"&&(o=new PA(o)),t[a]=o))}),t}function GA(n,e={}){return n?TM(NM(n,e),Rt({whitespace:!1},e)):""}function LM(n,e={}){const t={};if(!n)return t;const i=Object.entries(n),r=Object.entries(iM).concat(Object.entries((e==null?void 0:e.customHeaderMap)||{})),s=i.reduce((a,o)=>{var l,u;const[h,d]=o,p=((l=r.find(g=>g[1].includes(h)))===null||l===void 0?void 0:l[0])||bl.REQUEST;return(u=a[p])!==null&&u!==void 0||(a[p]={}),a[p][h]=d,a},{});return Object.entries(s).reduce((a,[o,l])=>(a[o]=GA(l,e),a),t)}function _M(n,e,t){return Rt(n,LM(e,t))}const MM="CMCD";function kM(n,e={}){if(!n)return"";const t=GA(n,e);return`${MM}=${encodeURIComponent(t)}`}const qA=/CMCD=[^&#]+/;function PM(n,e,t){const i=kM(e,t);if(!i)return n;if(qA.test(n))return n.replace(qA,i);const r=n.includes("?")?"&":"?";return`${n}${r}${i}`}class OM{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=r=>{try{this.apply(r,{ot:er.MANIFEST,su:!this.initialized})}catch(s){this.hls.logger.warn("Could not generate manifest CMCD data.",s)}},this.applyFragmentData=r=>{try{const{frag:s,part:a}=r,o=this.hls.levels[s.level],l=this.getObjectType(s),u={d:(a||s).duration*1e3,ot:l};(l===er.VIDEO||l===er.AUDIO||l==er.MUXED)&&(u.br=o.bitrate/1e3,u.tb=this.getTopBandwidth(l)/1e3,u.bl=this.getBufferLength(l));const h=a?this.getNextPart(a):this.getNextFrag(s);h!=null&&h.url&&h.url!==s.url&&(u.nor=h.url),this.apply(r,u)}catch(s){this.hls.logger.warn("Could not generate segment CMCD data.",s)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;i!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=i.useHeaders===!0,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHED,this.onMediaDetached,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHED,this.onMediaDetached,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,r;this.audioBuffer=(i=t.tracks.audio)==null?void 0:i.buffer,this.videoBuffer=(r=t.tracks.video)==null?void 0:r.buffer}createData(){var e;return{v:1,sf:tM.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Rt(t,this.createData());const i=t.ot===er.INIT||t.ot===er.VIDEO||t.ot===er.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);const{includeKeys:r}=this;r&&(t=Object.keys(t).reduce((a,o)=>(r.includes(o)&&(a[o]=t[o]),a),{}));const s={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),_M(e.headers,t,s)):e.url=PM(e.url,t,s)}getNextFrag(e){var t;const i=(t=this.hls.levels[e.level])==null?void 0:t.details;if(i){const r=e.sn-i.startSN;return i.fragments[r+1]}}getNextPart(e){var t,i;const{index:r,fragment:s}=e,a=(t=this.hls.levels[s.level])==null||(i=t.details)==null?void 0:i.partList;if(a){const{sn:o}=s;for(let l=a.length-1;l>=0;l--){const u=a[l];if(u.index===r&&u.fragment.sn===o)return a[l+1]}}}getObjectType(e){const{type:t}=e;if(t==="subtitle")return er.TIMED_TEXT;if(e.sn==="initSegment")return er.INIT;if(t==="audio")return er.AUDIO;if(t==="main")return this.hls.audioTracks.length?er.VIDEO:er.MUXED}getTopBandwidth(e){let t=0,i;const r=this.hls;if(e===er.AUDIO)i=r.audioTracks;else{const s=r.maxAutoLevel,a=s>-1?s+1:r.levels.length;i=r.levels.slice(0,a)}return i.forEach(s=>{s.bitrate>t&&(t=s.bitrate)}),t>0?t:NaN}getBufferLength(e){const t=this.media,i=e===er.AUDIO?this.audioBuffer:this.videoBuffer;return!i||!t?NaN:Je.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len*1e3}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(s){this.loader=void 0,this.loader=new i(s)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(s,a,o){t(s),this.loader.load(s,a,o)}}}}const FM=3e5;class BM extends Bn{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=this.timeToLoad*1e3-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(i=>i!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;i!==null&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((i==null?void 0:i.action)===_i.SendAlternateToPenaltyBox&&i.flags===Fr.MoveAllAlternatesMatchingHost){const r=this.levels;let s=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:o,pathwayId:l,type:u}=t.context;o&&r?a=this.getPathwayForGroupId(o,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&r&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),i.resolved=this.pathwayId!==a),i.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${r&&r.length} priorities: ${zt(s)} penalized: ${zt(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){this._pathwayPriority=e;let t;const i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(s=>{r-i[s]>FM&&delete i[s]});for(let s=0;s<e.length;s++){const a=e[s];if(a in i)continue;if(a===this.pathwayId)return;const o=this.hls.nextLoadLevel,l=this.hls.levels[o];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,JE(t),this.hls.trigger(T.LEVELS_UPDATED,{levels:t});const u=this.hls.levels[o];l&&u&&this.levels&&(u.attrs["STABLE-VARIANT-ID"]!==l.attrs["STABLE-VARIANT-ID"]&&u.bitrate!==l.bitrate&&this.log(`Unstable Pathways change from bitrate ${l.bitrate} to ${u.bitrate}`),this.hls.nextLoadLevel=o);break}}}getPathwayForGroupId(e,t,i){const r=this.getLevelsForPathway(i).concat(this.levels||[]);for(let s=0;s<r.length;s++)if(t===ct.AUDIO_TRACK&&r[s].hasAudioGroup(e)||t===ct.SUBTITLE_TRACK&&r[s].hasSubtitleGroup(e))return r[s].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},r={};e.forEach(s=>{const{ID:a,"BASE-ID":o,"URI-REPLACEMENT":l}=s;if(t.some(h=>h.pathwayId===a))return;const u=this.getLevelsForPathway(o).map(h=>{const d=new Jt(h.attrs);d["PATHWAY-ID"]=a;const p=d.AUDIO&&`${d.AUDIO}_clone_${a}`,g=d.SUBTITLES&&`${d.SUBTITLES}_clone_${a}`;p&&(i[d.AUDIO]=p,d.AUDIO=p),g&&(r[d.SUBTITLES]=g,d.SUBTITLES=g);const m=HA(h.uri,d["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),y=new ll({attrs:d,audioCodec:h.audioCodec,bitrate:h.bitrate,height:h.height,name:h.name,url:m,videoCodec:h.videoCodec,width:h.width});if(h.audioGroups)for(let b=1;b<h.audioGroups.length;b++)y.addGroupId("audio",`${h.audioGroups[b]}_clone_${a}`);if(h.subtitleGroups)for(let b=1;b<h.subtitleGroups.length;b++)y.addGroupId("text",`${h.subtitleGroups[b]}_clone_${a}`);return y});t.push(...u),VA(this.audioTracks,i,l,a),VA(this.subtitleTracks,r,l,a)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;this.loader&&this.loader.destroy(),this.loader=new i(t);let r;try{r=new self.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(r.protocol!=="data:"){const h=(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate)|0;r.searchParams.set("_HLS_pathway",this.pathwayId),r.searchParams.set("_HLS_throughput",""+h)}const s={responseType:"json",url:r.href},a=t.steeringManifestLoadPolicy.default,o=a.errorRetry||a.timeoutRetry||{},l={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:o.maxNumRetry||0,retryDelay:o.retryDelayMs||0,maxRetryDelay:o.maxRetryDelayMs||0},u={onSuccess:(h,d,p,g)=>{this.log(`Loaded steering manifest: "${r}"`);const m=h.data;if((m==null?void 0:m.VERSION)!==1){this.log(`Steering VERSION ${m.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=m.TTL;const{"RELOAD-URI":y,"PATHWAY-CLONES":b,"PATHWAY-PRIORITY":A}=m;if(y)try{this.uri=new self.URL(y,r).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${y}`);return}this.scheduleRefresh(this.uri||p.url),b&&this.clonePathways(b);const w={steeringManifest:m,url:r.toString()};this.hls.trigger(T.STEERING_MANIFEST_LOADED,w),A&&this.updatePathwayPriority(A)},onError:(h,d,p,g)=>{if(this.log(`Error loading steering manifest: ${h.code} ${h.text} (${d.url})`),this.stopLoad(),h.code===410){this.enabled=!1,this.log(`Steering manifest ${d.url} no longer available`);return}let m=this.timeToLoad*1e3;if(h.code===429){const y=this.loader;if(typeof(y==null?void 0:y.getResponseHeader)=="function"){const b=y.getResponseHeader("Retry-After");b&&(m=parseFloat(b)*1e3)}this.log(`Steering manifest ${d.url} rate limited`);return}this.scheduleRefresh(this.uri||d.url,m)},onTimeout:(h,d,p)=>{this.log(`Timeout loading steering manifest (${d.url})`),this.scheduleRefresh(this.uri||d.url)}};this.log(`Requesting steering manifest: ${r}`),this.loader.load(s,l,u)}scheduleRefresh(e,t=this.timeToLoad*1e3){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var i;const r=(i=this.hls)==null?void 0:i.media;if(r&&!r.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,this.timeToLoad*1e3)},t)}}function VA(n,e,t,i){n&&Object.keys(e).forEach(r=>{const s=n.filter(a=>a.groupId===r).map(a=>{const o=Rt({},a);return o.details=void 0,o.attrs=new Jt(o.attrs),o.url=o.attrs.URI=HA(a.url,a.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),o.groupId=o.attrs["GROUP-ID"]=e[r],o.attrs["PATHWAY-ID"]=i,o});n.push(...s)})}function HA(n,e,t,i){const{HOST:r,PARAMS:s,[t]:a}=i;let o;e&&(o=a==null?void 0:a[e],o&&(n=o));const l=new self.URL(n);return r&&!o&&(l.host=r),s&&Object.keys(s).sort().forEach(u=>{u&&l.searchParams.set(u,s[u])}),l.href}function hr(n,e,t){xr(n,e,t),n.addEventListener(e,t)}function xr(n,e,t){n.removeEventListener(e,t)}class io extends Bn{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=io.CDMCleanupPromise?[io.CDMCleanupPromise]:[],this.onMediaEncrypted=t=>{const{initDataType:i,initData:r}=t,s=`"${t.type}" event: init data type: "${i}"`;if(this.debug(s),r!==null){if(!this.keyFormatPromise){let a=Object.keys(this.keySystemAccessPromises);a.length||(a=cl(this.config));const o=a.map(sc).filter(l=>!!l);this.keyFormatPromise=this.getKeyFormatPromise(o)}this.keyFormatPromise.then(a=>{const o=rc(a);let l,u;if(i==="sinf"){if(o!==Tt.FAIRPLAY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${i}" for selected key-system ${o}`);return}const m=di(new Uint8Array(r));try{const y=Ag(JSON.parse(m).sinf),b=J1(y);if(!b)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(b.subarray(8,24)),u=Tt.FAIRPLAY}catch(y){this.warn(`${s} Failed to parse sinf: ${y}`);return}}else{if(o!==Tt.WIDEVINE&&o!==Tt.PLAYREADY){this.warn(`Ignoring unexpected "${t.type}" event with init data type: "${i}" for selected key-system ${o}`);return}const m=WN(r),y=m.filter(A=>!!A.systemId&&xg(A.systemId)===o);y.length>1&&this.warn(`${s} Using first of ${y.length} pssh found for selected key-system ${o}`);const b=y[0];if(!b){m.length===0||m.some(A=>!A.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${m.map(A=>xg(A.systemId)).join(",")} pssh data in favor of playlist keys`);return}if(u=xg(b.systemId),b.version===0&&b.data)if(u===Tt.WIDEVINE){const A=b.data.length-22;l=new Uint8Array(b.data.subarray(A,A+16))}else u===Tt.PLAYREADY&&(l=ME(b.data))}if(!u||!l)return;const h=dn.hexDump(l),{keyIdToKeySessionPromise:d,mediaKeySessions:p}=this;let g=d[h];for(let m=0;m<p.length;m++){const y=p[m],b=y.decryptdata;if(!b.keyId)continue;const A=dn.hexDump(b.keyId);if(h===A||b.uri.replace(/-/g,"").indexOf(h)!==-1){if(g=d[A],b.pssh)break;delete d[A],b.pssh=new Uint8Array(r),b.keyId=l,g=d[h]=g.then(()=>this.generateRequestWithPreferredKeySession(y,i,r,"encrypted-event-key-match")),g.catch(w=>this.handleError(w));break}}if(!g){if(u!==o){this.log(`Ignoring "${t.type}" event with ${u} init data for selected key-system ${o}`);return}g=d[h]=this.getKeySystemSelectionPromise([u]).then(({keySystem:m,mediaKeys:y})=>{var b;this.throwIfDestroyed();const A=new hl("ISO-23001-7",h,(b=sc(m))!=null?b:"");return A.pssh=new Uint8Array(r),A.keyId=l,this.attemptSetMediaKeys(m,y).then(()=>{this.throwIfDestroyed();const w=this.createMediaKeySessionContext({decryptdata:A,keySystem:m,mediaKeys:y});return this.generateRequestWithPreferredKeySession(w,i,r,"encrypted-event-no-match")})}),g.catch(m=>this.handleError(m))}})}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(T.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(T.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(T.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(T.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(T.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===Tt.WIDEVINE&&i)return i}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(t===void 0)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(a,o,l)=>!!a&&l.indexOf(a)===o,r=t.map(a=>a.audioCodec).filter(i),s=t.map(a=>a.videoCodec).filter(i);return r.length+s.length===0&&s.push("avc1.42e01e"),new Promise((a,o)=>{const l=u=>{const h=u.shift();this.getMediaKeysPromise(h,r,s).then(d=>a({keySystem:h,mediaKeys:d})).catch(d=>{u.length?l(u):d instanceof Tr?o(d):o(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_NO_ACCESS,error:d,fatal:!0},d.message))})};l(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if(typeof i!="function"){let r=`Configured requestMediaKeySystemAccess is not a function ${i}`;return _E===null&&self.location.protocol==="http:"&&(r=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(r))}return i(e,t)}getMediaKeysPromise(e,t,i){const r=OL(e,t,i,this.config.drmSystemOptions),s=this.keySystemAccessPromises[e];let a=s==null?void 0:s.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${zt(r)}`),a=this.requestMediaKeySystemAccess(e,r);const o=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(l=>{this.log(`Failed to obtain access to key-system "${e}": ${l}`)}),a.then(l=>{this.log(`Access for key-system "${l.keySystem}" obtained`);const u=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),o.mediaKeys=l.createMediaKeys().then(h=>(this.log(`Media-keys created for "${e}"`),o.hasMediaKeys=!0,u.then(d=>d?this.setMediaKeysServerCertificate(h,e,d):h))),o.mediaKeys.catch(h=>{this.error(`Failed to create media-keys for "${e}"}: ${h}`)}),o.mediaKeys})}return a.then(()=>s.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${dn.hexDump(e.keyId||[])}`);const r=i.createSession(),s={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(s),s}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t),s="cenc";this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(i,s,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw new Error("keyId is null");return dn.hexDump(e.keyId)}updateKeySession(e,t){var i;const r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${dn.hexDump(((i=e.decryptdata)==null?void 0:i.keyId)||[])}
      } (data length: ${t&&t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>sc(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:i})=>this.attemptSetMediaKeys(t,i))}selectKeySystem(e){return new Promise((t,i)=>this.getKeySystemSelectionPromise(e).then(({keySystem:r})=>{const s=sc(r);s?t(s):i(new Error(`Unable to find format for key-system "${r}"`))}).catch(i))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=cl(this.config),i=e.map(rc).filter(r=>!!r&&t.indexOf(r)!==-1);return this.selectKeySystem(i)}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),r=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let s=this.keyIdToKeySessionPromise[i];return s||(s=this.getKeySystemForKeyPromise(t).then(({keySystem:o,mediaKeys:l})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(o,l).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:o,mediaKeys:l,decryptdata:t}))))),(this.keyIdToKeySessionPromise[i]=s.then(o=>{const l="cenc",u=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(o,l,u,"playlist-key")})).catch(o=>this.handleError(o))),s}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof Tr?this.hls.trigger(T.ERROR,e.data):this.hls.trigger(T.ERROR,{type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const r=rc(e.keyFormat),s=r?[r]:cl(this.config);return this.attemptKeySystemAccess(s)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=cl(this.config)),e.length===0)throw new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${zt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const r=Promise.all(i).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(s=>i.indexOf(s)===-1)})}generateRequestWithPreferredKeySession(e,t,i,r){var s,a;const o=(s=this.config.drmSystems)==null||(a=s[e.keySystem])==null?void 0:a.generateRequest;if(o)try{const m=o.call(this.hls,t,i,e);if(!m)throw new Error("Invalid response from configured generateRequest filter");t=m.initDataType,i=m.initData?m.initData:null,e.decryptdata.pssh=i?new Uint8Array(i):null}catch(m){var l;if(this.warn(m.message),(l=this.hls)!=null&&l.config.debug)throw m}if(i===null)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);const u=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${u} (init data type: ${t} length: ${i?i.byteLength:null})`);const h=new Ng,d=e._onmessage=m=>{const y=e.mediaKeysSession;if(!y){h.emit("error",new Error("invalid state"));return}const{messageType:b,message:A}=m;this.log(`"${b}" message event for session "${y.sessionId}" message size: ${A.byteLength}`),b==="license-request"||b==="license-renewal"?this.renewLicense(e,A).catch(w=>{h.eventNames().length?h.emit("error",w):this.handleError(w)}):b==="license-release"?e.keySystem===Tt.FAIRPLAY&&(this.updateKeySession(e,Sg("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${b}"`)},p=e._onkeystatuseschange=m=>{if(!e.mediaKeysSession){h.emit("error",new Error("invalid state"));return}this.onKeyStatusChange(e);const b=e.keyStatus;h.emit("keyStatus",b),b==="expired"&&(this.warn(`${e.keySystem} expired for key ${u}`),this.renewKeySession(e))};hr(e.mediaKeysSession,"message",d),hr(e.mediaKeysSession,"keystatuseschange",p);const g=new Promise((m,y)=>{h.on("error",y),h.on("keyStatus",b=>{b.startsWith("usable")?m():b==="output-restricted"?y(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):b==="internal-error"?y(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${b}"`)):b==="expired"?y(new Error("key expired while generating request")):this.warn(`unhandled key status change "${b}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var m;this.log(`Request generated for key-session "${(m=e.mediaKeysSession)==null?void 0:m.sessionId}" keyId: ${u}`)}).catch(m=>{throw new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_NO_SESSION,error:m,fatal:!1},`Error generating key-session request: ${m}`)}).then(()=>g).catch(m=>{throw h.removeAllListeners(),this.removeSession(e),m}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{if(typeof i=="string"&&typeof t=="object"){const r=i;i=t,t=r}this.log(`key status change "${t}" for keyStatuses keyId: ${dn.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${dn.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,i=t.loader,r=new i(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,o)=>{const l={responseType:"arraybuffer",url:s},u=t.certLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,y)=>{a(p.data)},onError:(p,g,m,y)=>{o(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:xt({url:l.url,data:void 0},p)},`"${e}" certificate request failed (${s}). Status: ${p.code} (${p.text})`))},onTimeout:(p,g,m)=>{o(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:m,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(p,g,m)=>{o(new Error("aborted"))}};r.load(l,h,d)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((r,s)=>{e.setServerCertificate(i).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${i==null?void 0:i.byteLength}) on "${t}"`),r(e)}).catch(a=>{s(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:a,fatal:!0},a.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(i=>this.updateKeySession(e,new Uint8Array(i)).catch(r=>{throw new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:r,fatal:!0},r.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const r=new DOMParser().parseFromString(i,"application/xml"),s=r.querySelectorAll("HttpHeader");if(s.length>0){let h;for(let d=0,p=s.length;d<p;d++){var a,o;h=s[d];const g=(a=h.querySelector("name"))==null?void 0:a.textContent,m=(o=h.querySelector("value"))==null?void 0:o.textContent;g&&m&&e.setRequestHeader(g,m)}}const l=r.querySelector("Challenge"),u=l==null?void 0:l.textContent;if(!u)throw new Error("Cannot find <Challenge> in key message");return Sg(atob(u))}setupLicenseXHR(e,t,i,r){const s=this.config.licenseXhrSetup;return s?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return s.call(this.hls,e,t,i,r)}).catch(a=>{if(!i.decryptdata)throw a;return e.open("POST",t,!0),s.call(this.hls,e,t,i,r)}).then(a=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:a||r})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((r,s)=>{const a=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${a}`);const o=new XMLHttpRequest;o.responseType="arraybuffer",o.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return s(new Error("invalid state"));if(o.readyState===4)if(o.status===200){this._requestLicenseFailureCount=0;let l=o.response;this.log(`License received ${l instanceof ArrayBuffer?l.byteLength:l}`);const u=this.config.licenseResponseCallback;if(u)try{l=u.call(this.hls,o,a,e)}catch(h){this.error(h)}r(l)}else{const l=i.errorRetry,u=l?l.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>u||o.status>=400&&o.status<500)s(new Tr({type:$e.KEY_SYSTEM_ERROR,details:Z.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:o,response:{url:a,data:void 0,code:o.status,text:o.statusText}},`License Request XHR failed (${a}). Status: ${o.status} (${o.statusText})`));else{const h=u-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${h} attempts left`),this.requestLicense(e,t).then(r,s)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=o,this.setupLicenseXHR(o,a,e,t).then(({xhr:l,licenseChallenge:u})=>{e.keySystem==Tt.PLAYREADY&&(u=this.unpackPlayReadyKeyMessage(l,u)),l.send(u)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,hr(i,"encrypted",this.onMediaEncrypted),hr(i,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(xr(e,"encrypted",this.onMediaEncrypted),xr(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,hl.clearKeyUriToKeyIdMap();const r=i.length;io.CDMCleanupPromise=Promise.all(i.map(s=>this.removeSession(s)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(s=>{var a;this.log(`Could not clear media keys: ${s}`),(a=this.hls)==null||a.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${s}`)})}))).catch(s=>{var a;this.log(`Could not close sessions and clear media keys: ${s}`),(a=this.hls)==null||a.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${s}`)})}).then(()=>{r&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(!(!t||!this.config.emeEnabled)&&!this.keyFormatPromise){const i=t.reduce((r,s)=>(r.indexOf(s.keyFormat)===-1&&r.push(s.keyFormat),r),[]);this.log(`Selecting key-system from session-keys ${i.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(i)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const r=this.mediaKeySessions.indexOf(e);r>-1&&this.mediaKeySessions.splice(r,1);const{drmSystemOptions:s}=this.config;return(BL(s)?new Promise((o,l)=>{self.setTimeout(()=>l(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(o)}):Promise.resolve()).catch(o=>{var l;this.log(`Could not remove session: ${o}`),(l=this.hls)==null||l.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${o}`)})}).then(()=>t.close()).catch(o=>{var l;this.log(`Could not close session: ${o}`),(l=this.hls)==null||l.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${o}`)})})}}}io.CDMCleanupPromise=void 0;class Tr extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}class UM{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(T.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(T.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const r=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=r,r&&typeof r.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,i){const r=performance.now();if(t){if(this.lastTime){const s=r-this.lastTime,a=i-this.lastDroppedFrames,o=t-this.lastDecodedFrames,l=1e3*a/s,u=this.hls;if(u.trigger(T.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:i}),l>0&&a>u.config.fpsDroppedMonitoringThreshold*o){let h=u.currentLevel;u.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+h),h>0&&(u.autoLevelCapping===-1||u.autoLevelCapping>=h)&&(h=h-1,u.trigger(T.FPS_DROP_LEVEL_CAPPING,{level:h,droppedLevel:u.currentLevel}),u.autoLevelCapping=h,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function KA(n,e){let t;try{t=new Event("addtrack")}catch{t=document.createEvent("Event"),t.initEvent("addtrack",!1,!1)}t.track=n,e.dispatchEvent(t)}function WA(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues&&!n.cues.getCueById(e.id))try{if(n.addCue(e),!n.cues.getCueById(e.id))throw new Error(`addCue is failed for: ${e}`)}catch(i){Et.debug(`[texttrack-utils]: ${i}`);try{const r=new self.TextTrackCue(e.startTime,e.endTime,e.text);r.id=e.id,n.addCue(r)}catch(r){Et.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${r}`)}}t==="disabled"&&(n.mode=t)}function ro(n,e){const t=n.mode;if(t==="disabled"&&(n.mode="hidden"),n.cues)for(let i=n.cues.length;i--;)e&&n.cues[i].removeEventListener("enter",e),n.removeCue(n.cues[i]);t==="disabled"&&(n.mode=t)}function Xg(n,e,t,i){const r=n.mode;if(r==="disabled"&&(n.mode="hidden"),n.cues&&n.cues.length>0){const s=GM(n.cues,e,t);for(let a=0;a<s.length;a++)(!i||i(s[a]))&&n.removeCue(s[a])}r==="disabled"&&(n.mode=r)}function $M(n,e){if(e<=n[0].startTime)return 0;const t=n.length-1;if(e>n[t].endTime)return-1;let i=0,r=t,s;for(;i<=r;)if(s=Math.floor((r+i)/2),e<n[s].startTime)r=s-1;else if(e>n[s].startTime&&i<t)i=s+1;else return s;return n[i].startTime-e<e-n[r].startTime?i:r}function GM(n,e,t){const i=[],r=$M(n,e);if(r>-1)for(let s=r,a=n.length;s<a;s++){const o=n[s];if(o.startTime>=e&&o.endTime<=t)i.push(o);else if(o.startTime>t)return i}return i}function yc(n){const e=[];for(let t=0;t<n.length;t++){const i=n[t];(i.kind==="subtitles"||i.kind==="captions")&&i.label&&e.push(n[t])}return e}class qM extends Vg{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null;const i=yc(this.media.textTracks);for(let s=0;s<i.length;s++)if(i[s].mode==="hidden")t=i[s];else if(i[s].mode==="showing"){t=i[s];break}const r=this.findTrackForTextTrack(t);this.subtitleTrack!==r&&this.setSubtitleTrack(r)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const i=this.media;if(!i)return;const r=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,r)return;yc(i.textTracks).forEach(a=>{ro(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:r,details:s}=t,a=this.tracksInGroup[i];if(!a||a.groupId!==r){this.warn(`Subtitle track with id:${i} and group:${r} not found in active group ${a==null?void 0:a.groupId}`);return}const o=a.details;a.details=t.details,this.log(`Subtitle track ${i} "${a.name}" lang:${a.lang} group:${r} loaded [${s.startSN}-${s.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,o)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,r=this.groupIds;let s=this.currentTrack;if(!i||(r==null?void 0:r.length)!==(i==null?void 0:i.length)||i!=null&&i.some(a=>(r==null?void 0:r.indexOf(a))===-1)){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const a=this.tracks.filter(h=>!i||i.indexOf(h.groupId)!==-1);if(a.length)this.selectDefaultTrack&&!a.some(h=>h.default)&&(this.selectDefaultTrack=!1),a.forEach((h,d)=>{h.id=d});else if(!s&&!this.tracksInGroup.length)return;this.tracksInGroup=a;const o=this.hls.config.subtitlePreference;if(!s&&o){this.selectDefaultTrack=!1;const h=pn(o,a);if(h>-1)s=a[h];else{const d=pn(o,this.tracks);s=this.tracks[d]}}let l=this.findTrackId(s);l===-1&&s&&(l=this.findTrackId(null));const u={subtitleTracks:a};this.log(`Updating subtitle tracks, ${a.length} track(s) found in "${i==null?void 0:i.join(",")}" group-id`),this.hls.trigger(T.SUBTITLE_TRACKS_UPDATED,u),l!==-1&&this.trackId===-1&&this.setSubtitleTrack(l)}}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let r=0;r<t.length;r++){const s=t[r];if(!(i&&!s.default||!i&&!e)&&(!e||ia(s,e)))return r}if(e){for(let r=0;r<t.length;r++){const s=t[r];if(vl(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return r}for(let r=0;r<t.length;r++){const s=t[r];if(vl(e.attrs,s.attrs,["LANGUAGE"]))return r}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const r=t[i];if(Hg(r,e))return i}}return-1}onError(e,t){t.fatal||!t.context||t.context.type===ct.SUBTITLE_TRACK&&t.context.id===this.trackId&&(!this.groupIds||this.groupIds.indexOf(t.context.groupId)!==-1)&&this.checkRetry(t)}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&ia(e,i))return i;const r=pn(e,this.tracksInGroup);if(r>-1){const s=this.tracksInGroup[r];return this.setSubtitleTrack(r),s}else{if(i)return null;{const s=pn(e,t);if(s>-1)return t[s]}}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,r=e.groupId,s=this.getUrlWithDirectives(e.url,t),a=e.details,o=a==null?void 0:a.age;this.log(`Loading subtitle ${i} "${e.name}" lang:${e.lang} group:${r}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${s}`),this.hls.trigger(T.SUBTITLE_TRACK_LOADING,{url:s,id:i,groupId:r,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=yc(e.textTracks),i=this.currentTrack;let r;if(i&&(r=t.filter(s=>Hg(i,s))[0],r||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(s=>{s.mode!=="disabled"&&s!==r&&(s.mode="disabled")}),r){const s=this.subtitleDisplay?"showing":"hidden";r.mode!==s&&(r.mode=s)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!_e(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;const i=this.currentTrack,r=t[e]||null;if(this.trackId=e,this.currentTrack=r,this.toggleTrackModes(),!r){this.hls.trigger(T.SUBTITLE_TRACK_SWITCH,{id:e});return}const s=!!r.details&&!r.details.live;if(e===this.trackId&&r===i&&s)return;this.log(`Switching to subtitle-track ${e}`+(r?` "${r.name}" lang:${r.lang} group:${r.groupId}`:""));const{id:a,groupId:o="",name:l,type:u,url:h}=r;this.hls.trigger(T.SUBTITLE_TRACK_SWITCH,{id:a,groupId:o,name:l,type:u,url:h});const d=this.switchParams(r.url,i==null?void 0:i.details,r.details);this.loadPlaylist(d)}}function VM(){try{return crypto.randomUUID()}catch{try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch{let t=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const s=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(r=="x"?s:s&3|8).toString(16)})}}}function El(n){let e=5381,t=n.length;for(;t;)e=e*33^n.charCodeAt(--t);return(e>>>0).toString()}const no=.025;let vc=function(n){return n[n.Point=0]="Point",n[n.Range=1]="Range",n}({});function HM(n,e,t){return`${n.identifier}-${t+1}-${El(e)}`}class KM{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const i=this.playoutLimit;return e<=0||isNaN(i)?!1:i===0?!0:(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>i}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return Jg(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime,i=Jg(t,e);return t-i<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=_e(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return Jg(e,t)}return e}get appendInPlace(){return this.appendInPlaceStarted?!0:this.appendInPlaceDisabled?!1:!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<no))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return this._duration!==null?t=this._duration:this.dateRange.duration?t=this.dateRange.duration:t=this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?vc.Range:vc.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return WM(this)}}function Jg(n,e){return n-e.start<e.duration/2&&!(Math.abs(n-(e.start+e.duration))<no)?e.start:e.start+e.duration}function YA(n,e,t){const i=new self.URL(n,t);return i.protocol!=="data:"&&i.searchParams.set("_HLS_primary_id",e),i}function Qg(n,e){for(;(t=n.assetList[++e])!=null&&t.error;)var t;return e}function WM(n){return`["${n.identifier}" ${n.cue.pre?"<pre>":n.cue.post?"<post>":""}${n.timelineStart.toFixed(2)}-${n.resumeTime.toFixed(2)}]`}function so(n){const e=n.timelineStart,t=n.duration||0;return`["${n.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class YM{constructor(e,t,i,r){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(T.PLAYOUT_LIMIT_REACHED,{})};const s=this.hls=new e(t);this.interstitial=i,this.assetItem=r;let a=r.uri;try{a=YA(a,t.primarySessionId).href}catch{}s.loadSource(a);const o=()=>{this.hasDetails=!0};s.once(T.LEVEL_LOADED,o),s.once(T.AUDIO_TRACK_LOADED,o),s.once(T.SUBTITLE_TRACK_LOADED,o),s.on(T.MEDIA_ATTACHING,(l,{media:u})=>{this.removeMediaListeners(),this.mediaAttached=u,this.interstitial.playoutLimit&&(u.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&s.on(T.BUFFER_APPENDED,()=>{const d=this.bufferedEnd;this.reachedPlayout(d)&&(this._bufferedEosTime=d,s.trigger(T.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return((e=this.interstitial)==null?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const i=this.timelineOffset,r=Je.bufferInfo(e,i,0);return this.getAssetTime(r.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const i=this.interstitial.playoutLimit;return this.startOffset+e>=i}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=Je.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const i=e-t;if(Math.abs(i)>11111111111111112e-21){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,e-t),i)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=i=>delete i.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,i){this.hls.on(e,t)}once(e,t,i){this.hls.once(e,t)}off(e,t,i){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${so(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}const zA=.033;class zM extends Bn{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((i,r)=>e<=r.startOffset&&t>r.startOffset?(delete r.error,i+1):i,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let i=-1;e.nextEvent?i=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(i=this.findEventIndex(e.previousEvent.identifier)+1);const r=this.items;if(r)for(r[i]||(t===void 0&&(t=e.start),i=this.findItemIndexAtTime(t));i>=0&&(s=r[i])!=null&&s.event;){var s;i--}return i}findItemIndexAtTime(e,t){const i=this.items;if(i)for(let r=0;r<i.length;r++){let s=i[r];if(t&&t!=="primary"&&(s=s[t]),e===s.start||e>s.start&&e<s.end)return r}return-1}findJumpRestrictedIndex(e,t){const i=this.items;if(i)for(let r=e;r<=t&&i[r];r++){const s=i[r].event;if(s!=null&&s.restrictions.jump&&!s.appendInPlace)return r}return-1}findEventIndex(e){const t=this.items;if(t)for(let r=t.length;r--;){var i;if(((i=t[r].event)==null?void 0:i.identifier)===e)return r}return-1}findAssetIndex(e,t){const i=e.assetList,r=i.length;if(r>1)for(let s=0;s<r;s++){const a=i[s];if(!a.error){const o=a.timelineStart;if(t===o||t>o&&t<o+(a.duration||0))return s}}return 0}get assetIdAtEnd(){var e,t;const i=(e=this.items)==null||(t=e[this.length-1])==null?void 0:t.event;if(i){const r=i.assetList,s=r[r.length-1];if(s)return s.identifier}return null}parseInterstitialDateRanges(e,t){const i=e.main.details,{dateRanges:r}=i,s=this.events,a=this.parseDateRanges(r,{url:i.url},t),o=Object.keys(r),l=s?s.filter(u=>!o.includes(u.identifier)):[];a.length&&a.sort((u,h)=>{const d=u.cue.pre,p=u.cue.post,g=h.cue.pre,m=h.cue.post;if(d&&!g)return-1;if(g&&!d||p&&!m)return 1;if(m&&!p)return-1;if(!d&&!g&&!p&&!m){const y=u.startTime,b=h.startTime;if(y!==b)return y-b}return u.dateRange.tagOrder-h.dateRange.tagOrder}),this.events=a,l.forEach(u=>{this.removeEvent(u)}),this.updateSchedule(e,l)}updateSchedule(e,t=[]){const i=this.events||[];if(i.length||t.length||this.length<2){const r=this.items,s=this.parseSchedule(i,e);(t.length||(r==null?void 0:r.length)!==s.length||s.some((o,l)=>Math.abs(o.playout.start-r[l].playout.start)>.005||Math.abs(o.playout.end-r[l].playout.end)>.005))&&(this.items=s,this.onScheduleUpdate(t,r))}}parseDateRanges(e,t,i){const r=[],s=Object.keys(e);for(let a=0;a<s.length;a++){const o=s[a],l=e[o];if(l.isInterstitial){let u=this.eventMap[o];u?u.setDateRange(l):(u=new KM(l,t),this.eventMap[o]=u,i===!1&&(u.appendInPlace=i)),r.push(u)}}return r}parseSchedule(e,t){const i=[],r=t.main.details,s=r.live?1/0:r.edge;let a=0;if(e=e.filter(l=>!l.error&&!(l.cue.once&&l.hasPlayed)),e.length){this.resolveOffsets(e,t);let l=0,u=0;if(e.forEach((h,d)=>{const p=h.cue.pre,g=h.cue.post,m=e[d-1]||null,y=h.appendInPlace,b=g?s:h.startOffset,A=h.duration,w=h.timelineOccupancy===vc.Range?A:0,x=h.resumptionOffset,N=(m==null?void 0:m.startTime)===b,F=b+h.cumulativeDuration;let L=y?F+A:b+x;if(p||!g&&b<=0){const M=u;u+=w,h.timelineStart=F;const _=a;a+=A,i.push({event:h,start:F,end:L,playout:{start:_,end:a},integrated:{start:M,end:u}})}else if(b<=s){if(!N){const R=b-l;if(R>zA){const U=l,q=u;u+=R;const $=a;a+=R;const Y={previousEvent:e[d-1]||null,nextEvent:h,start:U,end:U+R,playout:{start:$,end:a},integrated:{start:q,end:u}};i.push(Y)}else R>0&&m&&(m.cumulativeDuration+=R,i[i.length-1].end=b)}g&&(L=F),h.timelineStart=F;const M=u;u+=w;const _=a;a+=A,i.push({event:h,start:F,end:L,playout:{start:_,end:a},integrated:{start:M,end:u}})}else return;const C=h.resumeTime;g||C>s?l=s:l=C}),l<s){var o;const h=l,d=u,p=s-l;u+=p;const g=a;a+=p,i.push({previousEvent:((o=i[i.length-1])==null?void 0:o.event)||null,nextEvent:null,start:l,end:h+p,playout:{start:g,end:a},integrated:{start:d,end:u}})}this.setDurations(s,a,u)}else i.push({previousEvent:null,nextEvent:null,start:0,end:s,playout:{start:0,end:s},integrated:{start:0,end:s}}),this.setDurations(s,s,s);return i}setDurations(e,t,i){this.durations={primary:e,playout:t,integrated:i}}resolveOffsets(e,t){const i=t.main.details,r=i.live?1/0:i.edge;let s=0,a=-1;e.forEach((o,l)=>{const u=o.cue.pre,h=o.cue.post,d=u?0:h?r:o.startTime;this.updateAssetDurations(o),a===d?o.cumulativeDuration=s:(s=0,a=d),!h&&o.snapOptions.in&&(o.resumeAnchor=na(null,i.fragments,o.startOffset+o.resumptionOffset,0,0)||void 0),o.appendInPlace&&!o.appendInPlaceStarted&&(this.primaryCanResumeInPlaceAt(o,t)||(o.appendInPlace=!1)),!o.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<zA&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${o}`));const g=_e(o.resumeOffset)?o.resumeOffset:o.duration;s+=g})}primaryCanResumeInPlaceAt(e,t){const i=e.resumeTime,r=e.startTime+e.resumptionOffset;return Math.abs(i-r)>no?(this.log(`"${e.identifier}" resumption ${i} not aligned with estimated timeline end ${r}`),!1):t?!Object.keys(t).some(a=>{const o=t[a].details,l=o.edge;if(i>=l)return this.log(`"${e.identifier}" resumption ${i} past ${a} playlist end ${l}`),!1;const u=na(null,o.fragments,i);if(!u)return this.log(`"${e.identifier}" resumption ${i} does not align with any fragments in ${a} playlist (${o.fragStart}-${o.fragmentEnd})`),!0;const h=a==="audio"?.175:0;return Math.abs(u.start-i)<no+h||Math.abs(u.end-i)<no+h?!1:(this.log(`"${e.identifier}" resumption ${i} not aligned with ${a} fragment bounds (${u.start}-${u.end} sn: ${u.sn} cc: ${u.cc})`),!0)}):(this.log(`"${e.identifier}" resumption ${i} can not be aligned with media (none selected)`),!1)}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let i=0,r=!1,s=!1;e.assetList.forEach((a,o)=>{const l=t+i;a.startOffset=i,a.timelineStart=l,r||(r=a.duration===null),s||(s=!!a.error);const u=a.error?0:a.duration||0;i+=u}),r&&!s?e.duration=Math.max(i,e.duration):e.duration=i}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function ws(n){return`[${n.event?'"'+n.event.identifier+'"':"primary"}: ${n.start.toFixed(2)}-${n.end.toFixed(2)}]`}class jM{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const i=e.assetListUrl;let r;try{r=YA(i,this.hls.sessionId,e.baseUrl)}catch(p){const g=this.assignAssetListError(e,Z.ASSET_LIST_LOAD_ERROR,p,i);this.hls.trigger(T.ERROR,g);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);const s=this.hls.config,a=s.loader,o=new a(s),l={responseType:"json",url:r.href},u=s.interstitialAssetListLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,y)=>{const b=p.data,A=b==null?void 0:b.ASSETS;if(!Array.isArray(A)){const w=this.assignAssetListError(e,Z.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),m.url,g,y);this.hls.trigger(T.ERROR,w);return}e.assetListResponse=b,this.hls.trigger(T.ASSET_LIST_LOADED,{event:e,assetListResponse:b,networkDetails:y})},onError:(p,g,m,y)=>{const b=this.assignAssetListError(e,Z.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${p.code} ${p.text} (${g.url})`),g.url,y,m);this.hls.trigger(T.ERROR,b)},onTimeout:(p,g,m)=>{const y=this.assignAssetListError(e,Z.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${g.url})`),g.url,p,m);this.hls.trigger(T.ERROR,y)}};return o.load(l,h,d),this.hls.trigger(T.ASSET_LIST_LOADING,{event:e}),o}assignAssetListError(e,t,i,r,s,a){return e.error=i,{type:$e.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:r,error:i,networkDetails:a,stats:s}}}function jA(n){n==null||n.play().catch(()=>{})}class XM extends Bn{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;const r=i-this.timelinePos;if(Math.abs(r)<1/7056e5)return;const a=r<=-.01;this.timelinePos=i,this.bufferedPos=i;const o=this.playingItem;if(!o){this.checkBuffer();return}if(a&&this.schedule.resetErrorsInRange(i,i-r)&&this.updateSchedule(),this.checkBuffer(),a&&i<o.start||i>=o.end){var l;const p=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(o)&&(l=this.media)!=null&&l.paused&&(this.shouldPlay=!1),!a){const g=this.findItemIndex(o);if(p>g){const m=this.schedule.findJumpRestrictedIndex(g+1,p);if(m>g){this.setSchedulePosition(m);return}}}this.setSchedulePosition(p);return}const u=this.playingAsset;if(!u){if(this.playingLastItem&&this.isInterstitial(o)){const p=o.event.assetList[0];p&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(i,p))}return}const h=u.timelineStart,d=u.duration||0;(a&&i<h||i>=h+d)&&this.setScheduleToAssetAtTime(i,u)},this.onTimeupdate=()=>{const i=this.currentTime;if(i===void 0||this.playbackDisabled)return;if(i>this.timelinePos)this.timelinePos=i,i>this.bufferedPos&&this.checkBuffer();else return;const r=this.playingItem;if(!r||this.playingLastItem)return;if(i>=r.end){this.timelinePos=r.end;const o=this.findItemIndex(r);this.setSchedulePosition(o+1)}const s=this.playingAsset;if(!s)return;const a=s.timelineStart+(s.duration||0);i>=a&&this.setScheduleToAssetAtTime(i,s)},this.onScheduleUpdate=(i,r)=>{const s=this.schedule,a=this.playingItem,o=s.events||[],l=s.items||[],u=s.durations,h=i.map(m=>m.identifier),d=!!(o.length||h.length);(d||r)&&this.log(`INTERSTITIALS_UPDATED (${o.length}): ${o}
Schedule: ${l.map(m=>ws(m))} pos: ${this.timelinePos}`),h.length&&this.log(`Removed events ${h}`),this.playerQueue.forEach(m=>{if(m.interstitial.appendInPlace){const y=m.assetItem.timelineStart,b=m.timelineOffset-y;if(b)try{m.timelineOffset=y}catch(A){Math.abs(b)>no&&this.warn(`${A} ("${m.assetId}" ${m.timelineOffset}->${y})`)}}});let p=null;if(a){const m=this.updateItem(a,this.timelinePos);this.itemsMatch(a,m)&&(this.playingItem=m,this.waitingItem=this.endedItem=null,p=()=>this.trimInPlace(m,a))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const g=this.bufferingItem;if(g){const m=this.updateItem(g,this.bufferedPos);this.itemsMatch(g,m)?(this.bufferingItem=m,p||(p=()=>this.trimInPlace(m,g))):g.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(g.event,null))}if(i.forEach(m=>{m.assetList.forEach(y=>{this.clearAssetPlayer(y.identifier,null)})}),d||r){if(this.hls.trigger(T.INTERSTITIALS_UPDATED,{events:o.slice(0),schedule:l.slice(0),durations:u,removedIds:h}),this.isInterstitial(a)&&h.includes(a.event.identifier)){this.warn(`Interstitial "${a.event.identifier}" removed while playing`),this.primaryFallback(a.event);return}p&&p(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new jM(e),this.schedule=new zM(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(T.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(T.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(T.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(T.BUFFER_APPENDED,this.onBufferAppended,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(T.MEDIA_ENDED,this.onMediaEnded,this),e.on(T.ERROR,this.onError,this),e.on(T.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(T.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(T.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(T.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(T.BUFFER_CODECS,this.onBufferCodecs,this),e.off(T.BUFFER_APPENDED,this.onBufferAppended,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(T.MEDIA_ENDED,this.onMediaEnded,this),e.off(T.ERROR,this.onError,this),e.off(T.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){xr(e,"play",this.onPlay),xr(e,"pause",this.onPause),xr(e,"seeking",this.onSeeking),xr(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const i=this.media=t.media;hr(i,"seeking",this.onSeeking),hr(i,"timeupdate",this.onTimeupdate),hr(i,"play",this.onPlay),hr(i,"pause",this.onPause)}onMediaAttached(e,t){const i=this.effectivePlayingItem,r=this.detachedData;if(this.detachedData=null,i===null)this.checkStart();else if(!r){this.clearScheduleState();const s=this.findItemIndex(i);this.setSchedulePosition(s)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const i=!!t.transferMedia,r=this.media;if(this.media=null,!i&&(r&&this.removeMediaListeners(r),this.detachedData)){const s=this.getBufferingPlayer();s&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,s.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,i=d=>d&&e.getAssetPlayer(d.identifier),r=(d,p,g,m,y)=>{if(d){let b=d[p].start;const A=d.event;if(A){if(p==="playout"||A.timelineOccupancy!==vc.Point){const w=i(g);(w==null?void 0:w.interstitial)===A&&(b+=w.assetItem.startOffset+w[y])}}else{const w=m==="bufferedPos"?a():e[m];b+=w-d.start}return b}return 0},s=(d,p)=>{if(d!==0&&p!=="primary"&&e.schedule.length){var g;const m=e.schedule.findItemIndexAtTime(d),y=(g=e.schedule.items)==null?void 0:g[m];if(y){const b=y[p].start-y.start;return d+b}}return d},a=()=>{const d=e.bufferedPos;return d===Number.MAX_VALUE?o("primary"):Math.max(d,0)},o=d=>{var p;return(p=e.primaryDetails)!=null&&p.live?e.primaryDetails.edge:e.schedule.durations[d]},l=(d,p)=>{var g,m;const y=e.effectivePlayingItem;if(y!=null&&(g=y.event)!=null&&g.restrictions.skip)return;e.log(`seek to ${d} "${p}"`);const b=e.effectivePlayingItem,A=e.schedule.findItemIndexAtTime(d,p),w=(m=e.schedule.items)==null?void 0:m[A],x=e.getBufferingPlayer(),N=x==null?void 0:x.interstitial,F=N==null?void 0:N.appendInPlace,L=b&&e.itemsMatch(b,w);if(b&&(F||L)){const M=i(e.playingAsset),_=(M==null?void 0:M.media)||e.primaryMedia;if(_){const R=p==="primary"?_.currentTime:r(b,p,e.playingAsset,"timelinePos","currentTime"),U=d-R,q=(F?R:_.currentTime)+U;if(q>=0&&(!M||F||q<=M.duration)){_.currentTime=q;return}}}if(w){let M=d;if(p!=="primary"){const R=w[p].start,U=d-R;M=w.start+U}const _=!e.isInterstitial(w);if((!e.isInterstitial(b)||b.event.appendInPlace)&&(_||w.event.appendInPlace)){const R=e.media||(F?x==null?void 0:x.media:null);R&&(R.currentTime=M)}else if(b){const R=e.findItemIndex(b);if(A>R){const q=e.schedule.findJumpRestrictedIndex(R+1,A);if(q>R){e.setSchedulePosition(q);return}}let U=0;if(_)e.timelinePos=M,e.checkBuffer();else{var C;const q=w==null||(C=w.event)==null?void 0:C.assetList;if(q){const $=d-(w[p]||w).start;for(let Y=q.length;Y--;){const ae=q[Y];if(ae.duration&&$>=ae.startOffset&&$<ae.startOffset+ae.duration){U=Y;break}}}}e.setSchedulePosition(A,U)}}},u=()=>{const d=e.effectivePlayingItem;if(e.isInterstitial(d))return d;const p=t();return e.isInterstitial(p)?p:null},h={get currentTime(){const d=u(),p=e.effectivePlayingItem;return p&&p===d?r(p,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-p.playout.start:0},set currentTime(d){const p=u(),g=e.effectivePlayingItem;g&&g===p&&l(d+g.playout.start,"playout")},get duration(){const d=u();return d?d.playout.end-d.playout.start:0},get assetPlayers(){var d;const p=(d=u())==null?void 0:d.event.assetList;return p?p.map(g=>e.getAssetPlayer(g.identifier)):[]},get playingIndex(){var d;const p=(d=u())==null?void 0:d.event;return p&&e.effectivePlayingAsset?p.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return u()}};this.manager={get events(){var d,p;return((d=e.schedule)==null||(p=d.events)==null?void 0:p.slice(0))||[]},get schedule(){var d,p;return((d=e.schedule)==null||(p=d.items)==null?void 0:p.slice(0))||[]},get interstitialPlayer(){return u()?h:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const d=t();return e.findItemIndex(d)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const d=e.effectivePlayingItem;return e.findItemIndex(d)},primary:{get bufferedEnd(){return a()},get currentTime(){const d=e.timelinePos;return d>0?d:0},set currentTime(d){l(d,"primary")},get duration(){return o("primary")},get seekableStart(){var d;return((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0}},integrated:{get bufferedEnd(){return r(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return r(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(d){l(d,"integrated")},get duration(){return o("integrated")},get seekableStart(){var d;return s(((d=e.primaryDetails)==null?void 0:d.fragmentStart)||0,"integrated")}},skip:()=>{const d=e.effectivePlayingItem,p=d==null?void 0:d.event;if(p&&!p.restrictions.skip){const g=e.findItemIndex(d);if(p.appendInPlace){const m=d.playout.start+d.event.duration;l(m+.001,"playout")}else e.advanceAfterAssetEnded(p,g,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,i=(e=this.schedule)==null?void 0:e.items;return!this.playbackStarted||!t||!i?!1:this.findItemIndex(t)===i.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t,i;if(this.mediaSelection===null)return;const r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let s=this.media;!s&&(e=this.bufferingItem)!=null&&(t=e.event)!=null&&t.appendInPlace&&(s=this.primaryMedia);const a=(i=s)==null?void 0:i.currentTime;if(!(a===void 0||!_e(a)))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){const i=this.getAssetPlayer(e);i&&this.transferMediaFromPlayer(i,t)}transferMediaFromPlayer(e,t){const i=e.interstitial.appendInPlace,r=e.media;if(i&&r===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&r){this.detachedData={media:r};return}const s=e.transferMedia();this.log(`transfer MediaSource from ${e} ${zt(s)}`),this.detachedData=s}else t&&r&&(this.shouldPlay||(this.shouldPlay=!r.paused))}transferMediaTo(e,t){var i,r;if(e.media===t)return;let s=null;const a=this.hls,o=e!==a,l=o&&e.interstitial.appendInPlace,u=(i=this.detachedData)==null?void 0:i.mediaSource;let h;if(a.media)l&&(s=a.transferMedia(),this.detachedData=s),h="Primary";else if(u){const g=this.getBufferingPlayer();g?(s=g.transferMedia(),h=`${g}`):h="detached MediaSource"}else h="detached media";if(!s){if(u)s=this.detachedData,this.log(`using detachedData: MediaSource ${zt(s)}`);else if(!this.detachedData||a.media===t){const g=this.playerQueue;g.length>1&&g.forEach(m=>{if(o&&m.interstitial.appendInPlace!==l){const y=m.interstitial;this.clearInterstitial(m.interstitial,null),y.appendInPlace=!1,y.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${y}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}const d=s&&"mediaSource"in s&&((r=s.mediaSource)==null?void 0:r.readyState)!=="closed",p=d&&s?s:t;if(this.log(`${d?"transfering MediaSource":"attaching media"} to ${o?e:"Primary"} from ${h}`),p===s){const g=o&&e.assetId===this.schedule.assetIdAtEnd;p.overrides={duration:this.schedule.duration,endOfStream:!o||g,cueRemoval:!o}}e.attachMedia(p)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);const i=this.timelinePos,r=this.effectivePlayingItem;if(i===-1){const s=this.hls.startPosition;if(this.timelinePos=s,t.length&&t[0].cue.pre){const a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(s>=0||!this.primaryLive){const a=this.timelinePos=s>0?s:0,o=e.findItemIndexAtTime(a);this.setSchedulePosition(o)}}else if(r&&!this.playingItem){const s=e.findItemIndex(r);this.setSchedulePosition(s)}}advanceAfterAssetEnded(e,t,i){const r=Qg(e,i);if(!e.isAssetPastPlayoutLimit(r))this.setSchedulePosition(t,r);else{const s=this.schedule.items;if(s){const a=t+1,o=s.length;if(a>=o){this.setSchedulePosition(-1);return}const l=e.resumeTime;this.timelinePos<l&&(this.timelinePos=l,this.checkBuffer()),this.setSchedulePosition(a)}}}setScheduleToAssetAtTime(e,t){const i=this.schedule,r=t.parentIdentifier,s=i.getEvent(r);if(s){const a=i.findEventIndex(r),o=i.findAssetIndex(s,e);this.advanceAfterAssetEnded(s,a,o-1)}}setSchedulePosition(e,t){const i=this.schedule.items;if(!i||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const r=e>=0?i[e]:null,s=this.playingItem,a=this.playingLastItem;if(this.isInterstitial(s)){var o;const u=s.event,h=this.playingAsset,d=h==null?void 0:h.identifier,p=d?this.getAssetPlayer(d):null;if(p&&d&&(!this.eventItemsMatch(s,r)||t!==void 0&&d!==((o=u.assetList)==null?void 0:o[t].identifier))){var l;const g=u.findAssetIndex(h);this.log(`INTERSTITIAL_ASSET_ENDED ${g+1}/${u.assetList.length} ${so(h)}`),this.endedAsset=h,this.playingAsset=null,this.hls.trigger(T.INTERSTITIAL_ASSET_ENDED,{asset:h,assetListIndex:g,event:u,schedule:i.slice(0),scheduleIndex:e,player:p}),this.retreiveMediaSource(d,r),p.media&&!((l=this.detachedData)!=null&&l.mediaSource)&&p.detachMedia()}if(!this.eventItemsMatch(s,r)&&(this.endedItem=s,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${u} ${ws(s)}`),u.hasPlayed=!0,this.hls.trigger(T.INTERSTITIAL_ENDED,{event:u,schedule:i.slice(0),scheduleIndex:e}),u.cue.once)){this.updateSchedule();const g=this.schedule.items;if(r&&g){const m=this.schedule.findItemIndex(r);this.advanceSchedule(m,g,t,s,a)}return}}this.advanceSchedule(e,i,t,s,a)}advanceSchedule(e,t,i,r,s){const a=e>=0?t[e]:null,o=this.primaryMedia,l=this.playerQueue;if(l.length&&l.forEach(u=>{const h=u.interstitial,d=this.schedule.findEventIndex(h.identifier);(d<e||d>e+1)&&this.clearInterstitial(h,a)}),this.isInterstitial(a)){this.timelinePos=Math.min(Math.max(this.timelinePos,a.start),a.end);const u=a.event;if(i===void 0){i=this.schedule.findAssetIndex(u,this.timelinePos);const g=Qg(u,i-1);if(u.isAssetPastPlayoutLimit(g)){this.advanceAfterAssetEnded(u,e,i);return}i=g}const h=this.waitingItem;this.assetsBuffered(a,o)||this.setBufferingItem(a);let d=this.preloadAssets(u,i);if(this.eventItemsMatch(a,h||r)||(this.waitingItem=a,this.log(`INTERSTITIAL_STARTED ${ws(a)} ${u.appendInPlace?"append in place":""}`),this.hls.trigger(T.INTERSTITIAL_STARTED,{event:u,schedule:t.slice(0),scheduleIndex:e})),!u.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${u}`);return}if(u.assetListLoader&&(u.assetListLoader.destroy(),u.assetListLoader=void 0),!o){this.log(`Waiting for attachMedia to start Interstitial ${u}`);return}this.waitingItem=this.endedItem=null,this.playingItem=a;const p=u.assetList[i];if(!p){const g=t[e+1],m=this.media;g&&m&&!this.isInterstitial(g)&&m.currentTime<g.start&&(m.currentTime=this.timelinePos=g.start),this.advanceAfterAssetEnded(u,e,i||0);return}if(d||(d=this.getAssetPlayer(p.identifier)),d===null||d.destroyed){const g=u.assetList.length;this.warn(`asset ${i+1}/${g} player destroyed ${u}`),d=this.createAssetPlayer(u,p,i)}if(!this.eventItemsMatch(a,this.bufferingItem)&&u.appendInPlace&&this.isAssetBuffered(p))return;this.startAssetPlayer(d,i,t,e,o),this.shouldPlay&&jA(d.media)}else a!==null?(this.resumePrimary(a,e,r),this.shouldPlay&&jA(this.hls.media)):s&&this.isInterstitial(r)&&(this.endedItem=null,this.playingItem=r,r.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e,t;return(e=this.mediaSelection)==null||(t=e.main)==null?void 0:t.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,i){var r;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${ws(e)}`),!((r=this.detachedData)!=null&&r.mediaSource)){let a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.timelinePos=a),this.attachPrimary(a,e)}if(!i)return;const s=this.schedule.items;s&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${ws(e)}`),this.hls.trigger(T.INTERSTITIALS_PRIMARY_RESUMED,{schedule:s.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const i=e.start;if(this.primaryLive){const r=this.primaryDetails;if(t===0)return this.hls.startPosition;if(r&&(i<r.fragmentStart||i>r.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:Je.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,i){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const r=this.primaryMedia;if(!r)return;const s=this.hls;s.media?this.checkBuffer():(this.transferMediaTo(s,r),i&&this.startLoadingPrimaryAt(e,i)),i||(this.timelinePos=e,this.startLoadingPrimaryAt(e,i))}startLoadingPrimaryAt(e,t){var i;const r=this.hls;!r.loadingEnabled||!r.media||Math.abs((((i=r.mainForwardBufferInfo)==null?void 0:i.start)||r.media.currentTime)-e)>.5?r.startLoad(e,t):r.bufferingEnabled||r.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(T.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(T.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1)return;const i=this.hls.levels[t.level],r=xt(xt({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=r,this.schedule.parseInterstitialDateRanges(r,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const i=this.hls.audioTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=xt(xt({},this.altSelection),{},{audio:i});return}const s=xt(xt({},r),{},{audio:i});this.mediaSelection=s}onSubtitleTrackUpdated(e,t){const i=this.hls.subtitleTracks[t.id],r=this.mediaSelection;if(!r){this.altSelection=xt(xt({},this.altSelection),{},{subtitles:i});return}const s=xt(xt({},r),{},{subtitles:i});this.mediaSelection=s}onAudioTrackSwitching(e,t){const i=gE(t);this.playerQueue.forEach(r=>r.hls.setAudioOption(t)||r.hls.setAudioOption(i))}onSubtitleTrackSwitch(e,t){const i=gE(t);this.playerQueue.forEach(r=>r.hls.setSubtitleOption(t)||t.id!==-1&&r.hls.setSubtitleOption(i))}onBufferCodecs(e,t){const i=t.tracks;i&&(this.requiredTracks=i)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const r=this.timelinePos;this.bufferedPos=r,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let r=0;r<t.length;r++){const s=t[r];if(s.cue.post){var i;const a=this.schedule.findEventIndex(s.identifier),o=(i=this.schedule.items)==null?void 0:i[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const i=this.findItemIndex(t);this.setSchedulePosition(i+1)}else this.shouldPlay=!1}updateItem(e,t){const i=this.schedule.items;if(e&&i){const r=this.findItemIndex(e,t);return i[r]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((s,a)=>{e.event.isAssetPastPlayoutLimit(a)&&this.clearAssetPlayer(s.identifier,null)});const i=e.end+.25,r=Je.bufferInfo(this.primaryMedia,i,0);(r.end>i||(r.nextStart||0)>i)&&(this.attachPrimary(i,null),this.flushFrontBuffer(i))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var i;return!!t&&(e===t||e.event.identifier===((i=t.event)==null?void 0:i.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const i=Je.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,t,e)}updateBufferedPos(e,t,i){const r=this.schedule,s=this.bufferingItem;if(this.bufferedPos>e)return;if(t.length===1&&this.itemsMatch(t[0],s)){this.bufferedPos=e;return}const a=this.playingItem,o=this.findItemIndex(a);let l=r.findItemIndexAtTime(e);if(this.bufferedPos<e){var u,h;const d=this.findItemIndex(s),p=Math.min(d+1,t.length-1),g=t[p];if((l===-1&&s&&e>=s.end||(u=g.event)!=null&&u.appendInPlace&&e+.01>=g.start)&&(l=p),p-o>1&&(s==null||(h=s.event)==null?void 0:h.appendInPlace)===!1)return;if(this.bufferedPos=e,l>d&&l>o)this.bufferedToItem(g);else{const m=this.primaryDetails;this.primaryLive&&m&&e>m.edge-m.targetduration&&g.start<m.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(g)&&this.preloadAssets(g.event,0)}}else i&&a&&!this.itemsMatch(a,s)&&(l===o?this.bufferedToItem(a):l===o+1&&this.bufferedToItem(t[l]))}assetsBuffered(e,t){return e.event.assetList.length===0?!1:!e.event.assetList.some(r=>{const s=this.getAssetPlayer(r.identifier);return!(s!=null&&s.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,i=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:r,events:s}=i;if(!r||!s)return t;const a=this.isInterstitial(e),o=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const l=o?o.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${ws(e)}`+(t?` (${l.toFixed(2)} remaining)`:"")),this.playbackDisabled||(a?e.event.assetList.forEach(u=>{const h=this.getAssetPlayer(u.identifier);h&&h.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(u=>u.pauseBuffering()))),this.hls.trigger(T.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:s.slice(0),schedule:r.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const i=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(i!==null){this.bufferingAsset=null;const r=this.detachedData;r?r.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e):this.preloadPrimary(e)}}}preloadPrimary(e){const t=this.findItemIndex(e),i=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(i)}bufferedToEvent(e,t){const i=e.event,r=i.assetList.length===0&&!i.assetListLoader,s=i.cue.once;if(r||!s){const a=this.preloadAssets(i,t);if(a!=null&&a.interstitial.appendInPlace){const o=i.assetList[t],l=this.primaryMedia;o&&l&&this.bufferAssetPlayer(a,l)}}}preloadAssets(e,t){const i=e.assetUrl,r=e.assetList.length,s=r===0&&!e.assetListLoader,a=e.cue.once;if(s){const l=e.timelineStart;if(e.appendInPlace){var o;const p=this.playingItem;!this.isInterstitial(p)&&(p==null||(o=p.nextEvent)==null?void 0:o.identifier)===e.identifier&&this.flushFrontBuffer(l+.25)}let u,h=0;if(!this.playingItem&&this.primaryLive&&(h=this.hls.startPosition,h===-1&&(h=this.hls.liveSyncPosition||0)),h&&!(e.cue.pre||e.cue.post)){const p=h-l;p>0&&(u=Math.round(p*1e3)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${i?1:r} ${e}${u?` live-start: ${h} start-offset: ${u}`:""}`),i)return this.createAsset(e,0,0,l,e.duration,i);const d=this.assetListLoader.loadAssetList(e,u);d&&(e.assetListLoader=d)}else if(!a&&r){for(let l=t;l<r;l++){const u=e.assetList[l],h=this.getAssetPlayerQueueIndex(u.identifier);(h===-1||this.playerQueue[h].destroyed)&&!u.error&&this.createAssetPlayer(e,u,l)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(T.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let i=0;i<t.length;i++)if(e===t[i].assetId)return i;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t){for(let i=0;i<e.length;i++)if(e[i].media===t)return e[i]}return null}createAsset(e,t,i,r,s,a){const o={parentIdentifier:e.identifier,identifier:HM(e,a,t),duration:s,startOffset:i,timelineStart:r,uri:a};return this.createAssetPlayer(e,o,t)}createAssetPlayer(e,t,i){const r=this.hls,s=r.userConfig;let a=s.videoPreference;const o=r.loadLevelObj||r.levels[r.currentLevel];(a||o)&&(a=Rt({},a),o.videoCodec&&(a.videoCodec=o.videoCodec),o.videoRange&&(a.allowedVideoRanges=[o.videoRange]));const l=r.audioTracks[r.audioTrack],u=r.subtitleTracks[r.subtitleTrack];let h=0;if(this.primaryLive||e.appendInPlace){const x=this.timelinePos-t.timelineStart;if(x>1){const N=t.duration;N&&x<N&&(h=x)}}const d=t.identifier,p=xt(xt({},s),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:r.sessionId,assetPlayerId:d,abrEwmaDefaultEstimate:r.bandwidthEstimate,interstitialsController:void 0,startPosition:h,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:a,audioPreference:l||s.audioPreference,subtitlePreference:u||s.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));const g=p.cmcd;g!=null&&g.sessionId&&g.contentId&&(p.cmcd=Rt({},g,{contentId:El(t.uri)})),this.getAssetPlayer(d)&&this.warn(`Duplicate date range identifier ${e} and asset ${d}`);const m=new YM(this.HlsPlayerClass,p,e,t);this.playerQueue.push(m),e.assetList[i]=t;const y=x=>{if(x.live){const L=new Error(`Interstitials MUST be VOD assets ${e}`),C={fatal:!0,type:$e.OTHER_ERROR,details:Z.INTERSTITIAL_ASSET_ITEM_ERROR,error:L};this.handleAssetItemError(C,e,this.schedule.findEventIndex(e.identifier),i,L.message);return}const N=x.edge-x.fragmentStart,F=t.duration;(F===null||N>F)&&(this.log(`Interstitial asset "${d}" duration change ${F} > ${N}`),t.duration=N,this.updateSchedule())};m.on(T.LEVEL_UPDATED,(x,{details:N})=>y(N)),m.on(T.LEVEL_PTS_UPDATED,(x,{details:N})=>y(N));const b=(x,N)=>{const F=this.getAssetPlayer(d);if(F&&N.tracks){F.off(T.BUFFER_CODECS,b),F.tracks=N.tracks;const L=this.primaryMedia;this.bufferingAsset===F.assetItem&&L&&!F.media&&this.bufferAssetPlayer(F,L)}};m.on(T.BUFFER_CODECS,b);const A=()=>{var x;const N=this.getAssetPlayer(d);if(this.log(`buffered to end of asset ${N}`),!N)return;const F=this.schedule.findEventIndex(e.identifier),L=(x=this.schedule.items)==null?void 0:x[F];if(this.isInterstitial(L)){const M=e.findAssetIndex(t),_=Qg(e,M);if(!e.isAssetPastPlayoutLimit(_))this.bufferedToItem(L,_);else{var C;const R=(C=this.schedule.items)==null?void 0:C[F+1];R&&this.bufferedToItem(R)}}};m.on(T.BUFFERED_TO_END,A);const w=x=>()=>{if(!this.getAssetPlayer(d))return;this.shouldPlay=!0;const F=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,F,x)};return m.once(T.MEDIA_ENDED,w(i)),m.once(T.PLAYOUT_LIMIT_REACHED,w(1/0)),m.on(T.ERROR,(x,N)=>{const F=this.getAssetPlayer(d);if(N.details===Z.BUFFER_STALLED_ERROR){if(F!=null&&F.media){const L=F.currentTime,C=F.duration-L;L&&e.appendInPlace&&C/F.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${d} ${e} at ${F.media.currentTime}`),A()):(this.warn(`Stalled at ${L} of ${L+C} in asset ${d} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}return}this.handleAssetItemError(N,e,this.schedule.findEventIndex(e.identifier),i,`Asset player error ${N.error} ${e}`)}),m.on(T.DESTROYING,()=>{if(!this.getAssetPlayer(d))return;const N=new Error(`Asset player destroyed unexpectedly ${d}`),F={fatal:!0,type:$e.OTHER_ERROR,details:Z.INTERSTITIAL_ASSET_ITEM_ERROR,error:N};this.handleAssetItemError(F,e,this.schedule.findEventIndex(e.identifier),i,N.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${so(t)}`),this.hls.trigger(T.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:i,event:e,player:m}),m}clearInterstitial(e,t){e.assetList.forEach(i=>{this.clearAssetPlayer(i.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);const i=this.playerQueue[t];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(e,t){const i=this.getAssetPlayerQueueIndex(e);if(i!==-1){this.log(`clear asset player "${e}" toSegment: ${t&&ws(t)}`);const r=this.playerQueue[i];this.transferMediaFromPlayer(r,t),this.playerQueue.splice(i,1),r.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,i,r,s){const{interstitial:a,assetItem:o,assetId:l}=e,u=a.assetList.length,h=this.playingAsset;this.endedAsset=null,this.playingAsset=o,(!h||h.identifier!==l)&&(h&&(this.clearAssetPlayer(h.identifier,i[r]),delete h.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${u} ${so(o)}`),this.hls.trigger(T.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:t,event:a,schedule:i.slice(0),scheduleIndex:r,player:e})),this.bufferAssetPlayer(e,s)}bufferAssetPlayer(e,t){var i,r;const{interstitial:s,assetItem:a}=e,o=this.schedule.findEventIndex(s.identifier),l=(i=this.schedule.items)==null?void 0:i[o];if(!l)return;this.setBufferingItem(l),this.bufferingAsset=a;const u=this.getBufferingPlayer();if(u===e)return;const h=s.appendInPlace;if(h&&(u==null?void 0:u.interstitial.appendInPlace)===!1)return;const d=(u==null?void 0:u.tracks)||((r=this.detachedData)==null?void 0:r.tracks)||this.requiredTracks;if(h&&a!==this.playingAsset){if(!e.tracks)return;if(d&&!q1(d,e.tracks)){const p=new Error(`Asset ${so(a)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(d)}')`),g={fatal:!0,type:$e.OTHER_ERROR,details:Z.INTERSTITIAL_ASSET_ITEM_ERROR,error:p},m=s.findAssetIndex(a);this.handleAssetItemError(g,s,o,m,p.message);return}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,i,r,s){if(e.details===Z.BUFFER_STALLED_ERROR)return;const a=t.assetList[r];this.warn(`INTERSTITIAL_ASSET_ERROR ${a&&so(a)} ${e.error}`);const o=a==null?void 0:a.identifier,l=this.getAssetPlayerQueueIndex(o),u=this.playerQueue[l]||null,h=this.schedule.items,d=Rt({},e,{fatal:!1,errorAction:ul(!0),asset:a,assetListIndex:r,event:t,schedule:h,scheduleIndex:i,player:u});if(this.hls.trigger(T.INTERSTITIAL_ASSET_ERROR,d),!e.fatal)return;const p=this.playingAsset,g=new Error(s);if(a&&(this.clearAssetPlayer(o,null),a.error=g),!t.assetList.some(m=>!m.error))t.error=g;else if(t.appendInPlace){for(let m=r;m<t.assetList.length;m++)this.resetAssetPlayer(t.assetList[m].identifier);this.updateSchedule()}t.error?this.primaryFallback(t):p&&p.identifier===o&&this.advanceAfterAssetEnded(t,i,r)}primaryFallback(e){const t=e.timelineStart,i=this.effectivePlayingItem;if(this.updateSchedule(),i){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${i?ws(i):"<none>"} error: ${e.error}`);let r=this.timelinePos;r===-1&&(r=this.hls.startPosition);const s=this.updateItem(i,r);this.itemsMatch(i,s)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const a=this.schedule.findItemIndexAtTime(r);this.setSchedulePosition(a)}else this.checkStart()}onAssetListLoaded(e,t){var i;const r=t.event,s=r.identifier,a=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(s))return;const o=r.timelineStart,l=r.duration;let u=0;a.forEach((m,y)=>{const b=parseFloat(m.DURATION);this.createAsset(r,y,u,o+u,b,m.URI),u+=b}),r.duration=u,this.log(`Loaded asset-list with duration: ${u} (was: ${l}) ${r}`);const h=this.waitingItem,d=(h==null?void 0:h.event.identifier)===s;this.updateSchedule();const p=(i=this.bufferingItem)==null?void 0:i.event;if(d){var g;const m=this.schedule.findEventIndex(s),y=(g=this.schedule.items)==null?void 0:g[m];if(y){if(!this.playingItem&&this.timelinePos>y.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==m){r.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${r}`),this.primaryFallback(r);return}this.setBufferingItem(y)}this.setSchedulePosition(m)}else if((p==null?void 0:p.identifier)===s&&p.appendInPlace){const m=r.assetList[0],y=this.getAssetPlayer(m.identifier),b=this.primaryMedia;m&&y&&b&&this.bufferAssetPlayer(y,b)}}onError(e,t){switch(t.details){case Z.ASSET_LIST_PARSING_ERROR:case Z.ASSET_LIST_LOAD_ERROR:case Z.ASSET_LIST_LOAD_TIMEOUT:{const i=t.interstitial;i&&this.primaryFallback(i);break}case Z.BUFFER_STALLED_ERROR:{this.onTimeupdate(),this.checkBuffer(!0);break}}}}const XA=500;class JM extends Ig{constructor(e,t,i){super(e,t,i,"subtitle-stream-controller",Oe.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(T.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(T.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(T.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=de.IDLE,this.setInterval(XA),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:r}=t;if(Ei(i)&&(this.fragPrevious=i),this.state=de.IDLE,!r)return;const s=this.tracksBuffered[this.currentTrackId];if(!s)return;let a;const o=i.start;for(let u=0;u<s.length;u++)if(o>=s[u].start&&o<=s[u].end){a=s[u];break}const l=i.start+i.duration;a?a.end=l:(a={start:o,end:l},s.push(a)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:i,endOffset:r}=t;if(i===0&&r!==Number.POSITIVE_INFINITY){const s=r-1;if(s<=0)return;t.endOffsetSubtitles=Math.max(0,s),this.tracksBuffered.forEach(a=>{for(let o=0;o<a.length;){if(a[o].end<=s){a.shift();continue}else if(a[o].start<s)a[o].start=s;else break;o++}}),this.fragmentTracker.removeFragmentsInRange(i,s,Oe.SUBTITLE)}}onError(e,t){const i=t.frag;(i==null?void 0:i.type)===Oe.SUBTITLE&&(t.details===Z.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==de.STOPPED&&(this.state=de.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&LA(this.levels,t)){this.levels=t.map(i=>new ll(i));return}this.tracksBuffered=[],this.levels=t.map(i=>{const r=new ll(i);return this.tracksBuffered[r.id]=[],r}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,Oe.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,!((i=this.levels)!=null&&i.length)||this.currentTrackId===-1){this.clearInterval();return}const r=this.levels[this.currentTrackId];r!=null&&r.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,r&&this.state!==de.STOPPED&&this.setInterval(XA)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:r,levels:s}=this,{details:a,id:o}=t;if(!s){this.warn(`Subtitle tracks were reset while loading level ${o}`);return}const l=s[o];if(o>=s.length||!l)return;this.log(`Subtitle track ${o} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let u=0;if(a.live||(i=l.details)!=null&&i.live){const d=this.mainDetails;if(a.deltaUpdateFailed||!d)return;const p=d.fragments[0];if(!l.details)a.hasProgramDateTime&&d.hasProgramDateTime?(oc(a,d),u=a.fragmentStart):p&&(u=p.start,Rg(a,u));else{var h;u=this.alignPlaylists(a,l.details,(h=this.levelLastLoaded)==null?void 0:h.details),u===0&&p&&(u=p.start,Rg(a,u))}}l.details=a,this.levelLastLoaded=l,o===r&&(this.hls.trigger(T.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===de.IDLE&&(na(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),l.details=void 0)))}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,r=t.decryptdata,s=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&r!=null&&r.key&&r.iv&&Ja(r.method)){const a=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer,Eg(r.method)).catch(o=>{throw s.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.FRAG_DECRYPT_ERROR,fatal:!1,error:o,reason:o.message,frag:t}),o}).then(o=>{const l=performance.now();s.trigger(T.FRAG_DECRYPTED,{frag:t,payload:o,stats:{tstart:a,tdecrypt:l}})}).catch(o=>{this.warn(`${o.name}: ${o.message}`),this.state=de.IDLE})}}doTick(){if(!this.media){this.state=de.IDLE;return}if(this.state===de.IDLE){const{currentTrackId:e,levels:t}=this,i=t==null?void 0:t[e];if(!i||!t.length||!i.details||this.waitForLive(i))return;const{config:r}=this,s=this.getLoadPosition(),a=Je.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],s,r.maxBufferHole),{end:o,len:l}=a,u=i.details,h=this.hls.maxBufferLength+u.levelTargetDuration;if(l>h)return;const d=u.fragments,p=d.length,g=u.edge;let m=null;const y=this.fragPrevious;if(o<g){const w=r.maxFragLookUpTolerance,x=o>g-w?0:w;m=na(y,d,Math.max(d[0].start,o),x),!m&&y&&y.start<d[0].start&&(m=d[0])}else m=d[p-1];if(m=this.filterReplacedPrimary(m,i.details),!m)return;const b=m.sn-u.startSN,A=d[b-1];if(A&&A.cc===m.cc&&this.fragmentTracker.getState(A)===fi.NOT_LOADED&&(m=A),this.fragmentTracker.getState(m)===fi.NOT_LOADED){const w=this.mapToInitFragWhenRequired(m);w&&this.loadFragment(w,i,o)}}}loadFragment(e,t,i){Ei(e)?super.loadFragment(e,t,i):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new QM(this.tracksBuffered[this.currentTrackId]||[])}}class QM{constructor(e){this.buffered=void 0;const t=(i,r,s)=>{if(r=r>>>0,r>s-1)throw new DOMException(`Failed to execute '${i}' on 'TimeRanges': The index provided (${r}) is greater than the maximum bound (${s})`);return e[r][i]};this.buffered={get length(){return e.length},end(i){return t("end",i,e.length)},start(i){return t("start",i,e.length)}}}}const ZM={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},JA=n=>String.fromCharCode(ZM[n]||n),Br=15,qn=100,ek={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},tk={17:2,18:4,21:6,22:8,23:10,19:13,20:15},ik={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},rk={25:2,26:4,29:6,30:8,31:10,27:13,28:15},nk=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class sk{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i=typeof t=="function"?t():t;Et.log(`${this.time} [${e}] ${i}`)}}}const sa=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class QA{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class ak{constructor(){this.uchar=" ",this.penState=new QA}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class ok{constructor(e){this.chars=[],this.pos=0,this.currPenState=new QA,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<qn;t++)this.chars.push(new ak);this.logger=e}equals(e){for(let t=0;t<qn;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<qn;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<qn;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>qn&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=qn)}moveCursor(e){const t=this.pos+e;if(e>1)for(let i=this.pos+1;i<t+1;i++)this.chars[i].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=JA(e);if(this.pos>=qn){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<qn;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<qn;i++){const r=this.chars[i].uchar;r!==" "&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Zg{constructor(e){this.rows=[],this.currRow=Br-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Br;t++)this.rows.push(new ok(e));this.logger=e}reset(){for(let e=0;e<Br;e++)this.rows[e].clear();this.currRow=Br-1}equals(e){let t=!0;for(let i=0;i<Br;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<Br;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Br;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+zt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let o=0;o<Br;o++)this.rows[o].clear();const s=this.currRow+1-this.nrRollUpRows,a=this.lastOutputScreen;if(a){const o=a.rows[s].cueStartTime,l=this.logger.time;if(o!==null&&l!==null&&o<l)for(let u=0;u<this.nrRollUpRows;u++)this.rows[t-this.nrRollUpRows+u+1].copy(a.rows[s+u])}}this.currRow=t;const i=this.rows[this.currRow];if(e.indent!==null){const s=e.indent,a=Math.max(s-1,0);i.setCursor(e.indent),e.color=i.chars[a].penState.foreground}const r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+zt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",r=-1;for(let s=0;s<Br;s++){const a=this.rows[s].getTextString();a&&(r=s+1,e?t.push("Row "+r+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(e?i="["+t.join(" | ")+"]":i=t.join(`
`)),i}getTextAndFormat(){return this.rows}}class ZA{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Zg(i),this.nonDisplayedMemory=new Zg(i),this.lastOutputScreen=new Zg(i),this.currRollUpRow=this.displayedMemory.rows[Br-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[Br-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let i=0;i<e.length;i++)this.writeScreen.insertChar(e[i]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2===1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,r=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=r[i]}this.logger.log(2,"MIDROW: "+zt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=t:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t),this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class eS{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=uk(),this.logger=void 0;const r=this.logger=new sk;this.channels=[null,new ZA(e,t,r),new ZA(e+1,i,r)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let i=0;i<t.length;i+=2){const r=t[i]&127,s=t[i+1]&127;let a=!1,o=null;if(r===0&&s===0)continue;this.logger.log(3,()=>"["+sa([t[i],t[i+1]])+"] -> ("+sa([r,s])+")");const l=this.cmdHistory;if(r>=16&&r<=31){if(lk(r,s,l)){bc(null,null,l),this.logger.log(3,()=>"Repeated command ("+sa([r,s])+") is dropped");continue}bc(r,s,this.cmdHistory),a=this.parseCmd(r,s),a||(a=this.parseMidrow(r,s)),a||(a=this.parsePAC(r,s)),a||(a=this.parseBackgroundAttributes(r,s))}else bc(null,null,l);if(!a&&(o=this.parseChars(r,s),o)){const h=this.currentChannel;h&&h>0?this.channels[h].insertChars(o):this.logger.log(2,"No channel found yet. TEXT-MODE?")}!a&&!o&&this.logger.log(2,()=>"Couldn't parse cleaned data "+sa([r,s])+" orig: "+sa([t[i],t[i+1]]))}}parseCmd(e,t){const i=(e===20||e===28||e===21||e===29)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=33&&t<=35;if(!(i||r))return!1;const s=e===20||e===21||e===23?1:2,a=this.channels[s];return e===20||e===21||e===28||e===29?t===32?a.ccRCL():t===33?a.ccBS():t===34?a.ccAOF():t===35?a.ccAON():t===36?a.ccDER():t===37?a.ccRU(2):t===38?a.ccRU(3):t===39?a.ccRU(4):t===40?a.ccFON():t===41?a.ccRDC():t===42?a.ccTR():t===43?a.ccRTD():t===44?a.ccEDM():t===45?a.ccCR():t===46?a.ccENM():t===47&&a.ccEOC():a.ccTO(t-32),this.currentChannel=s,!0}parseMidrow(e,t){let i=0;if((e===17||e===25)&&t>=32&&t<=47){if(e===17?i=1:i=2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const r=this.channels[i];return r?(r.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+sa([e,t])+")"),!0):!1}return!1}parsePAC(e,t){let i;const r=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,s=(e===16||e===24)&&t>=64&&t<=95;if(!(r||s))return!1;const a=e<=23?1:2;t>=64&&t<=95?i=a===1?ek[e]:ik[e]:i=a===1?tk[e]:rk[e];const o=this.channels[a];return o?(o.setPAC(this.interpretPAC(i,t)),this.currentChannel=a,!0):!1}interpretPAC(e,t){let i;const r={color:null,italics:!1,indent:null,underline:!1,row:e};return t>95?i=t-96:i=t-64,r.underline=(i&1)===1,i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=Math.floor((i-16)/2)*4,r}parseChars(e,t){let i,r=null,s=null;if(e>=25?(i=2,s=e-8):(i=1,s=e),s>=17&&s<=19){let a;s===17?a=t+80:s===18?a=t+112:a=t+144,this.logger.log(2,()=>"Special char '"+JA(a)+"' in channel "+i),r=[a]}else e>=32&&e<=127&&(r=t===0?[e]:[e,t]);return r&&this.logger.log(3,()=>"Char codes =  "+sa(r).join(",")),r}parseBackgroundAttributes(e,t){const i=(e===16||e===24)&&t>=32&&t<=47,r=(e===23||e===31)&&t>=45&&t<=47;if(!(i||r))return!1;let s;const a={};e===16||e===24?(s=Math.floor((t-32)/2),a.background=nk[s],t%2===1&&(a.background=a.background+"_semi")):t===45?a.background="transparent":(a.foreground="black",t===47&&(a.underline=!0));const o=e<=23?1:2;return this.channels[o].setBkgData(a),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}bc(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function bc(n,e,t){t.a=n,t.b=e}function lk(n,e,t){return t.a===n&&t.b===e}function uk(){return{a:null,b:null}}var ep=function(){if(ic!=null&&ic.VTTCue)return self.VTTCue;const n=["","lr","rl"],e=["start","middle","end","left","right"];function t(o,l){if(typeof l!="string"||!Array.isArray(o))return!1;const u=l.toLowerCase();return~o.indexOf(u)?u:!1}function i(o){return t(n,o)}function r(o){return t(e,o)}function s(o,...l){let u=1;for(;u<arguments.length;u++){const h=arguments[u];for(const d in h)o[d]=h[d]}return o}function a(o,l,u){const h=this,d={enumerable:!0};h.hasBeenReset=!1;let p="",g=!1,m=o,y=l,b=u,A=null,w="",x=!0,N="auto",F="start",L=50,C="middle",M=50,_="middle";Object.defineProperty(h,"id",s({},d,{get:function(){return p},set:function(R){p=""+R}})),Object.defineProperty(h,"pauseOnExit",s({},d,{get:function(){return g},set:function(R){g=!!R}})),Object.defineProperty(h,"startTime",s({},d,{get:function(){return m},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");m=R,this.hasBeenReset=!0}})),Object.defineProperty(h,"endTime",s({},d,{get:function(){return y},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");y=R,this.hasBeenReset=!0}})),Object.defineProperty(h,"text",s({},d,{get:function(){return b},set:function(R){b=""+R,this.hasBeenReset=!0}})),Object.defineProperty(h,"region",s({},d,{get:function(){return A},set:function(R){A=R,this.hasBeenReset=!0}})),Object.defineProperty(h,"vertical",s({},d,{get:function(){return w},set:function(R){const U=i(R);if(U===!1)throw new SyntaxError("An invalid or illegal string was specified.");w=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"snapToLines",s({},d,{get:function(){return x},set:function(R){x=!!R,this.hasBeenReset=!0}})),Object.defineProperty(h,"line",s({},d,{get:function(){return N},set:function(R){if(typeof R!="number"&&R!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");N=R,this.hasBeenReset=!0}})),Object.defineProperty(h,"lineAlign",s({},d,{get:function(){return F},set:function(R){const U=r(R);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");F=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"position",s({},d,{get:function(){return L},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");L=R,this.hasBeenReset=!0}})),Object.defineProperty(h,"positionAlign",s({},d,{get:function(){return C},set:function(R){const U=r(R);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");C=U,this.hasBeenReset=!0}})),Object.defineProperty(h,"size",s({},d,{get:function(){return M},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");M=R,this.hasBeenReset=!0}})),Object.defineProperty(h,"align",s({},d,{get:function(){return _},set:function(R){const U=r(R);if(!U)throw new SyntaxError("An invalid or illegal string was specified.");_=U,this.hasBeenReset=!0}})),h.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}();class ck{decode(e,t){if(!e)return"";if(typeof e!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function tS(n){function e(i,r,s,a){return(i|0)*3600+(r|0)*60+(s|0)+parseFloat(a||0)}const t=n.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class hk{constructor(){this.values=Object.create(null)}set(e,t){!this.get(e)&&t!==""&&(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function iS(n,e,t,i){const r=i?n.split(i):[n];for(const s in r){if(typeof r[s]!="string")continue;const a=r[s].split(t);if(a.length!==2)continue;const o=a[0],l=a[1];e(o,l)}}const tp=new ep(0,0,""),Ec=tp.align==="middle"?"middle":"center";function dk(n,e,t){const i=n;function r(){const o=tS(n);if(o===null)throw new Error("Malformed timestamp: "+i);return n=n.replace(/^[^\sa-zA-Z-]+/,""),o}function s(o,l){const u=new hk;iS(o,function(p,g){let m;switch(p){case"region":for(let y=t.length-1;y>=0;y--)if(t[y].id===g){u.set(p,t[y].region);break}break;case"vertical":u.alt(p,g,["rl","lr"]);break;case"line":m=g.split(","),u.integer(p,m[0]),u.percent(p,m[0])&&u.set("snapToLines",!1),u.alt(p,m[0],["auto"]),m.length===2&&u.alt("lineAlign",m[1],["start",Ec,"end"]);break;case"position":m=g.split(","),u.percent(p,m[0]),m.length===2&&u.alt("positionAlign",m[1],["start",Ec,"end","line-left","line-right","auto"]);break;case"size":u.percent(p,g);break;case"align":u.alt(p,g,["start",Ec,"end","left","right"]);break}},/:/,/\s/),l.region=u.get("region",null),l.vertical=u.get("vertical","");let h=u.get("line","auto");h==="auto"&&tp.line===-1&&(h=-1),l.line=h,l.lineAlign=u.get("lineAlign","start"),l.snapToLines=u.get("snapToLines",!0),l.size=u.get("size",100),l.align=u.get("align",Ec);let d=u.get("position","auto");d==="auto"&&tp.position===50&&(d=l.align==="start"||l.align==="left"?0:l.align==="end"||l.align==="right"?100:50),l.position=d}function a(){n=n.replace(/^\s+/,"")}if(a(),e.startTime=r(),a(),n.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+i);n=n.slice(3),a(),e.endTime=r(),a(),s(n,e)}function rS(n){return n.replace(/<br(?: \/)?>/gi,`
`)}let fk=class{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new ck,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));function i(){let s=t.buffer,a=0;for(s=rS(s);a<s.length&&s[a]!=="\r"&&s[a]!==`
`;)++a;const o=s.slice(0,a);return s[a]==="\r"&&++a,s[a]===`
`&&++a,t.buffer=s.slice(a),o}function r(s){iS(s,function(a,o){},/:/)}try{let s="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;s=i();const o=s.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(o!=null&&o[0]))throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:s=i(),t.state){case"HEADER":/:/.test(s)?r(s):s||(t.state="ID");continue;case"NOTE":s||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(s)){t.state="NOTE";break}if(!s)continue;if(t.cue=new ep(0,0,""),t.state="CUE",s.indexOf("-->")===-1){t.cue.id=s;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{dk(s,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const o=s.indexOf("-->")!==-1;if(!s||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=s}continue;case"BADCUE":s||(t.state="ID")}}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||e.state==="HEADER")&&(e.buffer+=`

`,e.parse()),e.state==="INITIAL"||e.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}};const gk=/\r\n|\n\r|\n|\r/g,ip=function(e,t,i=0){return e.slice(i,i+t.length)===t},pk=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),s=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!_e(t)||!_e(i)||!_e(r)||!_e(s))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=60*1e3*r,t+=60*60*1e3*s,t};function rp(n,e,t){return El(n.toString())+El(e.toString())+El(t)}const mk=function(e,t,i){let r=e[t],s=e[r.prevCC];if(!s||!s.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;(a=s)!=null&&a.new;){var a;e.ccOffset+=r.start-s.start,r.new=!1,r=s,s=e[r.prevCC]}e.presentationOffset=i};function yk(n,e,t,i,r,s,a){const o=new fk,l=ur(new Uint8Array(n)).trim().replace(gk,`
`).split(`
`),u=[],h=e?B_(e.baseTime,e.timescale):0;let d="00:00.000",p=0,g=0,m,y=!0;o.oncue=function(b){const A=t[i];let w=t.ccOffset;const x=(p-h)/9e4;if(A!=null&&A.new&&(g!==void 0?w=t.ccOffset=A.start:mk(t,i,x)),x){if(!e){m=new Error("Missing initPTS for VTT MPEGTS");return}w=x-t.presentationOffset}const N=b.endTime-b.startTime,F=Sr((b.startTime+w-g)*9e4,r*9e4)/9e4;b.startTime=Math.max(F,0),b.endTime=Math.max(F+N,0);const L=b.text.trim();b.text=decodeURIComponent(encodeURIComponent(L)),b.id||(b.id=rp(b.startTime,b.endTime,L)),b.endTime>0&&u.push(b)},o.onparsingerror=function(b){m=b},o.onflush=function(){if(m){a(m);return}s(u)},l.forEach(b=>{if(y)if(ip(b,"X-TIMESTAMP-MAP=")){y=!1,b.slice(16).split(",").forEach(A=>{ip(A,"LOCAL:")?d=A.slice(6):ip(A,"MPEGTS:")&&(p=parseInt(A.slice(7)))});try{g=pk(d)/1e3}catch(A){m=A}return}else b===""&&(y=!1);o.parse(b+`
`)}),o.flush()}const np="stpp.ttml.im1t",nS=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,sS=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,vk={left:"start",center:"center",right:"end",start:"start",end:"end"};function aS(n,e,t,i){const r=rt(new Uint8Array(n),["mdat"]);if(r.length===0){i(new Error("Could not parse IMSC1 mdat"));return}const s=r.map(o=>ur(o)),a=F_(e.baseTime,1,e.timescale);try{s.forEach(o=>t(bk(o,a)))}catch(o){i(o)}}function bk(n,e){const r=new DOMParser().parseFromString(n,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");const s={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},a=Object.keys(s).reduce((d,p)=>(d[p]=r.getAttribute(`ttp:${p}`)||s[p],d),{}),o=r.getAttribute("xml:space")!=="preserve",l=oS(sp(r,"styling","style")),u=oS(sp(r,"layout","region")),h=sp(r,"body","[begin]");return[].map.call(h,d=>{const p=lS(d,o);if(!p||!d.hasAttribute("begin"))return null;const g=op(d.getAttribute("begin"),a),m=op(d.getAttribute("dur"),a);let y=op(d.getAttribute("end"),a);if(g===null)throw uS(d);if(y===null){if(m===null)throw uS(d);y=g+m}const b=new ep(g-e,y-e,p);b.id=rp(b.startTime,b.endTime,b.text);const A=u[d.getAttribute("region")],w=l[d.getAttribute("style")],x=Ek(A,w,l),{textAlign:N}=x;if(N){const F=vk[N];F&&(b.lineAlign=F),b.align=N}return Rt(b,x),b}).filter(d=>d!==null)}function sp(n,e,t){const i=n.getElementsByTagName(e)[0];return i?[].slice.call(i.querySelectorAll(t)):[]}function oS(n){return n.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function lS(n,e){return[].slice.call(n.childNodes).reduce((t,i,r)=>{var s;return i.nodeName==="br"&&r?t+`
`:(s=i.childNodes)!=null&&s.length?lS(i,e):e?t+i.textContent.trim().replace(/\s+/g," "):t+i.textContent},"")}function Ek(n,e,t){const i="http://www.w3.org/ns/ttml#styling";let r=null;const s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],a=n!=null&&n.hasAttribute("style")?n.getAttribute("style"):null;return a&&t.hasOwnProperty(a)&&(r=t[a]),s.reduce((o,l)=>{const u=ap(e,i,l)||ap(n,i,l)||ap(r,i,l);return u&&(o[l]=u),o},{})}function ap(n,e,t){return n&&n.hasAttributeNS(e,t)?n.getAttributeNS(e,t):null}function uS(n){return new Error(`Could not parse ttml timestamp ${n}`)}function op(n,e){if(!n)return null;let t=tS(n);return t===null&&(nS.test(n)?t=Ak(n,e):sS.test(n)&&(t=Sk(n,e))),t}function Ak(n,e){const t=nS.exec(n),i=(t[4]|0)+(t[5]|0)/e.subFrameRate;return(t[1]|0)*3600+(t[2]|0)*60+(t[3]|0)+i/e.frameRate}function Sk(n,e){const t=sS.exec(n),i=Number(t[1]);switch(t[2]){case"h":return i*3600;case"m":return i*60;case"ms":return i*1e3;case"f":return i/e.frameRate;case"t":return i/e.tickRate}return i}class Ac{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class xk{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=dS(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(T.FRAG_LOADING,this.onFragLoading,this),e.on(T.FRAG_LOADED,this.onFragLoaded,this),e.on(T.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(T.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(T.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(T.FRAG_LOADING,this.onFragLoading,this),e.off(T.FRAG_LOADED,this.onFragLoaded,this),e.off(T.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(T.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(T.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(T.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new Ac(this,"textTrack1"),t=new Ac(this,"textTrack2"),i=new Ac(this,"textTrack3"),r=new Ac(this,"textTrack4");this.cea608Parser1=new eS(1,e,t),this.cea608Parser2=new eS(3,i,r)}addCues(e,t,i,r,s){let a=!1;for(let o=s.length;o--;){const l=s[o],u=Tk(l[0],l[1],t,i);if(u>=0&&(l[0]=Math.min(l[0],t),l[1]=Math.max(l[1],i),a=!0,u/(i-t)>.5))return}if(a||s.push([t,i]),this.config.renderTextTracksNatively){const o=this.captionsTracks[e];this.Cues.newCue(o,t,i,r)}else{const o=this.Cues.newCue(null,t,i,r);this.hls.trigger(T.CUES_PARSED,{type:"captions",cues:o,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:s}){const{unparsedVttFrags:a}=this;i===Oe.MAIN&&(this.initPTS[t.cc]={baseTime:r,timescale:s}),a.length&&(this.unparsedVttFrags=[],a.forEach(o=>{this.onFragLoaded(T.FRAG_LOADED,o)}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let r=0;r<i.textTracks.length;r++){const s=i.textTracks[r];if(hS(s,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return s}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:r}=this,{label:s,languageCode:a}=t[e],o=this.getExistingTrack(s,a);if(o)i[e]=o,ro(i[e]),KA(i[e],r);else{const l=this.createTextTrack("captions",s,a);l&&(l[e]=!0,i[e]=l)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i=t.label,r={_id:e,label:i,kind:"captions",default:t.media?!!t.media.default:!1,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(T.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,i){const r=this.media;if(r)return r.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const i=!!t.transferMedia;if(this.media=null,i)return;const{captionsTracks:r}=this;Object.keys(r).forEach(s=>{ro(r[s]),delete r[s]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=dS(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let i=0;i<t.length;i++)ro(t[i])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],r=i.some(s=>s.textCodec===np);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){if(LA(this.tracks,i)){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const a=this.media,o=a?yc(a.textTracks):null;if(this.tracks.forEach((l,u)=>{let h;if(o){let d=null;for(let p=0;p<o.length;p++)if(o[p]&&hS(o[p],l)){d=o[p],o[p]=null;break}d&&(h=d)}if(h)ro(h);else{const d=cS(l);h=this.createTextTrack(d,l.name,l.lang),h&&(h.mode="disabled")}h&&this.textTracks.push(h)}),o!=null&&o.length){const l=o.filter(u=>u!==null).map(u=>u.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const a=this.tracks.map(o=>({label:o.name,kind:o.type.toLowerCase(),default:o.default,subtitleTrack:o}));this.hls.trigger(T.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(i=>{const r=/(?:CC|SERVICE)([1-4])/.exec(i.instreamId);if(!r)return;const s=`textTrack${r[1]}`,a=this.captionsProperties[s];a&&(a.label=i.name,i.lang&&(a.languageCode=i.lang),a.media=i)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return t==null?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Oe.MAIN){var i,r;const{cea608Parser1:s,cea608Parser2:a,lastSn:o}=this,{cc:l,sn:u}=t.frag,h=(i=(r=t.part)==null?void 0:r.index)!=null?i:-1;s&&a&&(u!==o+1||u===o&&h!==this.lastPartIndex+1||l!==this.lastCc)&&(s.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=h}}onFragLoaded(e,t){const{frag:i,payload:r}=t;if(i.type===Oe.SUBTITLE)if(r.byteLength){const s=i.decryptdata,a="stats"in t;if(s==null||!s.encrypted||a){const o=this.tracks[i.level],l=this.vttCCs;l[i.cc]||(l[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),o&&o.textCodec===np?this._parseIMSC1(i,r):this._parseVTTs(t)}}else this.hls.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;aS(t,this.initPTS[e.cc],r=>{this._appendCues(r,e.level),i.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},r=>{i.logger.log(`Failed to parse IMSC1: ${r}`),i.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:r})})}_parseVTTs(e){var t;const{frag:i,payload:r}=e,{initPTS:s,unparsedVttFrags:a}=this,o=s.length-1;if(!s[i.cc]&&o===-1){a.push(e);return}const l=this.hls,u=(t=i.initSegment)!=null&&t.data?Ar(i.initSegment.data,new Uint8Array(r)).buffer:r;yk(u,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,h=>{this._appendCues(h,i.level),l.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},h=>{const d=h.message==="Missing initPTS for VTT MPEGTS";d?a.push(e):this._fallbackToIMSC1(i,r),l.logger.log(`Failed to parse VTT cue: ${h}`),!(d&&o>i.cc)&&l.trigger(T.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:h})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||aS(t,this.initPTS[e.cc],()=>{i.textCodec=np,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const r=this.textTracks[t];if(!r||r.mode==="disabled")return;e.forEach(s=>WA(r,s))}else{const r=this.tracks[t];if(!r)return;const s=r.default?"default":"subtitles"+t;i.trigger(T.CUES_PARSED,{type:"subtitles",cues:e,track:s})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===Oe.SUBTITLE&&this.onFragLoaded(T.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:r}=t;if(!(i.type===Oe.MAIN&&this.closedCaptionsForLevel(i)==="NONE"))for(let s=0;s<r.length;s++){const a=r[s].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();const o=this.extractCea608Data(a);this.cea608Parser1.addData(r[s].pts,o[0]),this.cea608Parser2.addData(r[s].pts,o[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:r,type:s}){const{media:a}=this;if(!(!a||a.currentTime<i)){if(!s||s==="video"){const{captionsTracks:o}=this;Object.keys(o).forEach(l=>Xg(o[l],t,i))}if(this.config.renderTextTracksNatively&&t===0&&r!==void 0){const{textTracks:o}=this;Object.keys(o).forEach(l=>Xg(o[l],t,r))}}}extractCea608Data(e){const t=[[],[]],i=e[0]&31;let r=2;for(let s=0;s<i;s++){const a=e[r++],o=127&e[r++],l=127&e[r++];if(o===0&&l===0)continue;if((4&a)!==0){const h=3&a;(h===0||h===1)&&(t[h].push(o),t[h].push(l))}}return t}}function cS(n){return n.characteristics&&/transcribes-spoken-dialog/gi.test(n.characteristics)&&/describes-music-and-sound/gi.test(n.characteristics)?"captions":"subtitles"}function hS(n,e){return!!n&&n.kind===cS(e)&&Hg(e,n)}function Tk(n,e,t,i){return Math.min(e,i)-Math.max(n,t)}function dS(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}const wk=/\s/,Dk={newCue(n,e,t,i){const r=[];let s,a,o,l,u;const h=self.VTTCue||self.TextTrackCue;for(let p=0;p<i.rows.length;p++)if(s=i.rows[p],o=!0,l=0,u="",!s.isEmpty()){var d;for(let y=0;y<s.chars.length;y++)wk.test(s.chars[y].uchar)&&o?l++:(u+=s.chars[y].uchar,o=!1);s.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;const g=rS(u.trim()),m=rp(e,t,g);n!=null&&(d=n.cues)!=null&&d.getCueById(m)||(a=new h(e,t,g),a.id=m,a.line=p+1,a.align="left",a.position=10+Math.min(80,Math.floor(l*8/32)*10),r.push(a))}return n&&r.length&&(r.sort((p,g)=>p.line==="auto"||g.line==="auto"?0:p.line>8&&g.line>8?g.line-p.line:p.line-g.line),r.forEach(p=>WA(n,p))),r}};function Rk(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}const Ik=/(\d+)-(\d+)\/(\d+)/;class fS{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||_k,this.controller=new self.AbortController,this.stats=new lg}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const r=this.stats;if(r.loading.start)throw new Error("Loader can only be used once.");r.loading.start=self.performance.now();const s=Ck(e,this.controller.signal),a=e.responseType==="arraybuffer",o=a?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,s),self.clearTimeout(this.requestTimeout),t.timeout=l&&_e(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},t.timeout),(yl(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(d=>{var p;this.response=this.loader=d;const g=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(r,e,this.response))},u-(g-r.loading.start)),!d.ok){const{status:y,statusText:b}=d;throw new Mk(b||"fetch, bad network response",y,d)}r.loading.first=g,r.total=Lk(d.headers)||r.total;const m=(p=this.callbacks)==null?void 0:p.onProgress;return m&&_e(t.highWaterMark)?this.loadProgressively(d,r,e,t.highWaterMark,m):a?d.arrayBuffer():e.responseType==="json"?d.json():d.text()}).then(d=>{var p,g;const m=this.response;if(!m)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);const y=d[o];y&&(r.loaded=r.total=y);const b={url:m.url,data:d,code:m.status},A=(p=this.callbacks)==null?void 0:p.onProgress;A&&!_e(t.highWaterMark)&&A(r,e,d,m),(g=this.callbacks)==null||g.onSuccess(b,r,e,m)}).catch(d=>{var p;if(self.clearTimeout(this.requestTimeout),r.aborted)return;const g=d&&d.code||0,m=d?d.message:null;(p=this.callbacks)==null||p.onError({code:g,text:m},e,d?d.details:null,r)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,r=0,s){const a=new iA,o=e.body.getReader(),l=()=>o.read().then(u=>{if(u.done)return a.dataLength&&s(t,i,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const h=u.value,d=h.length;return t.loaded+=d,d<r||a.dataLength?(a.push(h),a.dataLength>=r&&s(t,i,a.flush().buffer,e)):s(t,i,h.buffer,e),l()}).catch(()=>Promise.reject());return l()}}function Ck(n,e){const t={method:"GET",mode:"cors",credentials:"same-origin",signal:e,headers:new self.Headers(Rt({},n.headers))};return n.rangeEnd&&t.headers.set("Range","bytes="+n.rangeStart+"-"+String(n.rangeEnd-1)),t}function Nk(n){const e=Ik.exec(n);if(e)return parseInt(e[2])-parseInt(e[1])+1}function Lk(n){const e=n.get("Content-Range");if(e){const i=Nk(e);if(_e(i))return i}const t=n.get("Content-Length");if(t)return parseInt(t)}function _k(n,e){return new self.Request(n.url,e)}class Mk extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const kk=/^age:\s*[\d.]+\s*$/im;class gS{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new lg,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;const s=this.xhrSetup;s?Promise.resolve().then(()=>{if(!(this.loader!==i||this.stats.aborted))return s(i,t.url)}).catch(a=>{if(!(this.loader!==i||this.stats.aborted))return i.open("GET",t.url,!0),s(i,t.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(a=>{var o;(o=this.callbacks)==null||o.onError({code:i.status,text:a.message},t,i,r)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const r=t.headers,{maxTimeToFirstByteMs:s,maxLoadTimeMs:a}=i.loadPolicy;if(r)for(const o in r)e.setRequestHeader(o,r[o]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=s&&_e(s)?s:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const r=t.readyState,s=this.config;if(!i.aborted&&r>=2&&(i.loading.first===0&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),s.timeout!==s.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),s.timeout=s.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),s.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),r===4)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const u=t.status,h=t.responseType==="text"?t.responseText:null;if(u>=200&&u<300){const m=h??t.response;if(m!=null){var a,o;i.loading.end=Math.max(self.performance.now(),i.loading.first);const y=t.responseType==="arraybuffer"?m.byteLength:m.length;i.loaded=i.total=y,i.bwEstimate=i.total*8e3/(i.loading.end-i.loading.first);const b=(a=this.callbacks)==null?void 0:a.onProgress;b&&b(i,e,m,t);const A={url:t.responseURL,data:m,code:u};(o=this.callbacks)==null||o.onSuccess(A,i,e,t);return}}const d=s.loadPolicy.errorRetry,p=i.retry,g={url:e.url,data:void 0,code:u};if(Zu(d,p,!1,g))this.retry(d);else{var l;Et.error(`${u} while loading ${e.url}`),(l=this.callbacks)==null||l.onError({code:u,text:t.statusText},e,t,i)}}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry,t=this.stats.retry;if(Zu(e,t,!0))this.retry(e);else{var i;Et.warn(`timeout while loading ${(i=this.context)==null?void 0:i.url}`);const r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=mg(e,i.retry),i.retry++,Et.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t==null?void 0:t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&kk.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const Pk={maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null},Ok=xt(xt({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:60*1e3*1e3,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:gS,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:hL,bufferController:Z_,capLevelController:Wg,errorController:mL,fpsController:UM,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:_E,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:Pk},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},Fk()),{},{subtitleStreamController:JM,subtitleTrackController:qM,timelineController:xk,audioStreamController:j_,audioTrackController:X_,emeController:io,cmcdController:OM,contentSteeringController:BM,interstitialsController:XM});function Fk(){return{cueHandler:Dk,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function Bk(n,e,t){if((e.liveSyncDurationCount||e.liveMaxLatencyDurationCount)&&(e.liveSyncDuration||e.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(e.liveMaxLatencyDurationCount!==void 0&&(e.liveSyncDurationCount===void 0||e.liveMaxLatencyDurationCount<=e.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(e.liveMaxLatencyDuration!==void 0&&(e.liveSyncDuration===void 0||e.liveMaxLatencyDuration<=e.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const i=lp(n),r=["manifest","level","frag"],s=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return r.forEach(a=>{const o=`${a==="level"?"playlist":a}LoadPolicy`,l=e[o]===void 0,u=[];s.forEach(h=>{const d=`${a}Loading${h}`,p=e[d];if(p!==void 0&&l){u.push(d);const g=i[o].default;switch(e[o]={default:g},h){case"TimeOut":g.maxLoadTimeMs=p,g.maxTimeToFirstByteMs=p;break;case"MaxRetry":g.errorRetry.maxNumRetry=p,g.timeoutRetry.maxNumRetry=p;break;case"RetryDelay":g.errorRetry.retryDelayMs=p,g.timeoutRetry.retryDelayMs=p;break;case"MaxRetryTimeout":g.errorRetry.maxRetryDelayMs=p,g.timeoutRetry.maxRetryDelayMs=p;break}}}),u.length&&t.warn(`hls.js config: "${u.join('", "')}" setting(s) are deprecated, use "${o}": ${zt(e[o])}`)}),xt(xt({},i),e)}function lp(n){return n&&typeof n=="object"?Array.isArray(n)?n.map(lp):Object.keys(n).reduce((e,t)=>(e[t]=lp(n[t]),e),{}):n}function Uk(n,e){const t=n.loader;t!==fS&&t!==gS?(e.log("[config]: Custom loader detected, cannot enable progressive streaming"),n.progressive=!1):Rk()&&(n.loader=fS,n.progressive=!0,n.enableSoftwareAES=!0,e.log("[config]: Progressive streaming enabled, using FetchLoader"))}const Sc=2,$k=.1,Gk=.05,qk=100;class Vk extends wE{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var i;(i=this.media)!=null&&i.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var i;this.ended=((i=this.media)==null?void 0:i.currentTime)||1,this.hls.trigger(T.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(qk),this.mediaSource=t.mediaSource;const i=this.media=t.media;hr(i,"playing",this.onMediaPlaying),hr(i,"waiting",this.onMediaWaiting),hr(i,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:i}=this;i&&(xr(i,"playing",this.onMediaPlaying),xr(i,"waiting",this.onMediaWaiting),xr(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var i,r;const s=(i=this.hls)==null?void 0:i.config;if(!s)return;const a=this.media;if(!a)return;const{seeking:o}=a,l=this.seeking&&!o,u=!this.seeking&&o,h=a.paused&&!o||a.ended||a.playbackRate===0;if(this.seeking=o,e!==t){t&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,s.nudgeOnVideoHole&&!h&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(u||l){l&&this.stallResolved(e);return}if(h){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(T.MEDIA_ENDED,{stalled:!1}));return}if(!Je.getBuffered(a).length){this.nudgeRetry=0;return}const d=Je.bufferInfo(a,e,0),p=d.nextStart||0,g=this.fragmentTracker;if(o&&g&&this.hls){const L=pS(this.hls.inFlightFragments,e),C=d.len>Sc,M=!p||L||p-e>Sc&&!g.getPartialFragment(e);if(C||M)return;this.moved=!1}const m=(r=this.hls)==null?void 0:r.latestLevelDetails;if(!this.moved&&this.stalled!==null&&g){if(!(d.len>0)&&!p)return;const C=Math.max(p,d.start||0)-e,_=!!(m!=null&&m.live)?m.targetduration*2:Sc,R=g.getPartialFragment(e);if(C>0&&(C<=_||R)){a.paused||this._trySkipBufferHole(R);return}}const y=s.detectStallWithCurrentTimeMs,b=self.performance.now(),A=this.waiting;let w=this.stalled;if(w===null)if(A>0&&b-A<y)w=this.stalled=A;else{this.stalled=b;return}const x=b-w;if(!o&&(x>=y||A)&&this.hls){var N;if(((N=this.mediaSource)==null?void 0:N.readyState)==="ended"&&!(m!=null&&m.live)&&Math.abs(e-((m==null?void 0:m.edge)||0))<1){if(this.ended)return;this.ended=e||1,this.hls.trigger(T.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(d),!this.media||!this.hls)return}const F=Je.bufferInfo(a,e,s.maxBufferHole);this._tryFixBufferStall(F,x,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(T.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var i;const r=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(i=this.buffered.audio)!=null&&i.length&&r&&r.length>1&&e>r.end(0)){const s=Je.bufferedInfo(Je.timeRangesToArray(this.buffered.audio),e,0);if(s.len>1&&t>=s.start){const a=Je.timeRangesToArray(r),o=Je.bufferedInfo(a,t,0).bufferedIndex;if(o>-1&&o<a.length-1){const l=Je.bufferedInfo(a,e,0).bufferedIndex,u=a[o].end,h=a[o+1].start;if((l===-1||l>o)&&h-u<1&&e-u<2){const d=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${u} -> ${h} buffered index: ${l}`);this.warn(d.message),this.media.currentTime+=1e-6;const p=this.fragmentTracker.getPartialFragment(e)||void 0,g=Je.bufferInfo(this.media,e,0);this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:d,reason:d.message,frag:p,buffer:g.len,bufferInfo:g})}}}}}_tryFixBufferStall(e,t,i){var r,s;const{fragmentTracker:a,media:o}=this,l=(r=this.hls)==null?void 0:r.config;if(!o||!a||!l)return;const u=(s=this.hls)==null?void 0:s.latestLevelDetails,h=a.getPartialFragment(i);if((h||u!=null&&u.live&&i<u.fragmentStart)&&(this._trySkipBufferHole(h)||!this.media))return;const d=e.buffered,p=this.adjacentTraversal(e,i);(d&&d.length>1&&e.len>l.maxBufferHole||e.nextStart&&(e.nextStart-i<l.maxBufferHole||p))&&(t>l.highBufferWatchdogPeriod*1e3||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const i=this.fragmentTracker,r=e.nextStart;if(i&&r){const s=i.getFragAtPos(t,Oe.MAIN),a=i.getFragAtPos(r,Oe.MAIN);if(s&&a)return a.sn-s.sn<2}return!1}_reportStall(e){const{hls:t,media:i,stallReported:r,stalled:s}=this;if(!r&&s!==null&&i&&t){this.stallReported=!0;const a=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${zt(e)})`);this.warn(a.message),t.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:s}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:i,media:r}=this,s=(t=this.hls)==null?void 0:t.config;if(!r||!i||!s)return 0;const a=r.currentTime,o=Je.bufferInfo(r,a,0),l=a<o.start?o.start:o.nextStart;if(l&&this.hls){const h=o.len<=s.maxBufferHole,d=o.len>0&&o.len<1&&r.readyState<3,p=l-a;if(p>0&&(h||d)){if(p>s.maxBufferHole){let m=!1;if(a===0){const y=i.getAppendedFrag(0,Oe.MAIN);y&&l<y.end&&(m=!0)}if(!m){const y=e||i.getAppendedFrag(a,Oe.MAIN);if(y){var u;if(!((u=this.hls.loadLevelObj)!=null&&u.details)||pS(this.hls.inFlightFragments,l))return 0;let A=!1,w=y.end;for(;w<l;){const x=i.getPartialFragment(w);if(x)w+=x.duration;else{A=!0;break}}if(A)return 0}}}const g=Math.max(l+Gk,a+$k);if(this.warn(`skipping hole, adjusting currentTime from ${a} to ${g}`),this.moved=!0,r.currentTime=g,!(e!=null&&e.gap)){const m=new Error(`fragment loaded with buffer holes, seeking from ${a} to ${g}`);this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,frag:e||void 0,buffer:o.len,bufferInfo:o})}return g}}return 0}_tryNudgeBuffer(e){const{hls:t,media:i,nudgeRetry:r}=this,s=t==null?void 0:t.config;if(!i||!s)return 0;const a=i.currentTime;if(this.nudgeRetry++,r<s.nudgeMaxRetry){const o=a+(r+1)*s.nudgeOffset,l=new Error(`Nudging 'currentTime' from ${a} to ${o}`);this.warn(l.message),i.currentTime=o,t.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_NUDGE_ON_STALL,error:l,fatal:!1,buffer:e.len,bufferInfo:e})}else{const o=new Error(`Playhead still not moving while enough data buffered @${a} after ${s.nudgeMaxRetry} nudges`);this.error(o.message),t.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.BUFFER_STALLED_ERROR,error:o,fatal:!0,buffer:e.len,bufferInfo:e})}}}function pS(n,e){const t=mS(n.main);if(t&&t.start<=e)return t;const i=mS(n.audio);return i&&i.start<=e?i:null}function mS(n){if(!n)return null;switch(n.state){case de.IDLE:case de.STOPPED:case de.ENDED:case de.ERROR:return null}return n.frag}const Hk=.25;function up(){if(!(typeof self>"u"))return self.VTTCue||self.TextTrackCue}function yS(n,e,t,i,r){let s=new n(e,t,"");try{s.value=i,r&&(s.type=r)}catch{s=new n(e,t,zt(r?xt({type:r},i):i))}return s}const xc=(()=>{const n=up();try{n&&new n(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Kk(n){return Uint8Array.from(n.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Wk{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(T.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(T.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var i;this.media=t.media,((i=t.overrides)==null?void 0:i.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null,!t.transferMedia&&(this.id3Track&&(this.removeCues&&ro(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if(i.kind==="metadata"&&i.label==="id3")return KA(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:r}}}=this;if(!i&&!r)return;const{samples:s}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const a=up();if(a)for(let o=0;o<s.length;o++){const l=s[o].type;if(l===cr.emsg&&!i||!r)continue;const u=cA(s[o].data);if(u){const h=s[o].pts;let d=h+s[o].duration;d>xc&&(d=xc),d-h<=0&&(d=h+Hk);for(let g=0;g<u.length;g++){const m=u[g];if(!hA(m)){this.updateId3CueEnds(h,l);const y=yS(a,h,d,m,l);y&&this.id3Track.addCue(y)}}}}}updateId3CueEnds(e,t){var i;const r=(i=this.id3Track)==null?void 0:i.cues;if(r)for(let s=r.length;s--;){const a=r[s];a.type===t&&a.startTime<e&&a.endTime===xc&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:r}){const{id3Track:s,hls:a}=this;if(!a)return;const{config:{enableEmsgMetadataCues:o,enableID3MetadataCues:l}}=a;if(s&&(o||l)){let u;r==="audio"?u=h=>h.type===cr.audioId3&&l:r==="video"?u=h=>h.type===cr.emsg&&o:u=h=>h.type===cr.audioId3&&l||h.type===cr.emsg&&o,Xg(s,t,i,u)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:i}=this,{dateRanges:r}=e,s=Object.keys(r);let a=this.dateRangeCuesAppended;if(i&&t){var o;if((o=i.cues)!=null&&o.length){const h=Object.keys(a).filter(d=>!s.includes(d));for(let d=h.length;d--;){const p=h[d],g=a[p].cues;delete a[p],Object.keys(g).forEach(m=>{try{const y=g[m];y.removeEventListener("enter",this.onEventCueEnter),i.removeCue(y)}catch{}})}}else a=this.dateRangeCuesAppended={}}const l=e.fragments[e.fragments.length-1];if(s.length===0||!_e(l==null?void 0:l.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const u=up();for(let h=0;h<s.length;h++){const d=s[h],p=r[d],g=p.startTime,m=a[d],y=(m==null?void 0:m.cues)||{};let b=(m==null?void 0:m.durationKnown)||!1,A=xc;const{duration:w,endDate:x}=p;if(x&&w!==null)A=g+w,b=!0;else if(p.endOnNext&&!b){const F=s.reduce((L,C)=>{if(C!==p.id){const M=r[C];if(M.class===p.class&&M.startDate>p.startDate&&(!L||p.startDate<L.startDate))return M}return L},null);F&&(A=F.startTime,b=!0)}const N=Object.keys(p.attr);for(let F=0;F<N.length;F++){const L=N[F];if(!CL(L))continue;const C=y[L];if(C)b&&!m.durationKnown?C.endTime=A:Math.abs(C.startTime-g)>.01&&(C.startTime=g,C.endTime=A);else if(u){let M=p.attr[L];NL(L)&&(M=Kk(M));const R=yS(u,g,A,{key:L,data:M},cr.dateRange);R&&(R.id=d,this.id3Track.addCue(R),y[L]=R,this.hls.config.interstitialsController&&(L==="X-ASSET-LIST"||L==="X-ASSET-URL")&&R.addEventListener("enter",this.onEventCueEnter))}}a[d]={cues:y,dateRange:p,durationKnown:b}}}}class Yk{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:t}=this,i=this.levelDetails;if(!t||!i)return;this.currentTime=t.currentTime;const r=this.computeLatency();if(r===null)return;this._latency=r;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:a}=this.config;if(!s||a===1||!i.live)return;const o=this.targetLatency;if(o===null)return;const l=r-o,u=Math.min(this.maxLatency,o+i.targetduration);if(l<u&&l>.05&&this.forwardBufferLength>1){const d=Math.min(2,Math.max(1,a)),p=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20,g=Math.min(d,Math.max(1,p));this.changeMediaPlaybackRate(t,g)}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(e===null||this.hls===null)return null;const{holdBack:t,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:s,liveSyncDurationCount:a,lowLatencyMode:o}=this.config,l=this.hls.userConfig;let u=o&&i||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||u===0)&&(u=s!==void 0?s:a*r);const h=r;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,h)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;const i=this.levelDetails;if(i===null)return null;const r=i.edge,s=e-t-this.edgeStalled,a=r-i.totalduration,o=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,s),o)}get drift(){const e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(e===null)return 0;const t=(this.config.lowLatencyMode&&e.partTarget||e.targetduration)*3;return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(T.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(T.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(T.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(T.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var i;t.details===Z.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(i=this.levelDetails)!=null&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var i,r;e.playbackRate!==t&&((i=this.hls)==null||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(r=this.targetLatency)==null?void 0:r.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class zk extends Vg{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this),e.on(T.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this),e.off(T.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(t=>{t.loadError=0,t.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,r=[],s={},a={};let o=!1,l=!1,u=!1;t.levels.forEach(h=>{const d=h.attrs;let{audioCodec:p,videoCodec:g}=h;p&&(h.audioCodec=p=Yu(p,i)||void 0),g&&(g=h.videoCodec=JN(g));const{width:m,height:y,unknownCodecs:b}=h;let A=b?b.length:0;if(b)for(let R=A;R--;){const U=b[R];this.isAudioSupported(U)?(h.audioCodec=p=p?`${p},${U}`:U,A--,ja.audio[p.substring(0,4)]=2):this.isVideoSupported(U)&&(h.videoCodec=g=g?`${g},${U}`:U,A--,ja.video[g.substring(0,4)]=2)}if(o||(o=!!(m&&y)),l||(l=!!g),u||(u=!!p),A||p&&!this.isAudioSupported(p)||g&&!this.isVideoSupported(g)){this.log(`Some or all CODECS not supported "${d.CODECS}"`);return}const{CODECS:w,"FRAME-RATE":x,"HDCP-LEVEL":N,"PATHWAY-ID":F,RESOLUTION:L,"VIDEO-RANGE":C}=d,_=`${`${F||"."}-`}${h.bitrate}-${L}-${x}-${w}-${C}-${N}`;if(s[_])if(s[_].uri!==h.url&&!h.attrs["PATHWAY-ID"]){const R=a[_]+=1;h.attrs["PATHWAY-ID"]=new Array(R+1).join(".");const U=this.createLevel(h);s[_]=U,r.push(U)}else s[_].addGroupId("audio",d.AUDIO),s[_].addGroupId("text",d.SUBTITLES);else{const R=this.createLevel(h);s[_]=R,a[_]=1,r.push(R)}}),this.filterAndSortMediaOptions(r,t,o,l,u)}createLevel(e){const t=new ll(e),i=e.supplemental;if(i!=null&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const r=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(r.message),t.supportedResult=oE(r,[])}return t}isAudioSupported(e){return fg(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return fg(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,i,r,s){let a=[],o=[],l=e;if((i||r)&&s&&(l=l.filter(({videoCodec:b,videoRange:A,width:w,height:x})=>(!!b||!!(w&&x))&&iL(A))),l.length===0){Promise.resolve().then(()=>{if(this.hls){let b="no level with compatible codecs found in manifest",A=b;t.levels.length&&(A=`one or more CODECS in variant not supported: ${zt(t.levels.map(x=>x.attrs.CODECS).filter((x,N,F)=>F.indexOf(x)===N))}`,this.warn(A),b+=` (${A})`);const w=new Error(b);this.hls.trigger(T.ERROR,{type:$e.MEDIA_ERROR,details:Z.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:w,reason:A})}});return}t.audioTracks&&(a=t.audioTracks.filter(b=>!b.audioCodec||this.isAudioSupported(b.audioCodec)),vS(a)),t.subtitles&&(o=t.subtitles,vS(o));const u=l.slice(0);l.sort((b,A)=>{if(b.attrs["HDCP-LEVEL"]!==A.attrs["HDCP-LEVEL"])return(b.attrs["HDCP-LEVEL"]||"")>(A.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&b.height!==A.height)return b.height-A.height;if(b.frameRate!==A.frameRate)return b.frameRate-A.frameRate;if(b.videoRange!==A.videoRange)return ju.indexOf(b.videoRange)-ju.indexOf(A.videoRange);if(b.videoCodec!==A.videoCodec){const w=rE(b.videoCodec),x=rE(A.videoCodec);if(w!==x)return x-w}if(b.uri===A.uri&&b.codecSet!==A.codecSet){const w=Wu(b.codecSet),x=Wu(A.codecSet);if(w!==x)return x-w}return b.averageBitrate!==A.averageBitrate?b.averageBitrate-A.averageBitrate:0});let h=u[0];if(this.steering&&(l=this.steering.filterParsedLevels(l),l.length!==u.length)){for(let b=0;b<u.length;b++)if(u[b].pathwayId===l[0].pathwayId){h=u[b];break}}this._levels=l;for(let b=0;b<l.length;b++)if(l[b]===h){var d;this._firstLevel=b;const A=h.bitrate,w=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${l.length} level(s) found, first bitrate: ${A}`),((d=this.hls.userConfig)==null?void 0:d.abrEwmaDefaultEstimate)===void 0){const x=Math.min(A,this.hls.config.abrEwmaDefaultEstimateMax);x>w&&w===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=x)}break}const p=s&&!r,g=this.hls.config,m=!!(g.audioStreamController&&g.audioTrackController),y={levels:l,audioTracks:a,subtitleTracks:o,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:r,altAudio:m&&!p&&a.some(b=>!!b.url)};this.hls.trigger(T.MANIFEST_PARSED,y)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){const h=new Error("invalid level idx"),d=e<0;if(this.hls.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.LEVEL_SWITCH_ERROR,level:e,fatal:d,error:h,reason:h.message}),d)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,r=this.currentLevel,s=r?r.attrs["PATHWAY-ID"]:void 0,a=t[e],o=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,i===e&&r&&s===o)return;this.log(`Switching to level ${e} (${a.height?a.height+"p ":""}${a.videoRange?a.videoRange+" ":""}${a.codecSet?a.codecSet+" ":""}@${a.bitrate})${o?" with Pathway "+o:""} from level ${i}${s?" with Pathway "+s:""}`);const l={level:e,attrs:a.attrs,details:a.details,bitrate:a.bitrate,averageBitrate:a.averageBitrate,maxBitrate:a.maxBitrate,realBitrate:a.realBitrate,width:a.width,height:a.height,codecSet:a.codecSet,audioCodec:a.audioCodec,videoCodec:a.videoCodec,audioGroups:a.audioGroups,subtitleGroups:a.subtitleGroups,loaded:a.loaded,loadError:a.loadError,fragmentError:a.fragmentError,name:a.name,id:a.id,uri:a.uri,url:a.url,urlId:0,audioGroupIds:a.audioGroupIds,textGroupIds:a.textGroupIds};this.hls.trigger(T.LEVEL_SWITCHING,l);const u=a.details;if(!u||u.live){const h=this.switchParams(a.uri,r==null?void 0:r.details,u);this.loadPlaylist(h)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){const e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),i=e.filter(r=>t.indexOf(r)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=i}}onError(e,t){t.fatal||!t.context||t.context.type===ct.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===Oe.MAIN){const i=t.elementaryStreams;if(!Object.keys(i).some(s=>!!i[s]))return;const r=this._levels[t.level];r!=null&&r.loadError&&(this.log(`Resetting level error count of ${r.loadError} on frag buffered`),r.loadError=0)}}onLevelLoaded(e,t){var i;const{level:r,details:s}=t,a=t.levelInfo;if(!a){var o;this.warn(`Invalid level index ${r}`),(o=t.deliveryDirectives)!=null&&o.skip&&(s.deltaUpdateFailed=!0);return}if(a===this.currentLevel||t.withoutMultiVariant){a.fragmentError===0&&(a.loadError=0);let l=a.details;l===t.details&&l.advanced&&(l=void 0),this.playlistLoaded(r,t,l)}else(i=t.deliveryDirectives)!=null&&i.skip&&(s.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=this.getUrlWithDirectives(e.uri,t),r=this.currentLevelIndex,s=e.attrs["PATHWAY-ID"],a=e.details,o=a==null?void 0:a.age;this.log(`Loading level index ${r}${(t==null?void 0:t.msn)!==void 0?" at sn "+t.msn+" part "+t.part:""}${s?" Pathway "+s:""}${o&&a.live?" age "+o.toFixed(1)+(a.type&&" "+a.type||""):""} ${i}`),this.hls.trigger(T.LEVEL_LOADING,{url:i,level:r,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;const i=this._levels.filter((s,a)=>a!==e?!0:(this.steering&&this.steering.removeLevel(s),s===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,s.details&&s.details.fragments.forEach(o=>o.level=-1)),!1));JE(i),this._levels=i,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const r=i.length-1;this._firstLevel=Math.min(this._firstLevel,r),this._startLevel&&(this._startLevel=Math.min(this._startLevel,r)),this.hls.trigger(T.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(T.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function vS(n){const e={};n.forEach(t=>{const i=t.groupId||"";t.id=e[i]=e[i]||0,e[i]++})}function bS(){return self.SourceBuffer||self.WebKitSourceBuffer}function ES(){if(!As())return!1;const e=bS();return!e||e.prototype&&typeof e.prototype.appendBuffer=="function"&&typeof e.prototype.remove=="function"}function jk(){if(!ES())return!1;const n=As();return typeof(n==null?void 0:n.isTypeSupported)=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(e=>n.isTypeSupported(ol(e,"video")))||["mp4a.40.2","fLaC"].some(e=>n.isTypeSupported(ol(e,"audio"))))}function Xk(){var n;const e=bS();return typeof(e==null||(n=e.prototype)==null?void 0:n.changeType)=="function"}const Jk=100;class Qk extends Ig{constructor(e,t,i){super(e,t,i,"stream-controller",Oe.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const r=this.media,s=r?r.currentTime:null;if(s===null||!_e(s)||(this.log(`Media seeked to ${s.toFixed(3)}`),!this.getBufferedFrag(s)))return;const a=this.getFwdBufferInfoAtPos(r,s,Oe.MAIN,0);if(a===null||a.len===0){this.warn(`Main forward buffer length at ${s} on "seeked" event ${a?a.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(T.MANIFEST_PARSED,this.onManifestParsed,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.LEVEL_LOADED,this.onLevelLoaded,this),e.on(T.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(T.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(T.BUFFER_CREATED,this.onBufferCreated,this),e.on(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(T.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(T.MANIFEST_PARSED,this.onManifestParsed,this),e.off(T.LEVEL_LOADED,this.onLevelLoaded,this),e.off(T.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(T.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(T.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(T.BUFFER_CREATED,this.onBufferCreated,this),e.off(T.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(T.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:i,hls:r}=this;if(this.stopLoad(),this.setInterval(Jk),this.level=-1,!this.startFragRequested){let s=r.startLevel;s===-1&&(r.config.testBandwidth&&this.levels.length>1?(s=0,this.bitrateTest=!0):s=r.firstAutoLevel),r.nextLoadLevel=s,this.level=r.loadLevel,this._hasEnoughToStart=!!t}i>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i),this.state=de.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=de.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case de.WAITING_LEVEL:{const{levels:t,level:i}=this,r=t==null?void 0:t[i],s=r==null?void 0:r.details;if(s&&(!s.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(s))break;this.state=de.IDLE;break}else if(this.hls.nextLoadLevel!==this.level){this.state=de.IDLE;break}break}case de.FRAG_LOADING_WAITING_RETRY:{var e;const t=self.performance.now(),i=this.retryDate;if(!i||t>=i||(e=this.media)!=null&&e.seeking){const{levels:r,level:s}=this,a=r==null?void 0:r[s];this.resetStartWhenNotLoaded(a||null),this.state=de.IDLE}}break}this.state===de.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:r}=this;if(t===null||!r&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;const s=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(i!=null&&i[s]))return;const a=i[s],o=this.getMainFwdBufferInfo();if(o===null)return;const l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){const y={};this.altAudio===2&&(y.type="video"),this.hls.trigger(T.BUFFER_EOS,y),this.state=de.ENDED;return}if(!this.buffering)return;e.loadLevel!==s&&e.manualLevel===-1&&this.log(`Adapting to level ${s} from level ${this.level}`),this.level=e.nextLoadLevel=s;const u=a.details;if(!u||this.state===de.WAITING_LEVEL||this.waitForLive(a)){this.level=s,this.state=de.WAITING_LEVEL,this.startFragRequested=!1;return}const h=o.len,d=this.getMaxBufferLength(a.maxBitrate);if(h>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);const p=this.backtrackFragment?this.backtrackFragment.start:o.end;let g=this.getNextFragment(p,u);if(this.couldBacktrack&&!this.fragPrevious&&g&&Ei(g)&&this.fragmentTracker.getState(g)!==fi.OK){var m;const b=((m=this.backtrackFragment)!=null?m:g).sn-u.startSN,A=u.fragments[b-1];A&&g.cc===A.cc&&(g=A,this.fragmentTracker.removeFragment(A))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(g&&this.isLoopLoading(g,p)){if(!g.gap){const b=this.audioOnly&&!this.altAudio?Mt.AUDIO:Mt.VIDEO,A=(b===Mt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;A&&this.afterBufferFlushed(A,b,Oe.MAIN)}g=this.getNextFragmentLoopLoading(g,u,o,Oe.MAIN,d)}g&&(g.initSegment&&!g.initSegment.data&&!this.bitrateTest&&(g=g.initSegment),this.loadFragment(g,a,p))}loadFragment(e,t,i){const r=this.fragmentTracker.getState(e);r===fi.NOT_LOADED||r===fi.PARTIAL?Ei(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,i):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Oe.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(t!=null&&t.readyState){let i;const r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);const s=this.getLevelDetails();if(s!=null&&s.live){const o=this.getMainFwdBufferInfo();if(!o||o.len<s.targetduration*2)return}if(!t.paused&&e){const o=this.hls.nextLoadLevel,l=e[o],u=this.fragLastKbps;u&&this.fragCurrent?i=this.fragCurrent.duration*l.maxBitrate/(1e3*u)+1:i=0}else i=0;const a=this.getBufferedFrag(t.currentTime+i);if(a){const o=this.followingBufferedFrag(a);if(o){this.abortCurrentFrag();const l=o.maxStartPTS?o.maxStartPTS:o.start,u=o.duration,h=Math.max(a.end,l+Math.min(Math.max(u-this.config.maxFragLookUpTolerance,u*(this.couldBacktrack?.5:.125)),u*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(h,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case de.KEY_LOADING:case de.FRAG_LOADING:case de.FRAG_LOADING_WAITING_RETRY:case de.PARSING:case de.PARSED:this.state=de.IDLE;break}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;hr(i,"playing",this.onMediaPlaying),hr(i,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:i}=this;i&&(xr(i,"playing",this.onMediaPlaying),xr(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),!t.transferMedia&&(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(T.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let i=!1,r=!1;t.levels.forEach(s=>{const a=s.audioCodec;a&&(i=i||a.indexOf("mp4a.40.2")!==-1,r=r||a.indexOf("mp4a.40.5")!==-1)}),this.audioCodecSwitch=i&&r&&!Xk(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==de.IDLE)return;const r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=de.WAITING_LEVEL)}onLevelLoaded(e,t){var i;const{levels:r,startFragRequested:s}=this,a=t.level,o=t.details,l=o.totalduration;if(!r){this.warn(`Levels were reset while loading level ${a}`);return}this.log(`Level ${a} loaded [${o.startSN},${o.endSN}]${o.lastPartSn?`[part-${o.lastPartSn}-${o.lastPartIndex}]`:""}, cc [${o.startCC}, ${o.endCC}] duration:${l}`);const u=t.levelInfo,h=this.fragCurrent;h&&(this.state===de.FRAG_LOADING||this.state===de.FRAG_LOADING_WAITING_RETRY)&&h.level!==t.level&&h.loader&&this.abortCurrentFrag();let d=0;if(o.live||(i=u.details)!=null&&i.live){var p;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;d=this.alignPlaylists(o,u.details,(p=this.levelLastLoaded)==null?void 0:p.details)}if(u.details=o,this.levelLastLoaded=u,s||this.setStartPosition(o,d),this.hls.trigger(T.LEVEL_UPDATED,{details:o,level:a}),this.state===de.WAITING_LEVEL){if(this.waitForCdnTuneIn(o))return;this.state=de.IDLE}s&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const r=this.hls.liveSyncPosition,s=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,l=s>=a-t.maxFragLookUpTolerance&&s<=o;if(r!==null&&i.duration>r&&(s<r||!l)){const h=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!l&&i.readyState<4||s<o-h)&&(this._hasEnoughToStart||(this.nextLoadPosition=r),i.readyState))if(this.warn(`Playback: ${s.toFixed(3)} is located too far from the end of live sliding playlist: ${o}, reset currentTime to : ${r.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var u;const d=Je.bufferInfo(i,r,0);if(!(d!=null&&(u=d.buffered)!=null&&u.length)){i.currentTime=r;return}if(d.start<=s){i.currentTime=r;return}const{nextStart:g}=Je.bufferedInfo(d.buffered,s,0);g&&(i.currentTime=g)}else i.currentTime=r}}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:r,payload:s}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}const o=a[i.level];if(!o){this.warn(`Level ${i.level} not found on progress`);return}const l=o.details;if(!l){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}const u=o.videoCodec,h=l.PTSKnown||!l.live,d=(t=i.initSegment)==null?void 0:t.data,p=this._getAudioCodec(o),g=this.transmuxer=this.transmuxer||new CA(this.hls,Oe.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),m=r?r.index:-1,y=m!==-1,b=new vg(i.level,i.sn,i.stats.chunkCount,s.byteLength,m,y),A=this.initPTS[i.cc];g.push(s,d,p,u,i,r,l.totalduration,h,b,A)}onAudioTrackSwitching(e,t){const i=this.hls,r=this.altAudio===2;if(Ju(t.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(r){this.fragmentTracker.removeAllFragments(),i.once(T.BUFFER_FLUSHED,()=>{var a;(a=this.hls)==null||a.trigger(T.AUDIO_TRACK_SWITCHED,t)}),i.trigger(T.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}i.trigger(T.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=Ju(t.url,this.hls);if(i){const r=this.videoBuffer;r&&this.mediaBuffer!==r&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=r)}this.altAudio=i?2:0,this.tick()}onBufferCreated(e,t){const i=t.tracks;let r,s,a=!1;for(const o in i){const l=i[o];if(l.id==="main"){if(s=o,r=l,o==="video"){const u=i[o];u&&(this.videoBuffer=u.buffer)}}else a=!0}a&&r?(this.log(`Alternate track found, use ${s}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:r}=t,s=i.type===Oe.MAIN;if(s){if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===de.PARSED&&(this.state=de.IDLE);return}const o=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*o.total/(o.buffering.end-o.loading.first)),Ei(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}const a=this.media;a&&(!this._hasEnoughToStart&&Je.getBuffered(a).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),s&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var i;if(t.fatal){this.state=de.ERROR;return}switch(t.details){case Z.FRAG_GAP:case Z.FRAG_PARSING_ERROR:case Z.FRAG_DECRYPT_ERROR:case Z.FRAG_LOAD_ERROR:case Z.FRAG_LOAD_TIMEOUT:case Z.KEY_LOAD_ERROR:case Z.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Oe.MAIN,t);break;case Z.LEVEL_LOAD_ERROR:case Z.LEVEL_LOAD_TIMEOUT:case Z.LEVEL_PARSING_ERROR:!t.levelRetry&&this.state===de.WAITING_LEVEL&&((i=t.context)==null?void 0:i.type)===ct.LEVEL&&(this.state=de.IDLE);break;case Z.BUFFER_ADD_CODEC_ERROR:case Z.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.resetLoadingState();break;case Z.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case Z.INTERNAL_EXCEPTION:this.recoverWorkerError(t);break}}onFragLoadEmergencyAborted(){this.state=de.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Mt.AUDIO||!this.altAudio){const i=(t===Mt.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;i&&(this.afterBufferFlushed(i,t,Oe.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}const r=this.timelineOffset;r&&i&&(i+=r);const s=this.getLevelDetails(),a=Je.getBuffered(e),o=a.length?a.start(0):0,l=o-i,u=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||l>0&&(l<u||this.loadingParts&&l<2*((s==null?void 0:s.partTarget)||0)))&&(this.log(`adjusting start position by ${l} to match buffer start`),i+=l,this.startPosition=i),t<i&&(this.log(`seek to target start position ${i} from current time ${t} buffer start ${o}`),e.currentTime=i)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t.indexOf("mp4a.40.5")!==-1?t="mp4a.40.2":t="mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{const{hls:r}=this,s=i==null?void 0:i.frag;if(!s||this.fragContextChanged(s))return;t.fragmentError=0,this.state=de.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;const a=s.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),r.trigger(T.FRAG_LOADED,i),s.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i=this.playlistType,{hls:r}=this,{remuxResult:s,chunkMeta:a}=e,o=this.getCurrentContext(a);if(!o){this.resetWhenMissingContext(a);return}const{frag:l,part:u,level:h}=o,{video:d,text:p,id3:g,initSegment:m}=s,{details:y}=h,b=this.altAudio?void 0:s.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=de.PARSING,m){if(m!=null&&m.tracks){const x=l.initSegment||l;this._bufferInitSegment(h,m.tracks,x,a),r.trigger(T.FRAG_PARSING_INIT_SEGMENT,{frag:x,id:i,tracks:m.tracks})}const A=m.initPTS,w=m.timescale;_e(A)&&(this.initPTS[l.cc]={baseTime:A,timescale:w},r.trigger(T.INIT_PTS_FOUND,{frag:l,id:i,initPTS:A,timescale:w}))}if(d&&y){b&&d.type==="audiovideo"&&this.logMuxedErr(l);const A=y.fragments[l.sn-1-y.startSN],w=l.sn===y.startSN,x=!A||l.cc>A.cc;if(s.independent!==!1){const{startPTS:N,endPTS:F,startDTS:L,endDTS:C}=d;if(u)u.elementaryStreams[d.type]={startPTS:N,endPTS:F,startDTS:L,endDTS:C};else if(d.firstKeyFrame&&d.independent&&a.id===1&&!x&&(this.couldBacktrack=!0),d.dropped&&d.independent){const M=this.getMainFwdBufferInfo(),_=(M?M.end:this.getLoadPosition())+this.config.maxBufferHole,R=d.firstKeyFramePTS?d.firstKeyFramePTS:N;if(!w&&_<R-this.config.maxBufferHole&&!x){this.backtrack(l);return}else x&&(l.gap=!0);l.setElementaryStreamInfo(d.type,l.start,F,l.start,C,!0)}else w&&N-(y.appliedTimelineOffset||0)>Sc&&(l.gap=!0);l.setElementaryStreamInfo(d.type,N,F,L,C),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(d,l,u,a,w||x)}else if(w||x)l.gap=!0;else{this.backtrack(l);return}}if(b){const{startPTS:A,endPTS:w,startDTS:x,endDTS:N}=b;u&&(u.elementaryStreams[Mt.AUDIO]={startPTS:A,endPTS:w,startDTS:x,endDTS:N}),l.setElementaryStreamInfo(Mt.AUDIO,A,w,x,N),this.bufferFragmentData(b,l,u,a)}if(y&&g!=null&&(t=g.samples)!=null&&t.length){const A={id:i,frag:l,details:y,samples:g.samples};r.trigger(T.FRAG_PARSING_METADATA,A)}if(y&&p){const A={id:i,frag:l,details:y,samples:p.samples};r.trigger(T.FRAG_PARSING_USERDATA,A)}}logMuxedErr(e){this.warn(`${Ei(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,i,r){if(this.state!==de.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(i));const{audio:s,video:a,audiovideo:o}=t;if(s){let u=zu(s.codec,e.audioCodec);u==="mp4a"&&(u="mp4a.40.5");const h=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u.indexOf("mp4a.40.5")!==-1?u="mp4a.40.2":u="mp4a.40.5");const d=s.metadata;d&&"channelCount"in d&&(d.channelCount||1)!==1&&h.indexOf("firefox")===-1&&(u="mp4a.40.5")}u&&u.indexOf("mp4a.40.5")!==-1&&h.indexOf("android")!==-1&&s.container!=="audio/mpeg"&&(u="mp4a.40.2",this.log(`Android: force audio codec to ${u}`)),e.audioCodec&&e.audioCodec!==u&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${u}"`),s.levelCodec=u,s.id=Oe.MAIN,this.log(`Init audio buffer, container:${s.container}, codecs[selected/level/parsed]=[${u||""}/${e.audioCodec||""}/${s.codec}]`),delete t.audiovideo}if(a){a.levelCodec=e.videoCodec,a.id=Oe.MAIN;const u=a.codec;if((u==null?void 0:u.length)===4)switch(u){case"hvc1":case"hev1":a.codec="hvc1.1.6.L120.90";break;case"av01":a.codec="av01.0.04M.08";break;case"avc1":a.codec="avc1.42e01e";break}this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${u}]${a.codec!==u?" parsed-corrected="+a.codec:""}${a.supplemental?" supplemental="+a.supplemental:""}`),delete t.audiovideo}o&&(this.log(`Init audiovideo buffer, container:${o.container}, codecs[level/parsed]=[${e.codecs}/${o.codec}]`),delete t.video,delete t.audio);const l=Object.keys(t);if(l.length){if(this.hls.trigger(T.BUFFER_CODECS,t),!this.hls)return;l.forEach(u=>{const d=t[u].initSegment;d!=null&&d.byteLength&&this.hls.trigger(T.BUFFER_APPENDING,{type:u,data:d,frag:i,part:null,chunkMeta:r,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Oe.MAIN)}get maxBufferLength(){const{levels:e,level:t}=this,i=e==null?void 0:e[t];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=de.IDLE}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&e.seeking===!1){const i=e.currentTime;if(Je.isBuffered(e,i)?t=this.getAppendedFrag(i):Je.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const r=this.fragPlaying,s=t.level;(!r||t.sn!==r.sn||r.level!==s)&&(this.fragPlaying=t,this.hls.trigger(T.FRAG_CHANGED,{frag:t}),(!r||r.level!==s)&&this.hls.trigger(T.LEVEL_SWITCHED,{level:s}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return _e(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(_e(t)){const i=this.getLevelDetails(),r=this.currentFrag||(i?na(null,i.fragments,t):null);if(r){const s=r.programDateTime;if(s!==null){const a=s+(t-r.start)*1e3;return new Date(a)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Zk{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyUriToKeyInfo){const r=this.keyUriToKeyInfo[i].loader;if(r){var t;if(e&&e!==((t=r.context)==null?void 0:t.frag.type))return;r.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=Z.KEY_LOAD_ERROR,i,r,s){return new Un({type:$e.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:s,error:i,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length){const{sn:i,cc:r}=e;for(let s=0;s<t.length;s++){const a=t[s];if(r<=a.cc&&(i==="initSegment"||a.sn==="initSegment"||i<a.sn))return this.emeController.selectKeySystemFormat(a).then(o=>{if(a.setKeyFormat(o),this.emeController&&this.config.requireKeySystemAccessOnStart){const l=rc(o);if(l)return this.emeController.getKeySystemAccess([l])}})}}else if(this.config.requireKeySystemAccessOnStart){const i=cl(this.config);if(i.length)return this.emeController.getKeySystemAccess(i)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,r;t&&e.setKeyFormat(t);const s=e.decryptdata;if(!s){const u=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,Z.KEY_LOAD_ERROR,u))}const a=s.uri;if(!a)return Promise.reject(this.createKeyLoadError(e,Z.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${a}"`)));let o=this.keyUriToKeyInfo[a];if((i=o)!=null&&i.decryptdata.key)return s.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if((r=o)!=null&&r.keyLoadPromise){var l;switch((l=o.mediaKeySessionContext)==null?void 0:l.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(u=>(s.key=u.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}}switch(o=this.keyUriToKeyInfo[a]={decryptdata:s,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},s.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return s.keyFormat==="identity"?this.loadKeyHTTP(o,e):this.loadKeyEME(o,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,Z.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${s.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const r=this.emeController.loadKey(i);if(r)return(e.keyLoadPromise=r.then(s=>(e.mediaKeySessionContext=s,i))).catch(s=>{throw e.keyLoadPromise=null,s})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,r=i.loader,s=new r(i);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,o)=>{const l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},u=i.keyLoadPolicy.default,h={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},d={onSuccess:(p,g,m,y)=>{const{frag:b,keyInfo:A,url:w}=m;if(!b.decryptdata||A!==this.keyUriToKeyInfo[w])return o(this.createKeyLoadError(b,Z.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),y));A.decryptdata.key=b.decryptdata.key=new Uint8Array(p.data),b.keyLoader=null,A.loader=null,a({frag:b,keyInfo:A})},onError:(p,g,m,y)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Z.KEY_LOAD_ERROR,new Error(`HTTP Error ${p.code} loading key ${p.text}`),m,xt({url:l.url,data:void 0},p)))},onTimeout:(p,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Z.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),m))},onAbort:(p,g,m)=>{this.resetLoader(g),o(this.createKeyLoadError(t,Z.INTERNAL_ABORTED,new Error("key loading aborted"),m))}};s.load(l,h,d)})}resetLoader(e){const{frag:t,keyInfo:i,url:r}=e,s=i.loader;t.keyLoader===s&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[r],s&&s.destroy()}}function AS(n){const{type:e}=n;switch(e){case ct.AUDIO_TRACK:return Oe.AUDIO;case ct.SUBTITLE_TRACK:return Oe.SUBTITLE;default:return Oe.MAIN}}function cp(n,e){let t=n.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class eP{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(T.MANIFEST_LOADING,this.onManifestLoading,this),e.on(T.LEVEL_LOADING,this.onLevelLoading,this),e.on(T.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(T.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(T.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(T.MANIFEST_LOADING,this.onManifestLoading,this),e.off(T.LEVEL_LOADING,this.onLevelLoading,this),e.off(T.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(T.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(T.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,r=t.loader,s=i||r,a=new s(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:ct.MANIFEST,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:i,level:r,pathwayId:s,url:a,deliveryDirectives:o,levelInfo:l}=t;this.load({id:i,level:r,pathwayId:s,responseType:"text",type:ct.LEVEL,url:a,deliveryDirectives:o,levelOrTrack:l})}onAudioTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:a,track:o}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:ct.AUDIO_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onSubtitleTrackLoading(e,t){const{id:i,groupId:r,url:s,deliveryDirectives:a,track:o}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:ct.SUBTITLE_TRACK,url:s,deliveryDirectives:a,levelOrTrack:o})}onLevelsUpdated(e,t){const i=this.loaders[ct.LEVEL];if(i){const r=i.context;r&&!t.levels.some(s=>s===r.levelOrTrack)&&(i.abort(),delete this.loaders[ct.LEVEL])}}load(e){var t;const i=this.hls.config;let r=this.getInternalLoader(e);if(r){const u=this.hls.logger,h=r.context;if(h&&h.levelOrTrack===e.levelOrTrack&&(h.url===e.url||h.deliveryDirectives&&!e.deliveryDirectives)){h.url===e.url?u.log(`[playlist-loader]: ignore ${e.url} ongoing request`):u.log(`[playlist-loader]: ignore ${e.url} in favor of ${h.url}`);return}u.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),r.abort()}let s;if(e.type===ct.MANIFEST?s=i.manifestLoadPolicy.default:s=Rt({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),r=this.createInternalLoader(e),_e((t=e.deliveryDirectives)==null?void 0:t.part)){let u;if(e.type===ct.LEVEL&&e.level!==null?u=this.hls.levels[e.level].details:e.type===ct.AUDIO_TRACK&&e.id!==null?u=this.hls.audioTracks[e.id].details:e.type===ct.SUBTITLE_TRACK&&e.id!==null&&(u=this.hls.subtitleTracks[e.id].details),u){const h=u.partTarget,d=u.targetduration;if(h&&d){const p=Math.max(h*3,d*.8)*1e3;s=Rt({},s,{maxTimeToFirstByteMs:Math.min(p,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(p,s.maxTimeToFirstByteMs)})}}}const a=s.errorRetry||s.timeoutRetry||{},o={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0},l={onSuccess:(u,h,d,p)=>{const g=this.getInternalLoader(d);this.resetInternalLoader(d.type);const m=u.data;if(m.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(u,d,new Error("no EXTM3U delimiter"),p||null,h);return}h.parsing.start=performance.now(),mn.isMediaPlaylist(m)||d.type!==ct.MANIFEST?this.handleTrackOrLevelPlaylist(u,h,d,p||null,g):this.handleMasterPlaylist(u,h,d,p)},onError:(u,h,d,p)=>{this.handleNetworkError(h,d,!1,u,p)},onTimeout:(u,h,d)=>{this.handleNetworkError(h,d,!0,void 0,u)}};r.load(e,o,l)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:i}=this.hls;(e||i)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,i,r){const s=this.hls,a=e.data,o=cp(e,i),l=mn.parseMasterPlaylist(a,o);if(l.playlistParsingError){this.handleManifestParsingError(e,i,l.playlistParsingError,r,t);return}const{contentSteering:u,levels:h,sessionData:d,sessionKeys:p,startTimeOffset:g,variableList:m}=l;this.variableList=m;const{AUDIO:y=[],SUBTITLES:b,"CLOSED-CAPTIONS":A}=mn.parseMasterPlaylistMedia(a,o,l);y.length&&!y.some(x=>!x.url)&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Jt({}),bitrate:0,url:""})),s.trigger(T.MANIFEST_LOADED,{levels:h,audioTracks:y,subtitles:b,captions:A,contentSteering:u,url:o,stats:t,networkDetails:r,sessionData:d,sessionKeys:p,startTimeOffset:g,variableList:m})}handleTrackOrLevelPlaylist(e,t,i,r,s){const a=this.hls,{id:o,level:l,type:u}=i,h=cp(e,i),d=_e(l)?l:_e(o)?o:0,p=AS(i),g=mn.parseLevelPlaylist(e.data,h,d,p,0,this.variableList);if(u===ct.MANIFEST){const m={attrs:new Jt({}),bitrate:0,details:g,name:"",url:h};g.requestScheduled=t.loading.start+YE(g,0),a.trigger(T.MANIFEST_LOADED,{levels:[m],audioTracks:[],url:h,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=g,this.handlePlaylistLoaded(g,e,t,i,r,s)}handleManifestParsingError(e,t,i,r,s){this.hls.trigger(T.ERROR,{type:$e.NETWORK_ERROR,details:Z.MANIFEST_PARSING_ERROR,fatal:t.type===ct.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:r,stats:s})}handleNetworkError(e,t,i=!1,r,s){let a=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===ct.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===ct.AUDIO_TRACK||e.type===ct.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);const o=new Error(a);this.hls.logger.warn(`[playlist-loader]: ${a}`);let l=Z.UNKNOWN,u=!1;const h=this.getInternalLoader(e);switch(e.type){case ct.MANIFEST:l=i?Z.MANIFEST_LOAD_TIMEOUT:Z.MANIFEST_LOAD_ERROR,u=!0;break;case ct.LEVEL:l=i?Z.LEVEL_LOAD_TIMEOUT:Z.LEVEL_LOAD_ERROR,u=!1;break;case ct.AUDIO_TRACK:l=i?Z.AUDIO_TRACK_LOAD_TIMEOUT:Z.AUDIO_TRACK_LOAD_ERROR,u=!1;break;case ct.SUBTITLE_TRACK:l=i?Z.SUBTITLE_TRACK_LOAD_TIMEOUT:Z.SUBTITLE_LOAD_ERROR,u=!1;break}h&&this.resetInternalLoader(e.type);const d={type:$e.NETWORK_ERROR,details:l,fatal:u,url:e.url,loader:h,context:e,error:o,networkDetails:t,stats:s};if(r){const p=(t==null?void 0:t.url)||e.url;d.response=xt({url:p,data:void 0},r)}this.hls.trigger(T.ERROR,d)}handlePlaylistLoaded(e,t,i,r,s,a){const o=this.hls,{type:l,level:u,id:h,groupId:d,deliveryDirectives:p}=r,g=cp(t,r),m=AS(r),y=typeof r.level=="number"&&m===Oe.MAIN?u:void 0;if(!e.fragments.length){const A=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger(T.ERROR,{type:$e.NETWORK_ERROR,details:Z.LEVEL_EMPTY_ERROR,fatal:!1,url:g,error:A,reason:A.message,response:t,context:r,level:y,parent:m,networkDetails:s,stats:i});return}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const b=e.playlistParsingError;if(b){if(this.hls.logger.warn(b),!o.config.ignorePlaylistParsingErrors){o.trigger(T.ERROR,{type:$e.NETWORK_ERROR,details:Z.LEVEL_PARSING_ERROR,fatal:!1,url:g,error:b,reason:b.message,response:t,context:r,level:y,parent:m,networkDetails:s,stats:i});return}e.playlistParsingError=null}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),l){case ct.MANIFEST:case ct.LEVEL:o.trigger(T.LEVEL_LOADED,{details:e,levelInfo:r.levelOrTrack||o.levels[0],level:y||0,id:h||0,stats:i,networkDetails:s,deliveryDirectives:p,withoutMultiVariant:l===ct.MANIFEST});break;case ct.AUDIO_TRACK:o.trigger(T.AUDIO_TRACK_LOADED,{details:e,track:r.levelOrTrack,id:h||0,groupId:d||"",stats:i,networkDetails:s,deliveryDirectives:p});break;case ct.SUBTITLE_TRACK:o.trigger(T.SUBTITLE_TRACK_LOADED,{details:e,track:r.levelOrTrack,id:h||0,groupId:d||"",stats:i,networkDetails:s,deliveryDirectives:p});break}}}class Ur{static get version(){return fl}static isMSESupported(){return ES()}static isSupported(){return jk()}static getMediaSource(){return As()}static get Events(){return T}static get MetadataSchema(){return cr}static get ErrorTypes(){return $e}static get ErrorDetails(){return Z}static get DefaultConfig(){return Ur.defaultConfig?Ur.defaultConfig:Ok}static set DefaultConfig(e){Ur.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Ng,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=RN(e.debug||!1,"Hls instance",e.assetPlayerId),i=this.config=Bk(Ur.DefaultConfig,e,t);this.userConfig=e,i.progressive&&Uk(i,t);const{abrController:r,bufferController:s,capLevelController:a,errorController:o,fpsController:l}=i,u=new o(this),h=this.abrController=new r(this),d=new yL(this),p=i.interstitialsController,g=p?this.interstitialsController=new p(this,Ur):null,m=this.bufferController=new s(this,d),y=this.capLevelController=new a(this),b=new l(this),A=new eP(this),w=i.contentSteeringController,x=w?new w(this):null,N=this.levelController=new zk(this,x),F=new Wk(this),L=new Zk(this.config),C=this.streamController=new Qk(this,d,L),M=this.gapController=new Vk(this,d);y.setStreamController(C),b.setStreamController(C);const _=[A,N,C];g&&_.splice(1,0,g),x&&_.splice(1,0,x),this.networkControllers=_;const R=[h,m,M,y,b,F,d];this.audioTrackController=this.createController(i.audioTrackController,_);const U=i.audioStreamController;U&&_.push(this.audioStreamController=new U(this,d,L)),this.subtitleTrackController=this.createController(i.subtitleTrackController,_);const q=i.subtitleStreamController;q&&_.push(this.subtititleStreamController=new q(this,d,L)),this.createController(i.timelineController,R),L.emeController=this.emeController=this.createController(i.emeController,R),this.cmcdController=this.createController(i.cmcdController,R),this.latencyController=this.createController(Yk,R),this.coreComponents=R,_.push(u);const $=u.onErrorOut;typeof $=="function"&&this.on(T.ERROR,$,u),this.on(T.MANIFEST_LOADED,A.onManifestLoaded,A)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,r){this._emitter.off(e,t,i,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(i){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+i.message+'". Here is a stacktrace:',i),!this.triggeringException){this.triggeringException=!0;const r=e===T.ERROR;this.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.INTERNAL_EXCEPTION,fatal:r,event:e,error:i}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(T.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const s=new Error(`attachMedia failed: invalid argument (${e})`);this.trigger(T.ERROR,{type:$e.OTHER_ERROR,details:Z.ATTACH_MEDIA_ERROR,fatal:!0,error:s});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,i=t?e.media:e,r=t?e:{media:i};this._media=i,this.trigger(T.MEDIA_ATTACHING,r)}detachMedia(){this.logger.log("detachMedia"),this.trigger(T.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(T.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,i=this._url,r=this._url=og.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${r}`),t&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(T.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(e,t),!(!this.started||!this.networkControllers));i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!(this.started||!this.networkControllers));e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Oe.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Oe.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[Oe.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=e==null?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=VM()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){tL(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let r=0;r<i;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let r;if(t===-1&&e!=null&&e.length?r=e.length-1:r=t,i)for(let s=r;s--;){const a=e[s].attrs["HDCP-LEVEL"];if(a&&a<=i)return s}return r}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return e?e.subtitleDisplay:!1}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){const i=fE(t);return uE(e,i,navigator.mediaCapabilities)}}Ur.defaultConfig=void 0;class SS{async getIsLive(e,t){const i=t.media;return i.duration===1/0?!0:i.readyState<2&&Number.isNaN(i.duration)?this.waitForMediaMetadataLoad(i).then(r=>this.processLoadedDurationForLiveDetection(r,i)):!Number.isNaN(i.duration)&&i.duration>0?this.detectDurationIncreaseAsLive(i):!1}async processLoadedDurationForLiveDetection(e,t){return Number.isNaN(e)?(console.warn("Setting video as non-live due to metadata loading timeout"),!1):this.detectDurationIncreaseAsLive(t)}async waitForMediaMetadataLoad(e){return new Promise(t=>{Le(e).one("loadedmetadata",()=>t(e.duration)),setTimeout(()=>{t(NaN)},3e3)})}async detectDurationIncreaseAsLive(e){const t=e.duration,i=e.paused;if(i)try{await e.play()}catch(a){return console.warn("Failed to play video for live detection:",a),!1}const r=Jr(100).pipe(Ht(()=>e.duration),Zt(a=>a-t>=.5),Rn(1),Ht(()=>!0),ou({each:3e3,with:()=>Vt(!1)}),Ks(()=>(console.warn("Exception occurred during duration-based live detection, fallback to non-live video"),Vt(!1)))),s=await qo(r);return i&&!e.paused&&e.pause(),s}}class xS{async getIsLive(e,t){if(!Ur.isSupported())return console.warn("HLS is not supported, falling back to duration-based live detection"),new SS().getIsLive(e,t);const i=t.getParam("m3u8Url");if(!i)throw console.error("M3U8 URL is required for M3U8-based live detection"),new Error("M3U8 URL parameter is missing");const r=new Ur;return r.loadSource(i),new Promise((s,a)=>{r.on(Ur.Events.LEVEL_LOADED,(o,l)=>{s(l.details.live)}),r.on(Ur.Events.ERROR,function(o,l){a(l)})}).catch(s=>new SS().getIsLive(e,t))}}class tP{getIsPrivate(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract private video status using JSONPath"),Error("Context vo object is missing, unable to extract private video status using JSONPath");if(_t.isEmpty(e.values))throw console.error("Private video extraction configuration is missing JSONPath values property",e),new Error("Private video extraction configuration is missing JSONPath values property");return Yt.extractBooleanByJsonPath(e.values,e.computeType,t.data)}}class iP{getChannelId(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract channelId using JSONPath",t),Error("Context vo object is missing, unable to extract channelId using JSONPath");return on(t.data,e.value)}}class rP{extractDuration(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract duration using JSONPath",t),Error("Context vo object is missing, unable to extract duration using JSONPath");return Number(on(t.data,e.value))}}class nP{extractSupportLanguage(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract support language using JSONPath",t),Error("Context vo object is missing, unable to extract support language using JSONPath");return on(t.data,e.value)}}const Yn=class Yn{static isWeakPunctuation(e){return this.WEAK_PUNCTUATION.has(e)}static isPunctuation(e){return this.SENTENCE_ENDING_PUNCTUATION.has(e)}static endsWithPunctuation(e){if(!e||e.trim().length===0)return!1;const t=e.trim(),i=t.charAt(t.length-1);return Yn.isPunctuation(i)}static containsOnlyPunctuationAndSpaces(e){if(!e||e.trim().length===0)return!0;let t=!1;for(let i=0;i<e.length;i++){const r=e.charAt(i);if(r.trim().length!==0){if(Yn.isPunctuation(r)||Yn.isWeakPunctuation(r)||Yn.DECORATIVE_PUNCTUATION.has(r)){t=!0;continue}return!1}}return t}};X(Yn,"SENTENCE_ENDING_PUNCTUATION",new Set([".","!","?",";",":","。","！","？","；","：","…","‥","⋯","⋮","⋰","⋱","؟","؍","؎","؏","¿","¡","·","։","՜","՞","՟","׃","׆","ฯ","๚","๛","।","॥","‽","‼","⁇","⁈","⁉","⁏"])),X(Yn,"WEAK_PUNCTUATION",new Set([",","，",";","；",":","："])),X(Yn,"DECORATIVE_PUNCTUATION",new Set(['"',"'","“","”","‘","’","«","»","‹","›","「","」","『","』","《","》","〈","〉","（","）","(",")","【","】","[","]","{","}"]));let ii=Yn;var hp,TS;function sP(){if(TS)return hp;TS=1,hp=e;function n(i){return i instanceof Buffer?Buffer.from(i):new i.constructor(i.buffer.slice(),i.byteOffset,i.length)}function e(i){if(i=i||{},i.circles)return t(i);const r=new Map;if(r.set(Date,u=>new Date(u)),r.set(Map,(u,h)=>new Map(a(Array.from(u),h))),r.set(Set,(u,h)=>new Set(a(Array.from(u),h))),i.constructorHandlers)for(const u of i.constructorHandlers)r.set(u[0],u[1]);let s=null;return i.proto?l:o;function a(u,h){const d=Object.keys(u),p=new Array(d.length);for(let g=0;g<d.length;g++){const m=d[g],y=u[m];typeof y!="object"||y===null?p[m]=y:y.constructor!==Object&&(s=r.get(y.constructor))?p[m]=s(y,h):ArrayBuffer.isView(y)?p[m]=n(y):p[m]=h(y)}return p}function o(u){if(typeof u!="object"||u===null)return u;if(Array.isArray(u))return a(u,o);if(u.constructor!==Object&&(s=r.get(u.constructor)))return s(u,o);const h={};for(const d in u){if(Object.hasOwnProperty.call(u,d)===!1)continue;const p=u[d];typeof p!="object"||p===null?h[d]=p:p.constructor!==Object&&(s=r.get(p.constructor))?h[d]=s(p,o):ArrayBuffer.isView(p)?h[d]=n(p):h[d]=o(p)}return h}function l(u){if(typeof u!="object"||u===null)return u;if(Array.isArray(u))return a(u,l);if(u.constructor!==Object&&(s=r.get(u.constructor)))return s(u,l);const h={};for(const d in u){const p=u[d];typeof p!="object"||p===null?h[d]=p:p.constructor!==Object&&(s=r.get(p.constructor))?h[d]=s(p,l):ArrayBuffer.isView(p)?h[d]=n(p):h[d]=l(p)}return h}}function t(i){const r=[],s=[],a=new Map;if(a.set(Date,d=>new Date(d)),a.set(Map,(d,p)=>new Map(l(Array.from(d),p))),a.set(Set,(d,p)=>new Set(l(Array.from(d),p))),i.constructorHandlers)for(const d of i.constructorHandlers)a.set(d[0],d[1]);let o=null;return i.proto?h:u;function l(d,p){const g=Object.keys(d),m=new Array(g.length);for(let y=0;y<g.length;y++){const b=g[y],A=d[b];if(typeof A!="object"||A===null)m[b]=A;else if(A.constructor!==Object&&(o=a.get(A.constructor)))m[b]=o(A,p);else if(ArrayBuffer.isView(A))m[b]=n(A);else{const w=r.indexOf(A);w!==-1?m[b]=s[w]:m[b]=p(A)}}return m}function u(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return l(d,u);if(d.constructor!==Object&&(o=a.get(d.constructor)))return o(d,u);const p={};r.push(d),s.push(p);for(const g in d){if(Object.hasOwnProperty.call(d,g)===!1)continue;const m=d[g];if(typeof m!="object"||m===null)p[g]=m;else if(m.constructor!==Object&&(o=a.get(m.constructor)))p[g]=o(m,u);else if(ArrayBuffer.isView(m))p[g]=n(m);else{const y=r.indexOf(m);y!==-1?p[g]=s[y]:p[g]=u(m)}}return r.pop(),s.pop(),p}function h(d){if(typeof d!="object"||d===null)return d;if(Array.isArray(d))return l(d,h);if(d.constructor!==Object&&(o=a.get(d.constructor)))return o(d,h);const p={};r.push(d),s.push(p);for(const g in d){const m=d[g];if(typeof m!="object"||m===null)p[g]=m;else if(m.constructor!==Object&&(o=a.get(m.constructor)))p[g]=o(m,h);else if(ArrayBuffer.isView(m))p[g]=n(m);else{const y=r.indexOf(m);y!==-1?p[g]=s[y]:p[g]=h(m)}}return r.pop(),s.pop(),p}}return hp}var aP=sP();const wS=ms(aP);/**
 * @name codsen-utils
 * @fileoverview Various utility functions
 * @version 1.6.7
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/codsen-utils/}
 */wS();function dp(n){if(n==null||typeof n!="object")return!1;let e=Object.getPrototypeOf(n);return e!==null&&e!==Object.prototype&&Object.getPrototypeOf(e)!==null?!1:!(Symbol.iterator in n)&&!(Symbol.toStringTag in n)}function ao(n){return typeof n=="string"}function Ds(n){return Number.isSafeInteger(n)&&n>=0}function Rs(n){return n!=null}function oP(n,e){return dp(n)&&ao(e)&&e in n}var lP=typeof global=="object"&&global&&global.Object===Object&&global,uP=typeof self=="object"&&self&&self.Object===Object&&self,fp=lP||uP||Function("return this")(),oo=fp.Symbol,DS=Object.prototype,cP=DS.hasOwnProperty,hP=DS.toString,Al=oo?oo.toStringTag:void 0;function dP(n){var e=cP.call(n,Al),t=n[Al];try{n[Al]=void 0;var i=!0}catch{}var r=hP.call(n);return i&&(e?n[Al]=t:delete n[Al]),r}var fP=Object.prototype,gP=fP.toString;function pP(n){return gP.call(n)}var mP="[object Null]",yP="[object Undefined]",RS=oo?oo.toStringTag:void 0;function IS(n){return n==null?n===void 0?yP:mP:RS&&RS in Object(n)?dP(n):pP(n)}function CS(n){return n!=null&&typeof n=="object"}var vP="[object Symbol]";function bP(n){return typeof n=="symbol"||CS(n)&&IS(n)==vP}function EP(n,e){for(var t=-1,i=n==null?0:n.length,r=Array(i);++t<i;)r[t]=e(n[t],t,n);return r}var AP=Array.isArray,NS=oo?oo.prototype:void 0,LS=NS?NS.toString:void 0;function gp(n){if(typeof n=="string")return n;if(AP(n))return EP(n,gp)+"";if(bP(n))return LS?LS.call(n):"";var e=n+"";return e=="0"&&1/n==-1/0?"-0":e}var SP=/\s/;function xP(n){for(var e=n.length;e--&&SP.test(n.charAt(e)););return e}var TP=/^\s+/;function wP(n){return n&&n.slice(0,xP(n)+1).replace(TP,"")}function _S(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}function MS(n){return n}var DP="[object AsyncFunction]",RP="[object Function]",IP="[object GeneratorFunction]",CP="[object Proxy]";function kS(n){if(!_S(n))return!1;var e=IS(n);return e==RP||e==IP||e==DP||e==CP}var pp=fp["__core-js_shared__"],PS=function(){var n=/[^.]+$/.exec(pp&&pp.keys&&pp.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function NP(n){return!!PS&&PS in n}var LP=Function.prototype,_P=LP.toString;function MP(n){if(n!=null){try{return _P.call(n)}catch{}try{return n+""}catch{}}return""}var kP=/[\\^$.*+?()[\]{}|]/g,PP=/^\[object .+?Constructor\]$/,OP=Function.prototype,FP=Object.prototype,BP=OP.toString,UP=FP.hasOwnProperty,$P=RegExp("^"+BP.call(UP).replace(kP,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function GP(n){if(!_S(n)||NP(n))return!1;var e=kS(n)?$P:PP;return e.test(MP(n))}function qP(n,e){return n==null?void 0:n[e]}function mp(n,e){var t=qP(n,e);return GP(t)?t:void 0}function VP(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}var HP=800,KP=16,WP=Date.now;function YP(n){var e=0,t=0;return function(){var i=WP(),r=KP-(i-t);if(t=i,r>0){if(++e>=HP)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}function zP(n){return function(){return n}}var OS=function(){try{var n=mp(Object,"defineProperty");return n({},"",{}),n}catch{}}(),jP=OS?function(n,e){return OS(n,"toString",{configurable:!0,enumerable:!1,value:zP(e),writable:!0})}:MS,XP=YP(jP);function JP(n,e,t,i){for(var r=n.length,s=t+-1;++s<r;)if(e(n[s],s,n))return s;return-1}function QP(n){return n!==n}function ZP(n,e,t){for(var i=t-1,r=n.length;++i<r;)if(n[i]===e)return i;return-1}function yp(n,e,t){return e===e?ZP(n,e,t):JP(n,QP,t)}function eO(n,e){var t=n==null?0:n.length;return!!t&&yp(n,e,0)>-1}function tO(n,e){return n===e||n!==n&&e!==e}var FS=Math.max;function iO(n,e,t){return e=FS(e===void 0?n.length-1:e,0),function(){for(var i=arguments,r=-1,s=FS(i.length-e,0),a=Array(s);++r<s;)a[r]=i[e+r];r=-1;for(var o=Array(e+1);++r<e;)o[r]=i[r];return o[e]=t(a),VP(n,this,o)}}function rO(n,e){return XP(iO(n,e,MS),n+"")}var nO=9007199254740991;function sO(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=nO}function aO(n){return n!=null&&sO(n.length)&&!kS(n)}var Sl=mp(Object,"create");function oO(){this.__data__=Sl?Sl(null):{},this.size=0}function lO(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var uO="__lodash_hash_undefined__",cO=Object.prototype,hO=cO.hasOwnProperty;function dO(n){var e=this.__data__;if(Sl){var t=e[n];return t===uO?void 0:t}return hO.call(e,n)?e[n]:void 0}var fO=Object.prototype,gO=fO.hasOwnProperty;function pO(n){var e=this.__data__;return Sl?e[n]!==void 0:gO.call(e,n)}var mO="__lodash_hash_undefined__";function yO(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Sl&&e===void 0?mO:e,this}function aa(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}aa.prototype.clear=oO,aa.prototype.delete=lO,aa.prototype.get=dO,aa.prototype.has=pO,aa.prototype.set=yO;function vO(){this.__data__=[],this.size=0}function Tc(n,e){for(var t=n.length;t--;)if(tO(n[t][0],e))return t;return-1}var bO=Array.prototype,EO=bO.splice;function AO(n){var e=this.__data__,t=Tc(e,n);if(t<0)return!1;var i=e.length-1;return t==i?e.pop():EO.call(e,t,1),--this.size,!0}function SO(n){var e=this.__data__,t=Tc(e,n);return t<0?void 0:e[t][1]}function xO(n){return Tc(this.__data__,n)>-1}function TO(n,e){var t=this.__data__,i=Tc(t,n);return i<0?(++this.size,t.push([n,e])):t[i][1]=e,this}function lo(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}lo.prototype.clear=vO,lo.prototype.delete=AO,lo.prototype.get=SO,lo.prototype.has=xO,lo.prototype.set=TO;var wO=mp(fp,"Map");function DO(){this.size=0,this.__data__={hash:new aa,map:new(wO||lo),string:new aa}}function RO(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function wc(n,e){var t=n.__data__;return RO(e)?t[typeof e=="string"?"string":"hash"]:t.map}function IO(n){var e=wc(this,n).delete(n);return this.size-=e?1:0,e}function CO(n){return wc(this,n).get(n)}function NO(n){return wc(this,n).has(n)}function LO(n,e){var t=wc(this,n),i=t.size;return t.set(n,e),this.size+=t.size==i?0:1,this}function uo(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var i=n[e];this.set(i[0],i[1])}}uo.prototype.clear=DO,uo.prototype.delete=IO,uo.prototype.get=CO,uo.prototype.has=NO,uo.prototype.set=LO;function _O(n){return n==null?"":gp(n)}function MO(n,e,t){var i=-1,r=n.length;e<0&&(e=-e>r?0:r+e),t=t>r?r:t,t<0&&(t+=r),r=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(r);++i<r;)s[i]=n[i+e];return s}function kO(n,e,t){var i=n.length;return t=t===void 0?i:t,!e&&t>=i?n:MO(n,e,t)}var PO="\\ud800-\\udfff",OO="\\u0300-\\u036f",FO="\\ufe20-\\ufe2f",BO="\\u20d0-\\u20ff",UO=OO+FO+BO,$O="\\ufe0e\\ufe0f",GO="\\u200d",qO=RegExp("["+GO+PO+UO+$O+"]");function VO(n){return qO.test(n)}function HO(n){return n.split("")}var BS="\\ud800-\\udfff",KO="\\u0300-\\u036f",WO="\\ufe20-\\ufe2f",YO="\\u20d0-\\u20ff",zO=KO+WO+YO,jO="\\ufe0e\\ufe0f",XO="["+BS+"]",vp="["+zO+"]",bp="\\ud83c[\\udffb-\\udfff]",JO="(?:"+vp+"|"+bp+")",US="[^"+BS+"]",$S="(?:\\ud83c[\\udde6-\\uddff]){2}",GS="[\\ud800-\\udbff][\\udc00-\\udfff]",QO="\\u200d",qS=JO+"?",VS="["+jO+"]?",ZO="(?:"+QO+"(?:"+[US,$S,GS].join("|")+")"+VS+qS+")*",eF=VS+qS+ZO,tF="(?:"+[US+vp+"?",vp,$S,GS,XO].join("|")+")",iF=RegExp(bp+"(?="+bp+")|"+tF+eF,"g");function rF(n){return n.match(iF)||[]}function HS(n){return VO(n)?rF(n):HO(n)}var nF="__lodash_hash_undefined__";function sF(n){return this.__data__.set(n,nF),this}function aF(n){return this.__data__.has(n)}function Dc(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new uo;++e<t;)this.add(n[e])}Dc.prototype.add=Dc.prototype.push=sF,Dc.prototype.has=aF;function oF(n,e){return n.has(e)}function lF(n){return CS(n)&&aO(n)}var uF=200;function cF(n,e,t,i){var r=-1,s=eO,a=!0,o=n.length,l=[],u=e.length;if(!o)return l;e.length>=uF&&(s=oF,a=!1,e=new Dc(e));e:for(;++r<o;){var h=n[r],d=h;if(h=h!==0?h:0,a&&d===d){for(var p=u;p--;)if(e[p]===d)continue e;l.push(h)}else s(e,d,i)||l.push(h)}return l}function hF(n,e){for(var t=n.length;t--&&yp(e,n[t],0)>-1;);return t}function dF(n,e){for(var t=-1,i=n.length;++t<i&&yp(e,n[t],0)>-1;);return t}function KS(n,e,t){if(n=_O(n),n&&e===void 0)return wP(n);if(!n||!(e=gp(e)))return n;var i=HS(n),r=HS(e),s=dF(i,r),a=hF(i,r)+1;return kO(i,s,a).join("")}var fF=rO(function(n,e){return lF(n)?cF(n,e):[]}),co=function(){return co=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},co.apply(this,arguments)},gF="~",pF="~~";function Ep(n,e){for(var t={},i={},r=n.split(pF),s=!1,a=0;r.length>a;a++){for(var o=r[a].split(gF),l=0;l<o.length;l+=2){var u=o[l],h=o[l+1],d="&"+u+";";t[d]=h,s&&(t["&"+u]=h),i[h]=d}s=!0}return e?{entities:co(co({},t),e.entities),characters:co(co({},i),e.characters)}:{entities:t,characters:i}}var Ap={xml:/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html4:/&notin;|&(?:nbsp|iexcl|cent|pound|curren|yen|brvbar|sect|uml|copy|ordf|laquo|not|shy|reg|macr|deg|plusmn|sup2|sup3|acute|micro|para|middot|cedil|sup1|ordm|raquo|frac14|frac12|frac34|iquest|Agrave|Aacute|Acirc|Atilde|Auml|Aring|AElig|Ccedil|Egrave|Eacute|Ecirc|Euml|Igrave|Iacute|Icirc|Iuml|ETH|Ntilde|Ograve|Oacute|Ocirc|Otilde|Ouml|times|Oslash|Ugrave|Uacute|Ucirc|Uuml|Yacute|THORN|szlig|agrave|aacute|acirc|atilde|auml|aring|aelig|ccedil|egrave|eacute|ecirc|euml|igrave|iacute|icirc|iuml|eth|ntilde|ograve|oacute|ocirc|otilde|ouml|divide|oslash|ugrave|uacute|ucirc|uuml|yacute|thorn|yuml|quot|amp|lt|gt|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g,html5:/&centerdot;|&copysr;|&divideontimes;|&gtcc;|&gtcir;|&gtdot;|&gtlPar;|&gtquest;|&gtrapprox;|&gtrarr;|&gtrdot;|&gtreqless;|&gtreqqless;|&gtrless;|&gtrsim;|&ltcc;|&ltcir;|&ltdot;|&lthree;|&ltimes;|&ltlarr;|&ltquest;|&ltrPar;|&ltri;|&ltrie;|&ltrif;|&notin;|&notinE;|&notindot;|&notinva;|&notinvb;|&notinvc;|&notni;|&notniva;|&notnivb;|&notnivc;|&parallel;|&timesb;|&timesbar;|&timesd;|&(?:AElig|AMP|Aacute|Acirc|Agrave|Aring|Atilde|Auml|COPY|Ccedil|ETH|Eacute|Ecirc|Egrave|Euml|GT|Iacute|Icirc|Igrave|Iuml|LT|Ntilde|Oacute|Ocirc|Ograve|Oslash|Otilde|Ouml|QUOT|REG|THORN|Uacute|Ucirc|Ugrave|Uuml|Yacute|aacute|acirc|acute|aelig|agrave|amp|aring|atilde|auml|brvbar|ccedil|cedil|cent|copy|curren|deg|divide|eacute|ecirc|egrave|eth|euml|frac12|frac14|frac34|gt|iacute|icirc|iexcl|igrave|iquest|iuml|laquo|lt|macr|micro|middot|nbsp|not|ntilde|oacute|ocirc|ograve|ordf|ordm|oslash|otilde|ouml|para|plusmn|pound|quot|raquo|reg|sect|shy|sup1|sup2|sup3|szlig|thorn|times|uacute|ucirc|ugrave|uml|uuml|yacute|yen|yuml|#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);?/g},ho={};ho.xml=Ep(`lt~<~gt~>~quot~"~apos~'~amp~&`),ho.html4=Ep(`apos~'~OElig~Œ~oelig~œ~Scaron~Š~scaron~š~Yuml~Ÿ~circ~ˆ~tilde~˜~ensp~ ~emsp~ ~thinsp~ ~zwnj~‌~zwj~‍~lrm~‎~rlm~‏~ndash~–~mdash~—~lsquo~‘~rsquo~’~sbquo~‚~ldquo~“~rdquo~”~bdquo~„~dagger~†~Dagger~‡~permil~‰~lsaquo~‹~rsaquo~›~euro~€~fnof~ƒ~Alpha~Α~Beta~Β~Gamma~Γ~Delta~Δ~Epsilon~Ε~Zeta~Ζ~Eta~Η~Theta~Θ~Iota~Ι~Kappa~Κ~Lambda~Λ~Mu~Μ~Nu~Ν~Xi~Ξ~Omicron~Ο~Pi~Π~Rho~Ρ~Sigma~Σ~Tau~Τ~Upsilon~Υ~Phi~Φ~Chi~Χ~Psi~Ψ~Omega~Ω~alpha~α~beta~β~gamma~γ~delta~δ~epsilon~ε~zeta~ζ~eta~η~theta~θ~iota~ι~kappa~κ~lambda~λ~mu~μ~nu~ν~xi~ξ~omicron~ο~pi~π~rho~ρ~sigmaf~ς~sigma~σ~tau~τ~upsilon~υ~phi~φ~chi~χ~psi~ψ~omega~ω~thetasym~ϑ~upsih~ϒ~piv~ϖ~bull~•~hellip~…~prime~′~Prime~″~oline~‾~frasl~⁄~weierp~℘~image~ℑ~real~ℜ~trade~™~alefsym~ℵ~larr~←~uarr~↑~rarr~→~darr~↓~harr~↔~crarr~↵~lArr~⇐~uArr~⇑~rArr~⇒~dArr~⇓~hArr~⇔~forall~∀~part~∂~exist~∃~empty~∅~nabla~∇~isin~∈~notin~∉~ni~∋~prod~∏~sum~∑~minus~−~lowast~∗~radic~√~prop~∝~infin~∞~ang~∠~and~∧~or~∨~cap~∩~cup~∪~int~∫~there4~∴~sim~∼~cong~≅~asymp~≈~ne~≠~equiv~≡~le~≤~ge~≥~sub~⊂~sup~⊃~nsub~⊄~sube~⊆~supe~⊇~oplus~⊕~otimes~⊗~perp~⊥~sdot~⋅~lceil~⌈~rceil~⌉~lfloor~⌊~rfloor~⌋~lang~〈~rang~〉~loz~◊~spades~♠~clubs~♣~hearts~♥~diams~♦~~nbsp~ ~iexcl~¡~cent~¢~pound~£~curren~¤~yen~¥~brvbar~¦~sect~§~uml~¨~copy~©~ordf~ª~laquo~«~not~¬~shy~­~reg~®~macr~¯~deg~°~plusmn~±~sup2~²~sup3~³~acute~´~micro~µ~para~¶~middot~·~cedil~¸~sup1~¹~ordm~º~raquo~»~frac14~¼~frac12~½~frac34~¾~iquest~¿~Agrave~À~Aacute~Á~Acirc~Â~Atilde~Ã~Auml~Ä~Aring~Å~AElig~Æ~Ccedil~Ç~Egrave~È~Eacute~É~Ecirc~Ê~Euml~Ë~Igrave~Ì~Iacute~Í~Icirc~Î~Iuml~Ï~ETH~Ð~Ntilde~Ñ~Ograve~Ò~Oacute~Ó~Ocirc~Ô~Otilde~Õ~Ouml~Ö~times~×~Oslash~Ø~Ugrave~Ù~Uacute~Ú~Ucirc~Û~Uuml~Ü~Yacute~Ý~THORN~Þ~szlig~ß~agrave~à~aacute~á~acirc~â~atilde~ã~auml~ä~aring~å~aelig~æ~ccedil~ç~egrave~è~eacute~é~ecirc~ê~euml~ë~igrave~ì~iacute~í~icirc~î~iuml~ï~eth~ð~ntilde~ñ~ograve~ò~oacute~ó~ocirc~ô~otilde~õ~ouml~ö~divide~÷~oslash~ø~ugrave~ù~uacute~ú~ucirc~û~uuml~ü~yacute~ý~thorn~þ~yuml~ÿ~quot~"~amp~&~lt~<~gt~>`),ho.html5=Ep('Abreve~Ă~Acy~А~Afr~𝔄~Amacr~Ā~And~⩓~Aogon~Ą~Aopf~𝔸~ApplyFunction~⁡~Ascr~𝒜~Assign~≔~Backslash~∖~Barv~⫧~Barwed~⌆~Bcy~Б~Because~∵~Bernoullis~ℬ~Bfr~𝔅~Bopf~𝔹~Breve~˘~Bscr~ℬ~Bumpeq~≎~CHcy~Ч~Cacute~Ć~Cap~⋒~CapitalDifferentialD~ⅅ~Cayleys~ℭ~Ccaron~Č~Ccirc~Ĉ~Cconint~∰~Cdot~Ċ~Cedilla~¸~CenterDot~·~Cfr~ℭ~CircleDot~⊙~CircleMinus~⊖~CirclePlus~⊕~CircleTimes~⊗~ClockwiseContourIntegral~∲~CloseCurlyDoubleQuote~”~CloseCurlyQuote~’~Colon~∷~Colone~⩴~Congruent~≡~Conint~∯~ContourIntegral~∮~Copf~ℂ~Coproduct~∐~CounterClockwiseContourIntegral~∳~Cross~⨯~Cscr~𝒞~Cup~⋓~CupCap~≍~DD~ⅅ~DDotrahd~⤑~DJcy~Ђ~DScy~Ѕ~DZcy~Џ~Darr~↡~Dashv~⫤~Dcaron~Ď~Dcy~Д~Del~∇~Dfr~𝔇~DiacriticalAcute~´~DiacriticalDot~˙~DiacriticalDoubleAcute~˝~DiacriticalGrave~`~DiacriticalTilde~˜~Diamond~⋄~DifferentialD~ⅆ~Dopf~𝔻~Dot~¨~DotDot~⃜~DotEqual~≐~DoubleContourIntegral~∯~DoubleDot~¨~DoubleDownArrow~⇓~DoubleLeftArrow~⇐~DoubleLeftRightArrow~⇔~DoubleLeftTee~⫤~DoubleLongLeftArrow~⟸~DoubleLongLeftRightArrow~⟺~DoubleLongRightArrow~⟹~DoubleRightArrow~⇒~DoubleRightTee~⊨~DoubleUpArrow~⇑~DoubleUpDownArrow~⇕~DoubleVerticalBar~∥~DownArrow~↓~DownArrowBar~⤓~DownArrowUpArrow~⇵~DownBreve~̑~DownLeftRightVector~⥐~DownLeftTeeVector~⥞~DownLeftVector~↽~DownLeftVectorBar~⥖~DownRightTeeVector~⥟~DownRightVector~⇁~DownRightVectorBar~⥗~DownTee~⊤~DownTeeArrow~↧~Downarrow~⇓~Dscr~𝒟~Dstrok~Đ~ENG~Ŋ~Ecaron~Ě~Ecy~Э~Edot~Ė~Efr~𝔈~Element~∈~Emacr~Ē~EmptySmallSquare~◻~EmptyVerySmallSquare~▫~Eogon~Ę~Eopf~𝔼~Equal~⩵~EqualTilde~≂~Equilibrium~⇌~Escr~ℰ~Esim~⩳~Exists~∃~ExponentialE~ⅇ~Fcy~Ф~Ffr~𝔉~FilledSmallSquare~◼~FilledVerySmallSquare~▪~Fopf~𝔽~ForAll~∀~Fouriertrf~ℱ~Fscr~ℱ~GJcy~Ѓ~Gammad~Ϝ~Gbreve~Ğ~Gcedil~Ģ~Gcirc~Ĝ~Gcy~Г~Gdot~Ġ~Gfr~𝔊~Gg~⋙~Gopf~𝔾~GreaterEqual~≥~GreaterEqualLess~⋛~GreaterFullEqual~≧~GreaterGreater~⪢~GreaterLess~≷~GreaterSlantEqual~⩾~GreaterTilde~≳~Gscr~𝒢~Gt~≫~HARDcy~Ъ~Hacek~ˇ~Hat~^~Hcirc~Ĥ~Hfr~ℌ~HilbertSpace~ℋ~Hopf~ℍ~HorizontalLine~─~Hscr~ℋ~Hstrok~Ħ~HumpDownHump~≎~HumpEqual~≏~IEcy~Е~IJlig~Ĳ~IOcy~Ё~Icy~И~Idot~İ~Ifr~ℑ~Im~ℑ~Imacr~Ī~ImaginaryI~ⅈ~Implies~⇒~Int~∬~Integral~∫~Intersection~⋂~InvisibleComma~⁣~InvisibleTimes~⁢~Iogon~Į~Iopf~𝕀~Iscr~ℐ~Itilde~Ĩ~Iukcy~І~Jcirc~Ĵ~Jcy~Й~Jfr~𝔍~Jopf~𝕁~Jscr~𝒥~Jsercy~Ј~Jukcy~Є~KHcy~Х~KJcy~Ќ~Kcedil~Ķ~Kcy~К~Kfr~𝔎~Kopf~𝕂~Kscr~𝒦~LJcy~Љ~Lacute~Ĺ~Lang~⟪~Laplacetrf~ℒ~Larr~↞~Lcaron~Ľ~Lcedil~Ļ~Lcy~Л~LeftAngleBracket~⟨~LeftArrow~←~LeftArrowBar~⇤~LeftArrowRightArrow~⇆~LeftCeiling~⌈~LeftDoubleBracket~⟦~LeftDownTeeVector~⥡~LeftDownVector~⇃~LeftDownVectorBar~⥙~LeftFloor~⌊~LeftRightArrow~↔~LeftRightVector~⥎~LeftTee~⊣~LeftTeeArrow~↤~LeftTeeVector~⥚~LeftTriangle~⊲~LeftTriangleBar~⧏~LeftTriangleEqual~⊴~LeftUpDownVector~⥑~LeftUpTeeVector~⥠~LeftUpVector~↿~LeftUpVectorBar~⥘~LeftVector~↼~LeftVectorBar~⥒~Leftarrow~⇐~Leftrightarrow~⇔~LessEqualGreater~⋚~LessFullEqual~≦~LessGreater~≶~LessLess~⪡~LessSlantEqual~⩽~LessTilde~≲~Lfr~𝔏~Ll~⋘~Lleftarrow~⇚~Lmidot~Ŀ~LongLeftArrow~⟵~LongLeftRightArrow~⟷~LongRightArrow~⟶~Longleftarrow~⟸~Longleftrightarrow~⟺~Longrightarrow~⟹~Lopf~𝕃~LowerLeftArrow~↙~LowerRightArrow~↘~Lscr~ℒ~Lsh~↰~Lstrok~Ł~Lt~≪~Map~⤅~Mcy~М~MediumSpace~ ~Mellintrf~ℳ~Mfr~𝔐~MinusPlus~∓~Mopf~𝕄~Mscr~ℳ~NJcy~Њ~Nacute~Ń~Ncaron~Ň~Ncedil~Ņ~Ncy~Н~NegativeMediumSpace~​~NegativeThickSpace~​~NegativeThinSpace~​~NegativeVeryThinSpace~​~NestedGreaterGreater~≫~NestedLessLess~≪~NewLine~\n~Nfr~𝔑~NoBreak~⁠~NonBreakingSpace~ ~Nopf~ℕ~Not~⫬~NotCongruent~≢~NotCupCap~≭~NotDoubleVerticalBar~∦~NotElement~∉~NotEqual~≠~NotEqualTilde~≂̸~NotExists~∄~NotGreater~≯~NotGreaterEqual~≱~NotGreaterFullEqual~≧̸~NotGreaterGreater~≫̸~NotGreaterLess~≹~NotGreaterSlantEqual~⩾̸~NotGreaterTilde~≵~NotHumpDownHump~≎̸~NotHumpEqual~≏̸~NotLeftTriangle~⋪~NotLeftTriangleBar~⧏̸~NotLeftTriangleEqual~⋬~NotLess~≮~NotLessEqual~≰~NotLessGreater~≸~NotLessLess~≪̸~NotLessSlantEqual~⩽̸~NotLessTilde~≴~NotNestedGreaterGreater~⪢̸~NotNestedLessLess~⪡̸~NotPrecedes~⊀~NotPrecedesEqual~⪯̸~NotPrecedesSlantEqual~⋠~NotReverseElement~∌~NotRightTriangle~⋫~NotRightTriangleBar~⧐̸~NotRightTriangleEqual~⋭~NotSquareSubset~⊏̸~NotSquareSubsetEqual~⋢~NotSquareSuperset~⊐̸~NotSquareSupersetEqual~⋣~NotSubset~⊂⃒~NotSubsetEqual~⊈~NotSucceeds~⊁~NotSucceedsEqual~⪰̸~NotSucceedsSlantEqual~⋡~NotSucceedsTilde~≿̸~NotSuperset~⊃⃒~NotSupersetEqual~⊉~NotTilde~≁~NotTildeEqual~≄~NotTildeFullEqual~≇~NotTildeTilde~≉~NotVerticalBar~∤~Nscr~𝒩~Ocy~О~Odblac~Ő~Ofr~𝔒~Omacr~Ō~Oopf~𝕆~OpenCurlyDoubleQuote~“~OpenCurlyQuote~‘~Or~⩔~Oscr~𝒪~Otimes~⨷~OverBar~‾~OverBrace~⏞~OverBracket~⎴~OverParenthesis~⏜~PartialD~∂~Pcy~П~Pfr~𝔓~PlusMinus~±~Poincareplane~ℌ~Popf~ℙ~Pr~⪻~Precedes~≺~PrecedesEqual~⪯~PrecedesSlantEqual~≼~PrecedesTilde~≾~Product~∏~Proportion~∷~Proportional~∝~Pscr~𝒫~Qfr~𝔔~Qopf~ℚ~Qscr~𝒬~RBarr~⤐~Racute~Ŕ~Rang~⟫~Rarr~↠~Rarrtl~⤖~Rcaron~Ř~Rcedil~Ŗ~Rcy~Р~Re~ℜ~ReverseElement~∋~ReverseEquilibrium~⇋~ReverseUpEquilibrium~⥯~Rfr~ℜ~RightAngleBracket~⟩~RightArrow~→~RightArrowBar~⇥~RightArrowLeftArrow~⇄~RightCeiling~⌉~RightDoubleBracket~⟧~RightDownTeeVector~⥝~RightDownVector~⇂~RightDownVectorBar~⥕~RightFloor~⌋~RightTee~⊢~RightTeeArrow~↦~RightTeeVector~⥛~RightTriangle~⊳~RightTriangleBar~⧐~RightTriangleEqual~⊵~RightUpDownVector~⥏~RightUpTeeVector~⥜~RightUpVector~↾~RightUpVectorBar~⥔~RightVector~⇀~RightVectorBar~⥓~Rightarrow~⇒~Ropf~ℝ~RoundImplies~⥰~Rrightarrow~⇛~Rscr~ℛ~Rsh~↱~RuleDelayed~⧴~SHCHcy~Щ~SHcy~Ш~SOFTcy~Ь~Sacute~Ś~Sc~⪼~Scedil~Ş~Scirc~Ŝ~Scy~С~Sfr~𝔖~ShortDownArrow~↓~ShortLeftArrow~←~ShortRightArrow~→~ShortUpArrow~↑~SmallCircle~∘~Sopf~𝕊~Sqrt~√~Square~□~SquareIntersection~⊓~SquareSubset~⊏~SquareSubsetEqual~⊑~SquareSuperset~⊐~SquareSupersetEqual~⊒~SquareUnion~⊔~Sscr~𝒮~Star~⋆~Sub~⋐~Subset~⋐~SubsetEqual~⊆~Succeeds~≻~SucceedsEqual~⪰~SucceedsSlantEqual~≽~SucceedsTilde~≿~SuchThat~∋~Sum~∑~Sup~⋑~Superset~⊃~SupersetEqual~⊇~Supset~⋑~TRADE~™~TSHcy~Ћ~TScy~Ц~Tab~	~Tcaron~Ť~Tcedil~Ţ~Tcy~Т~Tfr~𝔗~Therefore~∴~ThickSpace~  ~ThinSpace~ ~Tilde~∼~TildeEqual~≃~TildeFullEqual~≅~TildeTilde~≈~Topf~𝕋~TripleDot~⃛~Tscr~𝒯~Tstrok~Ŧ~Uarr~↟~Uarrocir~⥉~Ubrcy~Ў~Ubreve~Ŭ~Ucy~У~Udblac~Ű~Ufr~𝔘~Umacr~Ū~UnderBar~_~UnderBrace~⏟~UnderBracket~⎵~UnderParenthesis~⏝~Union~⋃~UnionPlus~⊎~Uogon~Ų~Uopf~𝕌~UpArrow~↑~UpArrowBar~⤒~UpArrowDownArrow~⇅~UpDownArrow~↕~UpEquilibrium~⥮~UpTee~⊥~UpTeeArrow~↥~Uparrow~⇑~Updownarrow~⇕~UpperLeftArrow~↖~UpperRightArrow~↗~Upsi~ϒ~Uring~Ů~Uscr~𝒰~Utilde~Ũ~VDash~⊫~Vbar~⫫~Vcy~В~Vdash~⊩~Vdashl~⫦~Vee~⋁~Verbar~‖~Vert~‖~VerticalBar~∣~VerticalLine~|~VerticalSeparator~❘~VerticalTilde~≀~VeryThinSpace~ ~Vfr~𝔙~Vopf~𝕍~Vscr~𝒱~Vvdash~⊪~Wcirc~Ŵ~Wedge~⋀~Wfr~𝔚~Wopf~𝕎~Wscr~𝒲~Xfr~𝔛~Xopf~𝕏~Xscr~𝒳~YAcy~Я~YIcy~Ї~YUcy~Ю~Ycirc~Ŷ~Ycy~Ы~Yfr~𝔜~Yopf~𝕐~Yscr~𝒴~ZHcy~Ж~Zacute~Ź~Zcaron~Ž~Zcy~З~Zdot~Ż~ZeroWidthSpace~​~Zfr~ℨ~Zopf~ℤ~Zscr~𝒵~abreve~ă~ac~∾~acE~∾̳~acd~∿~acy~а~af~⁡~afr~𝔞~aleph~ℵ~amacr~ā~amalg~⨿~andand~⩕~andd~⩜~andslope~⩘~andv~⩚~ange~⦤~angle~∠~angmsd~∡~angmsdaa~⦨~angmsdab~⦩~angmsdac~⦪~angmsdad~⦫~angmsdae~⦬~angmsdaf~⦭~angmsdag~⦮~angmsdah~⦯~angrt~∟~angrtvb~⊾~angrtvbd~⦝~angsph~∢~angst~Å~angzarr~⍼~aogon~ą~aopf~𝕒~ap~≈~apE~⩰~apacir~⩯~ape~≊~apid~≋~approx~≈~approxeq~≊~ascr~𝒶~ast~*~asympeq~≍~awconint~∳~awint~⨑~bNot~⫭~backcong~≌~backepsilon~϶~backprime~‵~backsim~∽~backsimeq~⋍~barvee~⊽~barwed~⌅~barwedge~⌅~bbrk~⎵~bbrktbrk~⎶~bcong~≌~bcy~б~becaus~∵~because~∵~bemptyv~⦰~bepsi~϶~bernou~ℬ~beth~ℶ~between~≬~bfr~𝔟~bigcap~⋂~bigcirc~◯~bigcup~⋃~bigodot~⨀~bigoplus~⨁~bigotimes~⨂~bigsqcup~⨆~bigstar~★~bigtriangledown~▽~bigtriangleup~△~biguplus~⨄~bigvee~⋁~bigwedge~⋀~bkarow~⤍~blacklozenge~⧫~blacksquare~▪~blacktriangle~▴~blacktriangledown~▾~blacktriangleleft~◂~blacktriangleright~▸~blank~␣~blk12~▒~blk14~░~blk34~▓~block~█~bne~=⃥~bnequiv~≡⃥~bnot~⌐~bopf~𝕓~bot~⊥~bottom~⊥~bowtie~⋈~boxDL~╗~boxDR~╔~boxDl~╖~boxDr~╓~boxH~═~boxHD~╦~boxHU~╩~boxHd~╤~boxHu~╧~boxUL~╝~boxUR~╚~boxUl~╜~boxUr~╙~boxV~║~boxVH~╬~boxVL~╣~boxVR~╠~boxVh~╫~boxVl~╢~boxVr~╟~boxbox~⧉~boxdL~╕~boxdR~╒~boxdl~┐~boxdr~┌~boxh~─~boxhD~╥~boxhU~╨~boxhd~┬~boxhu~┴~boxminus~⊟~boxplus~⊞~boxtimes~⊠~boxuL~╛~boxuR~╘~boxul~┘~boxur~└~boxv~│~boxvH~╪~boxvL~╡~boxvR~╞~boxvh~┼~boxvl~┤~boxvr~├~bprime~‵~breve~˘~bscr~𝒷~bsemi~⁏~bsim~∽~bsime~⋍~bsol~\\~bsolb~⧅~bsolhsub~⟈~bullet~•~bump~≎~bumpE~⪮~bumpe~≏~bumpeq~≏~cacute~ć~capand~⩄~capbrcup~⩉~capcap~⩋~capcup~⩇~capdot~⩀~caps~∩︀~caret~⁁~caron~ˇ~ccaps~⩍~ccaron~č~ccirc~ĉ~ccups~⩌~ccupssm~⩐~cdot~ċ~cemptyv~⦲~centerdot~·~cfr~𝔠~chcy~ч~check~✓~checkmark~✓~cir~○~cirE~⧃~circeq~≗~circlearrowleft~↺~circlearrowright~↻~circledR~®~circledS~Ⓢ~circledast~⊛~circledcirc~⊚~circleddash~⊝~cire~≗~cirfnint~⨐~cirmid~⫯~cirscir~⧂~clubsuit~♣~colon~:~colone~≔~coloneq~≔~comma~,~commat~@~comp~∁~compfn~∘~complement~∁~complexes~ℂ~congdot~⩭~conint~∮~copf~𝕔~coprod~∐~copysr~℗~cross~✗~cscr~𝒸~csub~⫏~csube~⫑~csup~⫐~csupe~⫒~ctdot~⋯~cudarrl~⤸~cudarrr~⤵~cuepr~⋞~cuesc~⋟~cularr~↶~cularrp~⤽~cupbrcap~⩈~cupcap~⩆~cupcup~⩊~cupdot~⊍~cupor~⩅~cups~∪︀~curarr~↷~curarrm~⤼~curlyeqprec~⋞~curlyeqsucc~⋟~curlyvee~⋎~curlywedge~⋏~curvearrowleft~↶~curvearrowright~↷~cuvee~⋎~cuwed~⋏~cwconint~∲~cwint~∱~cylcty~⌭~dHar~⥥~daleth~ℸ~dash~‐~dashv~⊣~dbkarow~⤏~dblac~˝~dcaron~ď~dcy~д~dd~ⅆ~ddagger~‡~ddarr~⇊~ddotseq~⩷~demptyv~⦱~dfisht~⥿~dfr~𝔡~dharl~⇃~dharr~⇂~diam~⋄~diamond~⋄~diamondsuit~♦~die~¨~digamma~ϝ~disin~⋲~div~÷~divideontimes~⋇~divonx~⋇~djcy~ђ~dlcorn~⌞~dlcrop~⌍~dollar~$~dopf~𝕕~dot~˙~doteq~≐~doteqdot~≑~dotminus~∸~dotplus~∔~dotsquare~⊡~doublebarwedge~⌆~downarrow~↓~downdownarrows~⇊~downharpoonleft~⇃~downharpoonright~⇂~drbkarow~⤐~drcorn~⌟~drcrop~⌌~dscr~𝒹~dscy~ѕ~dsol~⧶~dstrok~đ~dtdot~⋱~dtri~▿~dtrif~▾~duarr~⇵~duhar~⥯~dwangle~⦦~dzcy~џ~dzigrarr~⟿~eDDot~⩷~eDot~≑~easter~⩮~ecaron~ě~ecir~≖~ecolon~≕~ecy~э~edot~ė~ee~ⅇ~efDot~≒~efr~𝔢~eg~⪚~egs~⪖~egsdot~⪘~el~⪙~elinters~⏧~ell~ℓ~els~⪕~elsdot~⪗~emacr~ē~emptyset~∅~emptyv~∅~emsp13~ ~emsp14~ ~eng~ŋ~eogon~ę~eopf~𝕖~epar~⋕~eparsl~⧣~eplus~⩱~epsi~ε~epsiv~ϵ~eqcirc~≖~eqcolon~≕~eqsim~≂~eqslantgtr~⪖~eqslantless~⪕~equals~=~equest~≟~equivDD~⩸~eqvparsl~⧥~erDot~≓~erarr~⥱~escr~ℯ~esdot~≐~esim~≂~excl~!~expectation~ℰ~exponentiale~ⅇ~fallingdotseq~≒~fcy~ф~female~♀~ffilig~ﬃ~fflig~ﬀ~ffllig~ﬄ~ffr~𝔣~filig~ﬁ~fjlig~fj~flat~♭~fllig~ﬂ~fltns~▱~fopf~𝕗~fork~⋔~forkv~⫙~fpartint~⨍~frac13~⅓~frac15~⅕~frac16~⅙~frac18~⅛~frac23~⅔~frac25~⅖~frac35~⅗~frac38~⅜~frac45~⅘~frac56~⅚~frac58~⅝~frac78~⅞~frown~⌢~fscr~𝒻~gE~≧~gEl~⪌~gacute~ǵ~gammad~ϝ~gap~⪆~gbreve~ğ~gcirc~ĝ~gcy~г~gdot~ġ~gel~⋛~geq~≥~geqq~≧~geqslant~⩾~ges~⩾~gescc~⪩~gesdot~⪀~gesdoto~⪂~gesdotol~⪄~gesl~⋛︀~gesles~⪔~gfr~𝔤~gg~≫~ggg~⋙~gimel~ℷ~gjcy~ѓ~gl~≷~glE~⪒~gla~⪥~glj~⪤~gnE~≩~gnap~⪊~gnapprox~⪊~gne~⪈~gneq~⪈~gneqq~≩~gnsim~⋧~gopf~𝕘~grave~`~gscr~ℊ~gsim~≳~gsime~⪎~gsiml~⪐~gtcc~⪧~gtcir~⩺~gtdot~⋗~gtlPar~⦕~gtquest~⩼~gtrapprox~⪆~gtrarr~⥸~gtrdot~⋗~gtreqless~⋛~gtreqqless~⪌~gtrless~≷~gtrsim~≳~gvertneqq~≩︀~gvnE~≩︀~hairsp~ ~half~½~hamilt~ℋ~hardcy~ъ~harrcir~⥈~harrw~↭~hbar~ℏ~hcirc~ĥ~heartsuit~♥~hercon~⊹~hfr~𝔥~hksearow~⤥~hkswarow~⤦~hoarr~⇿~homtht~∻~hookleftarrow~↩~hookrightarrow~↪~hopf~𝕙~horbar~―~hscr~𝒽~hslash~ℏ~hstrok~ħ~hybull~⁃~hyphen~‐~ic~⁣~icy~и~iecy~е~iff~⇔~ifr~𝔦~ii~ⅈ~iiiint~⨌~iiint~∭~iinfin~⧜~iiota~℩~ijlig~ĳ~imacr~ī~imagline~ℐ~imagpart~ℑ~imath~ı~imof~⊷~imped~Ƶ~in~∈~incare~℅~infintie~⧝~inodot~ı~intcal~⊺~integers~ℤ~intercal~⊺~intlarhk~⨗~intprod~⨼~iocy~ё~iogon~į~iopf~𝕚~iprod~⨼~iscr~𝒾~isinE~⋹~isindot~⋵~isins~⋴~isinsv~⋳~isinv~∈~it~⁢~itilde~ĩ~iukcy~і~jcirc~ĵ~jcy~й~jfr~𝔧~jmath~ȷ~jopf~𝕛~jscr~𝒿~jsercy~ј~jukcy~є~kappav~ϰ~kcedil~ķ~kcy~к~kfr~𝔨~kgreen~ĸ~khcy~х~kjcy~ќ~kopf~𝕜~kscr~𝓀~lAarr~⇚~lAtail~⤛~lBarr~⤎~lE~≦~lEg~⪋~lHar~⥢~lacute~ĺ~laemptyv~⦴~lagran~ℒ~langd~⦑~langle~⟨~lap~⪅~larrb~⇤~larrbfs~⤟~larrfs~⤝~larrhk~↩~larrlp~↫~larrpl~⤹~larrsim~⥳~larrtl~↢~lat~⪫~latail~⤙~late~⪭~lates~⪭︀~lbarr~⤌~lbbrk~❲~lbrace~{~lbrack~[~lbrke~⦋~lbrksld~⦏~lbrkslu~⦍~lcaron~ľ~lcedil~ļ~lcub~{~lcy~л~ldca~⤶~ldquor~„~ldrdhar~⥧~ldrushar~⥋~ldsh~↲~leftarrow~←~leftarrowtail~↢~leftharpoondown~↽~leftharpoonup~↼~leftleftarrows~⇇~leftrightarrow~↔~leftrightarrows~⇆~leftrightharpoons~⇋~leftrightsquigarrow~↭~leftthreetimes~⋋~leg~⋚~leq~≤~leqq~≦~leqslant~⩽~les~⩽~lescc~⪨~lesdot~⩿~lesdoto~⪁~lesdotor~⪃~lesg~⋚︀~lesges~⪓~lessapprox~⪅~lessdot~⋖~lesseqgtr~⋚~lesseqqgtr~⪋~lessgtr~≶~lesssim~≲~lfisht~⥼~lfr~𝔩~lg~≶~lgE~⪑~lhard~↽~lharu~↼~lharul~⥪~lhblk~▄~ljcy~љ~ll~≪~llarr~⇇~llcorner~⌞~llhard~⥫~lltri~◺~lmidot~ŀ~lmoust~⎰~lmoustache~⎰~lnE~≨~lnap~⪉~lnapprox~⪉~lne~⪇~lneq~⪇~lneqq~≨~lnsim~⋦~loang~⟬~loarr~⇽~lobrk~⟦~longleftarrow~⟵~longleftrightarrow~⟷~longmapsto~⟼~longrightarrow~⟶~looparrowleft~↫~looparrowright~↬~lopar~⦅~lopf~𝕝~loplus~⨭~lotimes~⨴~lowbar~_~lozenge~◊~lozf~⧫~lpar~(~lparlt~⦓~lrarr~⇆~lrcorner~⌟~lrhar~⇋~lrhard~⥭~lrtri~⊿~lscr~𝓁~lsh~↰~lsim~≲~lsime~⪍~lsimg~⪏~lsqb~[~lsquor~‚~lstrok~ł~ltcc~⪦~ltcir~⩹~ltdot~⋖~lthree~⋋~ltimes~⋉~ltlarr~⥶~ltquest~⩻~ltrPar~⦖~ltri~◃~ltrie~⊴~ltrif~◂~lurdshar~⥊~luruhar~⥦~lvertneqq~≨︀~lvnE~≨︀~mDDot~∺~male~♂~malt~✠~maltese~✠~map~↦~mapsto~↦~mapstodown~↧~mapstoleft~↤~mapstoup~↥~marker~▮~mcomma~⨩~mcy~м~measuredangle~∡~mfr~𝔪~mho~℧~mid~∣~midast~*~midcir~⫰~minusb~⊟~minusd~∸~minusdu~⨪~mlcp~⫛~mldr~…~mnplus~∓~models~⊧~mopf~𝕞~mp~∓~mscr~𝓂~mstpos~∾~multimap~⊸~mumap~⊸~nGg~⋙̸~nGt~≫⃒~nGtv~≫̸~nLeftarrow~⇍~nLeftrightarrow~⇎~nLl~⋘̸~nLt~≪⃒~nLtv~≪̸~nRightarrow~⇏~nVDash~⊯~nVdash~⊮~nacute~ń~nang~∠⃒~nap~≉~napE~⩰̸~napid~≋̸~napos~ŉ~napprox~≉~natur~♮~natural~♮~naturals~ℕ~nbump~≎̸~nbumpe~≏̸~ncap~⩃~ncaron~ň~ncedil~ņ~ncong~≇~ncongdot~⩭̸~ncup~⩂~ncy~н~neArr~⇗~nearhk~⤤~nearr~↗~nearrow~↗~nedot~≐̸~nequiv~≢~nesear~⤨~nesim~≂̸~nexist~∄~nexists~∄~nfr~𝔫~ngE~≧̸~nge~≱~ngeq~≱~ngeqq~≧̸~ngeqslant~⩾̸~nges~⩾̸~ngsim~≵~ngt~≯~ngtr~≯~nhArr~⇎~nharr~↮~nhpar~⫲~nis~⋼~nisd~⋺~niv~∋~njcy~њ~nlArr~⇍~nlE~≦̸~nlarr~↚~nldr~‥~nle~≰~nleftarrow~↚~nleftrightarrow~↮~nleq~≰~nleqq~≦̸~nleqslant~⩽̸~nles~⩽̸~nless~≮~nlsim~≴~nlt~≮~nltri~⋪~nltrie~⋬~nmid~∤~nopf~𝕟~notinE~⋹̸~notindot~⋵̸~notinva~∉~notinvb~⋷~notinvc~⋶~notni~∌~notniva~∌~notnivb~⋾~notnivc~⋽~npar~∦~nparallel~∦~nparsl~⫽⃥~npart~∂̸~npolint~⨔~npr~⊀~nprcue~⋠~npre~⪯̸~nprec~⊀~npreceq~⪯̸~nrArr~⇏~nrarr~↛~nrarrc~⤳̸~nrarrw~↝̸~nrightarrow~↛~nrtri~⋫~nrtrie~⋭~nsc~⊁~nsccue~⋡~nsce~⪰̸~nscr~𝓃~nshortmid~∤~nshortparallel~∦~nsim~≁~nsime~≄~nsimeq~≄~nsmid~∤~nspar~∦~nsqsube~⋢~nsqsupe~⋣~nsubE~⫅̸~nsube~⊈~nsubset~⊂⃒~nsubseteq~⊈~nsubseteqq~⫅̸~nsucc~⊁~nsucceq~⪰̸~nsup~⊅~nsupE~⫆̸~nsupe~⊉~nsupset~⊃⃒~nsupseteq~⊉~nsupseteqq~⫆̸~ntgl~≹~ntlg~≸~ntriangleleft~⋪~ntrianglelefteq~⋬~ntriangleright~⋫~ntrianglerighteq~⋭~num~#~numero~№~numsp~ ~nvDash~⊭~nvHarr~⤄~nvap~≍⃒~nvdash~⊬~nvge~≥⃒~nvgt~>⃒~nvinfin~⧞~nvlArr~⤂~nvle~≤⃒~nvlt~<⃒~nvltrie~⊴⃒~nvrArr~⤃~nvrtrie~⊵⃒~nvsim~∼⃒~nwArr~⇖~nwarhk~⤣~nwarr~↖~nwarrow~↖~nwnear~⤧~oS~Ⓢ~oast~⊛~ocir~⊚~ocy~о~odash~⊝~odblac~ő~odiv~⨸~odot~⊙~odsold~⦼~ofcir~⦿~ofr~𝔬~ogon~˛~ogt~⧁~ohbar~⦵~ohm~Ω~oint~∮~olarr~↺~olcir~⦾~olcross~⦻~olt~⧀~omacr~ō~omid~⦶~ominus~⊖~oopf~𝕠~opar~⦷~operp~⦹~orarr~↻~ord~⩝~order~ℴ~orderof~ℴ~origof~⊶~oror~⩖~orslope~⩗~orv~⩛~oscr~ℴ~osol~⊘~otimesas~⨶~ovbar~⌽~par~∥~parallel~∥~parsim~⫳~parsl~⫽~pcy~п~percnt~%~period~.~pertenk~‱~pfr~𝔭~phiv~ϕ~phmmat~ℳ~phone~☎~pitchfork~⋔~planck~ℏ~planckh~ℎ~plankv~ℏ~plus~+~plusacir~⨣~plusb~⊞~pluscir~⨢~plusdo~∔~plusdu~⨥~pluse~⩲~plussim~⨦~plustwo~⨧~pm~±~pointint~⨕~popf~𝕡~pr~≺~prE~⪳~prap~⪷~prcue~≼~pre~⪯~prec~≺~precapprox~⪷~preccurlyeq~≼~preceq~⪯~precnapprox~⪹~precneqq~⪵~precnsim~⋨~precsim~≾~primes~ℙ~prnE~⪵~prnap~⪹~prnsim~⋨~profalar~⌮~profline~⌒~profsurf~⌓~propto~∝~prsim~≾~prurel~⊰~pscr~𝓅~puncsp~ ~qfr~𝔮~qint~⨌~qopf~𝕢~qprime~⁗~qscr~𝓆~quaternions~ℍ~quatint~⨖~quest~?~questeq~≟~rAarr~⇛~rAtail~⤜~rBarr~⤏~rHar~⥤~race~∽̱~racute~ŕ~raemptyv~⦳~rangd~⦒~range~⦥~rangle~⟩~rarrap~⥵~rarrb~⇥~rarrbfs~⤠~rarrc~⤳~rarrfs~⤞~rarrhk~↪~rarrlp~↬~rarrpl~⥅~rarrsim~⥴~rarrtl~↣~rarrw~↝~ratail~⤚~ratio~∶~rationals~ℚ~rbarr~⤍~rbbrk~❳~rbrace~}~rbrack~]~rbrke~⦌~rbrksld~⦎~rbrkslu~⦐~rcaron~ř~rcedil~ŗ~rcub~}~rcy~р~rdca~⤷~rdldhar~⥩~rdquor~”~rdsh~↳~realine~ℛ~realpart~ℜ~reals~ℝ~rect~▭~rfisht~⥽~rfr~𝔯~rhard~⇁~rharu~⇀~rharul~⥬~rhov~ϱ~rightarrow~→~rightarrowtail~↣~rightharpoondown~⇁~rightharpoonup~⇀~rightleftarrows~⇄~rightleftharpoons~⇌~rightrightarrows~⇉~rightsquigarrow~↝~rightthreetimes~⋌~ring~˚~risingdotseq~≓~rlarr~⇄~rlhar~⇌~rmoust~⎱~rmoustache~⎱~rnmid~⫮~roang~⟭~roarr~⇾~robrk~⟧~ropar~⦆~ropf~𝕣~roplus~⨮~rotimes~⨵~rpar~)~rpargt~⦔~rppolint~⨒~rrarr~⇉~rscr~𝓇~rsh~↱~rsqb~]~rsquor~’~rthree~⋌~rtimes~⋊~rtri~▹~rtrie~⊵~rtrif~▸~rtriltri~⧎~ruluhar~⥨~rx~℞~sacute~ś~sc~≻~scE~⪴~scap~⪸~sccue~≽~sce~⪰~scedil~ş~scirc~ŝ~scnE~⪶~scnap~⪺~scnsim~⋩~scpolint~⨓~scsim~≿~scy~с~sdotb~⊡~sdote~⩦~seArr~⇘~searhk~⤥~searr~↘~searrow~↘~semi~;~seswar~⤩~setminus~∖~setmn~∖~sext~✶~sfr~𝔰~sfrown~⌢~sharp~♯~shchcy~щ~shcy~ш~shortmid~∣~shortparallel~∥~sigmav~ς~simdot~⩪~sime~≃~simeq~≃~simg~⪞~simgE~⪠~siml~⪝~simlE~⪟~simne~≆~simplus~⨤~simrarr~⥲~slarr~←~smallsetminus~∖~smashp~⨳~smeparsl~⧤~smid~∣~smile~⌣~smt~⪪~smte~⪬~smtes~⪬︀~softcy~ь~sol~/~solb~⧄~solbar~⌿~sopf~𝕤~spadesuit~♠~spar~∥~sqcap~⊓~sqcaps~⊓︀~sqcup~⊔~sqcups~⊔︀~sqsub~⊏~sqsube~⊑~sqsubset~⊏~sqsubseteq~⊑~sqsup~⊐~sqsupe~⊒~sqsupset~⊐~sqsupseteq~⊒~squ~□~square~□~squarf~▪~squf~▪~srarr~→~sscr~𝓈~ssetmn~∖~ssmile~⌣~sstarf~⋆~star~☆~starf~★~straightepsilon~ϵ~straightphi~ϕ~strns~¯~subE~⫅~subdot~⪽~subedot~⫃~submult~⫁~subnE~⫋~subne~⊊~subplus~⪿~subrarr~⥹~subset~⊂~subseteq~⊆~subseteqq~⫅~subsetneq~⊊~subsetneqq~⫋~subsim~⫇~subsub~⫕~subsup~⫓~succ~≻~succapprox~⪸~succcurlyeq~≽~succeq~⪰~succnapprox~⪺~succneqq~⪶~succnsim~⋩~succsim~≿~sung~♪~supE~⫆~supdot~⪾~supdsub~⫘~supedot~⫄~suphsol~⟉~suphsub~⫗~suplarr~⥻~supmult~⫂~supnE~⫌~supne~⊋~supplus~⫀~supset~⊃~supseteq~⊇~supseteqq~⫆~supsetneq~⊋~supsetneqq~⫌~supsim~⫈~supsub~⫔~supsup~⫖~swArr~⇙~swarhk~⤦~swarr~↙~swarrow~↙~swnwar~⤪~target~⌖~tbrk~⎴~tcaron~ť~tcedil~ţ~tcy~т~tdot~⃛~telrec~⌕~tfr~𝔱~therefore~∴~thetav~ϑ~thickapprox~≈~thicksim~∼~thkap~≈~thksim~∼~timesb~⊠~timesbar~⨱~timesd~⨰~tint~∭~toea~⤨~top~⊤~topbot~⌶~topcir~⫱~topf~𝕥~topfork~⫚~tosa~⤩~tprime~‴~triangle~▵~triangledown~▿~triangleleft~◃~trianglelefteq~⊴~triangleq~≜~triangleright~▹~trianglerighteq~⊵~tridot~◬~trie~≜~triminus~⨺~triplus~⨹~trisb~⧍~tritime~⨻~trpezium~⏢~tscr~𝓉~tscy~ц~tshcy~ћ~tstrok~ŧ~twixt~≬~twoheadleftarrow~↞~twoheadrightarrow~↠~uHar~⥣~ubrcy~ў~ubreve~ŭ~ucy~у~udarr~⇅~udblac~ű~udhar~⥮~ufisht~⥾~ufr~𝔲~uharl~↿~uharr~↾~uhblk~▀~ulcorn~⌜~ulcorner~⌜~ulcrop~⌏~ultri~◸~umacr~ū~uogon~ų~uopf~𝕦~uparrow~↑~updownarrow~↕~upharpoonleft~↿~upharpoonright~↾~uplus~⊎~upsi~υ~upuparrows~⇈~urcorn~⌝~urcorner~⌝~urcrop~⌎~uring~ů~urtri~◹~uscr~𝓊~utdot~⋰~utilde~ũ~utri~▵~utrif~▴~uuarr~⇈~uwangle~⦧~vArr~⇕~vBar~⫨~vBarv~⫩~vDash~⊨~vangrt~⦜~varepsilon~ϵ~varkappa~ϰ~varnothing~∅~varphi~ϕ~varpi~ϖ~varpropto~∝~varr~↕~varrho~ϱ~varsigma~ς~varsubsetneq~⊊︀~varsubsetneqq~⫋︀~varsupsetneq~⊋︀~varsupsetneqq~⫌︀~vartheta~ϑ~vartriangleleft~⊲~vartriangleright~⊳~vcy~в~vdash~⊢~vee~∨~veebar~⊻~veeeq~≚~vellip~⋮~verbar~|~vert~|~vfr~𝔳~vltri~⊲~vnsub~⊂⃒~vnsup~⊃⃒~vopf~𝕧~vprop~∝~vrtri~⊳~vscr~𝓋~vsubnE~⫋︀~vsubne~⊊︀~vsupnE~⫌︀~vsupne~⊋︀~vzigzag~⦚~wcirc~ŵ~wedbar~⩟~wedge~∧~wedgeq~≙~wfr~𝔴~wopf~𝕨~wp~℘~wr~≀~wreath~≀~wscr~𝓌~xcap~⋂~xcirc~◯~xcup~⋃~xdtri~▽~xfr~𝔵~xhArr~⟺~xharr~⟷~xlArr~⟸~xlarr~⟵~xmap~⟼~xnis~⋻~xodot~⨀~xopf~𝕩~xoplus~⨁~xotime~⨂~xrArr~⟹~xrarr~⟶~xscr~𝓍~xsqcup~⨆~xuplus~⨄~xutri~△~xvee~⋁~xwedge~⋀~yacy~я~ycirc~ŷ~ycy~ы~yfr~𝔶~yicy~ї~yopf~𝕪~yscr~𝓎~yucy~ю~zacute~ź~zcaron~ž~zcy~з~zdot~ż~zeetrf~ℨ~zfr~𝔷~zhcy~ж~zigrarr~⇝~zopf~𝕫~zscr~𝓏~~AMP~&~COPY~©~GT~>~LT~<~QUOT~"~REG~®',ho.html4);var mF={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376},yF=String.fromCodePoint||function(n){return String.fromCharCode(Math.floor((n-65536)/1024)+55296,(n-65536)%1024+56320)},fo=function(){return fo=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r])}return n},fo.apply(this,arguments)},vF=fo(fo({},ho),{all:ho.html5}),bF={scope:"body",level:"all"},Sp=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+);/g,xp=/&(?:#\d+|#[xX][\da-fA-F]+|[0-9a-zA-Z]+)[;=]?/g,WS={xml:{strict:Sp,attribute:xp,body:Ap.xml},html4:{strict:Sp,attribute:xp,body:Ap.html4},html5:{strict:Sp,attribute:xp,body:Ap.html5}},EF=fo(fo({},WS),{all:WS.html5}),YS=String.fromCharCode,AF=YS(65533);function SF(n,e,t,i){var r=n,s=n[n.length-1];if(t&&s==="=")r=n;else if(i&&s!==";")r=n;else{var a=e[n];if(a)r=a;else if(n[0]==="&"&&n[1]==="#"){var o=n[2],l=o=="x"||o=="X"?parseInt(n.substr(3),16):parseInt(n.substr(2));r=l>=1114111?AF:l>65535?yF(l):YS(mF[l]||l)}}return r}function zS(n,e){var t=e===void 0?bF:e,i=t.level,r=i===void 0?"all":i,s=t.scope,a=s===void 0?r==="xml"?"strict":"body":s;if(!n)return"";var o=EF[r][a],l=vF[r].entities,u=a==="attribute",h=a==="strict";return n.replace(o,function(d){return SF(d,l,u,h)})}/**
 * @name ranges-sort
 * @fileoverview Sort string index ranges
 * @version 6.0.13
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-sort/}
 */var xF={strictlyTwoElementsInRangeArrays:!1,progressFn:null};function Rc(n,e){if(!Array.isArray(n)||!n.length)return n;let t={...xF,...e},i,r;if(t.strictlyTwoElementsInRangeArrays&&!n.every((o,l)=>!Array.isArray(o)||o.length!==2?(i=l,r=o.length,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_03] The first argument should be an array and must consist of arrays which are natural number indexes representing TWO string index ranges. However, ${i}th range (${JSON.stringify(n[i],null,4)}) has not two but ${r} elements!`);if(!n.every((o,l)=>!Array.isArray(o)||!Number.isInteger(o[0])||o[0]<0||!Number.isInteger(o[1])||o[1]<0?(i=l,!1):!0))throw new TypeError(`ranges-sort: [THROW_ID_04] The first argument should be an array and must consist of arrays which are natural number indexes representing string index ranges. However, ${i}th range (${JSON.stringify(n[i],null,4)}) does not consist of only natural numbers!`);let s=n.length**2,a=0;return Array.from(n).sort((o,l)=>(t.progressFn&&(a+=1,t.progressFn(Math.floor(a*100/s))),o[0]===l[0]?o[1]<l[1]?-1:o[1]>l[1]?1:0:o[0]<l[0]?-1:1))}/**
 * @name ranges-merge
 * @fileoverview Merge and sort string index ranges
 * @version 9.0.18
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-merge/}
 */var jS={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function TF(n,e){function t(u){return!!u&&typeof u=="object"&&!Array.isArray(u)}if(!Array.isArray(n)||!n.length)return null;let i;if(e)if(t(e)){if(i={...jS,...e},i.progressFn&&t(i.progressFn)&&!Object.keys(i.progressFn).length)i.progressFn=null;else if(i.progressFn&&typeof i.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] opts.progressFn must be a function! It was given of a type: "${typeof i.progressFn}", equal to ${JSON.stringify(i.progressFn,null,4)}`);if(![1,2,"1","2"].includes(i.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof i.mergeType}", equal to ${JSON.stringify(i.mergeType,null,4)}`);if(typeof i.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] opts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof i.joinRangesThatTouchEdges}", equal to ${JSON.stringify(i.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`emlint: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(e,null,4)} (type ${typeof e})`);else i={...jS};let r=n.filter(u=>Array.isArray(u)).map(u=>[...u]).filter(u=>u[2]!==void 0||u[0]!==u[1]),s,a,o;i.progressFn?s=Rc(r,{progressFn:u=>{o=Math.floor(u/5),o!==a&&(a=o,i.progressFn(o))}}):s=Rc(r);let l=s.length-1;for(let u=l;u>0;u--)i.progressFn&&(o=Math.floor((1-u/l)*78)+21,o!==a&&o>a&&(a=o,i.progressFn(o))),(s[u][0]<=s[u-1][0]||!i.joinRangesThatTouchEdges&&s[u][0]<s[u-1][1]||i.joinRangesThatTouchEdges&&s[u][0]<=s[u-1][1])&&(s[u-1][0]=Math.min(s[u][0],s[u-1][0]),s[u-1][1]=Math.max(s[u][1],s[u-1][1]),s[u][2]!==void 0&&(s[u-1][0]>=s[u][0]||s[u-1][1]<=s[u][1])&&s[u-1][2]!==null&&(s[u][2]===null&&s[u-1][2]!==null?s[u-1][2]=null:s[u-1][2]!=null?+i.mergeType==2&&s[u-1][0]===s[u][0]?s[u-1][2]=s[u][2]:s[u-1][2]+=s[u][2]:s[u-1][2]=s[u][2]),s.splice(u,1),u=s.length);return s.length?s:null}var wF="Invariant failed";function DF(n,e){if(!n)throw new Error(wF)}/**
 * @name ranges-apply
 * @fileoverview Take an array of string index ranges, delete/replace the string according to them
 * @version 7.0.19
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-apply/}
 */function RF(n,e,t){if(arguments.length===0)throw new Error("ranges-apply: [THROW_ID_01] inputs missing!");if(typeof n!="string")throw new TypeError(`ranges-apply: [THROW_ID_02] first input argument must be a string! Currently it's: ${typeof n}, equal to: ${JSON.stringify(n,null,4)}`);if(e&&!Array.isArray(e))throw new TypeError(`ranges-apply: [THROW_ID_03] second input argument must be an array (or null)! Currently it's: ${typeof e}, equal to: ${JSON.stringify(e,null,4)}`);if(!(e!=null&&e.filter(a=>a).length))return n;let i;Array.isArray(e)&&Number.isInteger(e[0])&&Number.isInteger(e[1])?i=[Array.from(e)]:i=Array.from(e),i.length,i.filter(a=>a).forEach((a,o)=>{if(!Array.isArray(a))throw new TypeError(`ranges-apply: [THROW_ID_05] ranges array, second input arg., has ${o}th element not an array: ${JSON.stringify(a,null,4)}, which is ${typeof a}`);if(!Number.isInteger(a[0])){if(!Number.isInteger(+a[0])||+a[0]<0)throw new TypeError(`ranges-apply: [THROW_ID_06] ranges array, second input arg. has ${o}th element, array ${JSON.stringify(a,null,0)}. Its first element is not an integer, string index, but ${typeof a[0]}, equal to: ${JSON.stringify(a[0],null,4)}.`);i[o][0]=+i[o][0]}if(!Number.isInteger(a[1])){if(!Number.isInteger(+a[1])||+a[1]<0)throw new TypeError(`ranges-apply: [THROW_ID_07] ranges array, second input arg. has ${o}th element, array ${JSON.stringify(a,null,0)}. Its second element is not an integer, string index, but ${typeof a[1]}, equal to: ${JSON.stringify(a[1],null,4)}.`);i[o][1]=+i[o][1]}});let r=TF(i,{progressFn:a=>{}});DF(r);let s=r.length;if(s>0){let a=n.slice(r[s-1][1]);n=r.reduce((o,l,u,h)=>{let d=u===0?0:h[u-1][1],p=h[u][0];return`${o}${n.slice(d,p)}${h[u][2]||""}`},""),n+=a}return n}/**
 * @name string-collapse-leading-whitespace
 * @fileoverview Collapse the leading and trailing whitespace of a string
 * @version 7.0.9
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-collapse-leading-whitespace/}
 */function Tp(n,e=1){let t=" ";function i(s){return Array.from(s).reverse().join("")}function r(s,a,o){let l=o?`
`:"\r",u=o?"\r":`
`;if(!s)return s;let h=0,d="";for(let p=0,g=s.length;p<g;p++)(s[p]===l||s[p]===u&&s[p-1]!==l)&&h++,`\r
`.includes(s[p])||s[p]===t?s[p]===t?d+=s[p]:s[p]===l?h<=a&&(d+=s[p],s[p+1]===u&&(d+=s[p+1],p++)):s[p]===u&&(s==null?void 0:s[p-1])!==l&&h<=a&&(d+=s[p]):!s[p+1]&&!h&&(d+=" ");return d}if(typeof n=="string"&&n.length){let s=1;typeof+e=="number"&&Number.isInteger(+e)&&+e>=0&&(s=+e);let a="",o="";if(!n.trim())a=n;else if(!n[0].trim()){for(let l=0,u=n.length;l<u;l++)if(n[l].trim()){a=n.slice(0,l);break}}if(n.trim()&&(n.slice(-1).trim()===""||n.slice(-1)===t)){for(let l=n.length;l--;)if(n[l].trim()){o=n.slice(l+1);break}}return`${r(a,s,!1)}${n.trim()}${i(r(i(o),s,!0))}`}return n}/**
 * @name ranges-push
 * @fileoverview Gather string index ranges
 * @version 7.0.18
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/ranges-push/}
 */var XS={mergeType:1,progressFn:null,joinRangesThatTouchEdges:!0};function IF(n,e){var u;function t(h){return!!h&&typeof h=="object"&&!Array.isArray(h)}if(!Array.isArray(n)||!n.length)return null;let i;if(e)if(t(e)){if(i={...XS,...e},i.progressFn&&t(i.progressFn)&&!Object.keys(i.progressFn).length)i.progressFn=null;else if(i.progressFn&&typeof i.progressFn!="function")throw new Error(`ranges-merge: [THROW_ID_01] resolvedOpts.progressFn must be a function! It was given of a type: "${typeof i.progressFn}", equal to ${JSON.stringify(i.progressFn,null,4)}`);if(![1,2,"1","2"].includes(i.mergeType))throw new Error(`ranges-merge: [THROW_ID_02] resolvedOpts.mergeType was customised to a wrong thing! It was given of a type: "${typeof i.mergeType}", equal to ${JSON.stringify(i.mergeType,null,4)}`);if(typeof i.joinRangesThatTouchEdges!="boolean")throw new Error(`ranges-merge: [THROW_ID_04] resolvedOpts.joinRangesThatTouchEdges was customised to a wrong thing! It was given of a type: "${typeof i.joinRangesThatTouchEdges}", equal to ${JSON.stringify(i.joinRangesThatTouchEdges,null,4)}`)}else throw new Error(`ranges-merge: [THROW_ID_03] the second input argument must be a plain object. It was given as:
${JSON.stringify(e,null,4)} (type ${typeof e})`);else i={...XS};let r=n.filter(h=>Array.isArray(h)).map(h=>[...h]).filter(h=>h[2]!==void 0||h[0]!==h[1]),s,a,o;i.progressFn?s=Rc(r,{progressFn:h=>{o=Math.floor(h/5),o!==a&&(a=o,i.progressFn!=null&&i.progressFn(o))}}):s=Rc(r);let l=s.length-1;for(let h=l;h>0;h--)i.progressFn&&(o=Math.floor((1-h/l)*78)+21,o!==a&&o>a&&(a=o,i.progressFn(o))),(s[h][0]<=s[h-1][0]||!i.joinRangesThatTouchEdges&&s[h][0]<s[h-1][1]||i.joinRangesThatTouchEdges&&s[h][0]<=s[h-1][1])&&(s[h-1][0]=Math.min(s[h][0],s[h-1][0]),s[h-1][1]=Math.max(s[h][1],s[h-1][1]),s[h][2]!==void 0&&(s[h-1][0]>=s[h][0]||s[h-1][1]<=s[h][1])&&s[h-1][2]!==null&&(s[h][2]===null&&s[h-1][2]!==null?s[h-1][2]=null:s[h-1][2]!=null?+((u=i||{})==null?void 0:u.mergeType)==2&&s[h-1][0]===s[h][0]?s[h-1][2]=s[h][2]:s[h-1][2]+=s[h][2]:s[h-1][2]=s[h][2]),s.splice(h,1),h=s.length);return s.length?s:null}var CF={limitToBeAddedWhitespace:!1,limitLinebreaksCount:1,mergeType:1},NF=class{constructor(n){X(this,"ranges");X(this,"opts");let e={...CF,...n};if(e.mergeType&&e.mergeType!==1&&e.mergeType!==2)if(ao(e.mergeType)&&e.mergeType.trim()==="1")e.mergeType=1;else if(ao(e.mergeType)&&e.mergeType.trim()==="2")e.mergeType=2;else throw new Error(`ranges-push: [THROW_ID_02] opts.mergeType was customised to a wrong thing! It was given of a type: "${typeof e.mergeType}", equal to ${JSON.stringify(e.mergeType,null,4)}`);this.opts=e,this.ranges=[]}add(n,e,t){var s;if(n==null&&e==null)return;if(Rs(n)&&!Rs(e)){if(Array.isArray(n)){if(n.length){if(n.some(a=>Array.isArray(a))){n.forEach(a=>{Array.isArray(a)&&this.add(...a)});return}n.length&&Ds(+n[0])&&Ds(+n[1])&&this.add(...n)}return}throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_12] the first input argument, "from" is set (${JSON.stringify(n,null,0)}) but second-one, "to" is not (${JSON.stringify(e,null,0)})`)}else if(!Rs(n)&&Rs(e))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_13] the second input argument, "to" is set (${JSON.stringify(e,null,0)}) but first-one, "from" is not (${JSON.stringify(n,null,0)})`);let i=+n,r=+e;if(Ds(t)&&(t=String(t)),Ds(i)&&Ds(r)){if(Rs(t)&&!ao(t)&&!Ds(t))throw new TypeError(`ranges-push/Ranges/add(): [THROW_ID_08] The third argument, the value to add, was given not as string but ${typeof t}, equal to:
${JSON.stringify(t,null,4)}`);if(Rs(this.ranges)&&Array.isArray(this.last())&&i===this.last()[1]){if(this.last()[1]=r,this.last()[2],this.last()[2]!==null&&Rs(t)){let a=this.last()[2]&&this.last()[2].length&&(!((s=this.opts)!=null&&s.mergeType)||this.opts.mergeType===1)?`${this.last()[2]}${t}`:t;this.opts.limitToBeAddedWhitespace&&(a=Tp(a,this.opts.limitLinebreaksCount)),ao(a)&&!a.length||(this.last()[2]=a)}}else{this.ranges||(this.ranges=[]);let a=t!==void 0&&!(ao(t)&&!t.length)?[i,r,t&&this.opts.limitToBeAddedWhitespace?Tp(t,this.opts.limitLinebreaksCount):t]:[i,r];this.ranges.push(a)}}else throw Ds(i)&&i>=0?new TypeError(`ranges-push/Ranges/add(): [THROW_ID_10] "to" value, the second input argument, must be a natural number or zero! Currently it's of a type "${typeof r}" equal to: ${JSON.stringify(r,null,4)}`):new TypeError(`ranges-push/Ranges/add(): [THROW_ID_09] "from" value, the first input argument, must be a natural number or zero! Currently it's of a type "${typeof i}" equal to: ${JSON.stringify(i,null,4)}`)}push(n,e,t){this.add(n,e,t)}current(){return Array.isArray(this.ranges)&&this.ranges.length?(this.ranges=IF(this.ranges,{mergeType:this.opts.mergeType}),this.ranges&&this.opts.limitToBeAddedWhitespace?this.ranges.map(n=>Rs(n[2])?[n[0],n[1],Tp(n[2],this.opts.limitLinebreaksCount)]:n):this.ranges):null}wipe(){this.ranges=[]}replace(n){if(Array.isArray(n)&&n.length)if(Array.isArray(n[0])&&Ds(n[0][0]))this.ranges=Array.from(n);else throw new Error(`ranges-push/Ranges/replace(): [THROW_ID_11] Single range was given but we expected array of arrays! The first element, ${JSON.stringify(n[0],null,4)} should be an array and its first element should be an integer, a string index.`);else this.ranges=[]}last(){return Array.isArray(this.ranges)&&this.ranges.length?this.ranges[this.ranges.length-1]:null}};/**
 * @name string-left-right
 * @fileoverview Looks up the first non-whitespace character to the left/right of a given index
 * @version 6.0.20
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-left-right/}
 */wS();var wp=" ";function LF({str:n,idx:e=0,stopAtNewlines:t=!1,stopAtRawNbsp:i=!1}){if(typeof n!="string"||!n.length||((!e||typeof e!="number")&&(e=0),!n[e+1]))return null;if(n[e+1]&&(n[e+1].trim()||t&&`
\r`.includes(n[e+1])||i&&n[e+1]===wp))return e+1;if(n[e+2]&&(n[e+2].trim()||t&&`
\r`.includes(n[e+2])||i&&n[e+2]===wp))return e+2;for(let r=e+1,s=n.length;r<s;r++)if(n[r].trim()||t&&`
\r`.includes(n[r])||i&&n[r]===wp)return r;return null}function bn(n,e=0){return LF({str:n,idx:e,stopAtNewlines:!1,stopAtRawNbsp:!1})}/**
 * @name string-strip-html
 * @fileoverview Strip HTML tags from strings. No parser, accepts mixed sources.
 * @version 13.4.12
 * @author Roy Revelt, Codsen Ltd
 * @license MIT
 * {@link https://codsen.com/os/string-strip-html/}
 */function _F(n){return/[-_A-Za-z0-9]/.test(n)}function JS(n,e){if(!n)return[];if(Array.isArray(n))return n.filter(t=>typeof t=="string"&&t.trim());if(typeof n=="string")return n.trim()?[n]:[];throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_05] ${e} must be array containing zero or more strings or something falsey. Currently it's equal to: ${n}, that a type of ${typeof n}.`)}function Ic(n,e,t,i){for(let r=e,s=n.length;r<s;r++){if(n.startsWith(t,r))return!0;if(n.startsWith(i,r))return!1}return!1}function QS(n,e,t){var i,r,s,a,o,l,u;return n!=null&&n.quotes,(i=n==null?void 0:n.quotes)!=null&&i.value&&Ic(e,t+1,n.quotes.value,">"),(r=n==null?void 0:n.quotes)==null||r.next,Ic(e,((s=n==null?void 0:n.quotes)==null?void 0:s.next)-1,(a=n==null?void 0:n.quotes)==null?void 0:a.value,">"),!(n!=null&&n.quotes)||!Ic(e,t+1,n.quotes.value,">")&&((o=n==null?void 0:n.quotes)==null?void 0:o.next)!==-1&&Ic(e,((l=n==null?void 0:n.quotes)==null?void 0:l.next)-1,(u=n==null?void 0:n.quotes)==null?void 0:u.value,">")}function MF(n,e){return(e.match(new RegExp(n,"g"))||[]).length}var xl=new Set(["!doctype","abbr","address","area","article","aside","audio","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","doctype","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","param","picture","pre","progress","rb","rp","rt","rtc","ruby","samp","script","section","select","slot","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","ul","var","video","wbr","xml"]),Dp=new Set(["a","b","i","p","q","s","u"]),Rp=new Set([".",",",";","!","?"]),ZS=new Set([".",",","?",";",")","…",'"',"»"]),kF=new Set(["a","abbr","acronym","audio","b","bdi","bdo","big","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"]),e2={ignoreTags:[],ignoreTagsWithTheirContents:[],onlyStripTags:[],stripTogetherWithTheirContents:["script","style","xml"],skipHtmlDecoding:!1,trimOnlySpaces:!1,stripRecognisedHTMLOnly:!1,dumpLinkHrefsNearby:{enabled:!1,putOnNewLine:!1,wrapHeads:"",wrapTails:""},ignoreIndentations:!1,cb:null,reportProgressFunc:null,reportProgressFuncFrom:0,reportProgressFuncTo:100};function t2(n,e){var ve,pe,Te,Ce,Re,Be,Ue,Qe,Ze,qe,nt;let t=Date.now(),i=[],r=[],s=[],a=[],o={};function l(){o={attributes:[]}}l();let u=null,h=null,d=null,p=!1,g={},m={tagName:"",hrefValue:"",openingTagEnds:void 0},y="",b=!1,A=null,w=!0;function x(B,oe,Ae){if(Array.isArray(oe.stripTogetherWithTheirContents)&&(oe.stripTogetherWithTheirContents.includes(o.name)||oe.stripTogetherWithTheirContents.includes("*")))if(o.slashPresent&&Array.isArray(i)&&i.some(be=>be.name===o.name)){for(let be=i.length;be--;)if(i[be].name===o.name){a=a.filter(([Ie,Me])=>(Ie<i[be].lastOpeningBracketAt||Ie>=B+1)&&(Me<=i[be].lastOpeningBracketAt||Me>B+1));let me=B+1;o.lastClosingBracketAt&&(me=o.lastClosingBracketAt+1),a.push([i[be].lastOpeningBracketAt,me]),ZS.has(n[B])&&oe.cb?oe.cb({tag:o,deleteFrom:i[be].lastOpeningBracketAt,deleteTo:B+1,insert:null,rangesArr:Ae,proposedReturn:[i[be].lastOpeningBracketAt,B,null]}):oe.cb&&oe.cb({tag:o,deleteFrom:i[be].lastOpeningBracketAt,deleteTo:B,insert:"",rangesArr:Ae,proposedReturn:[i[be].lastOpeningBracketAt,B,""]}),i.splice(be,1);break}}else o.slashPresent||i.push(o);else Array.isArray(oe.ignoreTagsWithTheirContents)&&M(B,oe,o)&&(w=!1)}function N(B,oe,Ae,be,me,Ie){var P;if(Array.isArray($.current())&&typeof Ae=="number"&&$.current()[0][0]===0&&$.current()[0][1]>=Ae)return"";if(n.length===be&&Ie&&!((P=R==null?void 0:R.dumpLinkHrefsNearby)!=null&&P.enabled))return null;let Me="";if(Number.isInteger(Ae)&&Ae<me&&(Me+=B.slice(Ae,me)),Number.isInteger(be)&&be>Ie+1){let W=B.slice(Ie+1,be);be&&!bn(n,be-1)&&(W=W.trimEnd()),W.includes(`
`)&&L(be,B)?Me+=" ":Me+=W}let ue=!ZS.has(B[oe]),K=B[be-1]!==">"||!B[Ae].trim(),D=!['"',"("].includes(B[me-1]),S=![";",".",":","!"].includes(B[oe]);if((ue||K&&D&&S)&&(K||D)&&B[oe]!=="!"&&(!kF.has(o.name)||typeof Ae=="number"&&Ae<me||typeof be=="number"&&be>Ie+1)){let W=Me.match(/\n/g);return Array.isArray(W)&&W.length?W.length===1?`
`:W.length===2?`

`:`


`:" "}return""}function F(B,oe){var Ae,be;if((Ae=B.dumpLinkHrefsNearby)!=null&&Ae.enabled&&m.tagName&&m.tagName===o.name&&o.lastOpeningBracketAt&&(m.openingTagEnds&&o.lastOpeningBracketAt>m.openingTagEnds||!m.openingTagEnds)&&(b=!0),b){let me=(be=B.dumpLinkHrefsNearby)!=null&&be.putOnNewLine?`

`:"";y=`${me}${m.hrefValue}`,(typeof oe!="number"||bn(n,oe-1))&&(y+=me)}}function L(B,oe){return oe?oe[B]==="<"&&oe[B+1]!=="%":n[B]==="<"&&n[B+1]!=="%"}function C(B){return n[B]===">"&&n[B-1]!=="%"}function M(B,oe,Ae){if(oe.ignoreTagsWithTheirContents.includes("*"))return!0;let be=n.indexOf(`<${Ae.name}`,B),me=n.indexOf(`</${Ae.name}`,B);return!Ae.slashPresent&&me===-1||Ae.slashPresent&&!r.some(Ie=>Ie.name===Ae.name)||me>-1&&be>-1&&be<me?!1:oe.ignoreTagsWithTheirContents.includes(Ae.name)}if(typeof n!="string")throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_01] Input must be string! Currently it's: ${(typeof n).toLowerCase()}, equal to:
${JSON.stringify(n,null,4)}`);if(e)if(dp(e)){if(e.reportProgressFunc&&typeof e.reportProgressFunc!="function")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_03] The Optional Options Object's key reportProgressFunc, callback function, should be a function but it was given as type ${typeof e.reportProgressFunc}, equal to ${JSON.stringify(e.reportProgressFunc,null,4)}`);if(typeof e.dumpLinkHrefsNearby=="boolean"&&e.dumpLinkHrefsNearby!=null)throw new Error(`string-strip-html/stripHtml(): [THROW_ID_04] The Optional Options Object's key should be a plain object but it was given as type ${typeof e.dumpLinkHrefsNearby}, equal to ${JSON.stringify(e.dumpLinkHrefsNearby,null,4)}`)}else throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_02] Optional Options Object must be a plain object! Currently it's: ${(typeof e).toLowerCase()}, equal to:
${JSON.stringify(e,null,4)}`);function _(){b&&(m={tagName:"",hrefValue:"",openingTagEnds:void 0},b=!1)}let R={...e2,...e,dumpLinkHrefsNearby:Object.assign({},e2.dumpLinkHrefsNearby,e==null?void 0:e.dumpLinkHrefsNearby)};if(oP(R,"returnRangesOnly"))throw new TypeError("string-strip-html/stripHtml(): [THROW_ID_05] The Optional Options Object's key returnRangesOnly has been removed from the API since v.5 release.");if(R.reportProgressFunc){if(typeof R.reportProgressFuncFrom!="number")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_06] The Optional Options Object's key reportProgressFuncFrom, callback function's "from" range, should be a number but it was given as type ${typeof R.reportProgressFuncFrom}, equal to ${JSON.stringify(R.reportProgressFuncFrom,null,4)}`);if(typeof R.reportProgressFuncTo!="number")throw new Error(`string-strip-html/stripHtml(): [THROW_ID_07] The Optional Options Object's key reportProgressFuncTo, callback function's "to" range, should be a number but it was given as type ${typeof R.reportProgressFuncTo}, equal to ${JSON.stringify(R.reportProgressFuncTo,null,4)}`)}R.ignoreTags=JS(R.ignoreTags,"resolvedOpts.ignoreTags"),R.onlyStripTags=JS(R.onlyStripTags,"resolvedOpts.onlyStripTags");let U=!!R.onlyStripTags.length;R.onlyStripTags.length&&R.ignoreTags.length&&(R.onlyStripTags=fF(R.onlyStripTags,...R.ignoreTags)),R.stripTogetherWithTheirContents?typeof R.stripTogetherWithTheirContents=="string"&&R.stripTogetherWithTheirContents.length&&(R.stripTogetherWithTheirContents=[R.stripTogetherWithTheirContents]):R.stripTogetherWithTheirContents=[];let q={};if(R.stripTogetherWithTheirContents&&Array.isArray(R.stripTogetherWithTheirContents)&&R.stripTogetherWithTheirContents.length&&!R.stripTogetherWithTheirContents.every((B,oe)=>typeof B!="string"?(q.el=B,q.i=oe,!1):!0))throw new TypeError(`string-strip-html/stripHtml(): [THROW_ID_08] Optional Options Object's key stripTogetherWithTheirContents was set to contain not just string elements! For example, element at index ${q.i} has a value ${q.el} which is not string but ${(typeof q.el).toLowerCase()}.`);R.cb||(R.cb=({rangesArr:B,proposedReturn:oe})=>{oe&&B.push(...oe)});let $=new NF({limitToBeAddedWhitespace:!0,limitLinebreaksCount:2});if(!R.skipHtmlDecoding)for(;n!==zS(n,{scope:"strict"});)n=zS(n,{scope:"strict"});let Y=!1,ae=!1,ne=0,ce=0,re=n.length,V=Math.floor(re/2);for(let B=0;B<re;B++){if(R.reportProgressFunc&&(re>1e3&&re<2e3?B===V&&R.reportProgressFunc(Math.floor((R.reportProgressFuncTo-R.reportProgressFuncFrom)/2)):re>=2e3&&(ne=R.reportProgressFuncFrom+Math.floor(B/re*(R.reportProgressFuncTo-R.reportProgressFuncFrom)),ne!==ce&&(ce=ne,R.reportProgressFunc(ne)))),Object.keys(o).length>1&&o.lastClosingBracketAt&&o.lastClosingBracketAt<B&&n[B]!==" "&&A===null&&(A=B),!Y&&n[B]==="%"&&n[B-1]==="{"&&n.includes("%}",B+1)){d=null;let oe=n.indexOf("%}",B)-1;if(oe>B){B=oe;continue}}if(!Y&&C(B)&&(!o||Object.keys(o).length<2)&&B>1){for(let oe=B;oe--;)if(n[oe-1]===void 0||C(oe)){let Ae=n[oe-1]===void 0?oe:oe+1,be=n.slice(Ae,B+1)||"";if((be.includes("/>")||be.includes("/ >")||be.includes('="')||be.includes("='"))&&n!==`<${KS(be.trim(),"/>")}>`&&[...xl].some(me=>KS(be.trim().split(/\s+/).filter(Ie=>Ie.trim()).filter((Ie,Me)=>Me===0),"/>").toLowerCase()===me)&&t2(`<${be.trim()}>`,R).result===""){(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([Ae,B+1]),(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([Ae,B+1]);let me=N(n,B,Ae,B+1,Ae,B+1),Ie=B+1;if(n[Ie]&&!n[Ie].trim()){for(let Me=Ie;Me<re;Me++)if(n[Me].trim()){Ie=Me;break}}R.cb({tag:o,deleteFrom:Ae,deleteTo:Ie,insert:me,rangesArr:$,proposedReturn:[Ae,Ie,me]})}break}}if(!ae&&n[B]==="/"&&!((ve=o.quotes)!=null&&ve.value)&&Number.isInteger(o.lastOpeningBracketAt)&&!Number.isInteger(o.lastClosingBracketAt)&&(o.slashPresent=B),n[B]==='"'||n[B]==="'")if(!ae&&o.nameStarts&&((pe=o==null?void 0:o.quotes)==null?void 0:pe.value)===n[B])if(g.valueStarts===void 0)g={},delete o.quotes;else{g.valueEnds=B,g.value=n.slice(g.valueStarts,B),o.attributes.push(g),g={},delete o.quotes;let oe;(Te=R.dumpLinkHrefsNearby)!=null&&Te.enabled&&!i.length&&o.attributes.some(Ae=>{var be,me;if(typeof Ae.name=="string"&&Ae.name.toLowerCase()==="href")return oe=`${((be=R.dumpLinkHrefsNearby)==null?void 0:be.wrapHeads)||""}${Ae.value}${((me=R.dumpLinkHrefsNearby)==null?void 0:me.wrapTails)||""}`,!0})&&(m={tagName:o.name,hrefValue:oe,openingTagEnds:void 0})}else!ae&&!o.quotes&&o.nameStarts&&(o.quotes={},o.quotes.value=n[B],o.quotes.start=B,o.quotes.next=n.indexOf(n[B],B+1),g.nameStarts&&g.nameEnds&&g.nameEnds<B&&g.nameStarts<B&&!g.valueStarts&&(g.name=n.slice(g.nameStarts,g.nameEnds)));if(o.nameStarts!==void 0&&o.nameEnds===void 0&&(!n[B].trim()||!_F(n[B]))){if(o.nameEnds=B,o.name=n.slice(o.nameStarts,o.nameEnds+(!C(B)&&n[B]!=="/"&&n[B+1]===void 0?1:0)),n[o.nameStarts-1]!=="!"&&!o.name.replace(/-/g,"").length||/^\d+$/.test(o.name[0])){o={};continue}if(typeof o.name=="string"&&o.name.toLowerCase()==="doctype"&&(ae=!0),L(B)){F(R);let oe=N(n,B,o.leftOuterWhitespace,B,o.lastOpeningBracketAt,B);(R.stripTogetherWithTheirContents.includes(o.name)||R.stripTogetherWithTheirContents.includes("*"))&&(a=a.filter(([Ae,be])=>!(Ae===o.leftOuterWhitespace&&be===B))),R.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B,insert:`${oe}${y}${oe}`,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B,`${oe}${y}${oe}`]}),_(),x(B,R,$)}}if((Ce=o.quotes)!=null&&Ce.start&&o.quotes.start<B&&!o.quotes.end&&g.nameEnds&&g.equalsAt&&!g.valueStarts&&(g.valueStarts=B),!o.quotes&&g.nameEnds&&n[B]==="="&&!g.valueStarts&&!g.equalsAt&&(g.equalsAt=B),!o.quotes&&g.nameStarts&&g.nameEnds&&!g.valueStarts&&n[B].trim()&&n[B]!=="="&&(o.attributes.push(g),g={}),!o.quotes&&g.nameStarts&&!g.nameEnds&&(ae&&`'"`.includes(n[g.nameStarts])?g.nameStarts<B&&n[B]===n[g.nameStarts]&&(g.nameEnds=B+1,g.name=n.slice(g.nameStarts,g.nameEnds)):n[B].trim()?n[B]==="="?g.equalsAt||(g.nameEnds=B,g.equalsAt=B,g.name=n.slice(g.nameStarts,g.nameEnds)):n[B]==="/"||C(B)?(g.nameEnds=B,g.name=n.slice(g.nameStarts,g.nameEnds),o.attributes.push(g),g={}):L(B)&&(g.nameEnds=B,g.name=n.slice(g.nameStarts,g.nameEnds),o.attributes.push(g),g={}):(g.nameEnds=B,g.name=n.slice(g.nameStarts,g.nameEnds))),!o.quotes&&o.nameEnds<B&&!n[B-1].trim()&&n[B].trim()&&!"<>/!".includes(n[B])&&!g.nameStarts&&!o.lastClosingBracketAt&&(g.nameStarts=B),o.lastOpeningBracketAt!==null&&o.lastOpeningBracketAt<B&&n[B]==="/"&&o.onlyPlausible&&(o.onlyPlausible=!1),o.lastOpeningBracketAt!==null&&o.lastOpeningBracketAt<B&&n[B]!=="/"&&(o.onlyPlausible===void 0&&((!n[B].trim()||L(B))&&!o.slashPresent?o.onlyPlausible=!0:o.onlyPlausible=!1),n[B].trim()&&o.nameStarts===void 0&&!L(B)&&n[B]!=="/"&&!C(B)&&n[B]!=="!"&&(o.nameStarts=B,o.nameContainsLetters=!1)),o.nameStarts&&!o.quotes&&typeof n[B]=="string"&&n[B].toLowerCase()!==n[B].toUpperCase()&&(o.nameContainsLetters=!0),C(B)&&(QS(o,n,B)||o.quotes.value&&typeof o.lastOpeningBracketAt=="number"&&MF(o.quotes.value,n.slice(o.lastOpeningBracketAt,B))%2===1&&!n.slice(o.lastOpeningBracketAt+1,B).includes("<")&&!n.slice(o.lastOpeningBracketAt+1,B).includes(">"))&&o.lastOpeningBracketAt!==void 0&&(o.lastClosingBracketAt=B,A=null,Object.keys(g).length&&(o.attributes.push(g),g={}),(Re=R.dumpLinkHrefsNearby)!=null&&Re.enabled&&m.tagName&&!m.openingTagEnds&&(m.openingTagEnds=B)),(!ae||n[B]===">")&&o.lastOpeningBracketAt!==void 0){if(o.lastClosingBracketAt===void 0){if(o.lastOpeningBracketAt<B&&!L(B)&&(n[B+1]===void 0||L(B+1)&&!((Be=o==null?void 0:o.quotes)!=null&&Be.value))&&o.nameContainsLetters&&typeof o.nameStarts=="number"){if(o.name=n.slice(o.nameStarts,o.nameEnds||B+1).toLowerCase(),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,B+1]),R.ignoreTags.includes(o.name)||M(B,R,o)||!xl.has(o.name)&&(o.onlyPlausible||R.stripRecognisedHTMLOnly)){o={},g={};continue}if((xl.has(o.name)||Dp.has(o.name))&&(o.onlyPlausible===!1||o.onlyPlausible===!0&&o.attributes.length)||n[B+1]===void 0){F(R);let oe=N(n,B,o.leftOuterWhitespace,B+1,o.lastOpeningBracketAt,o.lastClosingBracketAt);Y&&o.name==="script"&&o.slashPresent&&(Y=!1);let Ae;oe===null||y===null?Ae=null:Ae=`${oe}${y}${oe}`,R.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B+1,insert:Ae,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B+1,Ae]}),_(),x(B,R,$)}if(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt&&a[a.length-1][1]!==B+1)if(R.stripTogetherWithTheirContents.includes(o.name)||R.stripTogetherWithTheirContents.includes("*")){let oe;for(let Ae=i.length;Ae--;)i[Ae].name===o.name&&(oe=i[Ae]);oe?(a=a.filter(([Ae])=>Ae!==oe.lastOpeningBracketAt),a.push([oe.lastOpeningBracketAt,B+1])):a.push([o.lastOpeningBracketAt,B+1])}else a.push([o.lastOpeningBracketAt,B+1])}}else if(B>o.lastClosingBracketAt&&n[B].trim()||n[B+1]===void 0||R.ignoreIndentations&&`\r
`.includes(n[B])){let oe=o.lastClosingBracketAt===B?B+1:B;R.trimOnlySpaces&&oe===re-1&&A!==null&&A<B&&(oe=A),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,o.lastClosingBracketAt+1]);let Ae=R.ignoreTags.includes(o.name),be=M(B,R,o);if(!w||R.stripRecognisedHTMLOnly&&typeof o.name=="string"&&!xl.has(o.name.toLowerCase())&&!Dp.has(o.name.toLowerCase())||!U&&(Ae||be)||U&&!R.onlyStripTags.includes(o.name)||R.ignoreTagsWithTheirContents.includes(o.name)){if(be)if(o.slashPresent){for(let me=r.length;me--;)if(r[me].name===o.name){r.splice(me,1);break}r.length||(w=!0)}else w&&(w=!1),r.push(o);R.cb({tag:o,deleteFrom:null,deleteTo:null,insert:null,rangesArr:$,proposedReturn:null}),o={},g={}}else if(!o.onlyPlausible||o.attributes.length===0&&o.name&&(xl.has(o.name.toLowerCase())||Dp.has(o.name.toLowerCase()))||(Ue=o.attributes)!=null&&Ue.some(me=>me.equalsAt)){(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([o.lastOpeningBracketAt,o.lastClosingBracketAt+1]);let me=N(n,B,o.leftOuterWhitespace,oe,o.lastOpeningBracketAt,o.lastClosingBracketAt);y="",b=!1,F(R,oe);let Ie;typeof y=="string"&&y.length?(Ie=`${me}${y}${me===`

`?`
`:me}`,oe===o.lastClosingBracketAt+1&&(!n[oe]||!Rp.has(n[oe]))&&(Ie+=" "),o.leftOuterWhitespace===o.lastOpeningBracketAt&&$.last()&&$.last()[1]<o.lastOpeningBracketAt&&(!((Qe=R==null?void 0:R.dumpLinkHrefsNearby)!=null&&Qe.putOnNewLine)||!Rp.has(n[oe]))&&(Ie=" "+Ie)):Ie=me,Ie!==null&&(o.leftOuterWhitespace===0||!bn(n,oe-1))&&(!((Ze=R.dumpLinkHrefsNearby)!=null&&Ze.enabled)||o.name!=="a")&&(Ie=void 0);let Me=0;if(b&&Rp.has(n[oe])){(qe=R.dumpLinkHrefsNearby)!=null&&qe.putOnNewLine&&(Ie=`${n[oe]}${Ie||""}`);let ue=bn(n,oe);ue&&(Ie!=null&&Ie.endsWith(`
`))?Me+=ue-B:(!ue||ue>B)&&Me++}R.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:oe+Me,insert:Ie,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,oe+Me,Ie]}),_(),x(B,R,$)}else o={};C(B)||(o={})}ae&&(ae=!1)}if((!Y||n[B]==="<"&&bn(n,bn(n,B))&&n[bn(n,B)]==="/"&&n.startsWith("script",bn(n,bn(n,B))))&&L(B)&&!L(B-1)&&!`'"`.includes(n[B+1])&&(!`'"`.includes(n[B+2])||/\w/.test(n[B+1]))&&!(n[B+1]==="c"&&n[B+2]===":")&&!(n[B+1]==="f"&&n[B+2]==="m"&&n[B+3]==="t"&&n[B+4]===":")&&!(n[B+1]==="s"&&n[B+2]==="q"&&n[B+3]==="l"&&n[B+4]===":")&&!(n[B+1]==="x"&&n[B+2]===":")&&!(n[B+1]==="f"&&n[B+2]==="n"&&n[B+3]===":")&&QS(o,n,B)){if(C(bn(n,B)))continue;if(o.nameEnds&&o.nameEnds<B&&!o.lastClosingBracketAt&&(o.onlyPlausible===!0&&((nt=o.attributes)!=null&&nt.length)||o.onlyPlausible===!1)){let oe=N(n,B,o.leftOuterWhitespace,B,o.lastOpeningBracketAt,B);R.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:B,insert:oe,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,B,oe]}),x(B,R,$),o={},g={}}if(o.lastOpeningBracketAt!==void 0&&o.onlyPlausible&&o.name&&!o.quotes&&(o.lastOpeningBracketAt=void 0,o.name=void 0,o.onlyPlausible=!1),(o.lastOpeningBracketAt===void 0||!o.onlyPlausible)&&!o.quotes&&(o.lastOpeningBracketAt=B,o.slashPresent=!1,o.attributes=[],u===null?o.leftOuterWhitespace=B:R.trimOnlySpaces&&u===0?o.leftOuterWhitespace=h||B:o.leftOuterWhitespace=u,`${n[B+1]}${n[B+2]}${n[B+3]}`=="!--"||`${n[B+1]}${n[B+2]}${n[B+3]}${n[B+4]}${n[B+5]}${n[B+6]}${n[B+7]}${n[B+8]}`=="![CDATA[")){let oe=!0;n[B+2]==="-"&&(oe=!1);let Ae;for(let be=B;be<re;be++)if((!Ae&&oe&&`${n[be-2]}${n[be-1]}${n[be]}`=="]]>"||!oe&&`${n[be-2]}${n[be-1]}${n[be]}`=="-->")&&(Ae=be),Ae&&(Ae<be&&n[be].trim()||n[be+1]===void 0)){let me=be;(n[be+1]===void 0&&!n[be].trim()||n[be]===">")&&(me+=1),(!s.length||s[s.length-1][0]!==o.lastOpeningBracketAt)&&s.push([o.lastOpeningBracketAt,Ae+1]),(!a.length||a[a.length-1][0]!==o.lastOpeningBracketAt)&&a.push([o.lastOpeningBracketAt,Ae+1]);let Ie=N(n,be,o.leftOuterWhitespace,me,o.lastOpeningBracketAt,Ae);R.cb({tag:o,deleteFrom:o.leftOuterWhitespace,deleteTo:me,insert:Ie,rangesArr:$,proposedReturn:[o.leftOuterWhitespace,me,Ie]}),B=be-1,n[be]===">"&&(B=be),o={},g={};break}}}!n[B].trim()||n[B].charCodeAt(0)===847?(u===null&&(u=B,o.lastOpeningBracketAt!==void 0&&o.lastOpeningBracketAt<B&&o.nameStarts&&o.nameStarts<o.lastOpeningBracketAt&&B===o.lastOpeningBracketAt+1&&!i.some(oe=>oe.name===o.name)&&(o.onlyPlausible=!0,o.name=void 0,o.nameStarts=void 0)),(n[B]===`
`||n[B]==="\r")&&(d=B,p&&(p=!1))):(u!==null&&(!o.quotes&&g.equalsAt>u-1&&g.nameEnds&&g.equalsAt>g.nameEnds&&n[B]!=='"'&&n[B]!=="'"&&(dp(g)&&o.attributes.push(g),g={},o.equalsSpottedAt=void 0),u=null),p||(p=!0,w&&!Y&&typeof d=="number"&&B&&d<B-1&&(n.slice(d+1,B).trim()?d=null:R.ignoreIndentations||$.push([d+1,B])))),n[B]===" "?h===null&&(h=B):h!==null&&(h=null),o.name==="script"&&(Y=!o.slashPresent)}if(n&&!R.ignoreIndentations&&(R.trimOnlySpaces&&n[0]===" "||!R.trimOnlySpaces&&!n[0].trim()))for(let B=0;B<re;B++)if(R.trimOnlySpaces&&n[B]!==" "||!R.trimOnlySpaces&&n[B].trim()){$.push([0,B]);break}else n[B+1]||$.push([0,B+1]);if(n&&(R.trimOnlySpaces&&n[~-n.length]===" "||!R.trimOnlySpaces&&!n[~-n.length].trim())){for(let B=n.length;B--;)if(R.trimOnlySpaces&&n[B]!==" "||!R.trimOnlySpaces&&n[B].trim()){$.push([B+1,re]);break}}let J=$.current();if(!(e!=null&&e.cb)&&J&&(J[0]&&!J[0][0]&&(J[0][1],$.ranges[0]=[$.ranges[0][0],$.ranges[0][1]]),J[J.length-1]&&J[J.length-1][1]===n.length&&(J[J.length-1][0],$.ranges))){let B=$.ranges[$.ranges.length-1][0];n[B-1]&&(R.trimOnlySpaces&&n[B-1]===" "||!R.trimOnlySpaces&&!n[B-1].trim())&&(B-=1);let oe=$.ranges[$.ranges.length-1][2];$.ranges[$.ranges.length-1]=[B,$.ranges[$.ranges.length-1][1]],oe!=null&&oe.trim()&&$.ranges[$.ranges.length-1].push(oe.trimEnd())}return{log:{timeTakenInMilliseconds:Date.now()-t},result:RF(n,$.current()),ranges:$.current(),allTagLocations:s,filteredTagLocations:a}}var Tl={exports:{}};/*! https://mths.be/he v1.2.0 by @mathias | MIT license */var PF=Tl.exports,i2;function OF(){return i2||(i2=1,function(n,e){(function(t){var i=e,r=n&&n.exports==i&&n,s=typeof Or=="object"&&Or;(s.global===s||s.window===s)&&(t=s);var a=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,o=/[\x01-\x7F]/g,l=/[\x01-\t\x0B\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,u=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,h={"­":"shy","‌":"zwnj","‍":"zwj","‎":"lrm","⁣":"ic","⁢":"it","⁡":"af","‏":"rlm","​":"ZeroWidthSpace","⁠":"NoBreak","̑":"DownBreve","⃛":"tdot","⃜":"DotDot","	":"Tab","\n":"NewLine"," ":"puncsp"," ":"MediumSpace"," ":"thinsp"," ":"hairsp"," ":"emsp13"," ":"ensp"," ":"emsp14"," ":"emsp"," ":"numsp"," ":"nbsp","  ":"ThickSpace","‾":"oline",_:"lowbar","‐":"dash","–":"ndash","—":"mdash","―":"horbar",",":"comma",";":"semi","⁏":"bsemi",":":"colon","⩴":"Colone","!":"excl","¡":"iexcl","?":"quest","¿":"iquest",".":"period","‥":"nldr","…":"mldr","·":"middot","'":"apos","‘":"lsquo","’":"rsquo","‚":"sbquo","‹":"lsaquo","›":"rsaquo",'"':"quot","“":"ldquo","”":"rdquo","„":"bdquo","«":"laquo","»":"raquo","(":"lpar",")":"rpar","[":"lsqb","]":"rsqb","{":"lcub","}":"rcub","⌈":"lceil","⌉":"rceil","⌊":"lfloor","⌋":"rfloor","⦅":"lopar","⦆":"ropar","⦋":"lbrke","⦌":"rbrke","⦍":"lbrkslu","⦎":"rbrksld","⦏":"lbrksld","⦐":"rbrkslu","⦑":"langd","⦒":"rangd","⦓":"lparlt","⦔":"rpargt","⦕":"gtlPar","⦖":"ltrPar","⟦":"lobrk","⟧":"robrk","⟨":"lang","⟩":"rang","⟪":"Lang","⟫":"Rang","⟬":"loang","⟭":"roang","❲":"lbbrk","❳":"rbbrk","‖":"Vert","§":"sect","¶":"para","@":"commat","*":"ast","/":"sol",undefined:null,"&":"amp","#":"num","%":"percnt","‰":"permil","‱":"pertenk","†":"dagger","‡":"Dagger","•":"bull","⁃":"hybull","′":"prime","″":"Prime","‴":"tprime","⁗":"qprime","‵":"bprime","⁁":"caret","`":"grave","´":"acute","˜":"tilde","^":"Hat","¯":"macr","˘":"breve","˙":"dot","¨":"die","˚":"ring","˝":"dblac","¸":"cedil","˛":"ogon","ˆ":"circ","ˇ":"caron","°":"deg","©":"copy","®":"reg","℗":"copysr","℘":"wp","℞":"rx","℧":"mho","℩":"iiota","←":"larr","↚":"nlarr","→":"rarr","↛":"nrarr","↑":"uarr","↓":"darr","↔":"harr","↮":"nharr","↕":"varr","↖":"nwarr","↗":"nearr","↘":"searr","↙":"swarr","↝":"rarrw","↝̸":"nrarrw","↞":"Larr","↟":"Uarr","↠":"Rarr","↡":"Darr","↢":"larrtl","↣":"rarrtl","↤":"mapstoleft","↥":"mapstoup","↦":"map","↧":"mapstodown","↩":"larrhk","↪":"rarrhk","↫":"larrlp","↬":"rarrlp","↭":"harrw","↰":"lsh","↱":"rsh","↲":"ldsh","↳":"rdsh","↵":"crarr","↶":"cularr","↷":"curarr","↺":"olarr","↻":"orarr","↼":"lharu","↽":"lhard","↾":"uharr","↿":"uharl","⇀":"rharu","⇁":"rhard","⇂":"dharr","⇃":"dharl","⇄":"rlarr","⇅":"udarr","⇆":"lrarr","⇇":"llarr","⇈":"uuarr","⇉":"rrarr","⇊":"ddarr","⇋":"lrhar","⇌":"rlhar","⇐":"lArr","⇍":"nlArr","⇑":"uArr","⇒":"rArr","⇏":"nrArr","⇓":"dArr","⇔":"iff","⇎":"nhArr","⇕":"vArr","⇖":"nwArr","⇗":"neArr","⇘":"seArr","⇙":"swArr","⇚":"lAarr","⇛":"rAarr","⇝":"zigrarr","⇤":"larrb","⇥":"rarrb","⇵":"duarr","⇽":"loarr","⇾":"roarr","⇿":"hoarr","∀":"forall","∁":"comp","∂":"part","∂̸":"npart","∃":"exist","∄":"nexist","∅":"empty","∇":"Del","∈":"in","∉":"notin","∋":"ni","∌":"notni","϶":"bepsi","∏":"prod","∐":"coprod","∑":"sum","+":"plus","±":"pm","÷":"div","×":"times","<":"lt","≮":"nlt","<⃒":"nvlt","=":"equals","≠":"ne","=⃥":"bne","⩵":"Equal",">":"gt","≯":"ngt",">⃒":"nvgt","¬":"not","|":"vert","¦":"brvbar","−":"minus","∓":"mp","∔":"plusdo","⁄":"frasl","∖":"setmn","∗":"lowast","∘":"compfn","√":"Sqrt","∝":"prop","∞":"infin","∟":"angrt","∠":"ang","∠⃒":"nang","∡":"angmsd","∢":"angsph","∣":"mid","∤":"nmid","∥":"par","∦":"npar","∧":"and","∨":"or","∩":"cap","∩︀":"caps","∪":"cup","∪︀":"cups","∫":"int","∬":"Int","∭":"tint","⨌":"qint","∮":"oint","∯":"Conint","∰":"Cconint","∱":"cwint","∲":"cwconint","∳":"awconint","∴":"there4","∵":"becaus","∶":"ratio","∷":"Colon","∸":"minusd","∺":"mDDot","∻":"homtht","∼":"sim","≁":"nsim","∼⃒":"nvsim","∽":"bsim","∽̱":"race","∾":"ac","∾̳":"acE","∿":"acd","≀":"wr","≂":"esim","≂̸":"nesim","≃":"sime","≄":"nsime","≅":"cong","≇":"ncong","≆":"simne","≈":"ap","≉":"nap","≊":"ape","≋":"apid","≋̸":"napid","≌":"bcong","≍":"CupCap","≭":"NotCupCap","≍⃒":"nvap","≎":"bump","≎̸":"nbump","≏":"bumpe","≏̸":"nbumpe","≐":"doteq","≐̸":"nedot","≑":"eDot","≒":"efDot","≓":"erDot","≔":"colone","≕":"ecolon","≖":"ecir","≗":"cire","≙":"wedgeq","≚":"veeeq","≜":"trie","≟":"equest","≡":"equiv","≢":"nequiv","≡⃥":"bnequiv","≤":"le","≰":"nle","≤⃒":"nvle","≥":"ge","≱":"nge","≥⃒":"nvge","≦":"lE","≦̸":"nlE","≧":"gE","≧̸":"ngE","≨︀":"lvnE","≨":"lnE","≩":"gnE","≩︀":"gvnE","≪":"ll","≪̸":"nLtv","≪⃒":"nLt","≫":"gg","≫̸":"nGtv","≫⃒":"nGt","≬":"twixt","≲":"lsim","≴":"nlsim","≳":"gsim","≵":"ngsim","≶":"lg","≸":"ntlg","≷":"gl","≹":"ntgl","≺":"pr","⊀":"npr","≻":"sc","⊁":"nsc","≼":"prcue","⋠":"nprcue","≽":"sccue","⋡":"nsccue","≾":"prsim","≿":"scsim","≿̸":"NotSucceedsTilde","⊂":"sub","⊄":"nsub","⊂⃒":"vnsub","⊃":"sup","⊅":"nsup","⊃⃒":"vnsup","⊆":"sube","⊈":"nsube","⊇":"supe","⊉":"nsupe","⊊︀":"vsubne","⊊":"subne","⊋︀":"vsupne","⊋":"supne","⊍":"cupdot","⊎":"uplus","⊏":"sqsub","⊏̸":"NotSquareSubset","⊐":"sqsup","⊐̸":"NotSquareSuperset","⊑":"sqsube","⋢":"nsqsube","⊒":"sqsupe","⋣":"nsqsupe","⊓":"sqcap","⊓︀":"sqcaps","⊔":"sqcup","⊔︀":"sqcups","⊕":"oplus","⊖":"ominus","⊗":"otimes","⊘":"osol","⊙":"odot","⊚":"ocir","⊛":"oast","⊝":"odash","⊞":"plusb","⊟":"minusb","⊠":"timesb","⊡":"sdotb","⊢":"vdash","⊬":"nvdash","⊣":"dashv","⊤":"top","⊥":"bot","⊧":"models","⊨":"vDash","⊭":"nvDash","⊩":"Vdash","⊮":"nVdash","⊪":"Vvdash","⊫":"VDash","⊯":"nVDash","⊰":"prurel","⊲":"vltri","⋪":"nltri","⊳":"vrtri","⋫":"nrtri","⊴":"ltrie","⋬":"nltrie","⊴⃒":"nvltrie","⊵":"rtrie","⋭":"nrtrie","⊵⃒":"nvrtrie","⊶":"origof","⊷":"imof","⊸":"mumap","⊹":"hercon","⊺":"intcal","⊻":"veebar","⊽":"barvee","⊾":"angrtvb","⊿":"lrtri","⋀":"Wedge","⋁":"Vee","⋂":"xcap","⋃":"xcup","⋄":"diam","⋅":"sdot","⋆":"Star","⋇":"divonx","⋈":"bowtie","⋉":"ltimes","⋊":"rtimes","⋋":"lthree","⋌":"rthree","⋍":"bsime","⋎":"cuvee","⋏":"cuwed","⋐":"Sub","⋑":"Sup","⋒":"Cap","⋓":"Cup","⋔":"fork","⋕":"epar","⋖":"ltdot","⋗":"gtdot","⋘":"Ll","⋘̸":"nLl","⋙":"Gg","⋙̸":"nGg","⋚︀":"lesg","⋚":"leg","⋛":"gel","⋛︀":"gesl","⋞":"cuepr","⋟":"cuesc","⋦":"lnsim","⋧":"gnsim","⋨":"prnsim","⋩":"scnsim","⋮":"vellip","⋯":"ctdot","⋰":"utdot","⋱":"dtdot","⋲":"disin","⋳":"isinsv","⋴":"isins","⋵":"isindot","⋵̸":"notindot","⋶":"notinvc","⋷":"notinvb","⋹":"isinE","⋹̸":"notinE","⋺":"nisd","⋻":"xnis","⋼":"nis","⋽":"notnivc","⋾":"notnivb","⌅":"barwed","⌆":"Barwed","⌌":"drcrop","⌍":"dlcrop","⌎":"urcrop","⌏":"ulcrop","⌐":"bnot","⌒":"profline","⌓":"profsurf","⌕":"telrec","⌖":"target","⌜":"ulcorn","⌝":"urcorn","⌞":"dlcorn","⌟":"drcorn","⌢":"frown","⌣":"smile","⌭":"cylcty","⌮":"profalar","⌶":"topbot","⌽":"ovbar","⌿":"solbar","⍼":"angzarr","⎰":"lmoust","⎱":"rmoust","⎴":"tbrk","⎵":"bbrk","⎶":"bbrktbrk","⏜":"OverParenthesis","⏝":"UnderParenthesis","⏞":"OverBrace","⏟":"UnderBrace","⏢":"trpezium","⏧":"elinters","␣":"blank","─":"boxh","│":"boxv","┌":"boxdr","┐":"boxdl","└":"boxur","┘":"boxul","├":"boxvr","┤":"boxvl","┬":"boxhd","┴":"boxhu","┼":"boxvh","═":"boxH","║":"boxV","╒":"boxdR","╓":"boxDr","╔":"boxDR","╕":"boxdL","╖":"boxDl","╗":"boxDL","╘":"boxuR","╙":"boxUr","╚":"boxUR","╛":"boxuL","╜":"boxUl","╝":"boxUL","╞":"boxvR","╟":"boxVr","╠":"boxVR","╡":"boxvL","╢":"boxVl","╣":"boxVL","╤":"boxHd","╥":"boxhD","╦":"boxHD","╧":"boxHu","╨":"boxhU","╩":"boxHU","╪":"boxvH","╫":"boxVh","╬":"boxVH","▀":"uhblk","▄":"lhblk","█":"block","░":"blk14","▒":"blk12","▓":"blk34","□":"squ","▪":"squf","▫":"EmptyVerySmallSquare","▭":"rect","▮":"marker","▱":"fltns","△":"xutri","▴":"utrif","▵":"utri","▸":"rtrif","▹":"rtri","▽":"xdtri","▾":"dtrif","▿":"dtri","◂":"ltrif","◃":"ltri","◊":"loz","○":"cir","◬":"tridot","◯":"xcirc","◸":"ultri","◹":"urtri","◺":"lltri","◻":"EmptySmallSquare","◼":"FilledSmallSquare","★":"starf","☆":"star","☎":"phone","♀":"female","♂":"male","♠":"spades","♣":"clubs","♥":"hearts","♦":"diams","♪":"sung","✓":"check","✗":"cross","✠":"malt","✶":"sext","❘":"VerticalSeparator","⟈":"bsolhsub","⟉":"suphsol","⟵":"xlarr","⟶":"xrarr","⟷":"xharr","⟸":"xlArr","⟹":"xrArr","⟺":"xhArr","⟼":"xmap","⟿":"dzigrarr","⤂":"nvlArr","⤃":"nvrArr","⤄":"nvHarr","⤅":"Map","⤌":"lbarr","⤍":"rbarr","⤎":"lBarr","⤏":"rBarr","⤐":"RBarr","⤑":"DDotrahd","⤒":"UpArrowBar","⤓":"DownArrowBar","⤖":"Rarrtl","⤙":"latail","⤚":"ratail","⤛":"lAtail","⤜":"rAtail","⤝":"larrfs","⤞":"rarrfs","⤟":"larrbfs","⤠":"rarrbfs","⤣":"nwarhk","⤤":"nearhk","⤥":"searhk","⤦":"swarhk","⤧":"nwnear","⤨":"toea","⤩":"tosa","⤪":"swnwar","⤳":"rarrc","⤳̸":"nrarrc","⤵":"cudarrr","⤶":"ldca","⤷":"rdca","⤸":"cudarrl","⤹":"larrpl","⤼":"curarrm","⤽":"cularrp","⥅":"rarrpl","⥈":"harrcir","⥉":"Uarrocir","⥊":"lurdshar","⥋":"ldrushar","⥎":"LeftRightVector","⥏":"RightUpDownVector","⥐":"DownLeftRightVector","⥑":"LeftUpDownVector","⥒":"LeftVectorBar","⥓":"RightVectorBar","⥔":"RightUpVectorBar","⥕":"RightDownVectorBar","⥖":"DownLeftVectorBar","⥗":"DownRightVectorBar","⥘":"LeftUpVectorBar","⥙":"LeftDownVectorBar","⥚":"LeftTeeVector","⥛":"RightTeeVector","⥜":"RightUpTeeVector","⥝":"RightDownTeeVector","⥞":"DownLeftTeeVector","⥟":"DownRightTeeVector","⥠":"LeftUpTeeVector","⥡":"LeftDownTeeVector","⥢":"lHar","⥣":"uHar","⥤":"rHar","⥥":"dHar","⥦":"luruhar","⥧":"ldrdhar","⥨":"ruluhar","⥩":"rdldhar","⥪":"lharul","⥫":"llhard","⥬":"rharul","⥭":"lrhard","⥮":"udhar","⥯":"duhar","⥰":"RoundImplies","⥱":"erarr","⥲":"simrarr","⥳":"larrsim","⥴":"rarrsim","⥵":"rarrap","⥶":"ltlarr","⥸":"gtrarr","⥹":"subrarr","⥻":"suplarr","⥼":"lfisht","⥽":"rfisht","⥾":"ufisht","⥿":"dfisht","⦚":"vzigzag","⦜":"vangrt","⦝":"angrtvbd","⦤":"ange","⦥":"range","⦦":"dwangle","⦧":"uwangle","⦨":"angmsdaa","⦩":"angmsdab","⦪":"angmsdac","⦫":"angmsdad","⦬":"angmsdae","⦭":"angmsdaf","⦮":"angmsdag","⦯":"angmsdah","⦰":"bemptyv","⦱":"demptyv","⦲":"cemptyv","⦳":"raemptyv","⦴":"laemptyv","⦵":"ohbar","⦶":"omid","⦷":"opar","⦹":"operp","⦻":"olcross","⦼":"odsold","⦾":"olcir","⦿":"ofcir","⧀":"olt","⧁":"ogt","⧂":"cirscir","⧃":"cirE","⧄":"solb","⧅":"bsolb","⧉":"boxbox","⧍":"trisb","⧎":"rtriltri","⧏":"LeftTriangleBar","⧏̸":"NotLeftTriangleBar","⧐":"RightTriangleBar","⧐̸":"NotRightTriangleBar","⧜":"iinfin","⧝":"infintie","⧞":"nvinfin","⧣":"eparsl","⧤":"smeparsl","⧥":"eqvparsl","⧫":"lozf","⧴":"RuleDelayed","⧶":"dsol","⨀":"xodot","⨁":"xoplus","⨂":"xotime","⨄":"xuplus","⨆":"xsqcup","⨍":"fpartint","⨐":"cirfnint","⨑":"awint","⨒":"rppolint","⨓":"scpolint","⨔":"npolint","⨕":"pointint","⨖":"quatint","⨗":"intlarhk","⨢":"pluscir","⨣":"plusacir","⨤":"simplus","⨥":"plusdu","⨦":"plussim","⨧":"plustwo","⨩":"mcomma","⨪":"minusdu","⨭":"loplus","⨮":"roplus","⨯":"Cross","⨰":"timesd","⨱":"timesbar","⨳":"smashp","⨴":"lotimes","⨵":"rotimes","⨶":"otimesas","⨷":"Otimes","⨸":"odiv","⨹":"triplus","⨺":"triminus","⨻":"tritime","⨼":"iprod","⨿":"amalg","⩀":"capdot","⩂":"ncup","⩃":"ncap","⩄":"capand","⩅":"cupor","⩆":"cupcap","⩇":"capcup","⩈":"cupbrcap","⩉":"capbrcup","⩊":"cupcup","⩋":"capcap","⩌":"ccups","⩍":"ccaps","⩐":"ccupssm","⩓":"And","⩔":"Or","⩕":"andand","⩖":"oror","⩗":"orslope","⩘":"andslope","⩚":"andv","⩛":"orv","⩜":"andd","⩝":"ord","⩟":"wedbar","⩦":"sdote","⩪":"simdot","⩭":"congdot","⩭̸":"ncongdot","⩮":"easter","⩯":"apacir","⩰":"apE","⩰̸":"napE","⩱":"eplus","⩲":"pluse","⩳":"Esim","⩷":"eDDot","⩸":"equivDD","⩹":"ltcir","⩺":"gtcir","⩻":"ltquest","⩼":"gtquest","⩽":"les","⩽̸":"nles","⩾":"ges","⩾̸":"nges","⩿":"lesdot","⪀":"gesdot","⪁":"lesdoto","⪂":"gesdoto","⪃":"lesdotor","⪄":"gesdotol","⪅":"lap","⪆":"gap","⪇":"lne","⪈":"gne","⪉":"lnap","⪊":"gnap","⪋":"lEg","⪌":"gEl","⪍":"lsime","⪎":"gsime","⪏":"lsimg","⪐":"gsiml","⪑":"lgE","⪒":"glE","⪓":"lesges","⪔":"gesles","⪕":"els","⪖":"egs","⪗":"elsdot","⪘":"egsdot","⪙":"el","⪚":"eg","⪝":"siml","⪞":"simg","⪟":"simlE","⪠":"simgE","⪡":"LessLess","⪡̸":"NotNestedLessLess","⪢":"GreaterGreater","⪢̸":"NotNestedGreaterGreater","⪤":"glj","⪥":"gla","⪦":"ltcc","⪧":"gtcc","⪨":"lescc","⪩":"gescc","⪪":"smt","⪫":"lat","⪬":"smte","⪬︀":"smtes","⪭":"late","⪭︀":"lates","⪮":"bumpE","⪯":"pre","⪯̸":"npre","⪰":"sce","⪰̸":"nsce","⪳":"prE","⪴":"scE","⪵":"prnE","⪶":"scnE","⪷":"prap","⪸":"scap","⪹":"prnap","⪺":"scnap","⪻":"Pr","⪼":"Sc","⪽":"subdot","⪾":"supdot","⪿":"subplus","⫀":"supplus","⫁":"submult","⫂":"supmult","⫃":"subedot","⫄":"supedot","⫅":"subE","⫅̸":"nsubE","⫆":"supE","⫆̸":"nsupE","⫇":"subsim","⫈":"supsim","⫋︀":"vsubnE","⫋":"subnE","⫌︀":"vsupnE","⫌":"supnE","⫏":"csub","⫐":"csup","⫑":"csube","⫒":"csupe","⫓":"subsup","⫔":"supsub","⫕":"subsub","⫖":"supsup","⫗":"suphsub","⫘":"supdsub","⫙":"forkv","⫚":"topfork","⫛":"mlcp","⫤":"Dashv","⫦":"Vdashl","⫧":"Barv","⫨":"vBar","⫩":"vBarv","⫫":"Vbar","⫬":"Not","⫭":"bNot","⫮":"rnmid","⫯":"cirmid","⫰":"midcir","⫱":"topcir","⫲":"nhpar","⫳":"parsim","⫽":"parsl","⫽⃥":"nparsl","♭":"flat","♮":"natur","♯":"sharp","¤":"curren","¢":"cent",$:"dollar","£":"pound","¥":"yen","€":"euro","¹":"sup1","½":"half","⅓":"frac13","¼":"frac14","⅕":"frac15","⅙":"frac16","⅛":"frac18","²":"sup2","⅔":"frac23","⅖":"frac25","³":"sup3","¾":"frac34","⅗":"frac35","⅜":"frac38","⅘":"frac45","⅚":"frac56","⅝":"frac58","⅞":"frac78","𝒶":"ascr","𝕒":"aopf","𝔞":"afr","𝔸":"Aopf","𝔄":"Afr","𝒜":"Ascr",ª:"ordf",á:"aacute",Á:"Aacute",à:"agrave",À:"Agrave",ă:"abreve",Ă:"Abreve",â:"acirc",Â:"Acirc",å:"aring",Å:"angst",ä:"auml",Ä:"Auml",ã:"atilde",Ã:"Atilde",ą:"aogon",Ą:"Aogon",ā:"amacr",Ā:"Amacr",æ:"aelig",Æ:"AElig","𝒷":"bscr","𝕓":"bopf","𝔟":"bfr","𝔹":"Bopf",ℬ:"Bscr","𝔅":"Bfr","𝔠":"cfr","𝒸":"cscr","𝕔":"copf",ℭ:"Cfr","𝒞":"Cscr",ℂ:"Copf",ć:"cacute",Ć:"Cacute",ĉ:"ccirc",Ĉ:"Ccirc",č:"ccaron",Č:"Ccaron",ċ:"cdot",Ċ:"Cdot",ç:"ccedil",Ç:"Ccedil","℅":"incare","𝔡":"dfr","ⅆ":"dd","𝕕":"dopf","𝒹":"dscr","𝒟":"Dscr","𝔇":"Dfr","ⅅ":"DD","𝔻":"Dopf",ď:"dcaron",Ď:"Dcaron",đ:"dstrok",Đ:"Dstrok",ð:"eth",Ð:"ETH","ⅇ":"ee",ℯ:"escr","𝔢":"efr","𝕖":"eopf",ℰ:"Escr","𝔈":"Efr","𝔼":"Eopf",é:"eacute",É:"Eacute",è:"egrave",È:"Egrave",ê:"ecirc",Ê:"Ecirc",ě:"ecaron",Ě:"Ecaron",ë:"euml",Ë:"Euml",ė:"edot",Ė:"Edot",ę:"eogon",Ę:"Eogon",ē:"emacr",Ē:"Emacr","𝔣":"ffr","𝕗":"fopf","𝒻":"fscr","𝔉":"Ffr","𝔽":"Fopf",ℱ:"Fscr",ﬀ:"fflig",ﬃ:"ffilig",ﬄ:"ffllig",ﬁ:"filig",fj:"fjlig",ﬂ:"fllig",ƒ:"fnof",ℊ:"gscr","𝕘":"gopf","𝔤":"gfr","𝒢":"Gscr","𝔾":"Gopf","𝔊":"Gfr",ǵ:"gacute",ğ:"gbreve",Ğ:"Gbreve",ĝ:"gcirc",Ĝ:"Gcirc",ġ:"gdot",Ġ:"Gdot",Ģ:"Gcedil","𝔥":"hfr",ℎ:"planckh","𝒽":"hscr","𝕙":"hopf",ℋ:"Hscr",ℌ:"Hfr",ℍ:"Hopf",ĥ:"hcirc",Ĥ:"Hcirc",ℏ:"hbar",ħ:"hstrok",Ħ:"Hstrok","𝕚":"iopf","𝔦":"ifr","𝒾":"iscr","ⅈ":"ii","𝕀":"Iopf",ℐ:"Iscr",ℑ:"Im",í:"iacute",Í:"Iacute",ì:"igrave",Ì:"Igrave",î:"icirc",Î:"Icirc",ï:"iuml",Ï:"Iuml",ĩ:"itilde",Ĩ:"Itilde",İ:"Idot",į:"iogon",Į:"Iogon",ī:"imacr",Ī:"Imacr",ĳ:"ijlig",Ĳ:"IJlig",ı:"imath","𝒿":"jscr","𝕛":"jopf","𝔧":"jfr","𝒥":"Jscr","𝔍":"Jfr","𝕁":"Jopf",ĵ:"jcirc",Ĵ:"Jcirc","ȷ":"jmath","𝕜":"kopf","𝓀":"kscr","𝔨":"kfr","𝒦":"Kscr","𝕂":"Kopf","𝔎":"Kfr",ķ:"kcedil",Ķ:"Kcedil","𝔩":"lfr","𝓁":"lscr",ℓ:"ell","𝕝":"lopf",ℒ:"Lscr","𝔏":"Lfr","𝕃":"Lopf",ĺ:"lacute",Ĺ:"Lacute",ľ:"lcaron",Ľ:"Lcaron",ļ:"lcedil",Ļ:"Lcedil",ł:"lstrok",Ł:"Lstrok",ŀ:"lmidot",Ŀ:"Lmidot","𝔪":"mfr","𝕞":"mopf","𝓂":"mscr","𝔐":"Mfr","𝕄":"Mopf",ℳ:"Mscr","𝔫":"nfr","𝕟":"nopf","𝓃":"nscr",ℕ:"Nopf","𝒩":"Nscr","𝔑":"Nfr",ń:"nacute",Ń:"Nacute",ň:"ncaron",Ň:"Ncaron",ñ:"ntilde",Ñ:"Ntilde",ņ:"ncedil",Ņ:"Ncedil","№":"numero",ŋ:"eng",Ŋ:"ENG","𝕠":"oopf","𝔬":"ofr",ℴ:"oscr","𝒪":"Oscr","𝔒":"Ofr","𝕆":"Oopf",º:"ordm",ó:"oacute",Ó:"Oacute",ò:"ograve",Ò:"Ograve",ô:"ocirc",Ô:"Ocirc",ö:"ouml",Ö:"Ouml",ő:"odblac",Ő:"Odblac",õ:"otilde",Õ:"Otilde",ø:"oslash",Ø:"Oslash",ō:"omacr",Ō:"Omacr",œ:"oelig",Œ:"OElig","𝔭":"pfr","𝓅":"pscr","𝕡":"popf",ℙ:"Popf","𝔓":"Pfr","𝒫":"Pscr","𝕢":"qopf","𝔮":"qfr","𝓆":"qscr","𝒬":"Qscr","𝔔":"Qfr",ℚ:"Qopf",ĸ:"kgreen","𝔯":"rfr","𝕣":"ropf","𝓇":"rscr",ℛ:"Rscr",ℜ:"Re",ℝ:"Ropf",ŕ:"racute",Ŕ:"Racute",ř:"rcaron",Ř:"Rcaron",ŗ:"rcedil",Ŗ:"Rcedil","𝕤":"sopf","𝓈":"sscr","𝔰":"sfr","𝕊":"Sopf","𝔖":"Sfr","𝒮":"Sscr","Ⓢ":"oS",ś:"sacute",Ś:"Sacute",ŝ:"scirc",Ŝ:"Scirc",š:"scaron",Š:"Scaron",ş:"scedil",Ş:"Scedil",ß:"szlig","𝔱":"tfr","𝓉":"tscr","𝕥":"topf","𝒯":"Tscr","𝔗":"Tfr","𝕋":"Topf",ť:"tcaron",Ť:"Tcaron",ţ:"tcedil",Ţ:"Tcedil","™":"trade",ŧ:"tstrok",Ŧ:"Tstrok","𝓊":"uscr","𝕦":"uopf","𝔲":"ufr","𝕌":"Uopf","𝔘":"Ufr","𝒰":"Uscr",ú:"uacute",Ú:"Uacute",ù:"ugrave",Ù:"Ugrave",ŭ:"ubreve",Ŭ:"Ubreve",û:"ucirc",Û:"Ucirc",ů:"uring",Ů:"Uring",ü:"uuml",Ü:"Uuml",ű:"udblac",Ű:"Udblac",ũ:"utilde",Ũ:"Utilde",ų:"uogon",Ų:"Uogon",ū:"umacr",Ū:"Umacr","𝔳":"vfr","𝕧":"vopf","𝓋":"vscr","𝔙":"Vfr","𝕍":"Vopf","𝒱":"Vscr","𝕨":"wopf","𝓌":"wscr","𝔴":"wfr","𝒲":"Wscr","𝕎":"Wopf","𝔚":"Wfr",ŵ:"wcirc",Ŵ:"Wcirc","𝔵":"xfr","𝓍":"xscr","𝕩":"xopf","𝕏":"Xopf","𝔛":"Xfr","𝒳":"Xscr","𝔶":"yfr","𝓎":"yscr","𝕪":"yopf","𝒴":"Yscr","𝔜":"Yfr","𝕐":"Yopf",ý:"yacute",Ý:"Yacute",ŷ:"ycirc",Ŷ:"Ycirc",ÿ:"yuml",Ÿ:"Yuml","𝓏":"zscr","𝔷":"zfr","𝕫":"zopf",ℨ:"Zfr",ℤ:"Zopf","𝒵":"Zscr",ź:"zacute",Ź:"Zacute",ž:"zcaron",Ž:"Zcaron",ż:"zdot",Ż:"Zdot",Ƶ:"imped",þ:"thorn",Þ:"THORN",ŉ:"napos",α:"alpha",Α:"Alpha",β:"beta",Β:"Beta",γ:"gamma",Γ:"Gamma",δ:"delta",Δ:"Delta",ε:"epsi","ϵ":"epsiv",Ε:"Epsilon",ϝ:"gammad",Ϝ:"Gammad",ζ:"zeta",Ζ:"Zeta",η:"eta",Η:"Eta",θ:"theta",ϑ:"thetav",Θ:"Theta",ι:"iota",Ι:"Iota",κ:"kappa",ϰ:"kappav",Κ:"Kappa",λ:"lambda",Λ:"Lambda",μ:"mu",µ:"micro",Μ:"Mu",ν:"nu",Ν:"Nu",ξ:"xi",Ξ:"Xi",ο:"omicron",Ο:"Omicron",π:"pi",ϖ:"piv",Π:"Pi",ρ:"rho",ϱ:"rhov",Ρ:"Rho",σ:"sigma",Σ:"Sigma",ς:"sigmaf",τ:"tau",Τ:"Tau",υ:"upsi",Υ:"Upsilon",ϒ:"Upsi",φ:"phi",ϕ:"phiv",Φ:"Phi",χ:"chi",Χ:"Chi",ψ:"psi",Ψ:"Psi",ω:"omega",Ω:"ohm",а:"acy",А:"Acy",б:"bcy",Б:"Bcy",в:"vcy",В:"Vcy",г:"gcy",Г:"Gcy",ѓ:"gjcy",Ѓ:"GJcy",д:"dcy",Д:"Dcy",ђ:"djcy",Ђ:"DJcy",е:"iecy",Е:"IEcy",ё:"iocy",Ё:"IOcy",є:"jukcy",Є:"Jukcy",ж:"zhcy",Ж:"ZHcy",з:"zcy",З:"Zcy",ѕ:"dscy",Ѕ:"DScy",и:"icy",И:"Icy",і:"iukcy",І:"Iukcy",ї:"yicy",Ї:"YIcy",й:"jcy",Й:"Jcy",ј:"jsercy",Ј:"Jsercy",к:"kcy",К:"Kcy",ќ:"kjcy",Ќ:"KJcy",л:"lcy",Л:"Lcy",љ:"ljcy",Љ:"LJcy",м:"mcy",М:"Mcy",н:"ncy",Н:"Ncy",њ:"njcy",Њ:"NJcy",о:"ocy",О:"Ocy",п:"pcy",П:"Pcy",р:"rcy",Р:"Rcy",с:"scy",С:"Scy",т:"tcy",Т:"Tcy",ћ:"tshcy",Ћ:"TSHcy",у:"ucy",У:"Ucy",ў:"ubrcy",Ў:"Ubrcy",ф:"fcy",Ф:"Fcy",х:"khcy",Х:"KHcy",ц:"tscy",Ц:"TScy",ч:"chcy",Ч:"CHcy",џ:"dzcy",Џ:"DZcy",ш:"shcy",Ш:"SHcy",щ:"shchcy",Щ:"SHCHcy",ъ:"hardcy",Ъ:"HARDcy",ы:"ycy",Ы:"Ycy",ь:"softcy",Ь:"SOFTcy",э:"ecy",Э:"Ecy",ю:"yucy",Ю:"YUcy",я:"yacy",Я:"YAcy",ℵ:"aleph",ℶ:"beth",ℷ:"gimel",ℸ:"daleth"},d=/["&'<>`]/g,p={'"':"&quot;","&":"&amp;","'":"&#x27;","<":"&lt;",">":"&gt;","`":"&#x60;"},g=/&#(?:[xX][^a-fA-F0-9]|[^0-9xX])/,m=/[\0-\x08\x0B\x0E-\x1F\x7F-\x9F\uFDD0-\uFDEF\uFFFE\uFFFF]|[\uD83F\uD87F\uD8BF\uD8FF\uD93F\uD97F\uD9BF\uD9FF\uDA3F\uDA7F\uDABF\uDAFF\uDB3F\uDB7F\uDBBF\uDBFF][\uDFFE\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,y=/&(CounterClockwiseContourIntegral|DoubleLongLeftRightArrow|ClockwiseContourIntegral|NotNestedGreaterGreater|NotSquareSupersetEqual|DiacriticalDoubleAcute|NotRightTriangleEqual|NotSucceedsSlantEqual|NotPrecedesSlantEqual|CloseCurlyDoubleQuote|NegativeVeryThinSpace|DoubleContourIntegral|FilledVerySmallSquare|CapitalDifferentialD|OpenCurlyDoubleQuote|EmptyVerySmallSquare|NestedGreaterGreater|DoubleLongRightArrow|NotLeftTriangleEqual|NotGreaterSlantEqual|ReverseUpEquilibrium|DoubleLeftRightArrow|NotSquareSubsetEqual|NotDoubleVerticalBar|RightArrowLeftArrow|NotGreaterFullEqual|NotRightTriangleBar|SquareSupersetEqual|DownLeftRightVector|DoubleLongLeftArrow|leftrightsquigarrow|LeftArrowRightArrow|NegativeMediumSpace|blacktriangleright|RightDownVectorBar|PrecedesSlantEqual|RightDoubleBracket|SucceedsSlantEqual|NotLeftTriangleBar|RightTriangleEqual|SquareIntersection|RightDownTeeVector|ReverseEquilibrium|NegativeThickSpace|longleftrightarrow|Longleftrightarrow|LongLeftRightArrow|DownRightTeeVector|DownRightVectorBar|GreaterSlantEqual|SquareSubsetEqual|LeftDownVectorBar|LeftDoubleBracket|VerticalSeparator|rightleftharpoons|NotGreaterGreater|NotSquareSuperset|blacktriangleleft|blacktriangledown|NegativeThinSpace|LeftDownTeeVector|NotLessSlantEqual|leftrightharpoons|DoubleUpDownArrow|DoubleVerticalBar|LeftTriangleEqual|FilledSmallSquare|twoheadrightarrow|NotNestedLessLess|DownLeftTeeVector|DownLeftVectorBar|RightAngleBracket|NotTildeFullEqual|NotReverseElement|RightUpDownVector|DiacriticalTilde|NotSucceedsTilde|circlearrowright|NotPrecedesEqual|rightharpoondown|DoubleRightArrow|NotSucceedsEqual|NonBreakingSpace|NotRightTriangle|LessEqualGreater|RightUpTeeVector|LeftAngleBracket|GreaterFullEqual|DownArrowUpArrow|RightUpVectorBar|twoheadleftarrow|GreaterEqualLess|downharpoonright|RightTriangleBar|ntrianglerighteq|NotSupersetEqual|LeftUpDownVector|DiacriticalAcute|rightrightarrows|vartriangleright|UpArrowDownArrow|DiacriticalGrave|UnderParenthesis|EmptySmallSquare|LeftUpVectorBar|leftrightarrows|DownRightVector|downharpoonleft|trianglerighteq|ShortRightArrow|OverParenthesis|DoubleLeftArrow|DoubleDownArrow|NotSquareSubset|bigtriangledown|ntrianglelefteq|UpperRightArrow|curvearrowright|vartriangleleft|NotLeftTriangle|nleftrightarrow|LowerRightArrow|NotHumpDownHump|NotGreaterTilde|rightthreetimes|LeftUpTeeVector|NotGreaterEqual|straightepsilon|LeftTriangleBar|rightsquigarrow|ContourIntegral|rightleftarrows|CloseCurlyQuote|RightDownVector|LeftRightVector|nLeftrightarrow|leftharpoondown|circlearrowleft|SquareSuperset|OpenCurlyQuote|hookrightarrow|HorizontalLine|DiacriticalDot|NotLessGreater|ntriangleright|DoubleRightTee|InvisibleComma|InvisibleTimes|LowerLeftArrow|DownLeftVector|NotSubsetEqual|curvearrowleft|trianglelefteq|NotVerticalBar|TildeFullEqual|downdownarrows|NotGreaterLess|RightTeeVector|ZeroWidthSpace|looparrowright|LongRightArrow|doublebarwedge|ShortLeftArrow|ShortDownArrow|RightVectorBar|GreaterGreater|ReverseElement|rightharpoonup|LessSlantEqual|leftthreetimes|upharpoonright|rightarrowtail|LeftDownVector|Longrightarrow|NestedLessLess|UpperLeftArrow|nshortparallel|leftleftarrows|leftrightarrow|Leftrightarrow|LeftRightArrow|longrightarrow|upharpoonleft|RightArrowBar|ApplyFunction|LeftTeeVector|leftarrowtail|NotEqualTilde|varsubsetneqq|varsupsetneqq|RightTeeArrow|SucceedsEqual|SucceedsTilde|LeftVectorBar|SupersetEqual|hookleftarrow|DifferentialD|VerticalTilde|VeryThinSpace|blacktriangle|bigtriangleup|LessFullEqual|divideontimes|leftharpoonup|UpEquilibrium|ntriangleleft|RightTriangle|measuredangle|shortparallel|longleftarrow|Longleftarrow|LongLeftArrow|DoubleLeftTee|Poincareplane|PrecedesEqual|triangleright|DoubleUpArrow|RightUpVector|fallingdotseq|looparrowleft|PrecedesTilde|NotTildeEqual|NotTildeTilde|smallsetminus|Proportional|triangleleft|triangledown|UnderBracket|NotHumpEqual|exponentiale|ExponentialE|NotLessTilde|HilbertSpace|RightCeiling|blacklozenge|varsupsetneq|HumpDownHump|GreaterEqual|VerticalLine|LeftTeeArrow|NotLessEqual|DownTeeArrow|LeftTriangle|varsubsetneq|Intersection|NotCongruent|DownArrowBar|LeftUpVector|LeftArrowBar|risingdotseq|GreaterTilde|RoundImplies|SquareSubset|ShortUpArrow|NotSuperset|quaternions|precnapprox|backepsilon|preccurlyeq|OverBracket|blacksquare|MediumSpace|VerticalBar|circledcirc|circleddash|CircleMinus|CircleTimes|LessGreater|curlyeqprec|curlyeqsucc|diamondsuit|UpDownArrow|Updownarrow|RuleDelayed|Rrightarrow|updownarrow|RightVector|nRightarrow|nrightarrow|eqslantless|LeftCeiling|Equilibrium|SmallCircle|expectation|NotSucceeds|thickapprox|GreaterLess|SquareUnion|NotPrecedes|NotLessLess|straightphi|succnapprox|succcurlyeq|SubsetEqual|sqsupseteq|Proportion|Laplacetrf|ImaginaryI|supsetneqq|NotGreater|gtreqqless|NotElement|ThickSpace|TildeEqual|TildeTilde|Fouriertrf|rmoustache|EqualTilde|eqslantgtr|UnderBrace|LeftVector|UpArrowBar|nLeftarrow|nsubseteqq|subsetneqq|nsupseteqq|nleftarrow|succapprox|lessapprox|UpTeeArrow|upuparrows|curlywedge|lesseqqgtr|varepsilon|varnothing|RightFloor|complement|CirclePlus|sqsubseteq|Lleftarrow|circledast|RightArrow|Rightarrow|rightarrow|lmoustache|Bernoullis|precapprox|mapstoleft|mapstodown|longmapsto|dotsquare|downarrow|DoubleDot|nsubseteq|supsetneq|leftarrow|nsupseteq|subsetneq|ThinSpace|ngeqslant|subseteqq|HumpEqual|NotSubset|triangleq|NotCupCap|lesseqgtr|heartsuit|TripleDot|Leftarrow|Coproduct|Congruent|varpropto|complexes|gvertneqq|LeftArrow|LessTilde|supseteqq|MinusPlus|CircleDot|nleqslant|NotExists|gtreqless|nparallel|UnionPlus|LeftFloor|checkmark|CenterDot|centerdot|Mellintrf|gtrapprox|bigotimes|OverBrace|spadesuit|therefore|pitchfork|rationals|PlusMinus|Backslash|Therefore|DownBreve|backsimeq|backprime|DownArrow|nshortmid|Downarrow|lvertneqq|eqvparsl|imagline|imagpart|infintie|integers|Integral|intercal|LessLess|Uarrocir|intlarhk|sqsupset|angmsdaf|sqsubset|llcorner|vartheta|cupbrcap|lnapprox|Superset|SuchThat|succnsim|succneqq|angmsdag|biguplus|curlyvee|trpezium|Succeeds|NotTilde|bigwedge|angmsdah|angrtvbd|triminus|cwconint|fpartint|lrcorner|smeparsl|subseteq|urcorner|lurdshar|laemptyv|DDotrahd|approxeq|ldrushar|awconint|mapstoup|backcong|shortmid|triangle|geqslant|gesdotol|timesbar|circledR|circledS|setminus|multimap|naturals|scpolint|ncongdot|RightTee|boxminus|gnapprox|boxtimes|andslope|thicksim|angmsdaa|varsigma|cirfnint|rtriltri|angmsdab|rppolint|angmsdac|barwedge|drbkarow|clubsuit|thetasym|bsolhsub|capbrcup|dzigrarr|doteqdot|DotEqual|dotminus|UnderBar|NotEqual|realpart|otimesas|ulcorner|hksearow|hkswarow|parallel|PartialD|elinters|emptyset|plusacir|bbrktbrk|angmsdad|pointint|bigoplus|angmsdae|Precedes|bigsqcup|varkappa|notindot|supseteq|precneqq|precnsim|profalar|profline|profsurf|leqslant|lesdotor|raemptyv|subplus|notnivb|notnivc|subrarr|zigrarr|vzigzag|submult|subedot|Element|between|cirscir|larrbfs|larrsim|lotimes|lbrksld|lbrkslu|lozenge|ldrdhar|dbkarow|bigcirc|epsilon|simrarr|simplus|ltquest|Epsilon|luruhar|gtquest|maltese|npolint|eqcolon|npreceq|bigodot|ddagger|gtrless|bnequiv|harrcir|ddotseq|equivDD|backsim|demptyv|nsqsube|nsqsupe|Upsilon|nsubset|upsilon|minusdu|nsucceq|swarrow|nsupset|coloneq|searrow|boxplus|napprox|natural|asympeq|alefsym|congdot|nearrow|bigstar|diamond|supplus|tritime|LeftTee|nvinfin|triplus|NewLine|nvltrie|nvrtrie|nwarrow|nexists|Diamond|ruluhar|Implies|supmult|angzarr|suplarr|suphsub|questeq|because|digamma|Because|olcross|bemptyv|omicron|Omicron|rotimes|NoBreak|intprod|angrtvb|orderof|uwangle|suphsol|lesdoto|orslope|DownTee|realine|cudarrl|rdldhar|OverBar|supedot|lessdot|supdsub|topfork|succsim|rbrkslu|rbrksld|pertenk|cudarrr|isindot|planckh|lessgtr|pluscir|gesdoto|plussim|plustwo|lesssim|cularrp|rarrsim|Cayleys|notinva|notinvb|notinvc|UpArrow|Uparrow|uparrow|NotLess|dwangle|precsim|Product|curarrm|Cconint|dotplus|rarrbfs|ccupssm|Cedilla|cemptyv|notniva|quatint|frac35|frac38|frac45|frac56|frac58|frac78|tridot|xoplus|gacute|gammad|Gammad|lfisht|lfloor|bigcup|sqsupe|gbreve|Gbreve|lharul|sqsube|sqcups|Gcedil|apacir|llhard|lmidot|Lmidot|lmoust|andand|sqcaps|approx|Abreve|spades|circeq|tprime|divide|topcir|Assign|topbot|gesdot|divonx|xuplus|timesd|gesles|atilde|solbar|SOFTcy|loplus|timesb|lowast|lowbar|dlcorn|dlcrop|softcy|dollar|lparlt|thksim|lrhard|Atilde|lsaquo|smashp|bigvee|thinsp|wreath|bkarow|lsquor|lstrok|Lstrok|lthree|ltimes|ltlarr|DotDot|simdot|ltrPar|weierp|xsqcup|angmsd|sigmav|sigmaf|zeetrf|Zcaron|zcaron|mapsto|vsupne|thetav|cirmid|marker|mcomma|Zacute|vsubnE|there4|gtlPar|vsubne|bottom|gtrarr|SHCHcy|shchcy|midast|midcir|middot|minusb|minusd|gtrdot|bowtie|sfrown|mnplus|models|colone|seswar|Colone|mstpos|searhk|gtrsim|nacute|Nacute|boxbox|telrec|hairsp|Tcedil|nbumpe|scnsim|ncaron|Ncaron|ncedil|Ncedil|hamilt|Scedil|nearhk|hardcy|HARDcy|tcedil|Tcaron|commat|nequiv|nesear|tcaron|target|hearts|nexist|varrho|scedil|Scaron|scaron|hellip|Sacute|sacute|hercon|swnwar|compfn|rtimes|rthree|rsquor|rsaquo|zacute|wedgeq|homtht|barvee|barwed|Barwed|rpargt|horbar|conint|swarhk|roplus|nltrie|hslash|hstrok|Hstrok|rmoust|Conint|bprime|hybull|hyphen|iacute|Iacute|supsup|supsub|supsim|varphi|coprod|brvbar|agrave|Supset|supset|igrave|Igrave|notinE|Agrave|iiiint|iinfin|copysr|wedbar|Verbar|vangrt|becaus|incare|verbar|inodot|bullet|drcorn|intcal|drcrop|cularr|vellip|Utilde|bumpeq|cupcap|dstrok|Dstrok|CupCap|cupcup|cupdot|eacute|Eacute|supdot|iquest|easter|ecaron|Ecaron|ecolon|isinsv|utilde|itilde|Itilde|curarr|succeq|Bumpeq|cacute|ulcrop|nparsl|Cacute|nprcue|egrave|Egrave|nrarrc|nrarrw|subsup|subsub|nrtrie|jsercy|nsccue|Jsercy|kappav|kcedil|Kcedil|subsim|ulcorn|nsimeq|egsdot|veebar|kgreen|capand|elsdot|Subset|subset|curren|aacute|lacute|Lacute|emptyv|ntilde|Ntilde|lagran|lambda|Lambda|capcap|Ugrave|langle|subdot|emsp13|numero|emsp14|nvdash|nvDash|nVdash|nVDash|ugrave|ufisht|nvHarr|larrfs|nvlArr|larrhk|larrlp|larrpl|nvrArr|Udblac|nwarhk|larrtl|nwnear|oacute|Oacute|latail|lAtail|sstarf|lbrace|odblac|Odblac|lbrack|udblac|odsold|eparsl|lcaron|Lcaron|ograve|Ograve|lcedil|Lcedil|Aacute|ssmile|ssetmn|squarf|ldquor|capcup|ominus|cylcty|rharul|eqcirc|dagger|rfloor|rfisht|Dagger|daleth|equals|origof|capdot|equest|dcaron|Dcaron|rdquor|oslash|Oslash|otilde|Otilde|otimes|Otimes|urcrop|Ubreve|ubreve|Yacute|Uacute|uacute|Rcedil|rcedil|urcorn|parsim|Rcaron|Vdashl|rcaron|Tstrok|percnt|period|permil|Exists|yacute|rbrack|rbrace|phmmat|ccaron|Ccaron|planck|ccedil|plankv|tstrok|female|plusdo|plusdu|ffilig|plusmn|ffllig|Ccedil|rAtail|dfisht|bernou|ratail|Rarrtl|rarrtl|angsph|rarrpl|rarrlp|rarrhk|xwedge|xotime|forall|ForAll|Vvdash|vsupnE|preceq|bigcap|frac12|frac13|frac14|primes|rarrfs|prnsim|frac15|Square|frac16|square|lesdot|frac18|frac23|propto|prurel|rarrap|rangle|puncsp|frac25|Racute|qprime|racute|lesges|frac34|abreve|AElig|eqsim|utdot|setmn|urtri|Equal|Uring|seArr|uring|searr|dashv|Dashv|mumap|nabla|iogon|Iogon|sdote|sdotb|scsim|napid|napos|equiv|natur|Acirc|dblac|erarr|nbump|iprod|erDot|ucirc|awint|esdot|angrt|ncong|isinE|scnap|Scirc|scirc|ndash|isins|Ubrcy|nearr|neArr|isinv|nedot|ubrcy|acute|Ycirc|iukcy|Iukcy|xutri|nesim|caret|jcirc|Jcirc|caron|twixt|ddarr|sccue|exist|jmath|sbquo|ngeqq|angst|ccaps|lceil|ngsim|UpTee|delta|Delta|rtrif|nharr|nhArr|nhpar|rtrie|jukcy|Jukcy|kappa|rsquo|Kappa|nlarr|nlArr|TSHcy|rrarr|aogon|Aogon|fflig|xrarr|tshcy|ccirc|nleqq|filig|upsih|nless|dharl|nlsim|fjlig|ropar|nltri|dharr|robrk|roarr|fllig|fltns|roang|rnmid|subnE|subne|lAarr|trisb|Ccirc|acirc|ccups|blank|VDash|forkv|Vdash|langd|cedil|blk12|blk14|laquo|strns|diams|notin|vDash|larrb|blk34|block|disin|uplus|vdash|vBarv|aelig|starf|Wedge|check|xrArr|lates|lbarr|lBarr|notni|lbbrk|bcong|frasl|lbrke|frown|vrtri|vprop|vnsup|gamma|Gamma|wedge|xodot|bdquo|srarr|doteq|ldquo|boxdl|boxdL|gcirc|Gcirc|boxDl|boxDL|boxdr|boxdR|boxDr|TRADE|trade|rlhar|boxDR|vnsub|npart|vltri|rlarr|boxhd|boxhD|nprec|gescc|nrarr|nrArr|boxHd|boxHD|boxhu|boxhU|nrtri|boxHu|clubs|boxHU|times|colon|Colon|gimel|xlArr|Tilde|nsime|tilde|nsmid|nspar|THORN|thorn|xlarr|nsube|nsubE|thkap|xhArr|comma|nsucc|boxul|boxuL|nsupe|nsupE|gneqq|gnsim|boxUl|boxUL|grave|boxur|boxuR|boxUr|boxUR|lescc|angle|bepsi|boxvh|varpi|boxvH|numsp|Theta|gsime|gsiml|theta|boxVh|boxVH|boxvl|gtcir|gtdot|boxvL|boxVl|boxVL|crarr|cross|Cross|nvsim|boxvr|nwarr|nwArr|sqsup|dtdot|Uogon|lhard|lharu|dtrif|ocirc|Ocirc|lhblk|duarr|odash|sqsub|Hacek|sqcup|llarr|duhar|oelig|OElig|ofcir|boxvR|uogon|lltri|boxVr|csube|uuarr|ohbar|csupe|ctdot|olarr|olcir|harrw|oline|sqcap|omacr|Omacr|omega|Omega|boxVR|aleph|lneqq|lnsim|loang|loarr|rharu|lobrk|hcirc|operp|oplus|rhard|Hcirc|orarr|Union|order|ecirc|Ecirc|cuepr|szlig|cuesc|breve|reals|eDDot|Breve|hoarr|lopar|utrif|rdquo|Umacr|umacr|efDot|swArr|ultri|alpha|rceil|ovbar|swarr|Wcirc|wcirc|smtes|smile|bsemi|lrarr|aring|parsl|lrhar|bsime|uhblk|lrtri|cupor|Aring|uharr|uharl|slarr|rbrke|bsolb|lsime|rbbrk|RBarr|lsimg|phone|rBarr|rbarr|icirc|lsquo|Icirc|emacr|Emacr|ratio|simne|plusb|simlE|simgE|simeq|pluse|ltcir|ltdot|empty|xharr|xdtri|iexcl|Alpha|ltrie|rarrw|pound|ltrif|xcirc|bumpe|prcue|bumpE|asymp|amacr|cuvee|Sigma|sigma|iiint|udhar|iiota|ijlig|IJlig|supnE|imacr|Imacr|prime|Prime|image|prnap|eogon|Eogon|rarrc|mdash|mDDot|cuwed|imath|supne|imped|Amacr|udarr|prsim|micro|rarrb|cwint|raquo|infin|eplus|range|rangd|Ucirc|radic|minus|amalg|veeeq|rAarr|epsiv|ycirc|quest|sharp|quot|zwnj|Qscr|race|qscr|Qopf|qopf|qint|rang|Rang|Zscr|zscr|Zopf|zopf|rarr|rArr|Rarr|Pscr|pscr|prop|prod|prnE|prec|ZHcy|zhcy|prap|Zeta|zeta|Popf|popf|Zdot|plus|zdot|Yuml|yuml|phiv|YUcy|yucy|Yscr|yscr|perp|Yopf|yopf|part|para|YIcy|Ouml|rcub|yicy|YAcy|rdca|ouml|osol|Oscr|rdsh|yacy|real|oscr|xvee|andd|rect|andv|Xscr|oror|ordm|ordf|xscr|ange|aopf|Aopf|rHar|Xopf|opar|Oopf|xopf|xnis|rhov|oopf|omid|xmap|oint|apid|apos|ogon|ascr|Ascr|odot|odiv|xcup|xcap|ocir|oast|nvlt|nvle|nvgt|nvge|nvap|Wscr|wscr|auml|ntlg|ntgl|nsup|nsub|nsim|Nscr|nscr|nsce|Wopf|ring|npre|wopf|npar|Auml|Barv|bbrk|Nopf|nopf|nmid|nLtv|beta|ropf|Ropf|Beta|beth|nles|rpar|nleq|bnot|bNot|nldr|NJcy|rscr|Rscr|Vscr|vscr|rsqb|njcy|bopf|nisd|Bopf|rtri|Vopf|nGtv|ngtr|vopf|boxh|boxH|boxv|nges|ngeq|boxV|bscr|scap|Bscr|bsim|Vert|vert|bsol|bull|bump|caps|cdot|ncup|scnE|ncap|nbsp|napE|Cdot|cent|sdot|Vbar|nang|vBar|chcy|Mscr|mscr|sect|semi|CHcy|Mopf|mopf|sext|circ|cire|mldr|mlcp|cirE|comp|shcy|SHcy|vArr|varr|cong|copf|Copf|copy|COPY|malt|male|macr|lvnE|cscr|ltri|sime|ltcc|simg|Cscr|siml|csub|Uuml|lsqb|lsim|uuml|csup|Lscr|lscr|utri|smid|lpar|cups|smte|lozf|darr|Lopf|Uscr|solb|lopf|sopf|Sopf|lneq|uscr|spar|dArr|lnap|Darr|dash|Sqrt|LJcy|ljcy|lHar|dHar|Upsi|upsi|diam|lesg|djcy|DJcy|leqq|dopf|Dopf|dscr|Dscr|dscy|ldsh|ldca|squf|DScy|sscr|Sscr|dsol|lcub|late|star|Star|Uopf|Larr|lArr|larr|uopf|dtri|dzcy|sube|subE|Lang|lang|Kscr|kscr|Kopf|kopf|KJcy|kjcy|KHcy|khcy|DZcy|ecir|edot|eDot|Jscr|jscr|succ|Jopf|jopf|Edot|uHar|emsp|ensp|Iuml|iuml|eopf|isin|Iscr|iscr|Eopf|epar|sung|epsi|escr|sup1|sup2|sup3|Iota|iota|supe|supE|Iopf|iopf|IOcy|iocy|Escr|esim|Esim|imof|Uarr|QUOT|uArr|uarr|euml|IEcy|iecy|Idot|Euml|euro|excl|Hscr|hscr|Hopf|hopf|TScy|tscy|Tscr|hbar|tscr|flat|tbrk|fnof|hArr|harr|half|fopf|Fopf|tdot|gvnE|fork|trie|gtcc|fscr|Fscr|gdot|gsim|Gscr|gscr|Gopf|gopf|gneq|Gdot|tosa|gnap|Topf|topf|geqq|toea|GJcy|gjcy|tint|gesl|mid|Sfr|ggg|top|ges|gla|glE|glj|geq|gne|gEl|gel|gnE|Gcy|gcy|gap|Tfr|tfr|Tcy|tcy|Hat|Tau|Ffr|tau|Tab|hfr|Hfr|ffr|Fcy|fcy|icy|Icy|iff|ETH|eth|ifr|Ifr|Eta|eta|int|Int|Sup|sup|ucy|Ucy|Sum|sum|jcy|ENG|ufr|Ufr|eng|Jcy|jfr|els|ell|egs|Efr|efr|Jfr|uml|kcy|Kcy|Ecy|ecy|kfr|Kfr|lap|Sub|sub|lat|lcy|Lcy|leg|Dot|dot|lEg|leq|les|squ|div|die|lfr|Lfr|lgE|Dfr|dfr|Del|deg|Dcy|dcy|lne|lnE|sol|loz|smt|Cup|lrm|cup|lsh|Lsh|sim|shy|map|Map|mcy|Mcy|mfr|Mfr|mho|gfr|Gfr|sfr|cir|Chi|chi|nap|Cfr|vcy|Vcy|cfr|Scy|scy|ncy|Ncy|vee|Vee|Cap|cap|nfr|scE|sce|Nfr|nge|ngE|nGg|vfr|Vfr|ngt|bot|nGt|nis|niv|Rsh|rsh|nle|nlE|bne|Bfr|bfr|nLl|nlt|nLt|Bcy|bcy|not|Not|rlm|wfr|Wfr|npr|nsc|num|ocy|ast|Ocy|ofr|xfr|Xfr|Ofr|ogt|ohm|apE|olt|Rho|ape|rho|Rfr|rfr|ord|REG|ang|reg|orv|And|and|AMP|Rcy|amp|Afr|ycy|Ycy|yen|yfr|Yfr|rcy|par|pcy|Pcy|pfr|Pfr|phi|Phi|afr|Acy|acy|zcy|Zcy|piv|acE|acd|zfr|Zfr|pre|prE|psi|Psi|qfr|Qfr|zwj|Or|ge|Gg|gt|gg|el|oS|lt|Lt|LT|Re|lg|gl|eg|ne|Im|it|le|DD|wp|wr|nu|Nu|dd|lE|Sc|sc|pi|Pi|ee|af|ll|Ll|rx|gE|xi|pm|Xi|ic|pr|Pr|in|ni|mp|mu|ac|Mu|or|ap|Gt|GT|ii);|&(Aacute|Agrave|Atilde|Ccedil|Eacute|Egrave|Iacute|Igrave|Ntilde|Oacute|Ograve|Oslash|Otilde|Uacute|Ugrave|Yacute|aacute|agrave|atilde|brvbar|ccedil|curren|divide|eacute|egrave|frac12|frac14|frac34|iacute|igrave|iquest|middot|ntilde|oacute|ograve|oslash|otilde|plusmn|uacute|ugrave|yacute|AElig|Acirc|Aring|Ecirc|Icirc|Ocirc|THORN|Ucirc|acirc|acute|aelig|aring|cedil|ecirc|icirc|iexcl|laquo|micro|ocirc|pound|raquo|szlig|thorn|times|ucirc|Auml|COPY|Euml|Iuml|Ouml|QUOT|Uuml|auml|cent|copy|euml|iuml|macr|nbsp|ordf|ordm|ouml|para|quot|sect|sup1|sup2|sup3|uuml|yuml|AMP|ETH|REG|amp|deg|eth|not|reg|shy|uml|yen|GT|LT|gt|lt)(?!;)([=a-zA-Z0-9]?)|&#([0-9]+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+)/g,b={aacute:"á",Aacute:"Á",abreve:"ă",Abreve:"Ă",ac:"∾",acd:"∿",acE:"∾̳",acirc:"â",Acirc:"Â",acute:"´",acy:"а",Acy:"А",aelig:"æ",AElig:"Æ",af:"⁡",afr:"𝔞",Afr:"𝔄",agrave:"à",Agrave:"À",alefsym:"ℵ",aleph:"ℵ",alpha:"α",Alpha:"Α",amacr:"ā",Amacr:"Ā",amalg:"⨿",amp:"&",AMP:"&",and:"∧",And:"⩓",andand:"⩕",andd:"⩜",andslope:"⩘",andv:"⩚",ang:"∠",ange:"⦤",angle:"∠",angmsd:"∡",angmsdaa:"⦨",angmsdab:"⦩",angmsdac:"⦪",angmsdad:"⦫",angmsdae:"⦬",angmsdaf:"⦭",angmsdag:"⦮",angmsdah:"⦯",angrt:"∟",angrtvb:"⊾",angrtvbd:"⦝",angsph:"∢",angst:"Å",angzarr:"⍼",aogon:"ą",Aogon:"Ą",aopf:"𝕒",Aopf:"𝔸",ap:"≈",apacir:"⩯",ape:"≊",apE:"⩰",apid:"≋",apos:"'",ApplyFunction:"⁡",approx:"≈",approxeq:"≊",aring:"å",Aring:"Å",ascr:"𝒶",Ascr:"𝒜",Assign:"≔",ast:"*",asymp:"≈",asympeq:"≍",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",awconint:"∳",awint:"⨑",backcong:"≌",backepsilon:"϶",backprime:"‵",backsim:"∽",backsimeq:"⋍",Backslash:"∖",Barv:"⫧",barvee:"⊽",barwed:"⌅",Barwed:"⌆",barwedge:"⌅",bbrk:"⎵",bbrktbrk:"⎶",bcong:"≌",bcy:"б",Bcy:"Б",bdquo:"„",becaus:"∵",because:"∵",Because:"∵",bemptyv:"⦰",bepsi:"϶",bernou:"ℬ",Bernoullis:"ℬ",beta:"β",Beta:"Β",beth:"ℶ",between:"≬",bfr:"𝔟",Bfr:"𝔅",bigcap:"⋂",bigcirc:"◯",bigcup:"⋃",bigodot:"⨀",bigoplus:"⨁",bigotimes:"⨂",bigsqcup:"⨆",bigstar:"★",bigtriangledown:"▽",bigtriangleup:"△",biguplus:"⨄",bigvee:"⋁",bigwedge:"⋀",bkarow:"⤍",blacklozenge:"⧫",blacksquare:"▪",blacktriangle:"▴",blacktriangledown:"▾",blacktriangleleft:"◂",blacktriangleright:"▸",blank:"␣",blk12:"▒",blk14:"░",blk34:"▓",block:"█",bne:"=⃥",bnequiv:"≡⃥",bnot:"⌐",bNot:"⫭",bopf:"𝕓",Bopf:"𝔹",bot:"⊥",bottom:"⊥",bowtie:"⋈",boxbox:"⧉",boxdl:"┐",boxdL:"╕",boxDl:"╖",boxDL:"╗",boxdr:"┌",boxdR:"╒",boxDr:"╓",boxDR:"╔",boxh:"─",boxH:"═",boxhd:"┬",boxhD:"╥",boxHd:"╤",boxHD:"╦",boxhu:"┴",boxhU:"╨",boxHu:"╧",boxHU:"╩",boxminus:"⊟",boxplus:"⊞",boxtimes:"⊠",boxul:"┘",boxuL:"╛",boxUl:"╜",boxUL:"╝",boxur:"└",boxuR:"╘",boxUr:"╙",boxUR:"╚",boxv:"│",boxV:"║",boxvh:"┼",boxvH:"╪",boxVh:"╫",boxVH:"╬",boxvl:"┤",boxvL:"╡",boxVl:"╢",boxVL:"╣",boxvr:"├",boxvR:"╞",boxVr:"╟",boxVR:"╠",bprime:"‵",breve:"˘",Breve:"˘",brvbar:"¦",bscr:"𝒷",Bscr:"ℬ",bsemi:"⁏",bsim:"∽",bsime:"⋍",bsol:"\\",bsolb:"⧅",bsolhsub:"⟈",bull:"•",bullet:"•",bump:"≎",bumpe:"≏",bumpE:"⪮",bumpeq:"≏",Bumpeq:"≎",cacute:"ć",Cacute:"Ć",cap:"∩",Cap:"⋒",capand:"⩄",capbrcup:"⩉",capcap:"⩋",capcup:"⩇",capdot:"⩀",CapitalDifferentialD:"ⅅ",caps:"∩︀",caret:"⁁",caron:"ˇ",Cayleys:"ℭ",ccaps:"⩍",ccaron:"č",Ccaron:"Č",ccedil:"ç",Ccedil:"Ç",ccirc:"ĉ",Ccirc:"Ĉ",Cconint:"∰",ccups:"⩌",ccupssm:"⩐",cdot:"ċ",Cdot:"Ċ",cedil:"¸",Cedilla:"¸",cemptyv:"⦲",cent:"¢",centerdot:"·",CenterDot:"·",cfr:"𝔠",Cfr:"ℭ",chcy:"ч",CHcy:"Ч",check:"✓",checkmark:"✓",chi:"χ",Chi:"Χ",cir:"○",circ:"ˆ",circeq:"≗",circlearrowleft:"↺",circlearrowright:"↻",circledast:"⊛",circledcirc:"⊚",circleddash:"⊝",CircleDot:"⊙",circledR:"®",circledS:"Ⓢ",CircleMinus:"⊖",CirclePlus:"⊕",CircleTimes:"⊗",cire:"≗",cirE:"⧃",cirfnint:"⨐",cirmid:"⫯",cirscir:"⧂",ClockwiseContourIntegral:"∲",CloseCurlyDoubleQuote:"”",CloseCurlyQuote:"’",clubs:"♣",clubsuit:"♣",colon:":",Colon:"∷",colone:"≔",Colone:"⩴",coloneq:"≔",comma:",",commat:"@",comp:"∁",compfn:"∘",complement:"∁",complexes:"ℂ",cong:"≅",congdot:"⩭",Congruent:"≡",conint:"∮",Conint:"∯",ContourIntegral:"∮",copf:"𝕔",Copf:"ℂ",coprod:"∐",Coproduct:"∐",copy:"©",COPY:"©",copysr:"℗",CounterClockwiseContourIntegral:"∳",crarr:"↵",cross:"✗",Cross:"⨯",cscr:"𝒸",Cscr:"𝒞",csub:"⫏",csube:"⫑",csup:"⫐",csupe:"⫒",ctdot:"⋯",cudarrl:"⤸",cudarrr:"⤵",cuepr:"⋞",cuesc:"⋟",cularr:"↶",cularrp:"⤽",cup:"∪",Cup:"⋓",cupbrcap:"⩈",cupcap:"⩆",CupCap:"≍",cupcup:"⩊",cupdot:"⊍",cupor:"⩅",cups:"∪︀",curarr:"↷",curarrm:"⤼",curlyeqprec:"⋞",curlyeqsucc:"⋟",curlyvee:"⋎",curlywedge:"⋏",curren:"¤",curvearrowleft:"↶",curvearrowright:"↷",cuvee:"⋎",cuwed:"⋏",cwconint:"∲",cwint:"∱",cylcty:"⌭",dagger:"†",Dagger:"‡",daleth:"ℸ",darr:"↓",dArr:"⇓",Darr:"↡",dash:"‐",dashv:"⊣",Dashv:"⫤",dbkarow:"⤏",dblac:"˝",dcaron:"ď",Dcaron:"Ď",dcy:"д",Dcy:"Д",dd:"ⅆ",DD:"ⅅ",ddagger:"‡",ddarr:"⇊",DDotrahd:"⤑",ddotseq:"⩷",deg:"°",Del:"∇",delta:"δ",Delta:"Δ",demptyv:"⦱",dfisht:"⥿",dfr:"𝔡",Dfr:"𝔇",dHar:"⥥",dharl:"⇃",dharr:"⇂",DiacriticalAcute:"´",DiacriticalDot:"˙",DiacriticalDoubleAcute:"˝",DiacriticalGrave:"`",DiacriticalTilde:"˜",diam:"⋄",diamond:"⋄",Diamond:"⋄",diamondsuit:"♦",diams:"♦",die:"¨",DifferentialD:"ⅆ",digamma:"ϝ",disin:"⋲",div:"÷",divide:"÷",divideontimes:"⋇",divonx:"⋇",djcy:"ђ",DJcy:"Ђ",dlcorn:"⌞",dlcrop:"⌍",dollar:"$",dopf:"𝕕",Dopf:"𝔻",dot:"˙",Dot:"¨",DotDot:"⃜",doteq:"≐",doteqdot:"≑",DotEqual:"≐",dotminus:"∸",dotplus:"∔",dotsquare:"⊡",doublebarwedge:"⌆",DoubleContourIntegral:"∯",DoubleDot:"¨",DoubleDownArrow:"⇓",DoubleLeftArrow:"⇐",DoubleLeftRightArrow:"⇔",DoubleLeftTee:"⫤",DoubleLongLeftArrow:"⟸",DoubleLongLeftRightArrow:"⟺",DoubleLongRightArrow:"⟹",DoubleRightArrow:"⇒",DoubleRightTee:"⊨",DoubleUpArrow:"⇑",DoubleUpDownArrow:"⇕",DoubleVerticalBar:"∥",downarrow:"↓",Downarrow:"⇓",DownArrow:"↓",DownArrowBar:"⤓",DownArrowUpArrow:"⇵",DownBreve:"̑",downdownarrows:"⇊",downharpoonleft:"⇃",downharpoonright:"⇂",DownLeftRightVector:"⥐",DownLeftTeeVector:"⥞",DownLeftVector:"↽",DownLeftVectorBar:"⥖",DownRightTeeVector:"⥟",DownRightVector:"⇁",DownRightVectorBar:"⥗",DownTee:"⊤",DownTeeArrow:"↧",drbkarow:"⤐",drcorn:"⌟",drcrop:"⌌",dscr:"𝒹",Dscr:"𝒟",dscy:"ѕ",DScy:"Ѕ",dsol:"⧶",dstrok:"đ",Dstrok:"Đ",dtdot:"⋱",dtri:"▿",dtrif:"▾",duarr:"⇵",duhar:"⥯",dwangle:"⦦",dzcy:"џ",DZcy:"Џ",dzigrarr:"⟿",eacute:"é",Eacute:"É",easter:"⩮",ecaron:"ě",Ecaron:"Ě",ecir:"≖",ecirc:"ê",Ecirc:"Ê",ecolon:"≕",ecy:"э",Ecy:"Э",eDDot:"⩷",edot:"ė",eDot:"≑",Edot:"Ė",ee:"ⅇ",efDot:"≒",efr:"𝔢",Efr:"𝔈",eg:"⪚",egrave:"è",Egrave:"È",egs:"⪖",egsdot:"⪘",el:"⪙",Element:"∈",elinters:"⏧",ell:"ℓ",els:"⪕",elsdot:"⪗",emacr:"ē",Emacr:"Ē",empty:"∅",emptyset:"∅",EmptySmallSquare:"◻",emptyv:"∅",EmptyVerySmallSquare:"▫",emsp:" ",emsp13:" ",emsp14:" ",eng:"ŋ",ENG:"Ŋ",ensp:" ",eogon:"ę",Eogon:"Ę",eopf:"𝕖",Eopf:"𝔼",epar:"⋕",eparsl:"⧣",eplus:"⩱",epsi:"ε",epsilon:"ε",Epsilon:"Ε",epsiv:"ϵ",eqcirc:"≖",eqcolon:"≕",eqsim:"≂",eqslantgtr:"⪖",eqslantless:"⪕",Equal:"⩵",equals:"=",EqualTilde:"≂",equest:"≟",Equilibrium:"⇌",equiv:"≡",equivDD:"⩸",eqvparsl:"⧥",erarr:"⥱",erDot:"≓",escr:"ℯ",Escr:"ℰ",esdot:"≐",esim:"≂",Esim:"⩳",eta:"η",Eta:"Η",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",euro:"€",excl:"!",exist:"∃",Exists:"∃",expectation:"ℰ",exponentiale:"ⅇ",ExponentialE:"ⅇ",fallingdotseq:"≒",fcy:"ф",Fcy:"Ф",female:"♀",ffilig:"ﬃ",fflig:"ﬀ",ffllig:"ﬄ",ffr:"𝔣",Ffr:"𝔉",filig:"ﬁ",FilledSmallSquare:"◼",FilledVerySmallSquare:"▪",fjlig:"fj",flat:"♭",fllig:"ﬂ",fltns:"▱",fnof:"ƒ",fopf:"𝕗",Fopf:"𝔽",forall:"∀",ForAll:"∀",fork:"⋔",forkv:"⫙",Fouriertrf:"ℱ",fpartint:"⨍",frac12:"½",frac13:"⅓",frac14:"¼",frac15:"⅕",frac16:"⅙",frac18:"⅛",frac23:"⅔",frac25:"⅖",frac34:"¾",frac35:"⅗",frac38:"⅜",frac45:"⅘",frac56:"⅚",frac58:"⅝",frac78:"⅞",frasl:"⁄",frown:"⌢",fscr:"𝒻",Fscr:"ℱ",gacute:"ǵ",gamma:"γ",Gamma:"Γ",gammad:"ϝ",Gammad:"Ϝ",gap:"⪆",gbreve:"ğ",Gbreve:"Ğ",Gcedil:"Ģ",gcirc:"ĝ",Gcirc:"Ĝ",gcy:"г",Gcy:"Г",gdot:"ġ",Gdot:"Ġ",ge:"≥",gE:"≧",gel:"⋛",gEl:"⪌",geq:"≥",geqq:"≧",geqslant:"⩾",ges:"⩾",gescc:"⪩",gesdot:"⪀",gesdoto:"⪂",gesdotol:"⪄",gesl:"⋛︀",gesles:"⪔",gfr:"𝔤",Gfr:"𝔊",gg:"≫",Gg:"⋙",ggg:"⋙",gimel:"ℷ",gjcy:"ѓ",GJcy:"Ѓ",gl:"≷",gla:"⪥",glE:"⪒",glj:"⪤",gnap:"⪊",gnapprox:"⪊",gne:"⪈",gnE:"≩",gneq:"⪈",gneqq:"≩",gnsim:"⋧",gopf:"𝕘",Gopf:"𝔾",grave:"`",GreaterEqual:"≥",GreaterEqualLess:"⋛",GreaterFullEqual:"≧",GreaterGreater:"⪢",GreaterLess:"≷",GreaterSlantEqual:"⩾",GreaterTilde:"≳",gscr:"ℊ",Gscr:"𝒢",gsim:"≳",gsime:"⪎",gsiml:"⪐",gt:">",Gt:"≫",GT:">",gtcc:"⪧",gtcir:"⩺",gtdot:"⋗",gtlPar:"⦕",gtquest:"⩼",gtrapprox:"⪆",gtrarr:"⥸",gtrdot:"⋗",gtreqless:"⋛",gtreqqless:"⪌",gtrless:"≷",gtrsim:"≳",gvertneqq:"≩︀",gvnE:"≩︀",Hacek:"ˇ",hairsp:" ",half:"½",hamilt:"ℋ",hardcy:"ъ",HARDcy:"Ъ",harr:"↔",hArr:"⇔",harrcir:"⥈",harrw:"↭",Hat:"^",hbar:"ℏ",hcirc:"ĥ",Hcirc:"Ĥ",hearts:"♥",heartsuit:"♥",hellip:"…",hercon:"⊹",hfr:"𝔥",Hfr:"ℌ",HilbertSpace:"ℋ",hksearow:"⤥",hkswarow:"⤦",hoarr:"⇿",homtht:"∻",hookleftarrow:"↩",hookrightarrow:"↪",hopf:"𝕙",Hopf:"ℍ",horbar:"―",HorizontalLine:"─",hscr:"𝒽",Hscr:"ℋ",hslash:"ℏ",hstrok:"ħ",Hstrok:"Ħ",HumpDownHump:"≎",HumpEqual:"≏",hybull:"⁃",hyphen:"‐",iacute:"í",Iacute:"Í",ic:"⁣",icirc:"î",Icirc:"Î",icy:"и",Icy:"И",Idot:"İ",iecy:"е",IEcy:"Е",iexcl:"¡",iff:"⇔",ifr:"𝔦",Ifr:"ℑ",igrave:"ì",Igrave:"Ì",ii:"ⅈ",iiiint:"⨌",iiint:"∭",iinfin:"⧜",iiota:"℩",ijlig:"ĳ",IJlig:"Ĳ",Im:"ℑ",imacr:"ī",Imacr:"Ī",image:"ℑ",ImaginaryI:"ⅈ",imagline:"ℐ",imagpart:"ℑ",imath:"ı",imof:"⊷",imped:"Ƶ",Implies:"⇒",in:"∈",incare:"℅",infin:"∞",infintie:"⧝",inodot:"ı",int:"∫",Int:"∬",intcal:"⊺",integers:"ℤ",Integral:"∫",intercal:"⊺",Intersection:"⋂",intlarhk:"⨗",intprod:"⨼",InvisibleComma:"⁣",InvisibleTimes:"⁢",iocy:"ё",IOcy:"Ё",iogon:"į",Iogon:"Į",iopf:"𝕚",Iopf:"𝕀",iota:"ι",Iota:"Ι",iprod:"⨼",iquest:"¿",iscr:"𝒾",Iscr:"ℐ",isin:"∈",isindot:"⋵",isinE:"⋹",isins:"⋴",isinsv:"⋳",isinv:"∈",it:"⁢",itilde:"ĩ",Itilde:"Ĩ",iukcy:"і",Iukcy:"І",iuml:"ï",Iuml:"Ï",jcirc:"ĵ",Jcirc:"Ĵ",jcy:"й",Jcy:"Й",jfr:"𝔧",Jfr:"𝔍",jmath:"ȷ",jopf:"𝕛",Jopf:"𝕁",jscr:"𝒿",Jscr:"𝒥",jsercy:"ј",Jsercy:"Ј",jukcy:"є",Jukcy:"Є",kappa:"κ",Kappa:"Κ",kappav:"ϰ",kcedil:"ķ",Kcedil:"Ķ",kcy:"к",Kcy:"К",kfr:"𝔨",Kfr:"𝔎",kgreen:"ĸ",khcy:"х",KHcy:"Х",kjcy:"ќ",KJcy:"Ќ",kopf:"𝕜",Kopf:"𝕂",kscr:"𝓀",Kscr:"𝒦",lAarr:"⇚",lacute:"ĺ",Lacute:"Ĺ",laemptyv:"⦴",lagran:"ℒ",lambda:"λ",Lambda:"Λ",lang:"⟨",Lang:"⟪",langd:"⦑",langle:"⟨",lap:"⪅",Laplacetrf:"ℒ",laquo:"«",larr:"←",lArr:"⇐",Larr:"↞",larrb:"⇤",larrbfs:"⤟",larrfs:"⤝",larrhk:"↩",larrlp:"↫",larrpl:"⤹",larrsim:"⥳",larrtl:"↢",lat:"⪫",latail:"⤙",lAtail:"⤛",late:"⪭",lates:"⪭︀",lbarr:"⤌",lBarr:"⤎",lbbrk:"❲",lbrace:"{",lbrack:"[",lbrke:"⦋",lbrksld:"⦏",lbrkslu:"⦍",lcaron:"ľ",Lcaron:"Ľ",lcedil:"ļ",Lcedil:"Ļ",lceil:"⌈",lcub:"{",lcy:"л",Lcy:"Л",ldca:"⤶",ldquo:"“",ldquor:"„",ldrdhar:"⥧",ldrushar:"⥋",ldsh:"↲",le:"≤",lE:"≦",LeftAngleBracket:"⟨",leftarrow:"←",Leftarrow:"⇐",LeftArrow:"←",LeftArrowBar:"⇤",LeftArrowRightArrow:"⇆",leftarrowtail:"↢",LeftCeiling:"⌈",LeftDoubleBracket:"⟦",LeftDownTeeVector:"⥡",LeftDownVector:"⇃",LeftDownVectorBar:"⥙",LeftFloor:"⌊",leftharpoondown:"↽",leftharpoonup:"↼",leftleftarrows:"⇇",leftrightarrow:"↔",Leftrightarrow:"⇔",LeftRightArrow:"↔",leftrightarrows:"⇆",leftrightharpoons:"⇋",leftrightsquigarrow:"↭",LeftRightVector:"⥎",LeftTee:"⊣",LeftTeeArrow:"↤",LeftTeeVector:"⥚",leftthreetimes:"⋋",LeftTriangle:"⊲",LeftTriangleBar:"⧏",LeftTriangleEqual:"⊴",LeftUpDownVector:"⥑",LeftUpTeeVector:"⥠",LeftUpVector:"↿",LeftUpVectorBar:"⥘",LeftVector:"↼",LeftVectorBar:"⥒",leg:"⋚",lEg:"⪋",leq:"≤",leqq:"≦",leqslant:"⩽",les:"⩽",lescc:"⪨",lesdot:"⩿",lesdoto:"⪁",lesdotor:"⪃",lesg:"⋚︀",lesges:"⪓",lessapprox:"⪅",lessdot:"⋖",lesseqgtr:"⋚",lesseqqgtr:"⪋",LessEqualGreater:"⋚",LessFullEqual:"≦",LessGreater:"≶",lessgtr:"≶",LessLess:"⪡",lesssim:"≲",LessSlantEqual:"⩽",LessTilde:"≲",lfisht:"⥼",lfloor:"⌊",lfr:"𝔩",Lfr:"𝔏",lg:"≶",lgE:"⪑",lHar:"⥢",lhard:"↽",lharu:"↼",lharul:"⥪",lhblk:"▄",ljcy:"љ",LJcy:"Љ",ll:"≪",Ll:"⋘",llarr:"⇇",llcorner:"⌞",Lleftarrow:"⇚",llhard:"⥫",lltri:"◺",lmidot:"ŀ",Lmidot:"Ŀ",lmoust:"⎰",lmoustache:"⎰",lnap:"⪉",lnapprox:"⪉",lne:"⪇",lnE:"≨",lneq:"⪇",lneqq:"≨",lnsim:"⋦",loang:"⟬",loarr:"⇽",lobrk:"⟦",longleftarrow:"⟵",Longleftarrow:"⟸",LongLeftArrow:"⟵",longleftrightarrow:"⟷",Longleftrightarrow:"⟺",LongLeftRightArrow:"⟷",longmapsto:"⟼",longrightarrow:"⟶",Longrightarrow:"⟹",LongRightArrow:"⟶",looparrowleft:"↫",looparrowright:"↬",lopar:"⦅",lopf:"𝕝",Lopf:"𝕃",loplus:"⨭",lotimes:"⨴",lowast:"∗",lowbar:"_",LowerLeftArrow:"↙",LowerRightArrow:"↘",loz:"◊",lozenge:"◊",lozf:"⧫",lpar:"(",lparlt:"⦓",lrarr:"⇆",lrcorner:"⌟",lrhar:"⇋",lrhard:"⥭",lrm:"‎",lrtri:"⊿",lsaquo:"‹",lscr:"𝓁",Lscr:"ℒ",lsh:"↰",Lsh:"↰",lsim:"≲",lsime:"⪍",lsimg:"⪏",lsqb:"[",lsquo:"‘",lsquor:"‚",lstrok:"ł",Lstrok:"Ł",lt:"<",Lt:"≪",LT:"<",ltcc:"⪦",ltcir:"⩹",ltdot:"⋖",lthree:"⋋",ltimes:"⋉",ltlarr:"⥶",ltquest:"⩻",ltri:"◃",ltrie:"⊴",ltrif:"◂",ltrPar:"⦖",lurdshar:"⥊",luruhar:"⥦",lvertneqq:"≨︀",lvnE:"≨︀",macr:"¯",male:"♂",malt:"✠",maltese:"✠",map:"↦",Map:"⤅",mapsto:"↦",mapstodown:"↧",mapstoleft:"↤",mapstoup:"↥",marker:"▮",mcomma:"⨩",mcy:"м",Mcy:"М",mdash:"—",mDDot:"∺",measuredangle:"∡",MediumSpace:" ",Mellintrf:"ℳ",mfr:"𝔪",Mfr:"𝔐",mho:"℧",micro:"µ",mid:"∣",midast:"*",midcir:"⫰",middot:"·",minus:"−",minusb:"⊟",minusd:"∸",minusdu:"⨪",MinusPlus:"∓",mlcp:"⫛",mldr:"…",mnplus:"∓",models:"⊧",mopf:"𝕞",Mopf:"𝕄",mp:"∓",mscr:"𝓂",Mscr:"ℳ",mstpos:"∾",mu:"μ",Mu:"Μ",multimap:"⊸",mumap:"⊸",nabla:"∇",nacute:"ń",Nacute:"Ń",nang:"∠⃒",nap:"≉",napE:"⩰̸",napid:"≋̸",napos:"ŉ",napprox:"≉",natur:"♮",natural:"♮",naturals:"ℕ",nbsp:" ",nbump:"≎̸",nbumpe:"≏̸",ncap:"⩃",ncaron:"ň",Ncaron:"Ň",ncedil:"ņ",Ncedil:"Ņ",ncong:"≇",ncongdot:"⩭̸",ncup:"⩂",ncy:"н",Ncy:"Н",ndash:"–",ne:"≠",nearhk:"⤤",nearr:"↗",neArr:"⇗",nearrow:"↗",nedot:"≐̸",NegativeMediumSpace:"​",NegativeThickSpace:"​",NegativeThinSpace:"​",NegativeVeryThinSpace:"​",nequiv:"≢",nesear:"⤨",nesim:"≂̸",NestedGreaterGreater:"≫",NestedLessLess:"≪",NewLine:`
`,nexist:"∄",nexists:"∄",nfr:"𝔫",Nfr:"𝔑",nge:"≱",ngE:"≧̸",ngeq:"≱",ngeqq:"≧̸",ngeqslant:"⩾̸",nges:"⩾̸",nGg:"⋙̸",ngsim:"≵",ngt:"≯",nGt:"≫⃒",ngtr:"≯",nGtv:"≫̸",nharr:"↮",nhArr:"⇎",nhpar:"⫲",ni:"∋",nis:"⋼",nisd:"⋺",niv:"∋",njcy:"њ",NJcy:"Њ",nlarr:"↚",nlArr:"⇍",nldr:"‥",nle:"≰",nlE:"≦̸",nleftarrow:"↚",nLeftarrow:"⇍",nleftrightarrow:"↮",nLeftrightarrow:"⇎",nleq:"≰",nleqq:"≦̸",nleqslant:"⩽̸",nles:"⩽̸",nless:"≮",nLl:"⋘̸",nlsim:"≴",nlt:"≮",nLt:"≪⃒",nltri:"⋪",nltrie:"⋬",nLtv:"≪̸",nmid:"∤",NoBreak:"⁠",NonBreakingSpace:" ",nopf:"𝕟",Nopf:"ℕ",not:"¬",Not:"⫬",NotCongruent:"≢",NotCupCap:"≭",NotDoubleVerticalBar:"∦",NotElement:"∉",NotEqual:"≠",NotEqualTilde:"≂̸",NotExists:"∄",NotGreater:"≯",NotGreaterEqual:"≱",NotGreaterFullEqual:"≧̸",NotGreaterGreater:"≫̸",NotGreaterLess:"≹",NotGreaterSlantEqual:"⩾̸",NotGreaterTilde:"≵",NotHumpDownHump:"≎̸",NotHumpEqual:"≏̸",notin:"∉",notindot:"⋵̸",notinE:"⋹̸",notinva:"∉",notinvb:"⋷",notinvc:"⋶",NotLeftTriangle:"⋪",NotLeftTriangleBar:"⧏̸",NotLeftTriangleEqual:"⋬",NotLess:"≮",NotLessEqual:"≰",NotLessGreater:"≸",NotLessLess:"≪̸",NotLessSlantEqual:"⩽̸",NotLessTilde:"≴",NotNestedGreaterGreater:"⪢̸",NotNestedLessLess:"⪡̸",notni:"∌",notniva:"∌",notnivb:"⋾",notnivc:"⋽",NotPrecedes:"⊀",NotPrecedesEqual:"⪯̸",NotPrecedesSlantEqual:"⋠",NotReverseElement:"∌",NotRightTriangle:"⋫",NotRightTriangleBar:"⧐̸",NotRightTriangleEqual:"⋭",NotSquareSubset:"⊏̸",NotSquareSubsetEqual:"⋢",NotSquareSuperset:"⊐̸",NotSquareSupersetEqual:"⋣",NotSubset:"⊂⃒",NotSubsetEqual:"⊈",NotSucceeds:"⊁",NotSucceedsEqual:"⪰̸",NotSucceedsSlantEqual:"⋡",NotSucceedsTilde:"≿̸",NotSuperset:"⊃⃒",NotSupersetEqual:"⊉",NotTilde:"≁",NotTildeEqual:"≄",NotTildeFullEqual:"≇",NotTildeTilde:"≉",NotVerticalBar:"∤",npar:"∦",nparallel:"∦",nparsl:"⫽⃥",npart:"∂̸",npolint:"⨔",npr:"⊀",nprcue:"⋠",npre:"⪯̸",nprec:"⊀",npreceq:"⪯̸",nrarr:"↛",nrArr:"⇏",nrarrc:"⤳̸",nrarrw:"↝̸",nrightarrow:"↛",nRightarrow:"⇏",nrtri:"⋫",nrtrie:"⋭",nsc:"⊁",nsccue:"⋡",nsce:"⪰̸",nscr:"𝓃",Nscr:"𝒩",nshortmid:"∤",nshortparallel:"∦",nsim:"≁",nsime:"≄",nsimeq:"≄",nsmid:"∤",nspar:"∦",nsqsube:"⋢",nsqsupe:"⋣",nsub:"⊄",nsube:"⊈",nsubE:"⫅̸",nsubset:"⊂⃒",nsubseteq:"⊈",nsubseteqq:"⫅̸",nsucc:"⊁",nsucceq:"⪰̸",nsup:"⊅",nsupe:"⊉",nsupE:"⫆̸",nsupset:"⊃⃒",nsupseteq:"⊉",nsupseteqq:"⫆̸",ntgl:"≹",ntilde:"ñ",Ntilde:"Ñ",ntlg:"≸",ntriangleleft:"⋪",ntrianglelefteq:"⋬",ntriangleright:"⋫",ntrianglerighteq:"⋭",nu:"ν",Nu:"Ν",num:"#",numero:"№",numsp:" ",nvap:"≍⃒",nvdash:"⊬",nvDash:"⊭",nVdash:"⊮",nVDash:"⊯",nvge:"≥⃒",nvgt:">⃒",nvHarr:"⤄",nvinfin:"⧞",nvlArr:"⤂",nvle:"≤⃒",nvlt:"<⃒",nvltrie:"⊴⃒",nvrArr:"⤃",nvrtrie:"⊵⃒",nvsim:"∼⃒",nwarhk:"⤣",nwarr:"↖",nwArr:"⇖",nwarrow:"↖",nwnear:"⤧",oacute:"ó",Oacute:"Ó",oast:"⊛",ocir:"⊚",ocirc:"ô",Ocirc:"Ô",ocy:"о",Ocy:"О",odash:"⊝",odblac:"ő",Odblac:"Ő",odiv:"⨸",odot:"⊙",odsold:"⦼",oelig:"œ",OElig:"Œ",ofcir:"⦿",ofr:"𝔬",Ofr:"𝔒",ogon:"˛",ograve:"ò",Ograve:"Ò",ogt:"⧁",ohbar:"⦵",ohm:"Ω",oint:"∮",olarr:"↺",olcir:"⦾",olcross:"⦻",oline:"‾",olt:"⧀",omacr:"ō",Omacr:"Ō",omega:"ω",Omega:"Ω",omicron:"ο",Omicron:"Ο",omid:"⦶",ominus:"⊖",oopf:"𝕠",Oopf:"𝕆",opar:"⦷",OpenCurlyDoubleQuote:"“",OpenCurlyQuote:"‘",operp:"⦹",oplus:"⊕",or:"∨",Or:"⩔",orarr:"↻",ord:"⩝",order:"ℴ",orderof:"ℴ",ordf:"ª",ordm:"º",origof:"⊶",oror:"⩖",orslope:"⩗",orv:"⩛",oS:"Ⓢ",oscr:"ℴ",Oscr:"𝒪",oslash:"ø",Oslash:"Ø",osol:"⊘",otilde:"õ",Otilde:"Õ",otimes:"⊗",Otimes:"⨷",otimesas:"⨶",ouml:"ö",Ouml:"Ö",ovbar:"⌽",OverBar:"‾",OverBrace:"⏞",OverBracket:"⎴",OverParenthesis:"⏜",par:"∥",para:"¶",parallel:"∥",parsim:"⫳",parsl:"⫽",part:"∂",PartialD:"∂",pcy:"п",Pcy:"П",percnt:"%",period:".",permil:"‰",perp:"⊥",pertenk:"‱",pfr:"𝔭",Pfr:"𝔓",phi:"φ",Phi:"Φ",phiv:"ϕ",phmmat:"ℳ",phone:"☎",pi:"π",Pi:"Π",pitchfork:"⋔",piv:"ϖ",planck:"ℏ",planckh:"ℎ",plankv:"ℏ",plus:"+",plusacir:"⨣",plusb:"⊞",pluscir:"⨢",plusdo:"∔",plusdu:"⨥",pluse:"⩲",PlusMinus:"±",plusmn:"±",plussim:"⨦",plustwo:"⨧",pm:"±",Poincareplane:"ℌ",pointint:"⨕",popf:"𝕡",Popf:"ℙ",pound:"£",pr:"≺",Pr:"⪻",prap:"⪷",prcue:"≼",pre:"⪯",prE:"⪳",prec:"≺",precapprox:"⪷",preccurlyeq:"≼",Precedes:"≺",PrecedesEqual:"⪯",PrecedesSlantEqual:"≼",PrecedesTilde:"≾",preceq:"⪯",precnapprox:"⪹",precneqq:"⪵",precnsim:"⋨",precsim:"≾",prime:"′",Prime:"″",primes:"ℙ",prnap:"⪹",prnE:"⪵",prnsim:"⋨",prod:"∏",Product:"∏",profalar:"⌮",profline:"⌒",profsurf:"⌓",prop:"∝",Proportion:"∷",Proportional:"∝",propto:"∝",prsim:"≾",prurel:"⊰",pscr:"𝓅",Pscr:"𝒫",psi:"ψ",Psi:"Ψ",puncsp:" ",qfr:"𝔮",Qfr:"𝔔",qint:"⨌",qopf:"𝕢",Qopf:"ℚ",qprime:"⁗",qscr:"𝓆",Qscr:"𝒬",quaternions:"ℍ",quatint:"⨖",quest:"?",questeq:"≟",quot:'"',QUOT:'"',rAarr:"⇛",race:"∽̱",racute:"ŕ",Racute:"Ŕ",radic:"√",raemptyv:"⦳",rang:"⟩",Rang:"⟫",rangd:"⦒",range:"⦥",rangle:"⟩",raquo:"»",rarr:"→",rArr:"⇒",Rarr:"↠",rarrap:"⥵",rarrb:"⇥",rarrbfs:"⤠",rarrc:"⤳",rarrfs:"⤞",rarrhk:"↪",rarrlp:"↬",rarrpl:"⥅",rarrsim:"⥴",rarrtl:"↣",Rarrtl:"⤖",rarrw:"↝",ratail:"⤚",rAtail:"⤜",ratio:"∶",rationals:"ℚ",rbarr:"⤍",rBarr:"⤏",RBarr:"⤐",rbbrk:"❳",rbrace:"}",rbrack:"]",rbrke:"⦌",rbrksld:"⦎",rbrkslu:"⦐",rcaron:"ř",Rcaron:"Ř",rcedil:"ŗ",Rcedil:"Ŗ",rceil:"⌉",rcub:"}",rcy:"р",Rcy:"Р",rdca:"⤷",rdldhar:"⥩",rdquo:"”",rdquor:"”",rdsh:"↳",Re:"ℜ",real:"ℜ",realine:"ℛ",realpart:"ℜ",reals:"ℝ",rect:"▭",reg:"®",REG:"®",ReverseElement:"∋",ReverseEquilibrium:"⇋",ReverseUpEquilibrium:"⥯",rfisht:"⥽",rfloor:"⌋",rfr:"𝔯",Rfr:"ℜ",rHar:"⥤",rhard:"⇁",rharu:"⇀",rharul:"⥬",rho:"ρ",Rho:"Ρ",rhov:"ϱ",RightAngleBracket:"⟩",rightarrow:"→",Rightarrow:"⇒",RightArrow:"→",RightArrowBar:"⇥",RightArrowLeftArrow:"⇄",rightarrowtail:"↣",RightCeiling:"⌉",RightDoubleBracket:"⟧",RightDownTeeVector:"⥝",RightDownVector:"⇂",RightDownVectorBar:"⥕",RightFloor:"⌋",rightharpoondown:"⇁",rightharpoonup:"⇀",rightleftarrows:"⇄",rightleftharpoons:"⇌",rightrightarrows:"⇉",rightsquigarrow:"↝",RightTee:"⊢",RightTeeArrow:"↦",RightTeeVector:"⥛",rightthreetimes:"⋌",RightTriangle:"⊳",RightTriangleBar:"⧐",RightTriangleEqual:"⊵",RightUpDownVector:"⥏",RightUpTeeVector:"⥜",RightUpVector:"↾",RightUpVectorBar:"⥔",RightVector:"⇀",RightVectorBar:"⥓",ring:"˚",risingdotseq:"≓",rlarr:"⇄",rlhar:"⇌",rlm:"‏",rmoust:"⎱",rmoustache:"⎱",rnmid:"⫮",roang:"⟭",roarr:"⇾",robrk:"⟧",ropar:"⦆",ropf:"𝕣",Ropf:"ℝ",roplus:"⨮",rotimes:"⨵",RoundImplies:"⥰",rpar:")",rpargt:"⦔",rppolint:"⨒",rrarr:"⇉",Rrightarrow:"⇛",rsaquo:"›",rscr:"𝓇",Rscr:"ℛ",rsh:"↱",Rsh:"↱",rsqb:"]",rsquo:"’",rsquor:"’",rthree:"⋌",rtimes:"⋊",rtri:"▹",rtrie:"⊵",rtrif:"▸",rtriltri:"⧎",RuleDelayed:"⧴",ruluhar:"⥨",rx:"℞",sacute:"ś",Sacute:"Ś",sbquo:"‚",sc:"≻",Sc:"⪼",scap:"⪸",scaron:"š",Scaron:"Š",sccue:"≽",sce:"⪰",scE:"⪴",scedil:"ş",Scedil:"Ş",scirc:"ŝ",Scirc:"Ŝ",scnap:"⪺",scnE:"⪶",scnsim:"⋩",scpolint:"⨓",scsim:"≿",scy:"с",Scy:"С",sdot:"⋅",sdotb:"⊡",sdote:"⩦",searhk:"⤥",searr:"↘",seArr:"⇘",searrow:"↘",sect:"§",semi:";",seswar:"⤩",setminus:"∖",setmn:"∖",sext:"✶",sfr:"𝔰",Sfr:"𝔖",sfrown:"⌢",sharp:"♯",shchcy:"щ",SHCHcy:"Щ",shcy:"ш",SHcy:"Ш",ShortDownArrow:"↓",ShortLeftArrow:"←",shortmid:"∣",shortparallel:"∥",ShortRightArrow:"→",ShortUpArrow:"↑",shy:"­",sigma:"σ",Sigma:"Σ",sigmaf:"ς",sigmav:"ς",sim:"∼",simdot:"⩪",sime:"≃",simeq:"≃",simg:"⪞",simgE:"⪠",siml:"⪝",simlE:"⪟",simne:"≆",simplus:"⨤",simrarr:"⥲",slarr:"←",SmallCircle:"∘",smallsetminus:"∖",smashp:"⨳",smeparsl:"⧤",smid:"∣",smile:"⌣",smt:"⪪",smte:"⪬",smtes:"⪬︀",softcy:"ь",SOFTcy:"Ь",sol:"/",solb:"⧄",solbar:"⌿",sopf:"𝕤",Sopf:"𝕊",spades:"♠",spadesuit:"♠",spar:"∥",sqcap:"⊓",sqcaps:"⊓︀",sqcup:"⊔",sqcups:"⊔︀",Sqrt:"√",sqsub:"⊏",sqsube:"⊑",sqsubset:"⊏",sqsubseteq:"⊑",sqsup:"⊐",sqsupe:"⊒",sqsupset:"⊐",sqsupseteq:"⊒",squ:"□",square:"□",Square:"□",SquareIntersection:"⊓",SquareSubset:"⊏",SquareSubsetEqual:"⊑",SquareSuperset:"⊐",SquareSupersetEqual:"⊒",SquareUnion:"⊔",squarf:"▪",squf:"▪",srarr:"→",sscr:"𝓈",Sscr:"𝒮",ssetmn:"∖",ssmile:"⌣",sstarf:"⋆",star:"☆",Star:"⋆",starf:"★",straightepsilon:"ϵ",straightphi:"ϕ",strns:"¯",sub:"⊂",Sub:"⋐",subdot:"⪽",sube:"⊆",subE:"⫅",subedot:"⫃",submult:"⫁",subne:"⊊",subnE:"⫋",subplus:"⪿",subrarr:"⥹",subset:"⊂",Subset:"⋐",subseteq:"⊆",subseteqq:"⫅",SubsetEqual:"⊆",subsetneq:"⊊",subsetneqq:"⫋",subsim:"⫇",subsub:"⫕",subsup:"⫓",succ:"≻",succapprox:"⪸",succcurlyeq:"≽",Succeeds:"≻",SucceedsEqual:"⪰",SucceedsSlantEqual:"≽",SucceedsTilde:"≿",succeq:"⪰",succnapprox:"⪺",succneqq:"⪶",succnsim:"⋩",succsim:"≿",SuchThat:"∋",sum:"∑",Sum:"∑",sung:"♪",sup:"⊃",Sup:"⋑",sup1:"¹",sup2:"²",sup3:"³",supdot:"⪾",supdsub:"⫘",supe:"⊇",supE:"⫆",supedot:"⫄",Superset:"⊃",SupersetEqual:"⊇",suphsol:"⟉",suphsub:"⫗",suplarr:"⥻",supmult:"⫂",supne:"⊋",supnE:"⫌",supplus:"⫀",supset:"⊃",Supset:"⋑",supseteq:"⊇",supseteqq:"⫆",supsetneq:"⊋",supsetneqq:"⫌",supsim:"⫈",supsub:"⫔",supsup:"⫖",swarhk:"⤦",swarr:"↙",swArr:"⇙",swarrow:"↙",swnwar:"⤪",szlig:"ß",Tab:"	",target:"⌖",tau:"τ",Tau:"Τ",tbrk:"⎴",tcaron:"ť",Tcaron:"Ť",tcedil:"ţ",Tcedil:"Ţ",tcy:"т",Tcy:"Т",tdot:"⃛",telrec:"⌕",tfr:"𝔱",Tfr:"𝔗",there4:"∴",therefore:"∴",Therefore:"∴",theta:"θ",Theta:"Θ",thetasym:"ϑ",thetav:"ϑ",thickapprox:"≈",thicksim:"∼",ThickSpace:"  ",thinsp:" ",ThinSpace:" ",thkap:"≈",thksim:"∼",thorn:"þ",THORN:"Þ",tilde:"˜",Tilde:"∼",TildeEqual:"≃",TildeFullEqual:"≅",TildeTilde:"≈",times:"×",timesb:"⊠",timesbar:"⨱",timesd:"⨰",tint:"∭",toea:"⤨",top:"⊤",topbot:"⌶",topcir:"⫱",topf:"𝕥",Topf:"𝕋",topfork:"⫚",tosa:"⤩",tprime:"‴",trade:"™",TRADE:"™",triangle:"▵",triangledown:"▿",triangleleft:"◃",trianglelefteq:"⊴",triangleq:"≜",triangleright:"▹",trianglerighteq:"⊵",tridot:"◬",trie:"≜",triminus:"⨺",TripleDot:"⃛",triplus:"⨹",trisb:"⧍",tritime:"⨻",trpezium:"⏢",tscr:"𝓉",Tscr:"𝒯",tscy:"ц",TScy:"Ц",tshcy:"ћ",TSHcy:"Ћ",tstrok:"ŧ",Tstrok:"Ŧ",twixt:"≬",twoheadleftarrow:"↞",twoheadrightarrow:"↠",uacute:"ú",Uacute:"Ú",uarr:"↑",uArr:"⇑",Uarr:"↟",Uarrocir:"⥉",ubrcy:"ў",Ubrcy:"Ў",ubreve:"ŭ",Ubreve:"Ŭ",ucirc:"û",Ucirc:"Û",ucy:"у",Ucy:"У",udarr:"⇅",udblac:"ű",Udblac:"Ű",udhar:"⥮",ufisht:"⥾",ufr:"𝔲",Ufr:"𝔘",ugrave:"ù",Ugrave:"Ù",uHar:"⥣",uharl:"↿",uharr:"↾",uhblk:"▀",ulcorn:"⌜",ulcorner:"⌜",ulcrop:"⌏",ultri:"◸",umacr:"ū",Umacr:"Ū",uml:"¨",UnderBar:"_",UnderBrace:"⏟",UnderBracket:"⎵",UnderParenthesis:"⏝",Union:"⋃",UnionPlus:"⊎",uogon:"ų",Uogon:"Ų",uopf:"𝕦",Uopf:"𝕌",uparrow:"↑",Uparrow:"⇑",UpArrow:"↑",UpArrowBar:"⤒",UpArrowDownArrow:"⇅",updownarrow:"↕",Updownarrow:"⇕",UpDownArrow:"↕",UpEquilibrium:"⥮",upharpoonleft:"↿",upharpoonright:"↾",uplus:"⊎",UpperLeftArrow:"↖",UpperRightArrow:"↗",upsi:"υ",Upsi:"ϒ",upsih:"ϒ",upsilon:"υ",Upsilon:"Υ",UpTee:"⊥",UpTeeArrow:"↥",upuparrows:"⇈",urcorn:"⌝",urcorner:"⌝",urcrop:"⌎",uring:"ů",Uring:"Ů",urtri:"◹",uscr:"𝓊",Uscr:"𝒰",utdot:"⋰",utilde:"ũ",Utilde:"Ũ",utri:"▵",utrif:"▴",uuarr:"⇈",uuml:"ü",Uuml:"Ü",uwangle:"⦧",vangrt:"⦜",varepsilon:"ϵ",varkappa:"ϰ",varnothing:"∅",varphi:"ϕ",varpi:"ϖ",varpropto:"∝",varr:"↕",vArr:"⇕",varrho:"ϱ",varsigma:"ς",varsubsetneq:"⊊︀",varsubsetneqq:"⫋︀",varsupsetneq:"⊋︀",varsupsetneqq:"⫌︀",vartheta:"ϑ",vartriangleleft:"⊲",vartriangleright:"⊳",vBar:"⫨",Vbar:"⫫",vBarv:"⫩",vcy:"в",Vcy:"В",vdash:"⊢",vDash:"⊨",Vdash:"⊩",VDash:"⊫",Vdashl:"⫦",vee:"∨",Vee:"⋁",veebar:"⊻",veeeq:"≚",vellip:"⋮",verbar:"|",Verbar:"‖",vert:"|",Vert:"‖",VerticalBar:"∣",VerticalLine:"|",VerticalSeparator:"❘",VerticalTilde:"≀",VeryThinSpace:" ",vfr:"𝔳",Vfr:"𝔙",vltri:"⊲",vnsub:"⊂⃒",vnsup:"⊃⃒",vopf:"𝕧",Vopf:"𝕍",vprop:"∝",vrtri:"⊳",vscr:"𝓋",Vscr:"𝒱",vsubne:"⊊︀",vsubnE:"⫋︀",vsupne:"⊋︀",vsupnE:"⫌︀",Vvdash:"⊪",vzigzag:"⦚",wcirc:"ŵ",Wcirc:"Ŵ",wedbar:"⩟",wedge:"∧",Wedge:"⋀",wedgeq:"≙",weierp:"℘",wfr:"𝔴",Wfr:"𝔚",wopf:"𝕨",Wopf:"𝕎",wp:"℘",wr:"≀",wreath:"≀",wscr:"𝓌",Wscr:"𝒲",xcap:"⋂",xcirc:"◯",xcup:"⋃",xdtri:"▽",xfr:"𝔵",Xfr:"𝔛",xharr:"⟷",xhArr:"⟺",xi:"ξ",Xi:"Ξ",xlarr:"⟵",xlArr:"⟸",xmap:"⟼",xnis:"⋻",xodot:"⨀",xopf:"𝕩",Xopf:"𝕏",xoplus:"⨁",xotime:"⨂",xrarr:"⟶",xrArr:"⟹",xscr:"𝓍",Xscr:"𝒳",xsqcup:"⨆",xuplus:"⨄",xutri:"△",xvee:"⋁",xwedge:"⋀",yacute:"ý",Yacute:"Ý",yacy:"я",YAcy:"Я",ycirc:"ŷ",Ycirc:"Ŷ",ycy:"ы",Ycy:"Ы",yen:"¥",yfr:"𝔶",Yfr:"𝔜",yicy:"ї",YIcy:"Ї",yopf:"𝕪",Yopf:"𝕐",yscr:"𝓎",Yscr:"𝒴",yucy:"ю",YUcy:"Ю",yuml:"ÿ",Yuml:"Ÿ",zacute:"ź",Zacute:"Ź",zcaron:"ž",Zcaron:"Ž",zcy:"з",Zcy:"З",zdot:"ż",Zdot:"Ż",zeetrf:"ℨ",ZeroWidthSpace:"​",zeta:"ζ",Zeta:"Ζ",zfr:"𝔷",Zfr:"ℨ",zhcy:"ж",ZHcy:"Ж",zigrarr:"⇝",zopf:"𝕫",Zopf:"ℤ",zscr:"𝓏",Zscr:"𝒵",zwj:"‍",zwnj:"‌"},A={aacute:"á",Aacute:"Á",acirc:"â",Acirc:"Â",acute:"´",aelig:"æ",AElig:"Æ",agrave:"à",Agrave:"À",amp:"&",AMP:"&",aring:"å",Aring:"Å",atilde:"ã",Atilde:"Ã",auml:"ä",Auml:"Ä",brvbar:"¦",ccedil:"ç",Ccedil:"Ç",cedil:"¸",cent:"¢",copy:"©",COPY:"©",curren:"¤",deg:"°",divide:"÷",eacute:"é",Eacute:"É",ecirc:"ê",Ecirc:"Ê",egrave:"è",Egrave:"È",eth:"ð",ETH:"Ð",euml:"ë",Euml:"Ë",frac12:"½",frac14:"¼",frac34:"¾",gt:">",GT:">",iacute:"í",Iacute:"Í",icirc:"î",Icirc:"Î",iexcl:"¡",igrave:"ì",Igrave:"Ì",iquest:"¿",iuml:"ï",Iuml:"Ï",laquo:"«",lt:"<",LT:"<",macr:"¯",micro:"µ",middot:"·",nbsp:" ",not:"¬",ntilde:"ñ",Ntilde:"Ñ",oacute:"ó",Oacute:"Ó",ocirc:"ô",Ocirc:"Ô",ograve:"ò",Ograve:"Ò",ordf:"ª",ordm:"º",oslash:"ø",Oslash:"Ø",otilde:"õ",Otilde:"Õ",ouml:"ö",Ouml:"Ö",para:"¶",plusmn:"±",pound:"£",quot:'"',QUOT:'"',raquo:"»",reg:"®",REG:"®",sect:"§",shy:"­",sup1:"¹",sup2:"²",sup3:"³",szlig:"ß",thorn:"þ",THORN:"Þ",times:"×",uacute:"ú",Uacute:"Ú",ucirc:"û",Ucirc:"Û",ugrave:"ù",Ugrave:"Ù",uml:"¨",uuml:"ü",Uuml:"Ü",yacute:"ý",Yacute:"Ý",yen:"¥",yuml:"ÿ"},w={0:"�",128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},x=[1,2,3,4,5,6,7,8,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,64976,64977,64978,64979,64980,64981,64982,64983,64984,64985,64986,64987,64988,64989,64990,64991,64992,64993,64994,64995,64996,64997,64998,64999,65e3,65001,65002,65003,65004,65005,65006,65007,65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111],N=String.fromCharCode,F={},L=F.hasOwnProperty,C=function(V,J){return L.call(V,J)},M=function(V,J){for(var ve=-1,pe=V.length;++ve<pe;)if(V[ve]==J)return!0;return!1},_=function(V,J){if(!V)return J;var ve={},pe;for(pe in J)ve[pe]=C(V,pe)?V[pe]:J[pe];return ve},R=function(V,J){var ve="";return V>=55296&&V<=57343||V>1114111?(J&&$("character reference outside the permissible Unicode range"),"�"):C(w,V)?(J&&$("disallowed character reference"),w[V]):(J&&M(x,V)&&$("disallowed character reference"),V>65535&&(V-=65536,ve+=N(V>>>10&1023|55296),V=56320|V&1023),ve+=N(V),ve)},U=function(V){return"&#x"+V.toString(16).toUpperCase()+";"},q=function(V){return"&#"+V+";"},$=function(V){throw Error("Parse error: "+V)},Y=function(V,J){J=_(J,Y.options);var ve=J.strict;ve&&m.test(V)&&$("forbidden code point");var pe=J.encodeEverything,Te=J.useNamedReferences,Ce=J.allowUnsafeSymbols,Re=J.decimal?q:U,Be=function(Ue){return Re(Ue.charCodeAt(0))};return pe?(V=V.replace(o,function(Ue){return Te&&C(h,Ue)?"&"+h[Ue]+";":Be(Ue)}),Te&&(V=V.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;").replace(/&#x66;&#x6A;/g,"&fjlig;")),Te&&(V=V.replace(u,function(Ue){return"&"+h[Ue]+";"}))):Te?(Ce||(V=V.replace(d,function(Ue){return"&"+h[Ue]+";"})),V=V.replace(/&gt;\u20D2/g,"&nvgt;").replace(/&lt;\u20D2/g,"&nvlt;"),V=V.replace(u,function(Ue){return"&"+h[Ue]+";"})):Ce||(V=V.replace(d,Be)),V.replace(a,function(Ue){var Qe=Ue.charCodeAt(0),Ze=Ue.charCodeAt(1),qe=(Qe-55296)*1024+Ze-56320+65536;return Re(qe)}).replace(l,Be)};Y.options={allowUnsafeSymbols:!1,encodeEverything:!1,strict:!1,useNamedReferences:!1,decimal:!1};var ae=function(V,J){J=_(J,ae.options);var ve=J.strict;return ve&&g.test(V)&&$("malformed character reference"),V.replace(y,function(pe,Te,Ce,Re,Be,Ue,Qe,Ze,qe){var nt,B,oe,Ae,be,me;return Te?(be=Te,b[be]):Ce?(be=Ce,me=Re,me&&J.isAttributeValue?(ve&&me=="="&&$("`&` did not start a character reference"),pe):(ve&&$("named character reference was not terminated by a semicolon"),A[be]+(me||""))):Be?(oe=Be,B=Ue,ve&&!B&&$("character reference was not terminated by a semicolon"),nt=parseInt(oe,10),R(nt,ve)):Qe?(Ae=Qe,B=Ze,ve&&!B&&$("character reference was not terminated by a semicolon"),nt=parseInt(Ae,16),R(nt,ve)):(ve&&$("named character reference was not terminated by a semicolon"),pe)})};ae.options={isAttributeValue:!1,strict:!1};var ne=function(V){return V.replace(d,function(J){return p[J]})},ce={version:"1.2.0",encode:Y,decode:ae,escape:ne,unescape:ae};if(i&&!i.nodeType)if(r)r.exports=ce;else for(var re in ce)C(ce,re)&&(i[re]=ce[re]);else t.he=ce})(PF)}(Tl,Tl.exports)),Tl.exports}var FF=OF();const BF=ms(FF);var Cc={exports:{}},r2={};/*! http://mths.be/fromcodepoint v0.2.1 by @mathias */var n2;function UF(){return n2||(n2=1,String.fromCodePoint||function(){var n=function(){try{var r={},s=Object.defineProperty,a=s(r,r,r)&&s}catch{}return a}(),e=String.fromCharCode,t=Math.floor,i=function(r){var s=16384,a=[],o,l,u=-1,h=arguments.length;if(!h)return"";for(var d="";++u<h;){var p=Number(arguments[u]);if(!isFinite(p)||p<0||p>1114111||t(p)!=p)throw RangeError("Invalid code point: "+p);p<=65535?a.push(p):(p-=65536,o=(p>>10)+55296,l=p%1024+56320,a.push(o,l)),(u+1==h||a.length>s)&&(d+=e.apply(null,a),a.length=0)}return d};n?n(String,"fromCodePoint",{value:i,configurable:!0,writable:!0}):String.fromCodePoint=i}()),r2}var s2;function $F(){return s2||(s2=1,function(n,e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,UF();var t=/\\(u\{([0-9A-Fa-f]+)\}|u([0-9A-Fa-f]{4})|x([0-9A-Fa-f]{2})|([1-7][0-7]{0,2}|[0-7]{2,3})|(['"tbrnfv0\\]))|\\U([0-9A-Fa-f]{8})/g,i={0:"\0",b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v","'":"'",'"':'"',"\\":"\\"},r=function(l){return String.fromCodePoint(parseInt(l,16))},s=function(l){return String.fromCodePoint(parseInt(l,8))},a=function(l){return l.replace(t,function(u,h,d,p,g,m,y,b){return d!==void 0?r(d):p!==void 0?r(p):g!==void 0?r(g):m!==void 0?s(m):b!==void 0?r(b):i[y]})};e.default=a,n.exports=e.default}(Cc,Cc.exports)),Cc.exports}var GF=$F();const qF=ms(GF),zn=class zn{static appendSubtitle(e,t,i){return e.end=t.end,e.dur=e.end-e.start,i?e.text+=" "+t.text:e.text+=t.text,e}static convertVttEntriesToSubtitles(e){const t=[],i=[];let r=!1;for(let s=0;s<e.length;s++){const a=e[s],o=this.createSubtitle(a),l=this.createOriginSubtitle(a);!r&&this.hasPunctuation(o.text)&&(r=!0),t.push(o),i.push(l)}return{hasPunctuation:r,subtitles:t,originSubtitles:i}}static convertDropboxSegmentsToSubtitles(e){const t=[],i=[];let r=!1;for(let s=0;s<e.length;s++){const a=e[s],o=this.createSubtitleBySegment(a),l=this.createOriginSubtitleBySegment(a);!r&&this.hasPunctuation(o.text)&&(r=!0),t.push(o),i.push(l)}return{hasPunctuation:r,subtitles:t,originSubtitles:i}}static createSubtitleBySegment(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:this.normalizeSubtitleText(e.text),processPunctuation:!0}}static createOriginSubtitleBySegment(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:e.text,processPunctuation:!0}}static createSubtitle(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:this.normalizeSubtitleText(e.text),processPunctuation:!0}}static createOriginSubtitle(e){return{start:e.startTime,end:e.endTime,dur:e.endTime-e.startTime,text:e.text,processPunctuation:!0}}static normalizeSubtitleText(e){let t=e.replaceAll(`
`," ");return t=qF(t),t=BF.decode(t),t=t2(t).result,t=t.replace(/[^\p{L}\p{N}\p{P}\p{Zs}]/gu,""),t=t.replace(/(\s+|^)uh,?/gi,"$1"),t=this.removeSoundEffectMarkers(t),t.startsWith("- [Instructor]")&&(t=t.replace("- [Instructor]","").trim()),t=this.removeSpeakerName(t),t}static hasPunctuation(e){for(let t=0;t<e.length;t++){const i=e.charAt(t);if(ii.isPunctuation(i))return!0}return!1}static hasAnyPunctuation(e){for(let t of e)if(zn.hasPunctuation(t.text))return!0;return!1}static copyToSubtitleRequests(e){return e.map(t=>({text:t.text,start:t.start,end:t.end,dur:t.dur}))}static copyToSubtitles(e){return e.map(t=>({text:t.text,start:t.start,end:t.end,dur:t.dur,processPunctuation:!0}))}static findFirstWord(e){let t="";const i=e.text.trim();for(let r=0;r<i.length;r++){const s=i.charAt(r);if(t+=s,ii.isPunctuation(s)||ii.isWeakPunctuation(s)||s.trim().length===0)return t}return t}static findLastWord(e){let t=[];for(let i=e.text.length-1;i>=0;i--){const r=e.text.charAt(i);if(!(t.length===0&&(ii.isPunctuation(r)||ii.isWeakPunctuation(r)||r.trim().length===0))&&(t.push(r),t.length!==0&&(ii.isPunctuation(r)||ii.isWeakPunctuation(r)||r.trim().length===0)))break}return t.reverse().join("")}static isSoundEffectMarker(e){const t=e.trim();if(!t.startsWith("[")||!t.endsWith("]"))return!1;const i=t.slice(1,-1).trim();if(!i||i.length>30||i.includes(":")||/\d/.test(i))return!1;const r=i.toLowerCase();for(const s of this.FUNCTIONAL_MARKERS)if(r===s||r.startsWith(s+" "))return!1;for(const s of this.SOUND_EFFECT_MARKERS)if(r===s)return!0;return!1}static removeSoundEffectMarkers(e){const t=/\[([^\]]+)\]/g;return e.replace(t,i=>this.isSoundEffectMarker(i)?"":i)}static removeSpeakerName(e){const t=e.trim(),i=t.indexOf(":");if(i===-1||i===0)return e;const r=t.substring(0,i).trim(),s=t.substring(i+1).trim();return this.isSpeakerName(r,s)?s:e}static isSpeakerName(e,t){if(e.length>50||!t||t.length<3)return!1;const i=e.split(/\s+/);if(i.length===0||i.length>4||!/^[A-Z]/.test(e))return!1;for(const o of zn.EXCLUDE_PATTERNS)if(o.test(e))return!1;if(/^\d+$/.test(e)&&/^\d+/.test(t)||!/^[A-Z]/.test(t))return!1;const r=/^(Dr|Mr|Ms|Mrs|Prof|Sr|Jr)\.?\s/i.test(e),s=/^Speaker\s+\d+$/i.test(e)||i.length===2&&i[0].toLowerCase()==="speaker"&&/^\d+$/.test(i[1]),a=zn.COMMON_ROLES.some(o=>e.toLowerCase()===o.toLowerCase());return!0}};X(zn,"EXCLUDE_PATTERNS",[/^(Question|Answer|Note|Tip|Warning|Example|Step|Chapter|Section|Part)$/i,/^\d+$/,/^[A-Z]$/,/^(https?|ftp|ftps|mailto|file)$/i]),X(zn,"COMMON_ROLES",["Instructor","Narrator","Host","Teacher","Student"]),X(zn,"SOUND_EFFECT_MARKERS",["music","applause","laughter","laugh","laughing","cheering","cheer","clapping","whistling","whistle","sighing","sigh","crying","coughing","cough","sneezing","sneeze","yawning","yawn","breathing","breath","gasping","gasp","screaming","scream","shouting","shout","footsteps","knocking","knock","ringing","ring","beeping","beep","buzzing","buzz","birds chirping","dog barking","thunder","rain","wind","door closing","door opening","inaudible","indistinct chatter","background noise","silence","pause","music playing","music plays"]),X(zn,"FUNCTIONAL_MARKERS",["instructor","narrator","host","teacher","student","question","answer","note","tip","warning","example","step","chapter","section","part","speaker","interviewer","interviewee"]);let It=zn;class VF{constructor(e="en"){X(this,"segmenter");X(this,"locale");X(this,"MIN_SENTENCE_LENGTH",10);X(this,"MAX_SENTENCE_LENGTH",300);X(this,"MAX_SUBTITLE_DURATION",30);X(this,"MIN_WORD_COUNT",5);this.locale=e,typeof Intl<"u"&&"Segmenter"in Intl&&(this.segmenter=new Intl.Segmenter(e,{granularity:"sentence"}))}segment(e){if(!this.segmenter)return this.fallbackSegment(e);const t=[],i=this.segmenter.segment(e);for(const{segment:r}of i){const s=r.trim();s.length>0&&t.push(s)}return this.postProcessSegments(t)}segmentSubtitle(e,t,i=!0){const r=this.segment(t);let s;if(i){const o=e.text||t;s=this.segment(o)}const a=this.distributeTimeToSegments(e,r,s);return this.secondarySplitByDuration(a,i)}distributeTimeToSegments(e,t,i){if(t.length===0)return[];const r=e.dur,s=e.start,a=t.map(d=>this.countCharacters(d)),o=a.reduce((d,p)=>d+p,0);if(o===0)return[];const l=[];let u=s;const h=i&&i.length===t.length;for(let d=0;d<t.length;d++){const p=t[d],g=h?i[d]:p,y=a[d]/o*r,b=Math.min(u+y,e.end);l.push({text:g,start:u,end:b,dur:b-u,googleTranslation:p,processPunctuation:!0}),u=b}return l}secondarySplitByDuration(e,t=!0){const i=[];for(const r of e){if(r.dur<=this.MAX_SUBTITLE_DURATION){i.push(r);continue}const s=r.googleTranslation||r.text,a=this.splitByWeakPunctuation(s);let o;if(t){const u=r.text;o=this.splitByWeakPunctuation(u)}if(a.length<=1){i.push(r);continue}const l=this.distributeTimeToSegments(r,a,o);i.push(...l)}return i}splitByWeakPunctuation(e){const t=e.split(/([，,？?！!]+)/),i=[];let r="";for(let a=0;a<t.length;a++)if(a%2===0)r=t[a];else{r+=t[a];const o=r.trim();o&&i.push(o),r=""}r.trim()&&i.push(r.trim());const s=this.mergeShortSegments(i);return s.length>0?s:[e]}isSegmentTooShort(e){if(!e||!e.trim())return!0;const t=new Intl.Segmenter(this.locale,{granularity:"word"});return Array.from(t.segment(e)).filter(a=>a.isWordLike).length<this.MIN_WORD_COUNT}mergeShortSegments(e){if(e.length===0)return e;const t=[];let i="";for(let r=0;r<e.length;r++){const s=e[r];this.isSegmentTooShort(s)?i?i+=" "+s:t.length>0?t[t.length-1]+=" "+s:i=s:i?(t.push(i+" "+s),i=""):t.push(s)}return i&&(t.length>0?t[t.length-1]+=" "+i:t.push(i)),t}countCharacters(e){let t=0;for(let i=0;i<e.length;i++){const r=e.charAt(i);!ii.isPunctuation(r)&&!ii.isWeakPunctuation(r)&&r.trim().length>0&&t++}return t}postProcessSegments(e){const t=[];let i="";for(let r=0;r<e.length;r++){const s=e[r];if(i&&this.shouldMergeWithPrevious(i,s)){i+=" "+s;continue}if(i&&s.length>=this.MIN_SENTENCE_LENGTH?(t.push(i),i=s):i?i+=" "+s:i=s,i.length>this.MAX_SENTENCE_LENGTH){const a=this.findBestSplitPoint(i);if(a>0&&a<i.length-1)t.push(i.substring(0,a+1).trim()),i=i.substring(a+1).trim();else{const o=this.findSpaceSplitPoint(i,this.MAX_SENTENCE_LENGTH);o>this.MIN_SENTENCE_LENGTH?(t.push(i.substring(0,o).trim()),i=i.substring(o).trim()):(t.push(i.substring(0,this.MAX_SENTENCE_LENGTH).trim()),i=i.substring(this.MAX_SENTENCE_LENGTH).trim())}}}for(;i;)if(i.length<this.MIN_SENTENCE_LENGTH&&t.length>0){const r=t[t.length-1];r.length+i.length<this.MAX_SENTENCE_LENGTH?(t[t.length-1]=r+" "+i,i=""):(t.push(i),i="")}else if(i.length<=this.MAX_SENTENCE_LENGTH)t.push(i),i="";else{const r=this.findBestSplitPoint(i);if(r>0)t.push(i.substring(0,r+1).trim()),i=i.substring(r+1).trim();else{const s=this.findSpaceSplitPoint(i,this.MAX_SENTENCE_LENGTH);s>this.MIN_SENTENCE_LENGTH?(t.push(i.substring(0,s).trim()),i=i.substring(s).trim()):(t.push(i.substring(0,this.MAX_SENTENCE_LENGTH).trim()),i=i.substring(this.MAX_SENTENCE_LENGTH).trim())}}return t.filter(r=>this.isValidSegment(r))}shouldMergeWithPrevious(e,t){var u;const i=e.trim(),r=t.trim();if(/\d\.$/.test(i)&&/^\d/.test(r)||/\w+\.\w+\.$/.test(i)&&/^(com|org|net|io|edu|gov|mil|int|co|uk|cn|jp|de|fr|au|ca|br|in|ru|kr|it|es|nl|se|no|dk|fi|ch|at|be|nz|sg|hk|tw|my|th|vn|id|ph|pk|bd|ng|za|eg|ke|gh|tz|ug|zm|zw|bw|mw|rw|et|sd|so|dj|er|ss|ao|mz|mg|mu|sc|re|yt|km|bi|sn|gm|gn|sl|lr|ci|bf|ml|ne|td|mr|gw|cf|cg|ga|gq|st|cm|tg|bj|cv)\b/i.test(r))return!0;const s=i.split(/\s+/).slice(-2),a=s[s.length-1];if(/^\w+\.\w{1,2}$/.test(a)&&/^[a-zA-Z]{1,3}(\s|$)/.test(r)){const h=a.split(".").pop()+r.split(/\s/)[0];if(["md","mdx","cpp","hpp","jsx","tsx","scss","yaml","yml","json","html","xml","svg","vue","php","sql","java","py","rb","go","rs","swift","kt","scala","clj","elm","lua","r","sh","bash","zsh","fish","ps1","bat","cmd"].includes(h.toLowerCase()))return!0}const o=["Dr","Mr","Mrs","Ms","Prof","Sr","Jr","Ph","M","B","D"],l=((u=i.split(" ").pop())==null?void 0:u.replace(".",""))||"";return!!(o.includes(l)||r.length<3&&!/[.!?]/.test(r))}findBestSplitPoint(e){const t=[".","!","?","。","！","？"];for(const r of t){const s=e.lastIndexOf(r,this.MAX_SENTENCE_LENGTH);if(s>this.MIN_SENTENCE_LENGTH){if(r==="."){const a=e.substring(Math.max(0,s-20),s),o=e.substring(s+1,Math.min(e.length,s+10));if(o.length>0&&/^[a-zA-Z]/.test(o)||/\w+\.\w+$/.test(a+".")||/\d$/.test(a)&&/^\d/.test(o))continue}return s}}const i=[",",";","，","；"];for(const r of i){const s=e.lastIndexOf(r,this.MAX_SENTENCE_LENGTH);if(s>this.MIN_SENTENCE_LENGTH)return s}return-1}findSpaceSplitPoint(e,t){for(let i=Math.min(t,e.length-1);i>this.MIN_SENTENCE_LENGTH;i--)if(e.charAt(i)===" "||e.charAt(i)==="　")return i;return-1}isValidSegment(e){const t=e.trim();if(!t||ii.containsOnlyPunctuationAndSpaces(t)||It.isSoundEffectMarker(t))return!1;const i=t.replace(/^-?\s*\[Instructor\]\s*/i,"");return!(!i||ii.containsOnlyPunctuationAndSpaces(i))}fallbackSegment(e){const t=e.split(/([.!?。！？]+)/),i=[];let r="";for(let s=0;s<t.length;s++)if(s%2===0)r=t[s];else{r+=t[s];const a=r.trim();a&&i.push(a),r=""}return r.trim()&&i.push(r.trim()),this.postProcessSegments(i)}}class Vn{constructor(){X(this,"smartSegmenter");X(this,"GAP_THRESHOLD",.15)}segmentSubtitlesBySentence(e,t){if(typeof Intl>"u"||!("Segmenter"in Intl))return console.warn("[PunctuationSubtitleService] Intl.Segmenter not supported, skipping segmentation"),e;(!this.smartSegmenter||this.smartSegmenter.locale!==(t||"en-US"))&&(this.smartSegmenter=new VF(t||"en-US"));const i=e.filter(o=>o.text&&!ii.containsOnlyPunctuationAndSpaces(o.text));if(i.length===0)return[];const r=i.reduce((o,l,u)=>this.processSubtitleItem(o,l,u,i,t||"en-US"),new HF),s=this.mergeSubtitlesByWordBoundary(r.subtitles),a=this.cleanupPunctuationOnlySubtitles(s);return this.resolveTimeOverlaps(a)}resolveTimeOverlaps(e){if(e.length<=1)return e;const t=[];for(let i=0;i<e.length;i++){const r={...e[i]};if(i<e.length-1){const s=e[i+1];r.end>s.start&&(r.end=s.start,r.dur=r.end-r.start)}t.push(r)}return t}processSubtitleItem(e,t,i,r,s){if(e.shouldSkip(i))return e;let a=t;if(e.hasPending()){const o=e.popPending();a=this.mergePendingToSubtitle(t,o,e.lastSubtitleEnd)}return this.processCurrentSubtitle(a,e,r,i,s),e}processCurrentSubtitle(e,t,i,r,s){if(this.hasSignificantGap(e,i,r+1)){t.pushSubtitle(e);return}const a=this.smartSegmenter.segment(e.text);a.length!==0&&(a.length===1?this.tryMergeForward(e,t,i,r+1,s):this.splitAtFirstSentence(e,t,a))}hasSignificantGap(e,t,i){return i>=t.length?!0:t[i].start-e.end>=this.GAP_THRESHOLD}splitAtFirstSentence(e,t,i){const r=i[0],s=e.text.substring(r.length).trim();if(!s){t.pushSubtitle(e);return}const a=this.calculateTextProportionalTime(e.text,s,e.dur),o=e.dur-a,l={...e,text:r,dur:o,end:e.start+o};t.pushSubtitle(l),t.pushPending(new Ip(s,a))}tryMergeForward(e,t,i,r,s){let a=e.text,o=e.dur,l=e.end;const u=[];let h=!1;for(let d=r;d<i.length&&!(d>r&&this.hasSignificantGap(i[d-1],i,d));d++){const p=i[d],g=a+" "+p.text,m=this.smartSegmenter.segment(g);if(m.length>1){const y=m[0].trim(),b=a.trim();if(g.startsWith(y+" ")&&y.length<b.length){const A=a.substring(y.length).trim(),w=this.calculateTextProportionalTime(a,A,o),x=o-w,N=e.start;t.pushSubtitle({...e,text:y,start:N,dur:x,end:N+x}),A&&t.pushPending(new Ip(A,w)),h=!0;break}y.length>b.length+1?(this.mergePartialNext(e,a,o,l,p,y,t),u.push(d)):t.pushSubtitle({...e,text:a,dur:o,end:l}),h=!0;break}else a=g,o+=p.dur,l=p.end,u.push(d)}h||t.pushSubtitle({...e,text:a,dur:o,end:l}),u.forEach(d=>t.markSkip(d))}mergePartialNext(e,t,i,r,s,a,o){const l=a.substring(t.length).trim(),u=this.calculateTextProportionalTime(s.text,l,s.dur),h=i+u,d=e.start,p={...e,text:a,start:d,dur:h,end:d+h};o.pushSubtitle(p);const g=s.text.substring(l.length).trim();if(g){const m=s.dur-u;o.pushPending(new Ip(g,m))}}mergePendingToSubtitle(e,t,i){let r=e.start-t.time;i>0&&r<i&&(r=i);const s=e.end-r;return{...e,text:t.text+" "+e.text,start:r,dur:s,end:e.end}}calculateTextProportionalTime(e,t,i){const r=this.calculateTextWeight(e),s=this.calculateTextWeight(t);return r===0?0:s/r*i}calculateTextWeight(e){let t=0;for(let i=0;i<e.length;i++){const r=e.charAt(i);!ii.isPunctuation(r)&&!ii.isWeakPunctuation(r)&&r.trim().length>0&&t++}return t}cleanupPunctuationOnlySubtitles(e){if(e.length===0)return e;if(e.length===1)return ii.containsOnlyPunctuationAndSpaces(e[0].text)?[]:e;const t=[];for(let i=0;i<e.length;i++){const r=e[i];ii.containsOnlyPunctuationAndSpaces(r.text)?i===0&&i+1<e.length?(It.appendSubtitle(r,e[i+1],!1),t.push(r),i++):t.length>0&&It.appendSubtitle(t[t.length-1],r,!1):t.push(r)}return t}mergeSubtitlesByWordBoundary(e){if(e.length<=1)return e;const t=[];let i=e[0];for(let r=0;r<e.length-1;r++){const s=e[r+1],a=It.findLastWord(i).trim(),o=It.findFirstWord(s).trim();a&&o&&a===o?It.appendSubtitle(i,s,!0):this.isDecimalNumberSplit(i,s)||ii.containsOnlyPunctuationAndSpaces(s.text)?It.appendSubtitle(i,s,!1):(t.push(i),i=s)}return t.push(i),t}isDecimalNumberSplit(e,t){const i=e.text.trim(),r=i.substring(i.length-2)+t.text.trim().charAt(0),s=Number(r);return!isNaN(s)&&isFinite(s)}postProcessParsedResult(e,t,i){return e.hasPunctuation&&(e.subtitles=this.segmentSubtitlesBySentence(e.subtitles,i)),t.subtitleTimeUnit==="millisecond"&&(e.subtitles=this.convertSubtitlesToSeconds(e.subtitles),e.originSubtitles=this.convertSubtitlesToSeconds(e.originSubtitles)),e}convertSubtitlesToSeconds(e){return e.forEach(t=>{t.start=t.start/1e3,t.end=t.end/1e3,t.dur=t.dur/1e3}),e}}class HF{constructor(){X(this,"_subtitles",[]);X(this,"_pendingText");X(this,"_skipIndices",new Set);X(this,"_lastSubtitleEnd",0)}get subtitles(){return this._subtitles}get lastSubtitleEnd(){return this._lastSubtitleEnd}pushSubtitle(e){this._subtitles.push(e),this._lastSubtitleEnd=e.end}pushPending(e){this._pendingText=e}hasPending(){return this._pendingText!==void 0}popPending(){const e=this._pendingText;return this._pendingText=void 0,e}markSkip(e){this._skipIndices.add(e)}shouldSkip(e){return this._skipIndices.has(e)}}class Ip{constructor(e,t){this.text=e,this.time=t}}class Cp{constructor(){X(this,"punctuationSubtitleService",new Vn)}async parse(e,t){const i=await this.parseSubtitle(e,t);return this.punctuationSubtitleService.postProcessParsedResult(i,t)}}const Hn={BadSignature:1,BadTimestamp:2,BadSettingValue:3,BadFormat:4,UnknownSetting:5};class Kn extends Error{constructor(t){super(t.reason);X(this,"code");X(this,"line");this.code=t.code,this.line=t.line}}const KF=/\r?\n|\r/gm;async function go(n,e){const t=new ReadableStream({start(i){const r=n.split(KF);for(const s of r)i.enqueue(s);i.close()}});return WF(t,e)}async function WF(n,e){const t=(e==null?void 0:e.type)??"vtt";let i;if(typeof t=="string")switch(t){case"srt":i=(await Promise.resolve().then(()=>SB)).default;break;case"ssa":case"ass":i=(await Promise.resolve().then(()=>TB)).default;break;default:i=(await Promise.resolve().then(function(){return h3})).default}else i=t;let r;const s=n.getReader(),a=i(),o=!!(e!=null&&e.strict)||!!(e!=null&&e.errors);await a.init({strict:!1,...e,errors:o,type:t,cancel(){s.cancel(),r=a.done(!0)}});let l=1;for(;;){const{value:u,done:h}=await s.read();if(h){a.parse("",l),r=a.done(!1);break}a.parse(u,l),l++}return r}const YF=window.VTTCue;class Np extends YF{constructor(){super(...arguments);X(this,"region",null);X(this,"vertical","");X(this,"snapToLines",!0);X(this,"line","auto");X(this,"lineAlign","start");X(this,"position","auto");X(this,"positionAlign","auto");X(this,"size",100);X(this,"align","center");X(this,"style")}}class zF{constructor(){X(this,"id","");X(this,"width",100);X(this,"lines",3);X(this,"regionAnchorX",0);X(this,"regionAnchorY",100);X(this,"viewportAnchorX",0);X(this,"viewportAnchorY",100);X(this,"scroll","")}}const a2=",",jF="%";function XF(n){const e=parseInt(n,10);return Number.isNaN(e)?null:e}function wl(n){const e=parseInt(n.replace(jF,""),10);return!Number.isNaN(e)&&e>=0&&e<=100?e:null}function o2(n){if(!n.includes(a2))return null;const[e,t]=n.split(a2).map(wl);return e!==null&&t!==null?[e,t]:null}function JF(n){const e=parseFloat(n);return Number.isNaN(e)?null:e}const QF="WEBVTT",l2=",",ZF="%",po=/[:=]/,e3=/^[\s\t]*(region|vertical|line|position|size|align)[:=]/,t3="NOTE",i3="REGION",r3=/^REGION:?[\s\t]+/,Dl=/[\s\t]+/,n3="-->",s3=/[\s\t]*-->[\s\t]+/,a3=/start|center|end|left|right/,o3=/start|center|end/,l3=/line-(?:left|right)|center|auto/,u3=/^(?:(\d{1,2}):)?(\d{2}):(\d{2})(?:\.(\d{1,3}))?$/;var Rl=(n=>(n[n.None=0]="None",n[n.Header=1]="Header",n[n.Cue=2]="Cue",n[n.Region=3]="Region",n[n.Note=4]="Note",n))(Rl||{});class Lp{constructor(){X(this,"f");X(this,"c",0);X(this,"g",{});X(this,"h",{});X(this,"j",[]);X(this,"a",null);X(this,"b",null);X(this,"k",[]);X(this,"d");X(this,"l","")}async init(e){this.f=e,e.strict&&(this.c=1),e.errors&&(this.d=(await Promise.resolve().then(()=>O2)).ParseErrorBuilder)}parse(e,t){var i,r,s,a,o,l;if(e==="")this.a?(this.j.push(this.a),(r=(i=this.f).onCue)==null||r.call(i,this.a),this.a=null):this.b?(this.h[this.b.id]=this.b,(a=(s=this.f).onRegion)==null||a.call(s,this.b),this.b=null):this.c===1&&(this.i(e,t),(l=(o=this.f).onHeaderMetadata)==null||l.call(o,this.g)),this.c=0;else if(this.c)switch(this.c){case 1:this.i(e,t);break;case 2:if(this.a){const u=this.a.text.length>0;!u&&e3.test(e)?this.m(e.split(Dl),t):this.a.text+=(u?`
`:"")+e}break;case 3:this.n(e.split(Dl),t);break}else if(e.startsWith(t3))this.c=4;else if(e.startsWith(i3))this.c=3,this.b=new zF,this.n(e.replace(r3,"").split(Dl),t);else if(e.includes(n3)){const u=this.o(e,t);u&&(this.a=new Np(u[0],u[1],""),this.a.id=this.l,this.m(u[2],t)),this.c=2}else t===1&&this.i(e,t);this.l=e}done(){return{metadata:this.g,cues:this.j,regions:Object.values(this.h),errors:this.k}}i(e,t){var i;if(t>1){if(po.test(e)){const[r,s]=e.split(po);r&&(this.g[r]=(s||"").replace(Dl,""))}}else e.startsWith(QF)?this.c=1:this.e((i=this.d)==null?void 0:i.p())}o(e,t){var u,h,d;const[i,r=""]=e.split(s3),[s,...a]=r.split(Dl),o=Il(i),l=Il(s);if(o!==null&&l!==null&&l>o)return[o,l,a];o===null&&this.e((u=this.d)==null?void 0:u.q(i,t)),l===null&&this.e((h=this.d)==null?void 0:h.r(s,t)),o!=null&&l!==null&&l>o&&this.e((d=this.d)==null?void 0:d.s(o,l,t))}n(e,t){var r,s;let i;for(let a=0;a<e.length;a++)if(po.test(e[a])){i=!1;const[o,l]=e[a].split(po);switch(o){case"id":this.b.id=l;break;case"width":const u=wl(l);u!==null?this.b.width=u:i=!0;break;case"lines":const h=XF(l);h!==null?this.b.lines=h:i=!0;break;case"regionanchor":const d=o2(l);d!==null?(this.b.regionAnchorX=d[0],this.b.regionAnchorY=d[1]):i=!0;break;case"viewportanchor":const p=o2(l);p!==null?(this.b.viewportAnchorX=p[0],this.b.viewportAnchorY=p[1]):i=!0;break;case"scroll":l==="up"?this.b.scroll="up":i=!0;break;default:this.e((r=this.d)==null?void 0:r.t(o,l,t))}i&&this.e((s=this.d)==null?void 0:s.u(o,l,t))}}m(e,t){var r,s;let i;for(let a=0;a<e.length;a++)if(i=!1,po.test(e[a])){const[o,l]=e[a].split(po);switch(o){case"region":const u=this.h[l];u&&(this.a.region=u);break;case"vertical":l==="lr"||l==="rl"?(this.a.vertical=l,this.a.region=null):i=!0;break;case"line":const[h,d]=l.split(l2);if(h.includes(ZF)){const b=wl(h);b!==null?(this.a.line=b,this.a.snapToLines=!1):i=!0}else{const b=JF(h);b!==null?this.a.line=b:i=!0}o3.test(d)?this.a.lineAlign=d:d&&(i=!0),this.a.line!=="auto"&&(this.a.region=null);break;case"position":const[p,g]=l.split(l2),m=wl(p);m!==null?this.a.position=m:i=!0,g&&l3.test(g)?this.a.positionAlign=g:g&&(i=!0);break;case"size":const y=wl(l);y!==null?(this.a.size=y,y<100&&(this.a.region=null)):i=!0;break;case"align":a3.test(l)?this.a.align=l:i=!0;break;default:this.e((r=this.d)==null?void 0:r.v(o,l,t))}i&&this.e((s=this.d)==null?void 0:s.w(o,l,t))}}e(e){var t,i;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(i=(t=this.f).onError)==null||i.call(t,e)}}}function Il(n){const e=n.match(u3);if(!e)return null;const t=e[1]?parseInt(e[1],10):0,i=parseInt(e[2],10),r=parseInt(e[3],10),s=e[4]?parseInt(e[4].padEnd(3,"0"),10):0,a=t*3600+i*60+r+s/1e3;return t<0||i<0||r<0||s<0||i>59||r>59?null:a}function c3(){return new Lp}var h3=Object.freeze({__proto__:null,VTTBlock:Rl,VTTParser:Lp,default:c3,parseVTTTimestamp:Il});class u2 extends Cp{async parseSubtitle(e,t){const i=this.removeVttHeader(e);let r;return t.subtitleFormat==="vtt"?r=await go(i):r=await go(i,{type:"srt"}),It.convertVttEntriesToSubtitles(r.cues)}removeVttHeader(e){let t=e.trimStart();return t.startsWith(`WEBVTT
`)&&(t=t.replace(`WEBVTT
`,"")),t}}class d3 extends Cp{async parseSubtitle(e,t){if(t.subtitleFormat==="vtt"||t.subtitleFormat==="srt")throw console.error("CustomFormatSubtitleParser does not support standard subtitle formats, please use SrtVttSubtitleParser for vtt/srt formats",{subtitleFormat:t.subtitleFormat,domain:t.domain}),new Error(`CustomFormatSubtitleParser does not support ${t.subtitleFormat} format, standard subtitle formats should be handled by SrtVttSubtitleParser`);const i=t.subtitleFormat,r=JSON.parse(e),s=on(r,i.subtitleListJsonPath),a=[],o=[];let l=!1;for(let u=0;u<s.length;u++){const h=s[u],d=this.createSubtitle(h,i),p=this.createSubtitle(h,i);!l&&It.hasPunctuation(d.text)&&(l=!0);const g=h;g[i.subtitleTextName].startsWith("♪")&&g[i.subtitleTextName].endsWith("♪")||g[i.subtitleTextName].trim()==="音乐"||a.push(d),o.push(p)}if(!l)for(let u of a)u.processPunctuation=!1;return{hasPunctuation:l,subtitles:a,originSubtitles:o}}createSubtitle(e,t){const i=e[t.subtitleStartTimeName],r=t.timeType==="end"?e[t.subtitleEndTimeName]:i+e[t.subtitleEndTimeName];return{start:i,end:r,dur:r-i,text:It.normalizeSubtitleText(e[t.subtitleTextName]),processPunctuation:!0}}}var Di=(n=>(n[n.GREEN=0]="GREEN",n[n.YELLOW=1]="YELLOW",n[n.RED=2]="RED",n))(Di||{});const f3="X-YouTubeDubbing";class _p{static isHeaderOnlySite(){const e=window.location.hostname;return e.includes("x.com")||e.includes("twitter.com")}static async fetchText(e){if(this.isHeaderOnlySite())return this.fetchWithHeader(e);try{const t=Qi.addParam(e,"youtubedubbing","true"),i=await fetch(t,{headers:{Referer:window.location.href}});if(!i.ok)throw new Error(`M3U8 fetch 失败: ${i.status}`);return i.text()}catch{return console.log(`查询参数方式失败，回退到 Header 方式: ${e}`),this.fetchWithHeader(e)}}static async fetchWithHeader(e){const t=await fetch(e,{headers:{Referer:window.location.href,[f3]:"true"}});if(!t.ok)throw new Error(`M3U8 fetch 失败: ${t.status}`);return t.text()}}var Mp=function(){function n(){this.listeners={}}var e=n.prototype;return e.on=function(i,r){this.listeners[i]||(this.listeners[i]=[]),this.listeners[i].push(r)},e.off=function(i,r){if(!this.listeners[i])return!1;var s=this.listeners[i].indexOf(r);return this.listeners[i]=this.listeners[i].slice(0),this.listeners[i].splice(s,1),s>-1},e.trigger=function(i){var r=this.listeners[i];if(r)if(arguments.length===2)for(var s=r.length,a=0;a<s;++a)r[a].call(this,arguments[1]);else for(var o=Array.prototype.slice.call(arguments,1),l=r.length,u=0;u<l;++u)r[u].apply(this,o)},e.dispose=function(){this.listeners={}},e.pipe=function(i){this.on("data",function(r){i.push(r)})},n}();function mo(){return mo=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},mo.apply(null,arguments)}var kp,c2;function g3(){if(c2)return kp;c2=1;var n;return typeof window<"u"?n=window:typeof Or<"u"?n=Or:typeof self<"u"?n=self:n={},kp=n,kp}var p3=g3();const h2=ms(p3);var m3=function(e){return h2.atob?h2.atob(e):Buffer.from(e,"base64").toString("binary")};function y3(n){for(var e=m3(n),t=new Uint8Array(e.length),i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}/*! @name m3u8-parser @version 7.2.0 @license Apache-2.0 */class v3 extends Mp{constructor(){super(),this.buffer=""}push(e){let t;for(this.buffer+=e,t=this.buffer.indexOf(`
`);t>-1;t=this.buffer.indexOf(`
`))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)}}const b3="	",Pp=function(n){const e=/([0-9.]*)?@?([0-9.]*)?/.exec(n||""),t={};return e[1]&&(t.length=parseInt(e[1],10)),e[2]&&(t.offset=parseInt(e[2],10)),t},E3=function(){const t="(?:"+"[^=]*"+")=(?:"+'"[^"]*"|[^,]*'+")";return new RegExp("(?:^|,)("+t+")")},Hi=function(n){const e={};if(!n)return e;const t=n.split(E3());let i=t.length,r;for(;i--;)t[i]!==""&&(r=/([^=]*)=(.*)/.exec(t[i]).slice(1),r[0]=r[0].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^\s+|\s+$/g,""),r[1]=r[1].replace(/^['"](.*)['"]$/g,"$1"),e[r[0]]=r[1]);return e},d2=n=>{const e=n.split("x"),t={};return e[0]&&(t.width=parseInt(e[0],10)),e[1]&&(t.height=parseInt(e[1],10)),t};class A3 extends Mp{constructor(){super(),this.customParsers=[],this.tagMappers=[]}push(e){let t,i;if(e=e.trim(),e.length===0)return;if(e[0]!=="#"){this.trigger("data",{type:"uri",uri:e});return}this.tagMappers.reduce((s,a)=>{const o=a(e);return o===e?s:s.concat([o])},[e]).forEach(s=>{for(let a=0;a<this.customParsers.length;a++)if(this.customParsers[a].call(this,s))return;if(s.indexOf("#EXT")!==0){this.trigger("data",{type:"comment",text:s.slice(1)});return}if(s=s.replace("\r",""),t=/^#EXTM3U/.exec(s),t){this.trigger("data",{type:"tag",tagType:"m3u"});return}if(t=/^#EXTINF:([0-9\.]*)?,?(.*)?$/.exec(s),t){i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),this.trigger("data",i);return}if(t=/^#EXT-X-TARGETDURATION:([0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-VERSION:([0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:(\-?[0-9.]*)?/.exec(s),t){i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),this.trigger("data",i);return}if(t=/^#EXT-X-PLAYLIST-TYPE:(.*)?$/.exec(s),t){i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-BYTERANGE:(.*)?$/.exec(s),t){i=mo(Pp(t[1]),{type:"tag",tagType:"byterange"}),this.trigger("data",i);return}if(t=/^#EXT-X-ALLOW-CACHE:(YES|NO)?/.exec(s),t){i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-MAP:(.*)$/.exec(s),t){if(i={type:"tag",tagType:"map"},t[1]){const a=Hi(t[1]);a.URI&&(i.uri=a.URI),a.BYTERANGE&&(i.byterange=Pp(a.BYTERANGE))}this.trigger("data",i);return}if(t=/^#EXT-X-STREAM-INF:(.*)$/.exec(s),t){i={type:"tag",tagType:"stream-inf"},t[1]&&(i.attributes=Hi(t[1]),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=d2(i.attributes.RESOLUTION)),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))),this.trigger("data",i);return}if(t=/^#EXT-X-MEDIA:(.*)$/.exec(s),t){i={type:"tag",tagType:"media"},t[1]&&(i.attributes=Hi(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-ENDLIST/.exec(s),t){this.trigger("data",{type:"tag",tagType:"endlist"});return}if(t=/^#EXT-X-DISCONTINUITY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(t=/^#EXT-X-PROGRAM-DATE-TIME:(.*)$/.exec(s),t){i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),this.trigger("data",i);return}if(t=/^#EXT-X-KEY:(.*)$/.exec(s),t){i={type:"tag",tagType:"key"},t[1]&&(i.attributes=Hi(t[1]),i.attributes.IV&&(i.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),this.trigger("data",i);return}if(t=/^#EXT-X-START:(.*)$/.exec(s),t){i={type:"tag",tagType:"start"},t[1]&&(i.attributes=Hi(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT-CONT:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-OUT:(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(s),t){i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",this.trigger("data",i);return}if(t=/^#EXT-X-SKIP:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"skip"},i.attributes=Hi(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(b3)),this.trigger("data",i);return}if(t=/^#EXT-X-PART:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"part"},i.attributes=Hi(t[1]),["DURATION"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["INDEPENDENT","GAP"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=Pp(i.attributes.BYTERANGE)),this.trigger("data",i);return}if(t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"server-control"},i.attributes=Hi(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=/YES/.test(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PART-INF:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"part-inf"},i.attributes=Hi(t[1]),["PART-TARGET"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseFloat(i.attributes[a]))}),this.trigger("data",i);return}if(t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"preload-hint"},i.attributes=Hi(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach(function(a){if(i.attributes.hasOwnProperty(a)){i.attributes[a]=parseInt(i.attributes[a],10);const o=a==="BYTERANGE-LENGTH"?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[o]=i.attributes[a],delete i.attributes[a]}}),this.trigger("data",i);return}if(t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"rendition-report"},i.attributes=Hi(t[1]),["LAST-MSN","LAST-PART"].forEach(function(a){i.attributes.hasOwnProperty(a)&&(i.attributes[a]=parseInt(i.attributes[a],10))}),this.trigger("data",i);return}if(t=/^#EXT-X-DATERANGE:(.*)$/.exec(s),t&&t[1]){i={type:"tag",tagType:"daterange"},i.attributes=Hi(t[1]),["ID","CLASS"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=String(i.attributes[o]))}),["START-DATE","END-DATE"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=new Date(i.attributes[o]))}),["DURATION","PLANNED-DURATION"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=parseFloat(i.attributes[o]))}),["END-ON-NEXT"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=/YES/i.test(i.attributes[o]))}),["SCTE35-CMD"," SCTE35-OUT","SCTE35-IN"].forEach(function(o){i.attributes.hasOwnProperty(o)&&(i.attributes[o]=i.attributes[o].toString(16))});const a=/^X-([A-Z]+-)+[A-Z]+$/;for(const o in i.attributes){if(!a.test(o))continue;const l=/[0-9A-Fa-f]{6}/g.test(i.attributes[o]),u=/^\d+(\.\d+)?$/.test(i.attributes[o]);i.attributes[o]=l?i.attributes[o].toString(16):u?parseFloat(i.attributes[o]):String(i.attributes[o])}this.trigger("data",i);return}if(t=/^#EXT-X-INDEPENDENT-SEGMENTS/.exec(s),t){this.trigger("data",{type:"tag",tagType:"independent-segments"});return}if(t=/^#EXT-X-I-FRAMES-ONLY/.exec(s),t){this.trigger("data",{type:"tag",tagType:"i-frames-only"});return}if(t=/^#EXT-X-CONTENT-STEERING:(.*)$/.exec(s),t){i={type:"tag",tagType:"content-steering"},i.attributes=Hi(t[1]),this.trigger("data",i);return}if(t=/^#EXT-X-I-FRAME-STREAM-INF:(.*)$/.exec(s),t){i={type:"tag",tagType:"i-frame-playlist"},i.attributes=Hi(t[1]),i.attributes.URI&&(i.uri=i.attributes.URI),i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes.RESOLUTION&&(i.attributes.RESOLUTION=d2(i.attributes.RESOLUTION)),i.attributes["AVERAGE-BANDWIDTH"]&&(i.attributes["AVERAGE-BANDWIDTH"]=parseInt(i.attributes["AVERAGE-BANDWIDTH"],10)),i.attributes["FRAME-RATE"]&&(i.attributes["FRAME-RATE"]=parseFloat(i.attributes["FRAME-RATE"])),this.trigger("data",i);return}if(t=/^#EXT-X-DEFINE:(.*)$/.exec(s),t){i={type:"tag",tagType:"define"},i.attributes=Hi(t[1]),this.trigger("data",i);return}this.trigger("data",{type:"tag",data:s.slice(4)})})}addParser({expression:e,customType:t,dataParser:i,segment:r}){typeof i!="function"&&(i=s=>s),this.customParsers.push(s=>{if(e.exec(s))return this.trigger("data",{type:"custom",data:i(s),customType:t,segment:r}),!0})}addTagMapper({expression:e,map:t}){const i=r=>e.test(r)?t(r):r;this.tagMappers.push(i)}}const S3=n=>n.toLowerCase().replace(/-(\w)/g,e=>e[1].toUpperCase()),Is=function(n){const e={};return Object.keys(n).forEach(function(t){e[S3(t)]=n[t]}),e},Op=function(n){const{serverControl:e,targetDuration:t,partTargetDuration:i}=n;if(!e)return;const r="#EXT-X-SERVER-CONTROL",s="holdBack",a="partHoldBack",o=t&&t*3,l=i&&i*2;t&&!e.hasOwnProperty(s)&&(e[s]=o,this.trigger("info",{message:`${r} defaulting HOLD-BACK to targetDuration * 3 (${o}).`})),o&&e[s]<o&&(this.trigger("warn",{message:`${r} clamping HOLD-BACK (${e[s]}) to targetDuration * 3 (${o})`}),e[s]=o),i&&!e.hasOwnProperty(a)&&(e[a]=i*3,this.trigger("info",{message:`${r} defaulting PART-HOLD-BACK to partTargetDuration * 3 (${e[a]}).`})),i&&e[a]<l&&(this.trigger("warn",{message:`${r} clamping PART-HOLD-BACK (${e[a]}) to partTargetDuration * 2 (${l}).`}),e[a]=l)};class x3 extends Mp{constructor(e={}){super(),this.lineStream=new v3,this.parseStream=new A3,this.lineStream.pipe(this.parseStream),this.mainDefinitions=e.mainDefinitions||{},this.params=new URL(e.uri,"https://a.com").searchParams,this.lastProgramDateTime=null;const t=this,i=[];let r={},s,a,o=!1;const l=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},h="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";let d=0;this.manifest={allowCache:!0,discontinuityStarts:[],dateRanges:[],iFramePlaylists:[],segments:[]};let p=0,g=0;const m={};this.on("end",()=>{r.uri||!r.parts&&!r.preloadHints||(!r.map&&s&&(r.map=s),!r.key&&a&&(r.key=a),!r.timeline&&typeof d=="number"&&(r.timeline=d),this.manifest.preloadSegment=r)}),this.parseStream.on("data",function(y){let b,A;if(t.manifest.definitions){for(const w in t.manifest.definitions)if(y.uri&&(y.uri=y.uri.replace(`{$${w}}`,t.manifest.definitions[w])),y.attributes)for(const x in y.attributes)typeof y.attributes[x]=="string"&&(y.attributes[x]=y.attributes[x].replace(`{$${w}}`,t.manifest.definitions[w]))}({tag(){({version(){y.version&&(this.manifest.version=y.version)},"allow-cache"(){this.manifest.allowCache=y.allowed,"allowed"in y||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange(){const w={};"length"in y&&(r.byterange=w,w.length=y.length,"offset"in y||(y.offset=p)),"offset"in y&&(r.byterange=w,w.offset=y.offset),p=w.offset+w.length},endlist(){this.manifest.endList=!0},inf(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),y.title&&(r.title=y.title),y.duration>0&&(r.duration=y.duration),y.duration===0&&(r.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=i},key(){if(!y.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(y.attributes.METHOD==="NONE"){a=null;return}if(!y.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(y.attributes.KEYFORMAT==="com.apple.streamingkeydelivery"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:y.attributes};return}if(y.attributes.KEYFORMAT==="com.microsoft.playready"){this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.microsoft.playready"]={uri:y.attributes.URI};return}if(y.attributes.KEYFORMAT===h){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(y.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(y.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),y.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(y.attributes.KEYID&&y.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection=this.manifest.contentProtection||{},this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:y.attributes.KEYFORMAT,keyId:y.attributes.KEYID.substring(2)},pssh:y3(y.attributes.URI.split(",")[1])};return}y.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:y.attributes.METHOD||"AES-128",uri:y.attributes.URI},typeof y.attributes.IV<"u"&&(a.iv=y.attributes.IV)},"media-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+y.number});return}this.manifest.mediaSequence=y.number},"discontinuity-sequence"(){if(!isFinite(y.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+y.number});return}this.manifest.discontinuitySequence=y.number,d=y.number},"playlist-type"(){if(!/VOD|EVENT/.test(y.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+y.playlist});return}this.manifest.playlistType=y.playlistType},map(){s={},y.uri&&(s.uri=y.uri),y.byterange&&(s.byterange=y.byterange),a&&(s.key=a)},"stream-inf"(){if(this.manifest.playlists=i,this.manifest.mediaGroups=this.manifest.mediaGroups||u,!y.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}r.attributes||(r.attributes={}),mo(r.attributes,y.attributes)},media(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,!(y.attributes&&y.attributes.TYPE&&y.attributes["GROUP-ID"]&&y.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}const w=this.manifest.mediaGroups[y.attributes.TYPE];w[y.attributes["GROUP-ID"]]=w[y.attributes["GROUP-ID"]]||{},b=w[y.attributes["GROUP-ID"]],A={default:/yes/i.test(y.attributes.DEFAULT)},A.default?A.autoselect=!0:A.autoselect=/yes/i.test(y.attributes.AUTOSELECT),y.attributes.LANGUAGE&&(A.language=y.attributes.LANGUAGE),y.attributes.URI&&(A.uri=y.attributes.URI),y.attributes["INSTREAM-ID"]&&(A.instreamId=y.attributes["INSTREAM-ID"]),y.attributes.CHARACTERISTICS&&(A.characteristics=y.attributes.CHARACTERISTICS),y.attributes.FORCED&&(A.forced=/yes/i.test(y.attributes.FORCED)),b[y.attributes.NAME]=A},discontinuity(){d+=1,r.discontinuity=!0,this.manifest.discontinuityStarts.push(i.length)},"program-date-time"(){typeof this.manifest.dateTimeString>"u"&&(this.manifest.dateTimeString=y.dateTimeString,this.manifest.dateTimeObject=y.dateTimeObject),r.dateTimeString=y.dateTimeString,r.dateTimeObject=y.dateTimeObject;const{lastProgramDateTime:w}=this;this.lastProgramDateTime=new Date(y.dateTimeString).getTime(),w===null&&this.manifest.segments.reduceRight((x,N)=>(N.programDateTime=x-N.duration*1e3,N.programDateTime),this.lastProgramDateTime)},targetduration(){if(!isFinite(y.duration)||y.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+y.duration});return}this.manifest.targetDuration=y.duration,Op.call(this,this.manifest)},start(){if(!y.attributes||isNaN(y.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:y.attributes["TIME-OFFSET"],precise:y.attributes.PRECISE}},"cue-out"(){r.cueOut=y.data},"cue-out-cont"(){r.cueOutCont=y.data},"cue-in"(){r.cueIn=y.data},skip(){this.manifest.skip=Is(y.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",y.attributes,["SKIPPED-SEGMENTS"])},part(){o=!0;const w=this.manifest.segments.length,x=Is(y.attributes);r.parts=r.parts||[],r.parts.push(x),x.byterange&&(x.byterange.hasOwnProperty("offset")||(x.byterange.offset=g),g=x.byterange.offset+x.byterange.length);const N=r.parts.length-1;this.warnOnMissingAttributes_(`#EXT-X-PART #${N} for segment #${w}`,y.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((F,L)=>{F.hasOwnProperty("lastPart")||this.trigger("warn",{message:`#EXT-X-RENDITION-REPORT #${L} lacks required attribute(s): LAST-PART`})})},"server-control"(){const w=this.manifest.serverControl=Is(y.attributes);w.hasOwnProperty("canBlockReload")||(w.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),Op.call(this,this.manifest),w.canSkipDateranges&&!w.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint"(){const w=this.manifest.segments.length,x=Is(y.attributes),N=x.type&&x.type==="PART";r.preloadHints=r.preloadHints||[],r.preloadHints.push(x),x.byterange&&(x.byterange.hasOwnProperty("offset")||(x.byterange.offset=N?g:0,N&&(g=x.byterange.offset+x.byterange.length)));const F=r.preloadHints.length-1;if(this.warnOnMissingAttributes_(`#EXT-X-PRELOAD-HINT #${F} for segment #${w}`,y.attributes,["TYPE","URI"]),!!x.type)for(let L=0;L<r.preloadHints.length-1;L++){const C=r.preloadHints[L];C.type&&C.type===x.type&&this.trigger("warn",{message:`#EXT-X-PRELOAD-HINT #${F} for segment #${w} has the same TYPE ${x.type} as preload hint #${L}`})}},"rendition-report"(){const w=Is(y.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(w);const x=this.manifest.renditionReports.length-1,N=["LAST-MSN","URI"];o&&N.push("LAST-PART"),this.warnOnMissingAttributes_(`#EXT-X-RENDITION-REPORT #${x}`,y.attributes,N)},"part-inf"(){this.manifest.partInf=Is(y.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",y.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),Op.call(this,this.manifest)},daterange(){this.manifest.dateRanges.push(Is(y.attributes));const w=this.manifest.dateRanges.length-1;this.warnOnMissingAttributes_(`#EXT-X-DATERANGE #${w}`,y.attributes,["ID","START-DATE"]);const x=this.manifest.dateRanges[w];x.endDate&&x.startDate&&new Date(x.endDate)<new Date(x.startDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE END-DATE must be equal to or later than the value of the START-DATE"}),x.duration&&x.duration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE DURATION must not be negative"}),x.plannedDuration&&x.plannedDuration<0&&this.trigger("warn",{message:"EXT-X-DATERANGE PLANNED-DURATION must not be negative"});const N=!!x.endOnNext;if(N&&!x.class&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must have a CLASS attribute"}),N&&(x.duration||x.endDate)&&this.trigger("warn",{message:"EXT-X-DATERANGE with an END-ON-NEXT=YES attribute must not contain DURATION or END-DATE attributes"}),x.duration&&x.endDate){const L=x.startDate.getTime()+x.duration*1e3;this.manifest.dateRanges[w].endDate=new Date(L)}if(!m[x.id])m[x.id]=x;else{for(const L in m[x.id])if(x[L]&&JSON.stringify(m[x.id][L])!==JSON.stringify(x[L])){this.trigger("warn",{message:"EXT-X-DATERANGE tags with the same ID in a playlist must have the same attributes values"});break}const F=this.manifest.dateRanges.findIndex(L=>L.id===x.id);this.manifest.dateRanges[F]=mo(this.manifest.dateRanges[F],x),m[x.id]=mo(m[x.id],x),this.manifest.dateRanges.pop()}},"independent-segments"(){this.manifest.independentSegments=!0},"i-frames-only"(){this.manifest.iFramesOnly=!0,this.requiredCompatibilityversion(this.manifest.version,4)},"content-steering"(){this.manifest.contentSteering=Is(y.attributes),this.warnOnMissingAttributes_("#EXT-X-CONTENT-STEERING",y.attributes,["SERVER-URI"])},define(){this.manifest.definitions=this.manifest.definitions||{};const w=(x,N)=>{if(x in this.manifest.definitions){this.trigger("error",{message:`EXT-X-DEFINE: Duplicate name ${x}`});return}this.manifest.definitions[x]=N};if("QUERYPARAM"in y.attributes){if("NAME"in y.attributes||"IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}const x=this.params.get(y.attributes.QUERYPARAM);if(!x){this.trigger("error",{message:`EXT-X-DEFINE: No query param ${y.attributes.QUERYPARAM}`});return}w(y.attributes.QUERYPARAM,decodeURIComponent(x));return}if("NAME"in y.attributes){if("IMPORT"in y.attributes){this.trigger("error",{message:"EXT-X-DEFINE: Invalid attributes"});return}if(!("VALUE"in y.attributes)||typeof y.attributes.VALUE!="string"){this.trigger("error",{message:`EXT-X-DEFINE: No value for ${y.attributes.NAME}`});return}w(y.attributes.NAME,y.attributes.VALUE);return}if("IMPORT"in y.attributes){if(!this.mainDefinitions[y.attributes.IMPORT]){this.trigger("error",{message:`EXT-X-DEFINE: No value ${y.attributes.IMPORT} to import, or IMPORT used on main playlist`});return}w(y.attributes.IMPORT,this.mainDefinitions[y.attributes.IMPORT]);return}this.trigger("error",{message:"EXT-X-DEFINE: No attribute"})},"i-frame-playlist"(){this.manifest.iFramePlaylists.push({attributes:y.attributes,uri:y.uri,timeline:d}),this.warnOnMissingAttributes_("#EXT-X-I-FRAME-STREAM-INF",y.attributes,["BANDWIDTH","URI"])}}[y.tagType]||l).call(t)},uri(){r.uri=y.uri,i.push(r),this.manifest.targetDuration&&!("duration"in r)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),r.duration=this.manifest.targetDuration),a&&(r.key=a),r.timeline=d,s&&(r.map=s),g=0,this.lastProgramDateTime!==null&&(r.programDateTime=this.lastProgramDateTime,this.lastProgramDateTime+=r.duration*1e3),r={}},comment(){},custom(){y.segment?(r.custom=r.custom||{},r.custom[y.customType]=y.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[y.customType]=y.data)}})[y.type].call(t)})}requiredCompatibilityversion(e,t){(e<t||!e)&&this.trigger("warn",{message:`manifest must be at least version ${t}`})}warnOnMissingAttributes_(e,t,i){const r=[];i.forEach(function(s){t.hasOwnProperty(s)||r.push(s)}),r.length&&this.trigger("warn",{message:`${e} lacks required attribute(s): ${r.join(", ")}`})}push(e){this.lineStream.push(e)}end(){this.lineStream.push(`
`),this.manifest.dateRanges.length&&this.lastProgramDateTime===null&&this.trigger("warn",{message:"A playlist with EXT-X-DATERANGE tag must contain atleast one EXT-X-PROGRAM-DATE-TIME tag"}),this.lastProgramDateTime=null,this.trigger("end")}addParser(e){this.parseStream.addParser(e)}addTagMapper(e){this.parseStream.addTagMapper(e)}}const Ri=[];for(let n=0;n<256;++n)Ri.push((n+256).toString(16).slice(1));function T3(n,e=0){return(Ri[n[e+0]]+Ri[n[e+1]]+Ri[n[e+2]]+Ri[n[e+3]]+"-"+Ri[n[e+4]]+Ri[n[e+5]]+"-"+Ri[n[e+6]]+Ri[n[e+7]]+"-"+Ri[n[e+8]]+Ri[n[e+9]]+"-"+Ri[n[e+10]]+Ri[n[e+11]]+Ri[n[e+12]]+Ri[n[e+13]]+Ri[n[e+14]]+Ri[n[e+15]]).toLowerCase()}let Fp;const w3=new Uint8Array(16);function D3(){if(!Fp){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Fp=crypto.getRandomValues.bind(crypto)}return Fp(w3)}const f2={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function R3(n,e,t){var r;if(f2.randomUUID&&!n)return f2.randomUUID();n=n||{};const i=n.random??((r=n.rng)==null?void 0:r.call(n))??D3();if(i.length<16)throw new Error("Random bytes length must be >= 16");return i[6]=i[6]&15|64,i[8]=i[8]&63|128,T3(i)}class g2{constructor(){X(this,"punctuationSubtitleService",new Vn)}async parserSubtitle(e,t,i){const r=await this.parseMasterManifest(e);return this.parserSubtitleByManifest(r,t,e,i)}async parserSubtitleByManifest(e,t,i,r){var s;if(e.segments.length===1&&e.segments[0].uri.endsWith(".vtt")){const a=this.resolveSegmentUrl(e.segments[0],i),o=await _p.fetchText(a);return await new u2().parse(o,r)}else{const a=(s=e.mediaGroups)==null?void 0:s.SUBTITLES;if(!a||Object.keys(a).length===0)return;const o=this.getSubtitleUrl(a,t);if(!o){console.error(`Subtitle track not found for language: ${t}`);return}return await this.parserSubtitlesBySubtitleUrl(o)}}async parserSubtitlesBySubtitleUrl(e){const t=await this.parseMasterManifest(e),i=await this.extractSegmentUrls(t,e);let r=It.convertVttEntriesToSubtitles(i);return r.hasPunctuation?{hasPunctuation:!0,subtitles:this.punctuationSubtitleService.segmentSubtitlesBySentence(r.subtitles),originSubtitles:r.originSubtitles}:r}extractSegmentUrls(e,t){return In.of(e.segments).map(i=>this.resolveSegmentUrl(i,t)).map(i=>_p.fetchText(i).then(r=>go(r)).then(r=>r.cues)).flatten().map(i=>i).distinct(i=>i.id&&i.id.length>0?i.id:R3()).toArray()}resolveSegmentUrl(e,t){let i=e.uri;return i.startsWith("https://")||(i=new URL(i,t).href),i}async parseMasterManifest(e){const t=await _p.fetchText(e);return this.parseManifest(t)}async parseManifestFromUrl(e){return this.parseMasterManifest(e)}parseManifest(e){const t=new x3;return t.push(e),t.end(),t.manifest}getSubtitleUrl(e,t){for(const[i,r]of Object.entries(e))for(const[s,a]of Object.entries(r))if(a.language===t)return a.uri}parserSubtitleMetadataArray(e){var a;const t=e.getParam("m3u8Manifest"),i=e.getParam("mediaUrl"),r=[],s=(a=t.mediaGroups)==null?void 0:a.SUBTITLES;if(s&&Object.keys(s).length>0){for(const[o,l]of Object.entries(s))for(const[u,h]of Object.entries(l))r.push({url:Qi.resolveUrl(h.uri,i),language:h.language||"unknown",isAsr:!1,hasPunctuation:!0});return r}if(t.segments&&t.segments.length>0){const o=t.segments[0].uri;if(o&&o.endsWith(".vtt"))return r.push({url:i,language:"unknown",isAsr:!1,hasPunctuation:!0}),r}return[]}}const I3="x-youtubedubbing",C3="youtubedubbing";function N3(n){const e=n||(typeof window<"u"?window.location.hostname:"");return e.includes("x.com")||e.includes("twitter.com")||e.includes("twimg.com")}async function p2(n,e){let t;try{t=new URL(n).hostname}catch{}if(N3(t)){const r=new Headers(e==null?void 0:e.headers);return r.set(I3,"true"),fetch(n,{...e,headers:r})}const i=Qi.addParam(n,C3,"true");return fetch(i,e)}class m2{static getCleanFetch(){if(this.cleanFetch)return this.cleanFetch;const e=document.createElement("iframe");e.style.display="none",document.documentElement.appendChild(e);const t=e.contentWindow;if(!t||!t.fetch)throw document.documentElement.removeChild(e),new Error("Failed to get clean fetch from iframe");return this.cleanFetch=t.fetch.bind(window),document.documentElement.removeChild(e),this.cleanFetch}static reset(){this.cleanFetch=null}}X(m2,"cleanFetch",null);class Mi{constructor(){X(this,"m3u8ParserService",new g2)}observeMediaMetadata(e){return this.createMetadataObservable(e).pipe(vt(i=>this.transformMetadata(i,e.siteDubbingRules)))}extractMediaMetadata(e,t,i){var o;const r=Yt.extractVideoId(e.videoIdExtract,t),s=Yt.extractTitle(e.titleExtract,t),a=this.getBestSubtitle(e,t);return{videoId:r,title:s,subtitleMetadata:a,subtitleLevel:a!=null&&a.isAsr?Di.RED:Di.YELLOW,videoLanguage:Yt.extractVideoLanguage(e,t),isPrivate:e.isPrivateExtract?new tP().getIsPrivate(e.isPrivateExtract,t):!1,channelId:e.channelIdExtract?new iP().getChannelId(e.channelIdExtract,t):"",duration:e.durationExtract?new rP().extractDuration(e.durationExtract,t):((o=t.media)==null?void 0:o.duration)??0,isLiveVideo:i,supportLanguageCode:e.supportedLanguageExtract?new nP().extractSupportLanguage(e.supportedLanguageExtract,t):["SG"],subtitles:[],originSubtitles:[]}}getBestSubtitle(e,t){return new zb().getBestSubtitle(e.subtitleExtract,t)}async transformMetadata(e,t){if(e.subtitleMetadata===void 0)return e;if(t.subtitleFormat==="m3u8"){const i=await this.m3u8ParserService.parserSubtitle(e.subtitleMetadata.url,e.subtitleMetadata.language,t);i&&(e.originSubtitles=i.originSubtitles,e.subtitles=i.subtitles,e.subtitleMetadata.hasPunctuation=i.hasPunctuation)}else{const r=await m2.getCleanFetch()(e.subtitleMetadata.url);if(r.ok){const s=await r.text(),a=await this.parseSubtitle(s,t);e.originSubtitles=a.originSubtitles,e.subtitles=a.subtitles,e.subtitleMetadata.hasPunctuation=a.hasPunctuation}}return e}async parseSubtitle(e,t){return t.subtitleFormat==="vtt"||t.subtitleFormat==="srt"?new u2().parse(e,t):new d3().parse(e,t)}matchUrl(e,t){return t.urlMatchType==="includes"?e.includes(t.url):!e.startsWith("https")||t.urlExclude&&new bi(t.urlExclude).includes(e)?!1:new bi(t.url).includes(e)}filterRequest(e,t,i,r){return i.urlRequestMethod.toLowerCase()===e.toLowerCase()&&this.matchUrl(t,i)&&r.dubbingPages.some(s=>new bi(s).includes(window.location.href))}}class y2 extends Mi{createMetadataObservable(e){if(e.siteDubbingRules.domTrackConfig===void 0)throw console.error("DomBasedMediaMetadataService: domTrackConfig is undefined for site",e.siteDubbingRules),new Error("the website is missing the domTrackConfig configuration.");const t=e.siteDubbingRules.mediaSelector;return lu(0,200).pipe(Ht(()=>{const r=this.findMedia(t);if(!r)return null;if((e.siteDubbingRules.subtitleFormat==="m3u8"||e.siteDubbingRules.site==="khanacademy"||e.siteDubbingRules.site==="kaltura")&&this.findTracks(r).length===0){if(e.siteDubbingRules.site==="khanacademy"||e.siteDubbingRules.site==="kaltura")return null;if(Le(r).find("source").length>0)return null}return r.currentSrc||r.src}),Zt(r=>r!=null&&r!==""),W0()).pipe(vt(r=>{const s=window.location.href;if(!this.matchDubbingPages(s,e.siteDubbingRules.dubbingPages))return jr;const o=this.findMedia(t),l=new si(o,e.tabTitle);return e.siteDubbingRules.domTrackConfig.parseConfig.isLiveVideoExtract?Xt(new xS().getIsLive(e.siteDubbingRules.domTrackConfig.parseConfig.isLiveVideoExtract,l)).pipe(Ht(u=>this.extractMediaMetadata(e.siteDubbingRules.domTrackConfig.parseConfig,l,u))):Vt(this.extractMediaMetadata(e.siteDubbingRules.domTrackConfig.parseConfig,l,!1))}))}findTracks(e){return Le(e).find('track[kind="captions"], track[kind="subtitles"]')}findMedia(e){return document.querySelector(e)}extractMediaMetadata(e,t,i){var r,s;return{videoId:Yt.extractVideoId(e.videoIdExtract,t),title:Yt.extractTitle(e.titleExtract,t),subtitleMetadata:this.getBestSubtitle(e,t),subtitleLevel:Di.YELLOW,videoLanguage:Yt.extractVideoLanguage(e,t),isPrivate:!1,channelId:"",duration:Number.isFinite((r=t.media)==null?void 0:r.duration)?(s=t.media)==null?void 0:s.duration:0,isLiveVideo:i,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}getBestSubtitle(e,t){return new U1().getBestSubtitle(e.subtitleExtract,t)}matchDubbingPages(e,t){return t.some(i=>{const r="\0WILDCARD\0";let s=i.replace(/\*/g,r);s=s.replace(/[.+?^${}()|[\]\\]/g,"\\$&"),s=s.replace(new RegExp(r,"g"),".*");try{return new RegExp(`^${s}$`).test(e)}catch(a){return console.error("[DomBasedMediaMetadataService] Invalid dubbingPages pattern:",i,a),!1}})}}class Nc{async getIsLive(e,t){if(!t.data)throw console.error("Context vo object is missing, unable to extract live video status using JSONPath",t),Error("Context vo object is missing, unable to extract live video status using JSONPath");if(_t.isEmpty(e.values))throw console.error("Live video extraction configuration is missing JSONPath values property",e),new Error("Live video extraction configuration is missing JSONPath values property");return Yt.extractBooleanByJsonPath(e.values,e.computeType,t.data)}}class v2 extends Mi{createMetadataObservable(e){var a;if(e.siteDubbingRules.windowVariableConfig===void 0)throw console.error("WindowBasedMediaMetadataService: windowVariableConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the windowVariableConfig configuration.");const t=document.querySelector(e.siteDubbingRules.mediaSelector),i=e.siteDubbingRules.windowVariableConfig,r=on(window,i.variableJsonPath);if(!r)return jr;const s=new si(t,e.tabTitle,r);return(a=i.parseConfig)!=null&&a.isLiveVideoExtract?Xt(new Nc().getIsLive(i.parseConfig.isLiveVideoExtract,s)).pipe(Ht(o=>this.extractMediaMetadata(i.parseConfig,s,o))):Vt(this.extractMediaMetadata(i.parseConfig,s,!1))}}var Cl={exports:{}},L3=Cl.exports,b2;function _3(){return b2||(b2=1,function(n,e){(function(t,i){var r="1.0.40",s="",a="?",o="function",l="undefined",u="object",h="string",d="major",p="model",g="name",m="type",y="vendor",b="version",A="architecture",w="console",x="mobile",N="tablet",F="smarttv",L="wearable",C="embedded",M=500,_="Amazon",R="Apple",U="ASUS",q="BlackBerry",$="Browser",Y="Chrome",ae="Edge",ne="Firefox",ce="Google",re="Huawei",V="LG",J="Microsoft",ve="Motorola",pe="Opera",Te="Samsung",Ce="Sharp",Re="Sony",Be="Xiaomi",Ue="Zebra",Qe="Facebook",Ze="Chromium OS",qe="Mac OS",nt=" Browser",B=function(se,le){var xe={};for(var We in se)le[We]&&le[We].length%2===0?xe[We]=le[We].concat(se[We]):xe[We]=se[We];return xe},oe=function(se){for(var le={},xe=0;xe<se.length;xe++)le[se[xe].toUpperCase()]=se[xe];return le},Ae=function(se,le){return typeof se===h?be(le).indexOf(be(se))!==-1:!1},be=function(se){return se.toLowerCase()},me=function(se){return typeof se===h?se.replace(/[^\d\.]/g,s).split(".")[0]:i},Ie=function(se,le){if(typeof se===h)return se=se.replace(/^\s\s*/,s),typeof le===l?se:se.substring(0,M)},Me=function(se,le){for(var xe=0,We,ri,kt,ft,Ve,Si;xe<le.length&&!Ve;){var wr=le[xe],ee=le[xe+1];for(We=ri=0;We<wr.length&&!Ve&&wr[We];)if(Ve=wr[We++].exec(se),Ve)for(kt=0;kt<ee.length;kt++)Si=Ve[++ri],ft=ee[kt],typeof ft===u&&ft.length>0?ft.length===2?typeof ft[1]==o?this[ft[0]]=ft[1].call(this,Si):this[ft[0]]=ft[1]:ft.length===3?typeof ft[1]===o&&!(ft[1].exec&&ft[1].test)?this[ft[0]]=Si?ft[1].call(this,Si,ft[2]):i:this[ft[0]]=Si?Si.replace(ft[1],ft[2]):i:ft.length===4&&(this[ft[0]]=Si?ft[3].call(this,Si.replace(ft[1],ft[2])):i):this[ft]=Si||i;xe+=2}},ue=function(se,le){for(var xe in le)if(typeof le[xe]===u&&le[xe].length>0){for(var We=0;We<le[xe].length;We++)if(Ae(le[xe][We],se))return xe===a?i:xe}else if(Ae(le[xe],se))return xe===a?i:xe;return le.hasOwnProperty("*")?le["*"]:se},K={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},D={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},S={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[b,[g,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[b,[g,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[g,b],[/opios[\/ ]+([\w\.]+)/i],[b,[g,pe+" Mini"]],[/\bop(?:rg)?x\/([\w\.]+)/i],[b,[g,pe+" GX"]],[/\bopr\/([\w\.]+)/i],[b,[g,pe]],[/\bb[ai]*d(?:uhd|[ub]*[aekoprswx]{5,6})[\/ ]?([\w\.]+)/i],[b,[g,"Baidu"]],[/\b(?:mxbrowser|mxios|myie2)\/?([-\w\.]*)\b/i],[b,[g,"Maxthon"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer|sleipnir)[\/ ]?([\w\.]*)/i,/(avant|iemobile|slim(?:browser|boat|jet))[\/ ]?([\d\.]*)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|duckduckgo|klar|helio|(?=comodo_)?dragon)\/([-\w\.]+)/i,/(heytap|ovi|115)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[g,b],[/quark(?:pc)?\/([-\w\.]+)/i],[b,[g,"Quark"]],[/\bddg\/([\w\.]+)/i],[b,[g,"DuckDuckGo"]],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[b,[g,"UC"+$]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i,/micromessenger\/([\w\.]+)/i],[b,[g,"WeChat"]],[/konqueror\/([\w\.]+)/i],[b,[g,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[b,[g,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[b,[g,"Yandex"]],[/slbrowser\/([\w\.]+)/i],[b,[g,"Smart Lenovo "+$]],[/(avast|avg)\/([\w\.]+)/i],[[g,/(.+)/,"$1 Secure "+$],b],[/\bfocus\/([\w\.]+)/i],[b,[g,ne+" Focus"]],[/\bopt\/([\w\.]+)/i],[b,[g,pe+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[b,[g,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[b,[g,"Dolphin"]],[/coast\/([\w\.]+)/i],[b,[g,pe+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[b,[g,"MIUI"+nt]],[/fxios\/([\w\.-]+)/i],[b,[g,ne]],[/\bqihoobrowser\/?([\w\.]*)/i],[b,[g,"360"]],[/\b(qq)\/([\w\.]+)/i],[[g,/(.+)/,"$1Browser"],b],[/(oculus|sailfish|huawei|vivo|pico)browser\/([\w\.]+)/i],[[g,/(.+)/,"$1"+nt],b],[/samsungbrowser\/([\w\.]+)/i],[b,[g,Te+" Internet"]],[/metasr[\/ ]?([\d\.]+)/i],[b,[g,"Sogou Explorer"]],[/(sogou)mo\w+\/([\d\.]+)/i],[[g,"Sogou Mobile"],b],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|2345(?=browser|chrome|explorer))\w*[\/ ]?v?([\w\.]+)/i],[g,b],[/(lbbrowser|rekonq)/i,/\[(linkedin)app\]/i],[g],[/ome\/([\w\.]+) \w* ?(iron) saf/i,/ome\/([\w\.]+).+qihu (360)[es]e/i],[b,g],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[g,Qe],b],[/(Klarna)\/([\w\.]+)/i,/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(alipay)client\/([\w\.]+)/i,/(twitter)(?:and| f.+e\/([\w\.]+))/i,/(chromium|instagram|snapchat)[\/ ]([-\w\.]+)/i],[g,b],[/\bgsa\/([\w\.]+) .*safari\//i],[b,[g,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[b,[g,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[b,[g,Y+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[g,Y+" WebView"],b],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[b,[g,"Android "+$]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[g,b],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[b,[g,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[b,g],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[g,[b,ue,K]],[/(webkit|khtml)\/([\w\.]+)/i],[g,b],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[g,"Netscape"],b],[/(wolvic|librewolf)\/([\w\.]+)/i],[g,b],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[b,[g,ne+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[g,[b,/_/g,"."]],[/(cobalt)\/([\w\.]+)/i],[g,[b,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[A,"amd64"]],[/(ia32(?=;))/i],[[A,be]],[/((?:i[346]|x)86)[;\)]/i],[[A,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[A,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[A,"armhf"]],[/windows (ce|mobile); ppc;/i],[[A,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[A,/ower/,s,be]],[/(sun4\w)[;\)]/i],[[A,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[A,be]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[p,[y,Te],[m,N]],[/\b((?:s[cgp]h|gt|sm)-(?![lr])\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]((?!sm-[lr])[-\w]+)/i,/sec-(sgh\w+)/i],[p,[y,Te],[m,x]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[p,[y,R],[m,x]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[p,[y,R],[m,N]],[/(macintosh);/i],[p,[y,R]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[p,[y,Ce],[m,x]],[/(?:honor)([-\w ]+)[;\)]/i],[p,[y,"Honor"],[m,x]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[p,[y,re],[m,N]],[/(?:huawei)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[p,[y,re],[m,x]],[/\b(poco[\w ]+|m2\d{3}j\d\d[a-z]{2})(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/oid[^\)]+; (m?[12][0-389][01]\w{3,6}[c-y])( bui|; wv|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite|pro)?)(?: bui|\))/i],[[p,/_/g," "],[y,Be],[m,x]],[/oid[^\)]+; (2\d{4}(283|rpbf)[cgl])( bui|\))/i,/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[p,/_/g," "],[y,Be],[m,N]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[p,[y,"OPPO"],[m,x]],[/\b(opd2\d{3}a?) bui/i],[p,[y,"OPPO"],[m,N]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[p,[y,"Vivo"],[m,x]],[/\b(rmx[1-3]\d{3})(?: bui|;|\))/i],[p,[y,"Realme"],[m,x]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[p,[y,ve],[m,x]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[p,[y,ve],[m,N]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[p,[y,V],[m,N]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[p,[y,V],[m,x]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[p,[y,"Lenovo"],[m,N]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[p,/_/g," "],[y,"Nokia"],[m,x]],[/(pixel c)\b/i],[p,[y,ce],[m,N]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[p,[y,ce],[m,x]],[/droid.+; (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[p,[y,Re],[m,x]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[p,"Xperia Tablet"],[y,Re],[m,N]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[p,[y,"OnePlus"],[m,x]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo(?!bc)\w\w)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[p,[y,_],[m,N]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[p,/(.+)/g,"Fire Phone $1"],[y,_],[m,x]],[/(playbook);[-\w\),; ]+(rim)/i],[p,y,[m,N]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[p,[y,q],[m,x]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[p,[y,U],[m,N]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[p,[y,U],[m,x]],[/(nexus 9)/i],[p,[y,"HTC"],[m,N]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[y,[p,/_/g," "],[m,x]],[/droid [\w\.]+; ((?:8[14]9[16]|9(?:0(?:48|60|8[01])|1(?:3[27]|66)|2(?:6[69]|9[56])|466))[gqswx])\w*(\)| bui)/i],[p,[y,"TCL"],[m,N]],[/(itel) ((\w+))/i],[[y,be],p,[m,ue,{tablet:["p10001l","w7001"],"*":"mobile"}]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[p,[y,"Acer"],[m,N]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[p,[y,"Meizu"],[m,x]],[/; ((?:power )?armor(?:[\w ]{0,8}))(?: bui|\))/i],[p,[y,"Ulefone"],[m,x]],[/; (energy ?\w+)(?: bui|\))/i,/; energizer ([\w ]+)(?: bui|\))/i],[p,[y,"Energizer"],[m,x]],[/; cat (b35);/i,/; (b15q?|s22 flip|s48c|s62 pro)(?: bui|\))/i],[p,[y,"Cat"],[m,x]],[/((?:new )?andromax[\w- ]+)(?: bui|\))/i],[p,[y,"Smartfren"],[m,x]],[/droid.+; (a(?:015|06[35]|142p?))/i],[p,[y,"Nothing"],[m,x]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron|infinix|tecno|micromax|advan)[-_ ]?([-\w]*)/i,/; (imo) ((?!tab)[\w ]+?)(?: bui|\))/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[y,p,[m,x]],[/(imo) (tab \w+)/i,/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[y,p,[m,N]],[/(surface duo)/i],[p,[y,J],[m,N]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[p,[y,"Fairphone"],[m,x]],[/(u304aa)/i],[p,[y,"AT&T"],[m,x]],[/\bsie-(\w*)/i],[p,[y,"Siemens"],[m,x]],[/\b(rct\w+) b/i],[p,[y,"RCA"],[m,N]],[/\b(venue[\d ]{2,7}) b/i],[p,[y,"Dell"],[m,N]],[/\b(q(?:mv|ta)\w+) b/i],[p,[y,"Verizon"],[m,N]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[p,[y,"Barnes & Noble"],[m,N]],[/\b(tm\d{3}\w+) b/i],[p,[y,"NuVision"],[m,N]],[/\b(k88) b/i],[p,[y,"ZTE"],[m,N]],[/\b(nx\d{3}j) b/i],[p,[y,"ZTE"],[m,x]],[/\b(gen\d{3}) b.+49h/i],[p,[y,"Swiss"],[m,x]],[/\b(zur\d{3}) b/i],[p,[y,"Swiss"],[m,N]],[/\b((zeki)?tb.*\b) b/i],[p,[y,"Zeki"],[m,N]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[y,"Dragon Touch"],p,[m,N]],[/\b(ns-?\w{0,9}) b/i],[p,[y,"Insignia"],[m,N]],[/\b((nxa|next)-?\w{0,9}) b/i],[p,[y,"NextBook"],[m,N]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[y,"Voice"],p,[m,x]],[/\b(lvtel\-)?(v1[12]) b/i],[[y,"LvTel"],p,[m,x]],[/\b(ph-1) /i],[p,[y,"Essential"],[m,x]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[p,[y,"Envizen"],[m,N]],[/\b(trio[-\w\. ]+) b/i],[p,[y,"MachSpeed"],[m,N]],[/\btu_(1491) b/i],[p,[y,"Rotor"],[m,N]],[/(shield[\w ]+) b/i],[p,[y,"Nvidia"],[m,N]],[/(sprint) (\w+)/i],[y,p,[m,x]],[/(kin\.[onetw]{3})/i],[[p,/\./g," "],[y,J],[m,x]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[p,[y,Ue],[m,N]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[p,[y,Ue],[m,x]],[/smart-tv.+(samsung)/i],[y,[m,F]],[/hbbtv.+maple;(\d+)/i],[[p,/^/,"SmartTV"],[y,Te],[m,F]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[y,V],[m,F]],[/(apple) ?tv/i],[y,[p,R+" TV"],[m,F]],[/crkey/i],[[p,Y+"cast"],[y,ce],[m,F]],[/droid.+aft(\w+)( bui|\))/i],[p,[y,_],[m,F]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[p,[y,Ce],[m,F]],[/(bravia[\w ]+)( bui|\))/i],[p,[y,Re],[m,F]],[/(mitv-\w{5}) bui/i],[p,[y,Be],[m,F]],[/Hbbtv.*(technisat) (.*);/i],[y,p,[m,F]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[y,Ie],[p,Ie],[m,F]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,F]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[y,p,[m,w]],[/droid.+; (shield) bui/i],[p,[y,"Nvidia"],[m,w]],[/(playstation [345portablevi]+)/i],[p,[y,Re],[m,w]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[p,[y,J],[m,w]],[/\b(sm-[lr]\d\d[05][fnuw]?s?)\b/i],[p,[y,Te],[m,L]],[/((pebble))app/i],[y,p,[m,L]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[p,[y,R],[m,L]],[/droid.+; (glass) \d/i],[p,[y,ce],[m,L]],[/droid.+; (wt63?0{2,3})\)/i],[p,[y,Ue],[m,L]],[/droid.+; (glass) \d/i],[p,[y,ce],[m,L]],[/(pico) (4|neo3(?: link|pro)?)/i],[y,p,[m,L]],[/; (quest( \d| pro)?)/i],[p,[y,Qe],[m,L]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[y,[m,C]],[/(aeobc)\b/i],[p,[y,_],[m,C]],[/droid .+?; ([^;]+?)(?: bui|; wv\)|\) applew).+? mobile safari/i],[p,[m,x]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[p,[m,N]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,N]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,x]],[/(android[-\w\. ]{0,9});.+buil/i],[p,[y,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[b,[g,ae+"HTML"]],[/(arkweb)\/([\w\.]+)/i],[g,b],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[b,[g,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna|servo)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[g,b],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[b,g]],os:[[/microsoft (windows) (vista|xp)/i],[g,b],[/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i],[g,[b,ue,D]],[/windows nt 6\.2; (arm)/i,/windows[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i,/(?:win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[b,ue,D],[g,"Windows"]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/(?:ios;fbsv\/|iphone.+ios[\/ ])([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[b,/_/g,"."],[g,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[g,qe],[b,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[b,g],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish|openharmony)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[g,b],[/\(bb(10);/i],[b,[g,q]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[b,[g,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[b,[g,ne+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[b,[g,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[b,[g,"watchOS"]],[/crkey\/([\d\.]+)/i],[b,[g,Y+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[g,Ze],b],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[g,b],[/(sunos) ?([\w\.\d]*)/i],[[g,"Solaris"],b],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[g,b]]},P=function(se,le){if(typeof se===u&&(le=se,se=i),!(this instanceof P))return new P(se,le).getResult();var xe=typeof t!==l&&t.navigator?t.navigator:i,We=se||(xe&&xe.userAgent?xe.userAgent:s),ri=xe&&xe.userAgentData?xe.userAgentData:i,kt=le?B(S,le):S,ft=xe&&xe.userAgent==We;return this.getBrowser=function(){var Ve={};return Ve[g]=i,Ve[b]=i,Me.call(Ve,We,kt.browser),Ve[d]=me(Ve[b]),ft&&xe&&xe.brave&&typeof xe.brave.isBrave==o&&(Ve[g]="Brave"),Ve},this.getCPU=function(){var Ve={};return Ve[A]=i,Me.call(Ve,We,kt.cpu),Ve},this.getDevice=function(){var Ve={};return Ve[y]=i,Ve[p]=i,Ve[m]=i,Me.call(Ve,We,kt.device),ft&&!Ve[m]&&ri&&ri.mobile&&(Ve[m]=x),ft&&Ve[p]=="Macintosh"&&xe&&typeof xe.standalone!==l&&xe.maxTouchPoints&&xe.maxTouchPoints>2&&(Ve[p]="iPad",Ve[m]=N),Ve},this.getEngine=function(){var Ve={};return Ve[g]=i,Ve[b]=i,Me.call(Ve,We,kt.engine),Ve},this.getOS=function(){var Ve={};return Ve[g]=i,Ve[b]=i,Me.call(Ve,We,kt.os),ft&&!Ve[g]&&ri&&ri.platform&&ri.platform!="Unknown"&&(Ve[g]=ri.platform.replace(/chrome os/i,Ze).replace(/macos/i,qe)),Ve},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return We},this.setUA=function(Ve){return We=typeof Ve===h&&Ve.length>M?Ie(Ve,M):Ve,this},this.setUA(We),this};P.VERSION=r,P.BROWSER=oe([g,b,d]),P.CPU=oe([A]),P.DEVICE=oe([p,y,m,w,x,F,N,L,C]),P.ENGINE=P.OS=oe([g,b]),n.exports&&(e=n.exports=P),e.UAParser=P;var W=typeof t!==l&&(t.jQuery||t.Zepto);if(W&&!W.ua){var Se=new P;W.ua=Se.getResult(),W.ua.get=function(){return Se.getUA()},W.ua.set=function(se){Se.setUA(se);var le=Se.getResult();for(var xe in le)W.ua[xe]=le[xe]}}})(typeof window=="object"?window:L3)}(Cl,Cl.exports)),Cl.exports}var M3=_3();const k3=ms(M3);class Nl{static isIos(){var t;const{browser:e}=k3(navigator.userAgent);return Yb.isMobile()&&((t=e.name)==null?void 0:t.includes("Safari"))}static isFirefox(){return!0}}class Lc{constructor(){X(this,"rules",[{className:"SiteDubbingRules",domain:"*://*.youtube.com/*",excludeKeywords:["youtube.com/embed/?"],dubbingPages:["*://*.youtube.com/embed/*"],injectPages:["*://*.youtube.com/embed/*"],playBtnContainerSelector:".ytp-right-controls",playBtnCss:{btnCss:"youtube-dubbing-embed-button",logoCss:"youtube-dubbing-embed-logo",containerCss:"youtube-dubbing-embed-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/embed/:videoId","videoId"]},subtitleFetchMethod:"youtube",apiInterceptConfig:{url:"/youtubei/v1/player?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"POST",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},windowVariableConfig:{variableJsonPath:"$.ytInitialPlayerResponse",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},supportedLanguageExtract:{type:"jsonpath",value:"$.videoDetails.supportedLanguage"},videoLanguageExtract:{type:"asr"}}},playerConfig:{playerClass:"YouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.youtube-nocookie.com/*",dubbingPages:["*://*.youtube-nocookie.com/embed/*"],injectPages:["*://*.youtube-nocookie.com/embed/*"],playBtnContainerSelector:".ytp-right-controls",playBtnCss:{btnCss:"youtube-dubbing-embed-button",logoCss:"youtube-dubbing-embed-logo",containerCss:"youtube-dubbing-embed-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/embed/:videoId","videoId"]},subtitleFetchMethod:"youtube",apiInterceptConfig:{url:"/youtubei/v1/player?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"POST",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},windowVariableConfig:{variableJsonPath:"$.ytInitialPlayerResponse",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},supportedLanguageExtract:{type:"jsonpath",value:"$.videoDetails.supportedLanguage"},videoLanguageExtract:{type:"asr"}}},playerConfig:{playerClass:"YouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://youtube.googleapis.com/*",dubbingPages:["*://youtube.googleapis.com/embed/*"],injectPages:["*://youtube.googleapis.com/embed/*"],playBtnContainerSelector:"section[role='tabpanel']",playBtnCss:{btnCss:"youtube-dubbing-gdrive-button",logoCss:"youtube-dubbing-gdrive-logo",containerCss:"youtube-dubbing-gdrive-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"undefined",buildType:"raw",values:[]},subtitleFetchMethod:"google_drive_youtube",playerConfig:{playerClass:"GoogleDriveYouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"google_drive_youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.youtube.com/*",dubbingPages:["*://*.youtube.com/watch*","*://*.youtube.com/shorts/*","*://*.youtube.com/live/*"],injectPages:["*://*.youtube.com/*"],playBtnContainerSelector:".ytp-right-controls",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video.video-stream.html5-main-video",enabled:!0,videoIdExtract:{type:"multi-pattern",buildType:"raw",values:[this.getYoutubeMultiPatternExtractVideoIdConfig()]},subtitleFetchMethod:"youtube",apiInterceptConfig:{url:"/youtubei/v1/player?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"POST",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},windowVariableConfig:{variableJsonPath:"$.ytInitialPlayerResponse",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.captions.playerCaptionsTracklistRenderer.captionTracks",subtitleUrlName:"baseUrl",subtitleLanguageName:"languageCode",subtitleAsrName:"kind",subtitleAsrValue:"asr"},titleExtract:{type:"jsonPath",values:["$.videoDetails.title"]},videoIdExtract:{type:"jsonPath",buildType:"raw",values:["$.videoDetails.videoId"]},isPrivateExtract:{type:"jsonpath",values:["$.videoDetails.isPrivate"],computeType:"all"},isLiveVideoExtract:{type:"jsonpath",computeType:"any",values:["$.videoDetails.isLive"]},channelIdExtract:{type:"jsonpath",value:"$.videoDetails.channelId"},durationExtract:{type:"jsonpath",value:"$.videoDetails.lengthSeconds"},supportedLanguageExtract:{type:"jsonpath",value:"$.microformat.playerMicroformatRenderer.availableCountries"},videoLanguageExtract:{type:"asr"}}},playerConfig:{playerClass:"YouTubePlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"millisecond",site:"youtube",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://whop.com/*",dubbingPages:["*://whop.com/*"],injectPages:["*://whop.com/*"],playBtnContainerSelector:"mux-player",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"mux-player",enabled:!0,videoIdExtract:{type:"attr",buildType:"raw",values:["mux-player","playback-id"],prefix:"mux_"},subtitleFetchMethod:"mux",muxConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"language"},titleExtract:{type:"attr",values:["mux-player","title"]},videoIdExtract:{type:"attr",buildType:"raw",values:["mux-player","playback-id"],prefix:"mux_"}}},playerConfig:{playerClass:"MuxPlayer"},subtitleFormat:{subtitleListJsonPath:"$.transcript.text",subtitleStartTimeName:"offsetTimeMs",timeType:"duration",subtitleEndTimeName:"dur",subtitleTextName:"utf8"},subtitleTimeUnit:"second",site:"mux"},{className:"SiteDubbingRules",domain:"*://*.bilibili.com/*",dubbingPages:["*://*.bilibili.com/video*"],injectPages:["*://*.bilibili.com/*"],playBtnContainerSelector:".bpx-player-control-bottom-right",playBtnCss:{btnCss:"bili-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"multi-type",buildType:"join",buildParams:["_"],prefix:"bili_",values:[this.getBiliMultiTypeExtractVideoIdConfig()]},subtitleFetchMethod:"bili",apiInterceptConfig:{url:"/x/player/wbi/v2?",urlMatchType:"includes",urlRequestType:"ajax",urlRequestMethod:"GET",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.data.subtitle.subtitles",subtitleUrlName:"subtitle_url",subtitleLanguageName:"lan",subtitleAsrName:"type",subtitleAsrValue:"1"},titleExtract:{type:"selector",values:[".video-title"]},videoIdExtract:{type:"multi-type",buildType:"join",buildParams:["_"],prefix:"bili_",values:[this.getJSONBiliMultiTypeExtractVideoIdConfig()]},isPrivateExtract:{type:"jsonpath",values:["$.data.is_ugc_pay_preview","$.data.is_upower_exclusive","$.data.is_upower_play"],computeType:"any"}}},windowVariableConfig:{variableJsonPath:"$['__INITIAL_STATE__']",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.data.subtitle.subtitles",subtitleUrlName:"subtitle_url",subtitleLanguageName:"lan",subtitleAsrName:"type",subtitleAsrValue:"1"},titleExtract:{type:"selector",values:[".video-title"]},videoIdExtract:{type:"multi-type",buildType:"join",buildParams:["_"],prefix:"bili_",values:[this.getJSONBiliMultiTypeExtractVideoIdConfig()]}}},playerConfig:{playerClass:"BiliPlayer"},subtitleFormat:{subtitleListJsonPath:"$.body",subtitleStartTimeName:"from",timeType:"end",subtitleEndTimeName:"to",subtitleTextName:"content"},subtitleTimeUnit:"second",site:"bili",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.udemy.*/*",dubbingPages:["*://*.udemy.*/course/*/learn/lecture/*"],injectPages:["*://*.udemy.*/course/*/learn/*"],playBtnContainerSelector:'div[data-purpose="video-controls"]',playBtnCss:{btnCss:"udemy-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"udemy_",values:["/course/:course/learn/lecture/:id","id"]},subtitleFetchMethod:"udemy",apiInterceptConfig:{url:"*://*.udemy.*/api-2.0/users/me/subscribed-courses/*/lectures/*",urlMatchType:"pattern",urlExclude:"*://*.udemy.*/api-2.0/users/me/subscribed-courses/*/lectures/*/social-bookmarks/*",urlRequestType:"ajax",urlRequestMethod:"GET",parseConfig:{subtitleExtract:{subtitleListJsonPath:"$.asset.captions",subtitleUrlName:"url",subtitleLanguageName:"locale_id"},titleExtract:{type:"tab"},videoIdExtract:{type:"jsonPath",buildType:"raw",prefix:"udemy_",values:["$.id"]},durationExtract:{type:"jsonpath",value:"$.asset.length"}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"udemy",needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://iframe.mediadelivery.net/*",dubbingPages:["*://iframe.mediadelivery.net/embed/*"],injectPages:["*://iframe.mediadelivery.net/embed/*"],playBtnContainerSelector:".plyr__controls",playBtnCss:{btnCss:"gamedev-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"#main-video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"gamedev_",values:["/embed/:videoLibId/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"gamedev_",values:["/embed/:videoLibId/:videoId","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"gamedev",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://dev.epicgames.com/*",dubbingPages:["*://dev.epicgames.com/*/embed.html"],injectPages:["*://dev.epicgames.com/*/embed.html"],playBtnContainerSelector:".vjs-control-bar",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"epicgames_",values:["/community/api/:category/videos/:videoId/embed.html","videoId"]},subtitleFetchMethod:"videojs",videoJsConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"epicgames_",values:["/community/api/:category/videos/:videoId/embed.html","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"epicgames",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://*.coursera.org/*",dubbingPages:["*://*.coursera.org/learn/*/lecture/*"],injectPages:["*://*.coursera.org/learn/*"],playBtnContainerSelector:".icon-container > div:last-child",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"coursera_",values:["/learn/:a/lecture/:videoId/:b","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"coursera_",values:["/learn/:a/lecture/:videoId/:b","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"coursera",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://player.vimeo.com/*",dubbingPages:["*://player.vimeo.com/video/*"],injectPages:["*://player.vimeo.com/video/*"],playBtnContainerSelector:"div:has(> #fullscreen-control-bar-button)",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/video/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/video/:videoId","videoId"]}}},playerConfig:{playerClass:"VimeoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"vimeo",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://vimeo.com/*",dubbingPages:["*://vimeo.com/*"],injectPages:["*://vimeo.com/*"],playBtnContainerSelector:"div:has(> #fullscreen-control-bar-button)",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"vimeo_",values:["/:videoId","videoId"]}}},playerConfig:{playerClass:"VimeoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"vimeo",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://threejs-journey.com/lessons/*",dubbingPages:["*://threejs-journey.com/lessons/*"],injectPages:["*://threejs-journey.com/lessons/*"],playBtnContainerSelector:"div.undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"threejs_journey_",values:["/lessons/:videoId","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang",domKind:"metadata"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"threejs_journey_",values:["/lessons/:videoId","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"threejs_journey",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://*.dropbox.com/*",excludeKeywords:["ccpa_iframe"],dubbingPages:["*://*.dropbox.com/preview/*","*://*.dropbox.com/scl/fi/*","*://*.dropbox.com/home*"],injectPages:["*://*.dropbox.com/*"],playBtnContainerSelector:"div.undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"multi-pattern",buildType:"raw",values:[this.getDropboxMultiPatternExtractVideoIdConfig()]},subtitleFetchMethod:"dropbox",dropboxConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"multi-pattern",buildType:"raw",values:[this.getDropboxMultiPatternExtractVideoIdConfig()]}}},playerConfig:{playerClass:"DropboxPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"dropbox",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://mediaspace.illinois.edu/*",dubbingPages:["*://mediaspace.illinois.edu/media/*"],injectPages:["*://mediaspace.illinois.edu/*"],playBtnContainerSelector:".playkit-controls-container .playkit-right-controls",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"undefined",buildType:"raw",values:[]},subtitleFetchMethod:"commonM3u8",mediaParseConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"undefined",buildType:"raw",values:[]}}},playerConfig:{playerClass:"IllinoisPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"illinois",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://players.brightcove.net/*",dubbingPages:["*://players.brightcove.net/*"],injectPages:["*://players.brightcove.net/*"],playBtnContainerSelector:".vjs-control-bar",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["videoId"],prefix:"brightcove_"},subtitleFetchMethod:"commonM3u8",mediaParseConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["videoId"],prefix:"brightcove_"}}},playerConfig:{playerClass:"BrightcovePlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"brightcove_",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://player.hotmart.com/*",dubbingPages:["*://player.hotmart.com/embed/*"],injectPages:["*://player.hotmart.com/*"],playBtnContainerSelector:".vjs-control-bar",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"hotmart_",values:["/embed/:videoId","videoId"]},subtitleFetchMethod:"commonM3u8",mediaParseConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"hotmart_",values:["/embed/:videoId","videoId"]}}},playerConfig:{playerClass:"HotmartPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"hotmart",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://learn.deeplearning.ai/*",dubbingPages:["*://learn.deeplearning.ai/courses/*"],injectPages:["*://learn.deeplearning.ai/*"],playBtnContainerSelector:"div:has(> .vds-fullscreen-button)",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"deeplearningai_",values:["/courses/:a/lesson/:videoId/:b","videoId"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"deeplearningai_",values:["/courses/:a/lesson/:videoId/:b","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"m3u8",subtitleTimeUnit:"second",site:"deeplearning.ai",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://opencast.dcex.harvard.edu/*",dubbingPages:["*://opencast.dcex.harvard.edu/engage/player/watch.html*"],injectPages:["*://opencast.dcex.harvard.edu/engage/player/watch.html*"],playBtnContainerSelector:"#player-container > div.playback-bar.top-mode > div.button-plugins.right-side",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["id"],prefix:"harvard_"},subtitleFetchMethod:"commonVtt",commonVttConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlQueryParam",buildType:"raw",values:["id"],prefix:"harvard_"}}},playerConfig:{playerClass:"HarvardPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"harvard",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://illinois.zoom.us/*",dubbingPages:["*://illinois.zoom.us/rec/play/*"],injectPages:["*://illinois.zoom.us/rec/play/*"],playBtnContainerSelector:".vjs-extend-control",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,mediaDownloadCorsBypass:{enabled:!0,requestDomains:["ssrweb.zoom.us"]},videoIdExtract:{type:"urlPath",buildType:"raw",values:["/rec/play/:videoId","videoId"],prefix:"zoom_illinois_"},subtitleFetchMethod:"commonVtt",commonVttConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",values:["/rec/play/:videoId","videoId"],prefix:"zoom_illinois_"}}},playerConfig:{playerClass:"IllinoisZoomPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"zoom_illinois",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://*.khanacademy.org/*",dubbingPages:["*://*.khanacademy.org/*/*/*/*/v/*"],injectPages:["*://*.khanacademy.org/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"khanac_",values:["/:category1/:category2/:slug1/:slug2/v/:title","title"]},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"khanac_",values:["/:category1/:category2/:slug1/:slug2/v/:title","title"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"khanacademy",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://courses.edx.org/*",dubbingPages:["*://courses.edx.org/*"],injectPages:["*://courses.edx.org/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"epicgames-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"attr",buildType:"raw",prefix:"edx_",values:[".video","data-course-id"]},subtitleFetchMethod:"edx",edxConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"lang"},titleExtract:{type:"tab"},videoIdExtract:{type:"attr",buildType:"raw",prefix:"edx_",values:[".video","data-course-id"]}}},playerConfig:{playerClass:"EdxPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"millisecond",site:"edx",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://cdnapisec.kaltura.com/*",dubbingPages:["*://cdnapisec.kaltura.com/html5/*"],injectPages:["*://cdnapisec.kaltura.com/html5/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/html5/:slug1/:slug2/:slug3/:slug4/:slug5/uiconf_id/:slug6/entry_id/:videoId","videoId"],prefix:"kaltura_"},subtitleFetchMethod:"domTrack",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang",domKind:"subtitles"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",values:["/html5/:slug1/:slug2/:slug3/:slug4/:slug5/uiconf_id/:slug6/entry_id/:videoId","videoId"],prefix:"kaltura_"}}},playerConfig:{playerClass:"KalturaPlayer"},subtitleFormat:"srt",subtitleTimeUnit:"second",site:"kaltura",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://www.ixl.com/*",dubbingPages:["*://www.ixl.com/*"],injectPages:["*://www.ixl.com/*"],playBtnContainerSelector:".undefined",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"custom-play-btn-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",values:["/:slug1/:slug2/:videoId","videoId"],prefix:"ixl_"},subtitleFetchMethod:"ixl",domTrackConfig:{parseConfig:{subtitleExtract:{subtitleLanguageName:"srclang",domKind:"subtitles"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",values:["/:slug1/:slug2/:videoId","videoId"],prefix:"ixl_"}}},playerConfig:{playerClass:"IxlPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"kaltura",startResetPlaybackRate:!0,needWebRequest:!0},{className:"SiteDubbingRules",domain:"*://www.linkedin.com/*",dubbingPages:["*://www.linkedin.com/learning/*/*"],injectPages:["*://www.linkedin.com/*"],playBtnContainerSelector:".vjs-control-bar",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"linkedin_",values:["/learning/:courseSlug/:videoId","videoId"]},subtitleFetchMethod:"domAttr",domAttrConfig:{attrSelector:"[data-captions-url]",attrName:"data-captions-url",parseConfig:{subtitleExtract:{subtitleLanguageName:"auto"},titleExtract:{type:"tab"},videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"linkedin_",values:["/learning/:courseSlug/:videoId","videoId"]}}},playerConfig:{playerClass:"NoOfflineVideoPlayer"},subtitleFormat:"vtt",subtitleTimeUnit:"second",site:"linkedin_learning",startResetPlaybackRate:!0,needWebRequest:!1,excludeOnIos:!0},{className:"SiteDubbingRules",domain:"*://anthropic.skilljar.com/*",dubbingPages:["*://anthropic.skilljar.com/*/*"],injectPages:["*://anthropic.skilljar.com/*"],playBtnContainerSelector:".jw-button-container",playBtnCss:{btnCss:"skilljar-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,videoIdExtract:{type:"urlPath",buildType:"raw",prefix:"claude_",values:["/:slug/:videoId","videoId"]},subtitleFetchMethod:"jwplayer",playerConfig:{playerClass:"JwPlayer"},subtitleFormat:"srt",subtitleTimeUnit:"second",site:"anthropic_skilljar",startResetPlaybackRate:!0},{className:"SiteDubbingRules",domain:"*://*.tiktok.com/*",dubbingPages:["*://*.tiktok.com/*"],injectPages:["*://*.tiktok.com/*"],excludePatterns:["^https://www\\.tiktok\\.com/@[^/]+/?$","^https://www\\.tiktok\\.com/live.*$","^https://www\\.tiktok\\.com/@[^/]+/live.*$"],playBtnContainerSelector:"video",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,needWebRequest:!0,videoIdExtract:{type:"tiktok",buildType:"raw",values:[]},subtitleFetchMethod:"universal",subtitleFormat:"vtt",subtitleTimeUnit:"second",playerConfig:{playerClass:"TikTokPlayer"},site:"tiktok",startResetPlaybackRate:!0,mediaDownloadCorsBypass:{enabled:!0,requestDomains:["tiktok.com"]}},{className:"SiteDubbingRules",domain:"*://*.douyin.com/*",dubbingPages:["*://*.douyin.com/*"],injectPages:["*://*.douyin.com/*"],excludePatterns:["^https://www\\.douyin\\.com/user/[^?]+(?:\\?(?!.*modal_id).*)?$","^https://www\\.douyin\\.com/jingxuan(?:/[^?]*)?(?:\\?(?!.*modal_id).*)?$","^https://www\\.douyin\\.com/vs(?:/[^?]*)?(?:\\?(?!.*modal_id).*)?$","^https://live\\.douyin\\.com/.*$","^https://www\\.douyin\\.com/follow/live/.*$"],playBtnContainerSelector:"video",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,needWebRequest:!0,videoIdExtract:{type:"douyin",buildType:"raw",values:[]},subtitleFetchMethod:"universal",subtitleFormat:"vtt",subtitleTimeUnit:"second",playerConfig:{playerClass:"DouyinPlayer"},site:"douyin",startResetPlaybackRate:!0,mediaDownloadCorsBypass:{enabled:!0,requestDomains:["douyinvod.com"]}},{className:"SiteDubbingRules",domain:"*://*.x.com/*",dubbingPages:["*://*.x.com/*"],injectPages:["*://*.x.com/*"],playBtnContainerSelector:"video",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,needWebRequest:!0,videoIdExtract:{type:"twitter",buildType:"raw",values:[]},subtitleFetchMethod:"twitter",subtitleFormat:"vtt",subtitleTimeUnit:"second",playerConfig:{playerClass:"TwitterPlayer"},site:"x",startResetPlaybackRate:!0,unmutedVolumeWorkaround:{enabled:!0,minVolume:1e-5}},{className:"SiteDubbingRules",domain:"*://*.twitter.com/*",dubbingPages:["*://*.twitter.com/*"],injectPages:["*://*.twitter.com/*"],playBtnContainerSelector:"video",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video",enabled:!0,needWebRequest:!0,videoIdExtract:{type:"twitter",buildType:"raw",values:[]},subtitleFetchMethod:"twitter",subtitleFormat:"vtt",subtitleTimeUnit:"second",playerConfig:{playerClass:"TwitterPlayer"},site:"twitter",startResetPlaybackRate:!0,unmutedVolumeWorkaround:{enabled:!0,minVolume:1e-5}},{className:"SiteDubbingRules",domain:"*://*/*",excludeKeywords:["youtube.com","youtube-nocookie.com","youtu.be","bilibili.com","bilivideo.com","vimeo.com","udemy.com","coursera.org","linkedin.com","dropbox.com","mux.com","brightcove.com","skilljar.com","x.com","twitter.com","tiktok.com","douyin.com","facebook.com","deeplearning.ai","whop.com","epicgames.com","threejs-journey.com","mediaspace.illinois.edu","hotmart.com","zoom.us","harvard.edu","khanacademy.org","edx.org","kaltura.com","ixl.com","mediadelivery.net","t.snaptrckr.fun","creative.xxxvjmp.com","pronhub.com","mail.qq.com"],dubbingPages:["*://*/*"],injectPages:["*://*/*"],playBtnContainerSelector:"video, audio",playBtnCss:{btnCss:"youtube-dubbing-button",logoCss:"youtube-dubbing-logo",containerCss:"youtube-dubbing-container"},mediaSelector:"video, audio",enabled:!0,videoIdExtract:{type:"universal",buildType:"raw",values:[]},subtitleFetchMethod:"universal",subtitleFormat:"vtt",subtitleTimeUnit:"second",playerConfig:{playerClass:"UniversalDubbingPlayer"},site:"common",startResetPlaybackRate:!0}])}getYoutubeMultiPatternExtractVideoIdConfig(){return ot.stringify({configMap:this.getYouTubeExtractVideoIdConfigMap()})}getYouTubeExtractVideoIdConfigMap(){const e=new Map;return e.set("*://*.youtube.com/watch*",{type:"urlQueryParam",buildType:"raw",values:["v"]}),e.set("*://*.youtube.com/shorts/*",{type:"urlPath",buildType:"raw",values:["/shorts/:videoId","videoId"]}),e.set("*://*.youtube.com/live/*",{type:"urlPath",buildType:"raw",values:["/live/:videoId","videoId"]}),e}getDropboxMultiPatternExtractVideoIdConfig(){return ot.stringify({configMap:this.getDropboxExtractVideoIdConfigMap()})}getDropboxExtractVideoIdConfigMap(){const e=new Map;return e.set("*://*.dropbox.com/preview/*",{type:"urlPath",buildType:"raw",prefix:"dropbox_",values:["/preview/:videoId","videoId"]}),e.set("*://*.dropbox.com/scl/fi/*",{type:"urlPath",buildType:"raw",prefix:"dropbox_",values:["/scl/fi/:videoId/:fileName","videoId"]}),e.set("*://*.dropbox.com/home*",{type:"urlQueryParam",buildType:"raw",prefix:"dropbox_",values:["preview"]}),e}getBiliMultiTypeExtractVideoIdConfig(){return ot.stringify({configList:this.getBiliExtractVideoIdConfigList()})}getBiliExtractVideoIdConfigList(){return[{type:"urlPath",buildType:"raw",values:["/video/:bvid","bvid"]},{type:"urlQueryParam",buildType:"raw",values:["p"],defaultValue:"1"}]}getJSONBiliMultiTypeExtractVideoIdConfig(){return ot.stringify({configList:this.getJSONBiliExtractVideoIdConfigList()})}getJSONBiliExtractVideoIdConfigList(){return[{type:"jsonPath",buildType:"raw",values:["$.data.bvid"]},{type:"jsonPath",buildType:"raw",values:["$.data.page_no"]}]}match(e){const t=Nl.isIos();return this.rules.find(i=>t&&i.excludeOnIos?!1:new bi(i.domain).includes(e)&&i.dubbingPages.some(r=>new bi(r).includes(e))&&(!i.excludeKeywords||i.excludeKeywords.every(r=>!e.toString().includes(r)))&&(!i.excludePatterns||i.excludePatterns.every(r=>!new RegExp(r).test(e.toString()))))}static shouldIgnoreLocationChange(e,t,i){if(!e)return!1;const r=e.videoIdExtract.type;if(r!=="urlPath"&&r!=="multi-pattern"&&r!=="urlQueryParam"&&r!=="multi-type")return!1;for(const s of e.dubbingPages)if(new bi(s).includes(t)&&new bi(s).includes(i)){let a=new si(null,"",void 0);a.setParam("matchUrl",t);const o=Yt.extractVideoId(e.videoIdExtract,a);a=new si(null,"",void 0),a.setParam("matchUrl",i);const l=Yt.extractVideoId(e.videoIdExtract,a);if(o!==void 0&&o===l)return!0}return!1}static isSameDubbingPage(e,t,i){const r=e.videoIdExtract.type;if(r!=="urlPath"&&r!=="multi-pattern"&&r!=="urlQueryParam"&&r!=="multi-type")return t===i;for(const s of e.dubbingPages)if(new bi(s).includes(t)&&new bi(s).includes(i)){let a=new si(null,"",void 0);a.setParam("matchUrl",t);const o=Yt.extractVideoId(e.videoIdExtract,a);a=new si(null,"",void 0),a.setParam("matchUrl",i);const l=Yt.extractVideoId(e.videoIdExtract,a);if(o!==void 0&&o===l)return!0}return!1}matchInjectPages(e){const t=Nl.isIos();return this.rules.find(i=>t&&i.excludeOnIos?!1:new bi(i.domain).includes(e)&&i.injectPages.some(r=>new bi(r).includes(e))&&(!i.excludeKeywords||i.excludeKeywords.every(r=>!e.toString().includes(r))))}matchDubbingPages(e){const t=Nl.isIos();return this.rules.find(i=>t&&i.excludeOnIos?!1:new bi(i.domain).includes(e)&&i.dubbingPages.some(r=>new bi(r).includes(e))&&(!i.excludeKeywords||i.excludeKeywords.every(r=>!e.toString().includes(r))))}}class oa{constructor(){X(this,"siteDubbingRulesService",new Lc);X(this,"result");X(this,"lastComputeSearch");X(this,"lastResultType");X(this,"metadataSubject");var e,t;this.metadataSubject=new qw(1),(e=window.pageContentRpc)==null||e.onMessage("sendRequestInfo",i=>this.metadataSubject.next(i.data)),(t=window.pageContentRpc)==null||t.onMessage("onUrlChange",()=>{var i;this.lastComputeSearch&&this.lastResultType&&((i=window.pageContentRpc)==null||i.sendMessage("getRequestMetadata",{search:this.lastComputeSearch(),resultType:this.lastResultType}).then())})}observeSubtitleRequests(e,t,i){var r;return this.lastComputeSearch=e,this.lastResultType=t,this.result||(this.result=this.metadataSubject.asObservable().pipe(vt(s=>t==="m3u8"||i==="youtube"||i==="google_drive_youtube"?Vt(s):Vt(s).pipe(vt(a=>{const o=Qi.addParam(a.url,"youtubedubbing","true");return Xt(fetch(o,{credentials:"include"}).catch(()=>fetch(o)))}),vt(a=>{if(!a.ok)throw new Error(`Fetch 失败: ${a.status}`);return Xt(t==="json"?a.json():a.text())}))))),this.siteDubbingRulesService.matchDubbingPages(window.location.href)&&((r=window.pageContentRpc)==null||r.sendMessage("getRequestMetadata",{search:e(),resultType:t}).then()),this.result}resendRequest(){var e;this.siteDubbingRulesService.matchDubbingPages(window.location.href)&&this.lastComputeSearch&&this.lastResultType&&((e=window.pageContentRpc)==null||e.sendMessage("getRequestMetadata",{search:this.lastComputeSearch(),resultType:this.lastResultType}).then())}}class Bp extends Mi{constructor(){super(...arguments);X(this,"subtitleRequestInfoStreamService",new oa)}createMetadataObservable(t){const i=t.siteDubbingRules.apiInterceptConfig;if(i===void 0)throw console.error("ApiInterceptBasedMediaMetadataService: apiInterceptConfig is undefined for site",t.siteDubbingRules),new Error("The website is missing the apiInterceptConfig configuration.");return this.subtitleRequestInfoStreamService.observeSubtitleRequests(this.getSearch.bind(this,t),"json").pipe(vt(r=>{var o;const s=document.querySelector(t.siteDubbingRules.mediaSelector),a=new si(s,t.tabTitle,r);return(o=i.parseConfig)!=null&&o.isLiveVideoExtract?Xt(new Nc().getIsLive(i.parseConfig.isLiveVideoExtract,a)).pipe(Ht(l=>this.extractMediaMetadata(i.parseConfig,a,l))):Vt(this.extractMediaMetadata(i.parseConfig,a,!1))}))}getSearch(t){return t.siteDubbingRules.site}}class P3 extends Mi{constructor(){super();X(this,"windowBasedService");X(this,"apiInterceptService");this.windowBasedService=new v2,this.apiInterceptService=new Bp}createMetadataObservable(t){const i=this.windowBasedService.createMetadataObservable(t).pipe(Rn(1)),r=this.apiInterceptService.createMetadataObservable(t);return pD(i,r)}}class Up{convertToOriginSubtitles(e,t=!0){var r;const i=[];for(let s=0;s<e.length;s++){const a=e[s];if(a.segs===void 0)continue;if(a.segs.length===1){if(a.segs[0].utf8===`
`)continue;if(It.isSoundEffectMarker(a.segs[0].utf8))continue;if(_t.isEmpty((r=a.segs[0].utf8)==null?void 0:r.trim()))continue}const o=this.convertOriginSubtitle(a);i.push(o)}if(t)for(let s of i)s.start=s.start/1e3,s.end=s.end/1e3,s.dur=s.dur/1e3;return i}convertOriginSubtitle(e){const t=e.segs;let i="";for(let r of t)i+=r.utf8+" ";return{start:e.tStartMs,end:e.tStartMs+e.dDurationMs,dur:e.dDurationMs,text:i,processPunctuation:!0}}}class E2{constructor(){X(this,"youtubeOriginSubtitleService",new Up)}async parse(e,t){const r=JSON.parse(e).events;let s={hasPunctuation:!1,subtitles:[],originSubtitles:[]};s.originSubtitles=this.youtubeOriginSubtitleService.convertToOriginSubtitles(r);for(let a=0;a<r.length;a++){const o=r[a];if(o.segs===void 0)continue;if(o.segs.length===1){if(o.segs[0].utf8===`
`)continue;if(this.isSoundEffectMarker(o.segs[0].utf8))continue}const l=r[a+1],u=this.convertSubtitles(o,l);ii.containsOnlyPunctuationAndSpaces(u.text)||s.subtitles.push(u)}return s}isSoundEffectMarker(e){return e.startsWith("[")&&e.endsWith("]")}convertSubtitles(e,t){if(e.segs===void 0)throw new Error("Subtitle events must be provided");const i=e.segs;let r;for(let s=0;s<i.length;s++){const a=i[s];if(r===void 0)r=this.createSubtitle(e,a,s,t);else{const o=this.createSubtitle(e,a,s,t);r=It.appendSubtitle(r,o,!0)}}return r&&(r.text=It.normalizeSubtitleText(r.text)),r}createSubtitle(e,t,i,r){let s=e.tStartMs;t.tOffsetMs!==void 0&&(s+=t.tOffsetMs),s=s/1e3;let a=this.calculateSegmentEndTime(e,i+1,r)/1e3;return{start:s,end:a,dur:a-s,text:t.utf8,processPunctuation:!1}}calculateSegmentEndTime(e,t,i){if(e.segs===void 0)throw new Error("Subtitle events must be provided");let s=e.segs[t];return s!==void 0?e.tStartMs+s.tOffsetMs:i!==void 0?i.tStartMs:e.tStartMs+e.dDurationMs}}class A2 extends Cp{constructor(){super(...arguments);X(this,"youtubeOriginSubtitleService",new Up)}async parseSubtitle(t,i){const s=JSON.parse(t).events;let a=this.youtubeOriginSubtitleService.convertToOriginSubtitles(s,!1);const o=[];let l=!1;for(let u=0;u<s.length;u++){const h=s[u],d=h.segs;if(d===void 0||_t.isEmpty(d))continue;const p=this.createSubtitle(h,d[0]);!l&&It.hasPunctuation(p.text)&&(l=!0),o.push(p)}return{subtitles:o,hasPunctuation:l,originSubtitles:a}}createSubtitle(t,i){return{start:t.tStartMs,end:t.tStartMs+t.dDurationMs,dur:t.dDurationMs,text:It.normalizeSubtitleText(i.utf8),processPunctuation:!0}}}class S2{constructor(){X(this,"punctuationSubtitleService",new Vn);X(this,"youtubeOriginSubtitleService",new Up)}async parse(e,t){const r=JSON.parse(e).events;let s={hasPunctuation:!0,subtitles:[],originSubtitles:[]};return s.originSubtitles=this.youtubeOriginSubtitleService.convertToOriginSubtitles(r),s.subtitles=this.segmentYouTubeAsrSubtitles(r),s.subtitles=this.punctuationSubtitleService.segmentSubtitlesBySentence(s.subtitles),s}segmentYouTubeAsrSubtitles(e){var i;const t=[];for(let r=0;r<e.length;r++){const s=e[r];if(s.segs===void 0)continue;if(s.segs.length===1){if(s.segs[0].utf8===`
`)continue;if(It.isSoundEffectMarker(s.segs[0].utf8))continue;if(_t.isEmpty((i=s.segs[0].utf8)==null?void 0:i.trim()))continue}const a=e[r+1],o=this.convertSubtitles(s,a);if(!_t.isEmpty(o))if(_t.isEmpty(t))t.push(...o);else{const l=_t.last(t);ii.endsWithPunctuation(l.text)?t.push(...o):(It.appendSubtitle(l,o[0],!0),o.length>1&&t.push(...o.slice(1)))}}return t}convertSubtitles(e,t){if(e.segs===void 0)throw new Error("Subtitle events must be provided");const i=e.segs,r=[];let s;for(let a=0;a<i.length;a++){const o=i[a];if(s===void 0)s=this.createSubtitle(e,o,a,t);else{const l=this.createSubtitle(e,o,a,t);s=It.appendSubtitle(s,l,!1)}ii.endsWithPunctuation(s.text)&&(s.text=It.normalizeSubtitleText(s.text),r.push(s),s=void 0)}return s!==void 0&&(s.text=It.normalizeSubtitleText(s.text),r.push(s)),r}createSubtitle(e,t,i,r){let s=e.tStartMs;t.tOffsetMs!==void 0&&(s+=t.tOffsetMs),s=s/1e3;let a=this.calculateSegmentEndTime(e,i+1,r)/1e3;return{start:s,end:a,dur:a-s,text:t.utf8,processPunctuation:!0}}calculateSegmentEndTime(e,t,i){if(e.segs===void 0)throw new Error("Subtitle events must be provided");let s=e.segs[t];return s!==void 0?e.tStartMs+s.tOffsetMs:i!==void 0?i.tStartMs:e.tStartMs+e.dDurationMs}}class x2{static fromMutationObserver(e,t){return SD(i=>{const r=new MutationObserver(s=>i(s));return r.observe(e,t),r},(i,r)=>r.disconnect())}static fromAttributeChanges(e,t){return this.fromMutationObserver(e,{attributes:!0,attributeFilter:t})}static async waitForPunctuation(e){const t=lu(0,200).pipe(Zt(()=>e()),Rn(1));await qo(t)}}class Ki{static getPlayerId(){return new bi("*://*.youtube.com/shorts/*").includes(window.location.href)?"shorts-player":"movie_player"}static createWatchAdsObservable(){const e=Le(".html5-video-player");if(e.hasClass("ad-showing")){const t=e[0];return x2.fromAttributeChanges(t,["class"]).pipe(Zt(i=>i.some(()=>!e.hasClass("ad-showing"))))}}static createPlayerClassObservable(){const t=Le(".html5-video-player")[0];return x2.fromAttributeChanges(t,["class"])}}class O3 extends Mi{constructor(){super(...arguments);X(this,"lastVideoId");X(this,"subtitleRequestInfoStreamService",new oa);X(this,"siteDubbingRulesService",new Lc);X(this,"captionRestoreTimer");X(this,"savedCaptionState");X(this,"savedTextTrackModes",new Map)}createMetadataObservable(t){return Jr(500).pipe(Zt(()=>this.siteDubbingRulesService.matchDubbingPages(window.location.href)!==void 0),vt(()=>{const i=Ki.createWatchAdsObservable();return i?(console.log("YouTube ads detected, waiting for ads to finish..."),i.pipe(Rn(1),Ws(()=>console.log("YouTube ads finished, proceeding with metadata extraction...")),Ht(()=>{}))):Vt(void 0)}),Ht(()=>{var r,s;const i=document.getElementById(Ki.getPlayerId());if(!(!i||i.getPlayerState()===3))return(s=(r=i.getPlayerResponse())==null?void 0:r.videoDetails)==null?void 0:s.videoId}),Zt(i=>i!=null),Zt(i=>this.lastVideoId===void 0||i!==this.lastVideoId),Ws(i=>this.lastVideoId=i),vt(i=>{const r=document.getElementById(Ki.getPlayerId());return(r.getPlayerState()===-1||r.getPlayerState()===2)&&Le(`#${Ki.getPlayerId()} > div.html5-video-container > video`)[0].play().catch(a=>console.error("try play media occur error",a)),Vt(i)}),vt(i=>{var u;const s=document.getElementById(Ki.getPlayerId()).getPlayerResponse(),a=Le(`#${Ki.getPlayerId()} > div.html5-video-container > video`)[0],o=t.siteDubbingRules.windowVariableConfig,l=new si(a,t.tabTitle,s);return(u=o==null?void 0:o.parseConfig)!=null&&u.isLiveVideoExtract?Xt(new Nc().getIsLive(o.parseConfig.isLiveVideoExtract,l)).pipe(Ht(h=>this.extractMediaMetadata(o.parseConfig,l,h))):Vt(this.extractMediaMetadata(o.parseConfig,l,!1))}))}async transformMetadata(t,i){if(t.subtitleMetadata===void 0)return t;const r=t.subtitleMetadata.language,s=document.getElementById(Ki.getPlayerId());if(this.shouldUseTextTrackApi(s)){const u=await this.getSubtitleViaTextTrack(t,r);return u||t}if(!s)return t;if(!this.savedCaptionState)try{const u=localStorage.getItem("yt-player-sticky-caption"),h=u?JSON.parse(u).data:null,d=localStorage.getItem("yt-player-caption-sticky-language"),p=d?JSON.parse(d).data:null,g=h==="true"||h===!0,m=p||"";this.savedCaptionState={wasEnabled:g,originalLanguage:m}}catch{}const a=this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>JSON.stringify({videoId:"youtube_"+t.videoId,language:r,now:new Date().getTime()}),"json","youtube").pipe(ou(7e3),Ks(u=>{if(u instanceof zh){if(!(this.siteDubbingRulesService.matchDubbingPages(location.href)!==void 0&&this.lastVideoId===t.videoId))return jr;this.enableCaptionsWithReset(s,r)}return au(()=>u)}),z0({delay:0}),Zt(u=>u.site==="youtube_"+t.videoId),Ws(u=>{this.restoreUserCaptionState(s)}),vt(u=>{var d,p,g;const h=(g=(p=(d=s.getPlayerResponse())==null?void 0:d.microformat)==null?void 0:p.playerMicroformatRenderer)==null?void 0:g.publishDate;return Xt(this.fetchYouTubeSubtitle(u,r).then(m=>this.parseYouTubeSubtitle(m,i,t.subtitleMetadata.isAsr,this.checkSubtitleHasPunctuation(m,h)))).pipe(Ht(m=>m.errorStatus&&m.errorStatus===429?(t.errorStatus=429,t):(t.originSubtitles=m.originSubtitles,t.subtitles=m.subtitles,t.subtitleMetadata.hasPunctuation=m.hasPunctuation,t)),Ks(m=>m&&m.message==="Empty subtitle text"?jr:au(()=>m)))}),Y0(()=>{this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0)}),K0(t)),o=qo(a),l=()=>{this.enableCaptionsWithReset(s,r),s.removeEventListener("onReady",l)};return s.addEventListener("onReady",l),setTimeout(()=>{this.enableCaptionsWithReset(s,r)},500),s.addEventListener("onApiChange",()=>{this.enableCaptionsWithReset(s,r)}),o}async fetchYouTubeSubtitle(t,i){const r={credentials:"include",headers:{"X-YouTubeDubbing":"true"}},s=Qi.replaceParam(t.url,"lang",i),a=await fetch(s,r).catch(o=>fetch(s,r));if(!a.ok){if(a.status===429)return"429";throw new Error(`Fetch 失败: ${a.status}`)}return a.text()}enableCaptionsWithReset(t,i){if(this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0),!this.savedCaptionState)return;const r=this.savedCaptionState.wasEnabled,s=this.savedCaptionState.originalLanguage;if(r&&s===i){t.setOption("captions","track",{}),t.setOption("captions","track",{languageCode:i});return}((t.getOption("captions","track")||{}).languageCode||"")&&t.setOption("captions","track",{}),t.unloadModule("captions"),t.loadModule("captions"),t.setOption("captions","track",{languageCode:i}),this.captionRestoreTimer=window.setTimeout(()=>{this.restoreUserCaptionState(t)},5e3)}restoreUserCaptionState(t){if(!this.savedCaptionState)return;this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0);const r=(t.getOption("captions","track")||{}).languageCode||"";this.savedCaptionState.wasEnabled?r!==this.savedCaptionState.originalLanguage&&t.setOption("captions","track",{languageCode:this.savedCaptionState.originalLanguage}):t.setOption("captions","track",{}),this.savedCaptionState=void 0}checkSubtitleHasPunctuation(t,i){if(i){const r=new Date(i).getTime(),s=new Date("2025-03-31").getTime();if(r<s)return!1}try{const s=JSON.parse(t).events||[],a=new Set([",",".","!","?",";",":","-","—","–",'"',"'","`","(",")","[","]","{","}","...","…","，","。","！","？","；","：","、",'"','"',"'","'","《","》","（","）","【","】","—","…","·","¿","¡","«","»","‹","›","„",'"']);return s.slice(0,10).some(l=>{if(!l.segs||l.segs.length===0)return!1;const u=l.segs.map(h=>h.utf8).join("");for(const h of u)if(a.has(h))return!0;return!1})}catch(r){return console.error("解析字幕判断标点符号失败:",r),!1}}parseYouTubeSubtitle(t,i,r,s){return t==="429"?Promise.resolve({originSubtitles:[],subtitles:[],hasPunctuation:!1,errorStatus:429}):!t||t.trim().length===0?(this.subtitleRequestInfoStreamService.resendRequest(),Promise.reject(new Error("Empty subtitle text"))):r||this.isAsrSubtitle(t)?s||!r?new S2().parse(t,i):new E2().parse(t,i):new A2().parse(t,i)}isAsrSubtitle(t){const r=JSON.parse(t).events;return this.findFirstSegArray(r).length>1}findFirstSegArray(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.segs&&r.segs.length>0)return r.segs}return[]}shouldUseTextTrackApi(t){var h,d;if(!Nl.isIos())return!1;const r=window.location.hostname,s=window.location.href;if(r!=="www.youtube.com"||!s.includes("app=desktop")||!t)return!1;const o=t.getPlayerResponse(),l=(d=(h=o==null?void 0:o.captions)==null?void 0:h.playerCaptionsTracklistRenderer)==null?void 0:d.captionTracks;return!!(l&&l.length>0)}async getSubtitleViaTextTrack(t,i){const r=await this.waitForTextTracks();if(!r)return;this.saveTextTrackModes(r.textTracks);const s=this.findTextTrack(r.textTracks,i);if(!s){this.restoreTextTrackModes(r.textTracks);return}const a=await this.enableTrackAndWaitForCues(s);if(!a||a.length===0){this.restoreTextTrackModes(r.textTracks);return}const o=Array.from(a),l=It.convertVttEntriesToSubtitles(o);return this.restoreTextTrackModes(r.textTracks),t.subtitles=l.subtitles,t.originSubtitles=l.originSubtitles,t.subtitleMetadata.hasPunctuation=l.hasPunctuation,t}async waitForTextTracks(t=1e4,i=200){const r=Jr(i).pipe(Ht(()=>document.querySelector("video")),Zt(s=>{if(!s||!s.textTracks)return!1;for(let a=0;a<s.textTracks.length;a++){const o=s.textTracks[a];if(o.kind==="subtitles"||o.kind==="captions")return!0}return!1}),ou(t),Ks(s=>Vt(null)));return qo(r)}findTextTrack(t,i){for(let s=0;s<t.length;s++){const a=t[s];if((a.kind==="subtitles"||a.kind==="captions")&&a.language===i)return a}for(let s=0;s<t.length;s++){const a=t[s];if((a.kind==="subtitles"||a.kind==="captions")&&a.language.startsWith(i+"-"))return a}const r=i.split("-")[0];if(r!==i)for(let s=0;s<t.length;s++){const a=t[s];if((a.kind==="subtitles"||a.kind==="captions")&&a.language===r)return a}return null}async enableTrackAndWaitForCues(t,i=5e3){return new Promise(r=>{if(t.cues&&t.cues.length>0){r(t.cues);return}t.mode="hidden";let s=!1,a;const o=window.setTimeout(()=>{s||(s=!0,a&&clearInterval(a),console.warn("[TextTrack] Cues load timeout after",i,"ms"),r(t.cues))},i);a=window.setInterval(()=>{t.cues&&t.cues.length>0&&(s||(s=!0,clearInterval(a),clearTimeout(o),r(t.cues)))},100);const l=()=>{t.cues&&t.cues.length>0&&!s&&(s=!0,a&&clearInterval(a),clearTimeout(o),t.removeEventListener("cuechange",l),r(t.cues))};t.addEventListener("cuechange",l)})}saveTextTrackModes(t){this.savedTextTrackModes.clear();for(let i=0;i<t.length;i++){const r=t[i];this.savedTextTrackModes.set(r,r.mode)}}restoreTextTrackModes(t){for(let i=0;i<t.length;i++){const r=t[i],s=this.savedTextTrackModes.get(r);s!==void 0&&r.mode!==s&&(r.mode=s)}this.savedTextTrackModes.clear()}}class T2 extends Ha{getSubtitles(e,t){const i=t.data;return!Array.isArray(i)||i.length===0?(console.warn("[PlayerApiBasedExtractSubtitleService] No caption tracks available or invalid data format"),[]):i.filter(r=>r.is_servable).map(r=>this.buildSubtitleMetadata(r))}buildSubtitleMetadata(e){return{url:"",language:e.languageCode,isAsr:this.isAsrTrack(e),hasPunctuation:!1}}isAsrTrack(e){if(e.kind==="asr")return!0;const t=(e.displayName||e.name||"").toLowerCase();return t.includes("auto-generated")||t.includes("automatic")||t.includes("auto generated")}}class F3 extends Mi{constructor(){super(...arguments);X(this,"lastVideoId");X(this,"subtitleRequestInfoStreamService",new oa);X(this,"siteDubbingRulesService",new Lc);X(this,"captionRestoreTimer");X(this,"savedCaptionState")}createMetadataObservable(t){return Jr(500).pipe(Zt(()=>this.siteDubbingRulesService.matchDubbingPages(window.location.href)!==void 0),Ht(()=>{const i=document.getElementById(Ki.getPlayerId());if(!i||i.getPlayerState()===3)return;if(typeof i.getCaptionTracks=="function"){const s=i.getCaptionTracks();if(!s||s.length===0)return}else{const s=new URLSearchParams(window.location.search);if(s.get("cc_asr")!=="1"&&s.get("cc3_module")!=="1")return}const r=i.getVideoData();return r==null?void 0:r.video_id}),Zt(i=>i!=null),Ht(i=>`google_drive_${i}`),Zt(i=>this.lastVideoId===void 0||i!==this.lastVideoId),Ws(i=>this.lastVideoId=i),vt(i=>{const r=document.getElementById(Ki.getPlayerId());return(r.getPlayerState()===-1||r.getPlayerState()===2)&&Le(`#${Ki.getPlayerId()} > div.html5-video-container > video`)[0].play().catch(a=>console.error("try play media occur error",a)),Vt(i)}),vt(i=>{const r=document.getElementById(Ki.getPlayerId()),s=r.getVideoData(),a=Le(`#${Ki.getPlayerId()} > div.html5-video-container > video`)[0];let o;typeof r.getCaptionTracks=="function"&&(o=r.getCaptionTracks());let l,u=Di.YELLOW;if(o&&o.length>0){const d=new si(a,s.title||"Google Drive Video",o);l=new T2().getBestSubtitle({},d),l&&(u=l.isAsr?Di.RED:Di.YELLOW)}const h={videoId:i,title:s.title||"Google Drive Video",duration:r.getDuration(),isLiveVideo:s.isLive||!1,subtitles:[],originSubtitles:[],subtitleMetadata:l,isPrivate:!1,channelId:"",supportLanguageCode:["SG"],subtitleLevel:u};return Vt(h)}))}async transformMetadata(t,i){const r=document.getElementById(Ki.getPlayerId());if(!r)return t;if(t.subtitleMetadata===void 0){if(Nl.isIos())t.subtitleMetadata={url:"",language:"en",isAsr:!1,hasPunctuation:!0},t.subtitleLevel=Di.YELLOW;else if(typeof r.getCaptionTracks!="function"){const h=await this.fetchCaptionTracksViaTypeList(r);if(h&&h.length>0){const d=Le(`#${Ki.getPlayerId()} > div.html5-video-container > video`)[0],p=r.getVideoData(),g=new si(d,p.title||"Google Drive Video",h),m=new T2().getBestSubtitle({},g);m&&(t.subtitleMetadata=m,t.subtitleLevel=m.isAsr?Di.RED:Di.YELLOW)}}if(t.subtitleMetadata===void 0)return t}const s=t.subtitleMetadata.language;if(!this.savedCaptionState)try{const u=localStorage.getItem("yt-player-sticky-caption"),h=u?JSON.parse(u).data:null,d=localStorage.getItem("yt-player-caption-sticky-language"),p=d?JSON.parse(d).data:null,g=h==="true"||h===!0,m=p||"";this.savedCaptionState={wasEnabled:g,originalLanguage:m}}catch{}const a=this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>JSON.stringify({videoId:t.videoId,language:s,now:new Date().getTime()}),"json","google_drive_youtube").pipe(ou(7e3),Ks(u=>{if(u instanceof zh){if(!(this.siteDubbingRulesService.matchDubbingPages(location.href)!==void 0&&this.lastVideoId===t.videoId))return jr;this.enableCaptionsWithReset(r,s)}return au(()=>u)}),z0({delay:0}),Zt(u=>u.site===t.videoId),Ws(u=>{this.restoreUserCaptionState(r)}),vt(u=>(qI.parse(u.url),Xt(this.fetchSubtitle(u,s).then(h=>this.parseYouTubeSubtitle(h,i,t.subtitleMetadata.isAsr,this.isAsrSubtitle(h)))).pipe(Ht(h=>h.errorStatus&&h.errorStatus===429?(t.errorStatus=429,t):(t.originSubtitles=h.originSubtitles,t.subtitles=h.subtitles,t.subtitleMetadata.hasPunctuation=h.hasPunctuation,t)),Ks(h=>h&&h.message==="Empty subtitle text"?jr:au(()=>h))))),Y0(()=>{this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0)}),K0(t)),o=qo(a),l=()=>{this.enableCaptionsWithReset(r,s),r.removeEventListener("onReady",l)};return r.addEventListener("onReady",l),setTimeout(()=>{this.enableCaptionsWithReset(r,s)},500),r.addEventListener("onApiChange",()=>{this.enableCaptionsWithReset(r,s)}),o}async fetchSubtitle(t,i){const r=Qi.replaceParam(t.url,"lang",i),s=await p2(r,{credentials:"include"}).catch(a=>p2(r,{credentials:"include"}));if(!s.ok){if(s.status===429)return"429";throw new Error(`Fetch 失败: ${s.status}`)}return s.text()}enableCaptionsWithReset(t,i){this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0),this.savedCaptionState||(this.savedCaptionState={wasEnabled:!1,originalLanguage:""});const r=this.savedCaptionState.wasEnabled,s=this.savedCaptionState.originalLanguage;if(r&&s===i){t.setOption("captions","track",{}),t.setOption("captions","track",{languageCode:i});return}((t.getOption("captions","track")||{}).languageCode||"")&&t.setOption("captions","track",{}),t.unloadModule("captions"),t.loadModule("captions"),t.setOption("captions","track",{languageCode:i}),this.captionRestoreTimer=window.setTimeout(()=>{this.restoreUserCaptionState(t)},5e3)}restoreUserCaptionState(t){if(!this.savedCaptionState)return;this.captionRestoreTimer!==void 0&&(clearTimeout(this.captionRestoreTimer),this.captionRestoreTimer=void 0);const r=(t.getOption("captions","track")||{}).languageCode||"";this.savedCaptionState.wasEnabled?r!==this.savedCaptionState.originalLanguage&&t.setOption("captions","track",{languageCode:this.savedCaptionState.originalLanguage}):t.setOption("captions","track",{}),this.savedCaptionState=void 0}parseYouTubeSubtitle(t,i,r,s){return t==="429"?Promise.resolve({originSubtitles:[],subtitles:[],hasPunctuation:!1,errorStatus:429}):!t||t.trim().length===0?(this.subtitleRequestInfoStreamService.resendRequest(),Promise.reject(new Error("Empty subtitle text"))):r||this.isAsrSubtitle(t)?s||!r?new S2().parse(t,i):new E2().parse(t,i):new A2().parse(t,i)}isAsrSubtitle(t){const r=JSON.parse(t).events;return this.findFirstSegArray(r).length>1}findFirstSegArray(t){for(let i=0;i<t.length;i++){const r=t[i];if(r.segs&&r.segs.length>0)return r.segs}return[]}fetchCaptionTracksViaTypeList(t){return new Promise(i=>{const r=XMLHttpRequest.prototype.open;let s=null;XMLHttpRequest.prototype.open=function(a,o){return o.includes("timedtext")&&o.includes("type=track")&&(s=o),r.apply(this,arguments)},t.unloadModule("captions"),setTimeout(()=>{t.loadModule("captions"),setTimeout(()=>{t.setOption("captions","track",{languageCode:"en"}),setTimeout(async()=>{if(XMLHttpRequest.prototype.open=r,!s){i([]);return}const a=s.replace("type=track","type=list").replace(/&lang=[^&]*/,"")+"&tlangs=1";try{const l=await(await fetch(a,{credentials:"include"})).text(),u=this.parseTrackListXml(l);i(u)}catch(o){console.error("[debug-metadata-gdrive] Firefox Android: fetchCaptionTracksViaTypeList 失败:",o),i([])}},1e3)},300)},300)})}parseTrackListXml(t){try{const s=new DOMParser().parseFromString(t,"text/xml").querySelectorAll("track");return Array.from(s).map((a,o)=>({languageCode:a.getAttribute("lang_code")||"",languageName:a.getAttribute("lang_translated")||"",displayName:a.getAttribute("lang_translated")||"",kind:a.getAttribute("kind")||"",name:a.getAttribute("name")||"",id:a.getAttribute("id")||String(o),is_servable:!0,is_default:o===0,is_translateable:a.getAttribute("cantran")==="true",vss_id:`a.${a.getAttribute("lang_code")}`}))}catch(i){return console.error("[debug-metadata-gdrive] parseTrackListXml 解析失败:",i),[]}}}class B3{static findTrack(e,t,i){for(let r of e)if(r.kind===i&&r.language===t)return r}}class U3 extends Ha{getSubtitles(e,t){let i=[];const r=this.findMuxVideoByMedia(t.media);if(!r)throw console.error("Failed to find mux-video element in Shadow Root, cannot extract subtitles"),new Error("MuxBasedExtractSubtitleService: Unable to locate mux-video element required for subtitle extraction");for(let s of t.media.textTracks)s.kind==="subtitles"&&i.push(this.buildSubtitleMediaData(s,r));return i}buildSubtitleMediaData(e,t){return{url:t.src,language:e.language,isAsr:!1,hasPunctuation:!0}}postProcessSubtitle(e,t){if(e===void 0)return;const i=B3.findTrack(t.media.textTracks,e.language,"subtitles");return i&&(i.mode="showing"),e}findMuxVideoByMedia(e){const t=e.shadowRoot;if(!t)console.error("未找到 Shadow Root");else{const i=t.querySelector("mux-video");if(i)return i;console.error("在 Shadow Root 中未找到 mux-video")}}}class $3 extends Mi{constructor(){super(...arguments);X(this,"lastPlaybackId")}createMetadataObservable(t){if(t.siteDubbingRules.muxConfig===void 0)throw console.error("MuxBasedMediaMetadataService: muxConfig is undefined for site",t.siteDubbingRules),new Error("the website is missing the muxConfig configuration.");return Jr(200).pipe(Ht(i=>{const r=document.querySelector(t.siteDubbingRules.mediaSelector);return r?Le(r).attr("playback-id"):null}),Zt(i=>i!=null),Zt(i=>this.lastPlaybackId===void 0||i!==this.lastPlaybackId),Ws(i=>{this.lastPlaybackId=i}),vt(i=>{const r=document.querySelector(t.siteDubbingRules.mediaSelector);return r&&Le(r).attr("playback-id")===i?this.handleMediaLoadStat(r,t):jr}))}handleMediaLoadStat(t,i){return t.readyState>=1?this.createObservableFromLoadedMedia(t,i):Xh(t,"loadedmetadata").pipe(Rn(1),vt(()=>this.createObservableFromLoadedMedia(t,i)))}createObservableFromLoadedMedia(t,i){const r=new si(t,i.tabTitle);if(i.siteDubbingRules.muxConfig===void 0)throw console.error("MuxBasedMediaMetadataService: muxConfig is undefined for site",i.siteDubbingRules),new Error("the website is missing the muxConfig configuration.");return i.siteDubbingRules.muxConfig.parseConfig.isLiveVideoExtract?Xt(new xS().getIsLive(i.siteDubbingRules.muxConfig.parseConfig.isLiveVideoExtract,r)).pipe(Ht(s=>this.extractMediaMetadata(i.siteDubbingRules.muxConfig.parseConfig,r,s))):Vt(this.extractMediaMetadata(i.siteDubbingRules.muxConfig.parseConfig,r,!1))}extractMediaMetadata(t,i,r){var s;return{videoId:Yt.extractVideoId(t.videoIdExtract,i),title:Yt.extractTitle(t.titleExtract,i),subtitleMetadata:new U3().getBestSubtitle(t.subtitleExtract,i),subtitleLevel:Di.YELLOW,videoLanguage:Yt.extractVideoLanguage(t,i),isPrivate:!1,channelId:"",duration:((s=i.media)==null?void 0:s.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}async transformMetadata(t,i){if(t.subtitleMetadata===void 0)return t;const r=await this.m3u8ParserService.parserSubtitle(t.subtitleMetadata.url,t.subtitleMetadata.language,i);return r&&(t.originSubtitles=r.originSubtitles,t.subtitles=r.subtitles,t.subtitleMetadata.hasPunctuation=r.hasPunctuation),t}}class G3 extends Mi{constructor(){super(...arguments);X(this,"siteDubbingRulesService",new Lc)}createMetadataObservable(t){var s;if(t.siteDubbingRules.windowVariableConfig===void 0)throw console.error("BiliBasedMediaMetadataService: windowVariableConfig is undefined for site",t.siteDubbingRules),new Error("The website is missing the windowVariableConfig configuration.");if(t.siteDubbingRules.apiInterceptConfig===void 0)throw console.error("BiliBasedMediaMetadataService: apiInterceptConfig is undefined for site",t.siteDubbingRules),new Error("The website is missing the apiInterceptConfig configuration.");const i=new Gw(this.siteDubbingRulesService.matchDubbingPages(window.location.href)!==void 0);(s=window.pageContentRpc)==null||s.onMessage("onUrlChange",a=>{i.next(!0)});const r=t.siteDubbingRules.apiInterceptConfig;return i.pipe(Zt(a=>a),vt(()=>Jr(200).pipe(Ht(()=>window.__INITIAL_STATE__),Zt(a=>a!==void 0),Rn(1),vt(a=>{if(window.location.href.startsWith("https://m.bilibili.com/")){const o=a;return Xt(fetch(`https://api.bilibili.com/x/player/wbi/v2?aid=${o.video.viewInfo.aid}&cid=${o.video.viewInfo.cid}`,{credentials:"include"}).then(l=>l.json()))}else{const o=a;return Xt(fetch(`https://api.bilibili.com/x/player/wbi/v2?aid=${o.aid}&cid=${o.cid}`,{credentials:"include"}).then(l=>l.json()))}}),vt(a=>{var u;const o=document.querySelector(t.siteDubbingRules.mediaSelector),l=new si(o,t.tabTitle,a);return(u=r.parseConfig)!=null&&u.isLiveVideoExtract?Xt(new Nc().getIsLive(r.parseConfig.isLiveVideoExtract,l)).pipe(Ht(h=>this.extractMediaMetadata(r.parseConfig,l,h))):Vt(this.extractMediaMetadata(r.parseConfig,l,!1))}))))}}class q3 extends Mi{createMetadataObservable(e){if(e.siteDubbingRules.videoJsConfig===void 0)throw console.error("AjaxVttBasedMediaMetadataService: videoJsConfig is undefined for site",e.siteDubbingRules),new Error("The website is missing the videoJsConfig configuration.");return Jr(200).pipe(Ht(()=>{var t;return(t=document.querySelector("div.video-js"))==null?void 0:t.player}),Zt(t=>t!=null&&t.readyState()>=1),Rn(1),vt(t=>{const i=t.textTracks().tracks_,r=document.querySelector(e.siteDubbingRules.mediaSelector),s=new si(r,e.tabTitle);return i.length>1&&s.setParam("subtitleUrl",i[0].src),Vt(this.extractMediaMetadata(e.siteDubbingRules.videoJsConfig.parseConfig,s,!1))}))}getBestSubtitle(e,t){if(t.getParam("subtitleUrl"))return{url:t.getParam("subtitleUrl"),language:"auto",isAsr:!1,hasPunctuation:!0}}}class V3 extends Mi{constructor(){super(...arguments);X(this,"punctuationSubtitleService",new Vn);X(this,"subtitleRequestInfoStreamService",new oa)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>t.siteDubbingRules.site,"json").pipe(vt(i=>{const r=document.querySelector(t.siteDubbingRules.mediaSelector),s=new si(r,t.tabTitle);return s.setParam("subtitleJson",i),s.setParam("rules",t.siteDubbingRules),Vt(this.extractMediaMetadata(t.siteDubbingRules.dropboxConfig.parseConfig,s,!1))}))}extractMediaMetadata(t,i,r){var l;const s=i.getParam("subtitleJson"),a=i.getParam("rules");let o=It.convertDropboxSegmentsToSubtitles(s.segments);return o=this.punctuationSubtitleService.postProcessParsedResult(o,a),{videoId:Yt.extractVideoId(t.videoIdExtract,i),title:i.tabTitle,subtitleMetadata:{url:void 0,language:s.transcriptLocale,isAsr:!1,hasPunctuation:o.hasPunctuation},subtitleLevel:Di.YELLOW,videoLanguage:hi.fromLanguage,isPrivate:!1,channelId:"",duration:((l=i.media)==null?void 0:l.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:o.subtitles,originSubtitles:o.originSubtitles,mediaUrl:i.getParam("mediaUrl")}}async transformMetadata(t,i){return t}}var $p={exports:{}};/**
 * [js-sha256]{@link https://github.com/emn178/js-sha256}
 *
 * @version 0.11.1
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2025
 * @license MIT
 */var w2;function H3(){return w2||(w2=1,function(n){(function(){var e="input is invalid type",t=typeof window=="object",i=t?window:{};i.JS_SHA256_NO_WINDOW&&(t=!1);var r=!t&&typeof self=="object",s=!i.JS_SHA256_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node&&process.type!="renderer";s?i=Or:r&&(i=self);var a=!i.JS_SHA256_NO_COMMON_JS&&!0&&n.exports,o=!i.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",l="0123456789abcdef".split(""),u=[-2147483648,8388608,32768,128],h=[24,16,8,0],d=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],p=["hex","array","digest","arrayBuffer"],g=[];(i.JS_SHA256_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(L){return Object.prototype.toString.call(L)==="[object Array]"}),o&&(i.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(L){return typeof L=="object"&&L.buffer&&L.buffer.constructor===ArrayBuffer});var m=function(L,C){return function(M){return new x(C,!0).update(M)[L]()}},y=function(L){var C=m("hex",L);s&&(C=b(C,L)),C.create=function(){return new x(L)},C.update=function(R){return C.create().update(R)};for(var M=0;M<p.length;++M){var _=p[M];C[_]=m(_,L)}return C},b=function(L,C){var M=Vd,_=Vd.Buffer,R=C?"sha224":"sha256",U;_.from&&!i.JS_SHA256_NO_BUFFER_FROM?U=_.from:U=function($){return new _($)};var q=function($){if(typeof $=="string")return M.createHash(R).update($,"utf8").digest("hex");if($==null)throw new Error(e);return $.constructor===ArrayBuffer&&($=new Uint8Array($)),Array.isArray($)||ArrayBuffer.isView($)||$.constructor===_?M.createHash(R).update(U($)).digest("hex"):L($)};return q},A=function(L,C){return function(M,_){return new N(M,C,!0).update(_)[L]()}},w=function(L){var C=A("hex",L);C.create=function(R){return new N(R,L)},C.update=function(R,U){return C.create(R).update(U)};for(var M=0;M<p.length;++M){var _=p[M];C[_]=A(_,L)}return C};function x(L,C){C?(g[0]=g[16]=g[1]=g[2]=g[3]=g[4]=g[5]=g[6]=g[7]=g[8]=g[9]=g[10]=g[11]=g[12]=g[13]=g[14]=g[15]=0,this.blocks=g):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],L?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=L}x.prototype.update=function(L){if(!this.finalized){var C,M=typeof L;if(M!=="string"){if(M==="object"){if(L===null)throw new Error(e);if(o&&L.constructor===ArrayBuffer)L=new Uint8Array(L);else if(!Array.isArray(L)&&(!o||!ArrayBuffer.isView(L)))throw new Error(e)}else throw new Error(e);C=!0}for(var _,R=0,U,q=L.length,$=this.blocks;R<q;){if(this.hashed&&(this.hashed=!1,$[0]=this.block,this.block=$[16]=$[1]=$[2]=$[3]=$[4]=$[5]=$[6]=$[7]=$[8]=$[9]=$[10]=$[11]=$[12]=$[13]=$[14]=$[15]=0),C)for(U=this.start;R<q&&U<64;++R)$[U>>>2]|=L[R]<<h[U++&3];else for(U=this.start;R<q&&U<64;++R)_=L.charCodeAt(R),_<128?$[U>>>2]|=_<<h[U++&3]:_<2048?($[U>>>2]|=(192|_>>>6)<<h[U++&3],$[U>>>2]|=(128|_&63)<<h[U++&3]):_<55296||_>=57344?($[U>>>2]|=(224|_>>>12)<<h[U++&3],$[U>>>2]|=(128|_>>>6&63)<<h[U++&3],$[U>>>2]|=(128|_&63)<<h[U++&3]):(_=65536+((_&1023)<<10|L.charCodeAt(++R)&1023),$[U>>>2]|=(240|_>>>18)<<h[U++&3],$[U>>>2]|=(128|_>>>12&63)<<h[U++&3],$[U>>>2]|=(128|_>>>6&63)<<h[U++&3],$[U>>>2]|=(128|_&63)<<h[U++&3]);this.lastByteIndex=U,this.bytes+=U-this.start,U>=64?(this.block=$[16],this.start=U-64,this.hash(),this.hashed=!0):this.start=U}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},x.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var L=this.blocks,C=this.lastByteIndex;L[16]=this.block,L[C>>>2]|=u[C&3],this.block=L[16],C>=56&&(this.hashed||this.hash(),L[0]=this.block,L[16]=L[1]=L[2]=L[3]=L[4]=L[5]=L[6]=L[7]=L[8]=L[9]=L[10]=L[11]=L[12]=L[13]=L[14]=L[15]=0),L[14]=this.hBytes<<3|this.bytes>>>29,L[15]=this.bytes<<3,this.hash()}},x.prototype.hash=function(){var L=this.h0,C=this.h1,M=this.h2,_=this.h3,R=this.h4,U=this.h5,q=this.h6,$=this.h7,Y=this.blocks,ae,ne,ce,re,V,J,ve,pe,Te,Ce,Re;for(ae=16;ae<64;++ae)V=Y[ae-15],ne=(V>>>7|V<<25)^(V>>>18|V<<14)^V>>>3,V=Y[ae-2],ce=(V>>>17|V<<15)^(V>>>19|V<<13)^V>>>10,Y[ae]=Y[ae-16]+ne+Y[ae-7]+ce<<0;for(Re=C&M,ae=0;ae<64;ae+=4)this.first?(this.is224?(pe=300032,V=Y[0]-1413257819,$=V-150054599<<0,_=V+24177077<<0):(pe=704751109,V=Y[0]-210244248,$=V-1521486534<<0,_=V+143694565<<0),this.first=!1):(ne=(L>>>2|L<<30)^(L>>>13|L<<19)^(L>>>22|L<<10),ce=(R>>>6|R<<26)^(R>>>11|R<<21)^(R>>>25|R<<7),pe=L&C,re=pe^L&M^Re,ve=R&U^~R&q,V=$+ce+ve+d[ae]+Y[ae],J=ne+re,$=_+V<<0,_=V+J<<0),ne=(_>>>2|_<<30)^(_>>>13|_<<19)^(_>>>22|_<<10),ce=($>>>6|$<<26)^($>>>11|$<<21)^($>>>25|$<<7),Te=_&L,re=Te^_&C^pe,ve=$&R^~$&U,V=q+ce+ve+d[ae+1]+Y[ae+1],J=ne+re,q=M+V<<0,M=V+J<<0,ne=(M>>>2|M<<30)^(M>>>13|M<<19)^(M>>>22|M<<10),ce=(q>>>6|q<<26)^(q>>>11|q<<21)^(q>>>25|q<<7),Ce=M&_,re=Ce^M&L^Te,ve=q&$^~q&R,V=U+ce+ve+d[ae+2]+Y[ae+2],J=ne+re,U=C+V<<0,C=V+J<<0,ne=(C>>>2|C<<30)^(C>>>13|C<<19)^(C>>>22|C<<10),ce=(U>>>6|U<<26)^(U>>>11|U<<21)^(U>>>25|U<<7),Re=C&M,re=Re^C&_^Ce,ve=U&q^~U&$,V=R+ce+ve+d[ae+3]+Y[ae+3],J=ne+re,R=L+V<<0,L=V+J<<0,this.chromeBugWorkAround=!0;this.h0=this.h0+L<<0,this.h1=this.h1+C<<0,this.h2=this.h2+M<<0,this.h3=this.h3+_<<0,this.h4=this.h4+R<<0,this.h5=this.h5+U<<0,this.h6=this.h6+q<<0,this.h7=this.h7+$<<0},x.prototype.hex=function(){this.finalize();var L=this.h0,C=this.h1,M=this.h2,_=this.h3,R=this.h4,U=this.h5,q=this.h6,$=this.h7,Y=l[L>>>28&15]+l[L>>>24&15]+l[L>>>20&15]+l[L>>>16&15]+l[L>>>12&15]+l[L>>>8&15]+l[L>>>4&15]+l[L&15]+l[C>>>28&15]+l[C>>>24&15]+l[C>>>20&15]+l[C>>>16&15]+l[C>>>12&15]+l[C>>>8&15]+l[C>>>4&15]+l[C&15]+l[M>>>28&15]+l[M>>>24&15]+l[M>>>20&15]+l[M>>>16&15]+l[M>>>12&15]+l[M>>>8&15]+l[M>>>4&15]+l[M&15]+l[_>>>28&15]+l[_>>>24&15]+l[_>>>20&15]+l[_>>>16&15]+l[_>>>12&15]+l[_>>>8&15]+l[_>>>4&15]+l[_&15]+l[R>>>28&15]+l[R>>>24&15]+l[R>>>20&15]+l[R>>>16&15]+l[R>>>12&15]+l[R>>>8&15]+l[R>>>4&15]+l[R&15]+l[U>>>28&15]+l[U>>>24&15]+l[U>>>20&15]+l[U>>>16&15]+l[U>>>12&15]+l[U>>>8&15]+l[U>>>4&15]+l[U&15]+l[q>>>28&15]+l[q>>>24&15]+l[q>>>20&15]+l[q>>>16&15]+l[q>>>12&15]+l[q>>>8&15]+l[q>>>4&15]+l[q&15];return this.is224||(Y+=l[$>>>28&15]+l[$>>>24&15]+l[$>>>20&15]+l[$>>>16&15]+l[$>>>12&15]+l[$>>>8&15]+l[$>>>4&15]+l[$&15]),Y},x.prototype.toString=x.prototype.hex,x.prototype.digest=function(){this.finalize();var L=this.h0,C=this.h1,M=this.h2,_=this.h3,R=this.h4,U=this.h5,q=this.h6,$=this.h7,Y=[L>>>24&255,L>>>16&255,L>>>8&255,L&255,C>>>24&255,C>>>16&255,C>>>8&255,C&255,M>>>24&255,M>>>16&255,M>>>8&255,M&255,_>>>24&255,_>>>16&255,_>>>8&255,_&255,R>>>24&255,R>>>16&255,R>>>8&255,R&255,U>>>24&255,U>>>16&255,U>>>8&255,U&255,q>>>24&255,q>>>16&255,q>>>8&255,q&255];return this.is224||Y.push($>>>24&255,$>>>16&255,$>>>8&255,$&255),Y},x.prototype.array=x.prototype.digest,x.prototype.arrayBuffer=function(){this.finalize();var L=new ArrayBuffer(this.is224?28:32),C=new DataView(L);return C.setUint32(0,this.h0),C.setUint32(4,this.h1),C.setUint32(8,this.h2),C.setUint32(12,this.h3),C.setUint32(16,this.h4),C.setUint32(20,this.h5),C.setUint32(24,this.h6),this.is224||C.setUint32(28,this.h7),L};function N(L,C,M){var _,R=typeof L;if(R==="string"){var U=[],q=L.length,$=0,Y;for(_=0;_<q;++_)Y=L.charCodeAt(_),Y<128?U[$++]=Y:Y<2048?(U[$++]=192|Y>>>6,U[$++]=128|Y&63):Y<55296||Y>=57344?(U[$++]=224|Y>>>12,U[$++]=128|Y>>>6&63,U[$++]=128|Y&63):(Y=65536+((Y&1023)<<10|L.charCodeAt(++_)&1023),U[$++]=240|Y>>>18,U[$++]=128|Y>>>12&63,U[$++]=128|Y>>>6&63,U[$++]=128|Y&63);L=U}else if(R==="object"){if(L===null)throw new Error(e);if(o&&L.constructor===ArrayBuffer)L=new Uint8Array(L);else if(!Array.isArray(L)&&(!o||!ArrayBuffer.isView(L)))throw new Error(e)}else throw new Error(e);L.length>64&&(L=new x(C,!0).update(L).array());var ae=[],ne=[];for(_=0;_<64;++_){var ce=L[_]||0;ae[_]=92^ce,ne[_]=54^ce}x.call(this,C,M),this.update(ne),this.oKeyPad=ae,this.inner=!0,this.sharedMemory=M}N.prototype=new x,N.prototype.finalize=function(){if(x.prototype.finalize.call(this),this.inner){this.inner=!1;var L=this.array();x.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(L),x.prototype.finalize.call(this)}};var F=y();F.sha256=F,F.sha224=y(!0),F.sha256.hmac=w(),F.sha224.hmac=w(!0),a?n.exports=F:(i.sha256=F.sha256,i.sha224=F.sha224)})()}($p)),$p.exports}var Gp=H3();class K3 extends Mi{constructor(){super(...arguments);X(this,"punctuationSubtitleService",new Vn);X(this,"subtitleRequestInfoStreamService",new oa)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>"common","vtt").pipe(vt(i=>Xt(this.parserVtt(i))),vt(i=>{const r=document.querySelector(t.siteDubbingRules.mediaSelector),s=new si(r,t.tabTitle);return s.setParam("vttParsedResult",i),s.setParam("rules",t.siteDubbingRules),Vt(this.extractMediaMetadata(t.siteDubbingRules.commonVttConfig.parseConfig,s,!1))}))}async parserVtt(t){const i=await go(t);return It.convertVttEntriesToSubtitles(i.cues)}extractMediaMetadata(t,i,r){var l;let s=i.getParam("vttParsedResult"),a=i.getParam("rules");return s=this.punctuationSubtitleService.postProcessParsedResult(s,a),{videoId:this.extractVideoId(t,i),title:i.tabTitle,subtitleMetadata:{url:void 0,language:"auto",isAsr:!1,hasPunctuation:s.hasPunctuation},subtitleLevel:Di.YELLOW,videoLanguage:hi.fromLanguage,isPrivate:!1,channelId:"",duration:((l=i.media)==null?void 0:l.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:s.subtitles,originSubtitles:s.originSubtitles,mediaUrl:i.getParam("mediaUrl")}}computeVideoId(t){const i=`${Qi.removeQueryParams(t)}`;return this.getSite()+"_"+Gp.sha256(i)}extractVideoId(t,i){return t.videoIdExtract.type==="undefined"?this.computeVideoId(window.location.href):Yt.extractVideoId(t.videoIdExtract,i)}getSite(){return"common"}async transformMetadata(t,i){return t}}class W3 extends Ha{constructor(){super(...arguments);X(this,"m3u8ParserService",new g2)}getSubtitles(t,i){return this.m3u8ParserService.parserSubtitleMetadataArray(i)}}class Y3 extends Mi{constructor(){super(...arguments);X(this,"m3u8ExtractSubtitleService",new W3);X(this,"subtitleRequestInfoStreamService",new oa);X(this,"punctuationSubtitleService",new Vn)}isHeaderOnlySite(){const t=window.location.hostname;return t.includes("x.com")||t.includes("twitter.com")}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>"common","m3u8").pipe(Ws(i=>this.syncMediaElementSrc(t,i.url)),vt(i=>{if(this.isHeaderOnlySite()){const a={credentials:"include",headers:{"X-YouTubeDubbing":"true"}};return Xt(fetch(i.url,a))}const r=Qi.addParam(i.url,"youtubedubbing","true");return Xt(fetch(r,{credentials:"include"}).catch(()=>fetch(r)))}),vt(i=>{if(!i.ok)throw new Error(`Fetch 失败: ${i.status}`);return Xt(i.text()).pipe(Ht(r=>({url:i.url,responseText:r})))}),vt(i=>{const r=this.m3u8ParserService.parseManifest(i.responseText),s=new si(document.querySelector(t.siteDubbingRules.mediaSelector),t.tabTitle);return s.setParam("mediaType","m3u8"),s.setParam("m3u8Manifest",r),s.setParam("mediaUrl",i.url),Vt(this.extractMediaMetadata(t.siteDubbingRules.mediaParseConfig.parseConfig,s,!1))}))}async transformMetadata(t,i){if(t.subtitleMetadata===void 0)return t;let r;return Qi.endsWith(t.mediaUrl,".m3u8")?(r=await this.m3u8ParserService.parserSubtitlesBySubtitleUrl(t.subtitleMetadata.url),r=this.punctuationSubtitleService.postProcessParsedResult(r,i),t.originSubtitles=r.originSubtitles,t.subtitles=r.subtitles,t.subtitleMetadata.hasPunctuation=r.hasPunctuation,t):super.transformMetadata(t,i)}extractMediaMetadata(t,i,r){var s;return{videoId:this.extractVideoId(t,i),title:i.tabTitle,subtitleMetadata:this.getM3u8BestSubtitle(i),subtitleLevel:Di.YELLOW,videoLanguage:hi.fromLanguage,isPrivate:!1,channelId:"",duration:((s=i.media)==null?void 0:s.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[],mediaUrl:i.getParam("mediaUrl")}}getM3u8BestSubtitle(t){const i={subtitleLanguageName:"srclang"};return this.m3u8ExtractSubtitleService.getBestSubtitle(i,t)}syncMediaElementSrc(t,i,r){const s=r??document.querySelector(t.siteDubbingRules.mediaSelector);if(s){const a=s.getAttribute("youtube-dubbing-src");if(!a||a!==s.src){const o=this.computeVideoId(i,window.location.href);s.setAttribute("youtube-dubbing-src",s.src),s.setAttribute("youtube-dubbing-videoId",o)}}}computeVideoId(t,i){const r=`${Qi.removeQueryParams(t)}:${Qi.removeQueryParams(i)}`;return"common_"+Gp.sha256(r)}extractVideoId(t,i){return t.videoIdExtract.type==="undefined"?i.media.getAttribute("youtube-dubbing-videoId"):Yt.extractVideoId(t.videoIdExtract,i)}}class z3 extends Bp{getSearch(e){const t=document.querySelector(e.siteDubbingRules.mediaSelector);return Yt.extractVideoId(e.siteDubbingRules.videoIdExtract,new si(t,e.tabTitle,void 0))}}class j3 extends Ha{getSubtitles(e,t){return sr.of(Le(".subtitles").find(".subtitles-menu")).map(this.createSubtitleMetadata).toArray()}createSubtitleMetadata(e){return{url:"",language:Le(e).prop("lang"),isAsr:!1,hasPunctuation:!0}}}class X3 extends Mi{constructor(){super(...arguments);X(this,"punctuationSubtitleService",new Vn)}createMetadataObservable(t){if(t.siteDubbingRules.edxConfig===void 0)throw console.error("EdxDomBasedMediaMetadataService: edxConfig is undefined for site",t.siteDubbingRules),new Error("the website is missing the edxConfig configuration.");const i=t.siteDubbingRules.edxConfig,r=document.querySelector(t.siteDubbingRules.mediaSelector),s=new si(r,t.tabTitle);return Jr(500).pipe(Zt(()=>Le(".subtitles-menu").length>0),Rn(1),vt(()=>Vt(this.extractMediaMetadata(i.parseConfig,s,!1))))}getBestSubtitle(t,i){return new j3().getBestSubtitle(t.subtitleExtract,i)}async transformMetadata(t,i){if(t.subtitleMetadata===void 0)return t;let r=this.convertSubtitles(t);return r=this.punctuationSubtitleService.postProcessParsedResult(r,i),t.originSubtitles=r.originSubtitles,t.subtitles=r.subtitles,t.subtitleMetadata.hasPunctuation=r.hasPunctuation,t}convertSubtitles(t){let i=sr.of(Le(`.subtitles-menu[lang=${t.subtitleMetadata.language}]`).find("li")).filter(a=>!a.className.includes("spacing")).filter(a=>!this.isMusicOrEmpty(Le(a).text())).toArray(),r=[],s=[];for(let a=0;a<i.length;a++){const o=Le(i[a]);let l=o.text();a===0&&(l=l.substring(l.indexOf(":")+1));let u=Number.parseInt(o.find("span").attr("data-start")),h=0;a===i.length-1?h=t.duration:h=Number.parseInt(Le(i[a+1]).find("span").attr("data-start")),r.push({start:u,end:h,dur:h-u,text:l,processPunctuation:!0}),s.push({start:u,end:h,dur:h-u,text:l,processPunctuation:!0})}return{subtitles:r,originSubtitles:s,hasPunctuation:!0}}isMusicOrEmpty(t){let i=t.trim();return i.length===0?!0:!!(i.startsWith("[")&&i.endsWith("]"))}}class J3 extends Mi{constructor(){super(...arguments);X(this,"punctuationSubtitleService",new Vn);X(this,"subtitleRequestInfoStreamService",new oa)}createMetadataObservable(t){return this.subtitleRequestInfoStreamService.observeSubtitleRequests(()=>"common","srt").pipe(vt(i=>Xt(this.parserSrt(i))),vt(i=>{const r=document.querySelector(t.siteDubbingRules.mediaSelector),s=new si(r,t.tabTitle);return s.setParam("vttParsedResult",i),s.setParam("rules",t.siteDubbingRules),Vt(this.extractMediaMetadata(t.siteDubbingRules.commonSrtConfig.parseConfig,s,!1))}))}async parserSrt(t){const i=await go(t,{type:"srt"});return It.convertVttEntriesToSubtitles(i.cues)}extractMediaMetadata(t,i,r){var l;let s=i.getParam("vttParsedResult"),a=i.getParam("rules");return s=this.punctuationSubtitleService.postProcessParsedResult(s,a),{videoId:this.extractVideoId(t,i),title:i.tabTitle,subtitleMetadata:{url:void 0,language:"auto",isAsr:!1,hasPunctuation:s.hasPunctuation},subtitleLevel:Di.YELLOW,videoLanguage:hi.fromLanguage,isPrivate:!1,channelId:"",duration:((l=i.media)==null?void 0:l.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:s.subtitles,originSubtitles:s.originSubtitles,mediaUrl:i.getParam("mediaUrl")}}computeVideoId(t){const i=`${Qi.removeQueryParams(t)}`;return this.getSite()+"_"+Gp.sha256(i)}extractVideoId(t,i){return t.videoIdExtract.type==="undefined"?this.computeVideoId(window.location.href):Yt.extractVideoId(t.videoIdExtract,i)}getSite(){return"common"}async transformMetadata(t,i){return t}}class Q3 extends U1{findTracks(e,t){const i=document.getElementById("kalutra-player_ifp");return i!=null&&i.contentDocument&&e.media?Le(e.media,i.contentDocument).find(t):super.findTracks(e,t)}}class Z3 extends y2{findMedia(e){var t,i;return(i=(t=document.getElementById("kalutra-player_ifp"))==null?void 0:t.contentDocument)==null?void 0:i.querySelector(e)}findTracks(e){const t=document.getElementById("kalutra-player_ifp");return t!=null&&t.contentDocument&&e?Le(e,t.contentDocument).find('track[kind="captions"], track[kind="subtitles"]'):super.findTracks(e)}getBestSubtitle(e,t){return new Q3().getBestSubtitle(e.subtitleExtract,t)}}var qp,D2;function eB(){return D2||(D2=1,qp={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"аҧсуа бызшәа"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"አማርኛ"},an:{name:"Aragonese",nativeName:"aragonés"},ar:{name:"Arabic",nativeName:"العربية"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},be:{name:"Belarusian",nativeName:"беларуская мова"},bg:{name:"Bulgarian",nativeName:"български език"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"বাংলা"},bo:{name:"Tibetan",nativeName:"བོད་ཡིག"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"Català"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},cs:{name:"Czech",nativeName:"Čeština"},cu:{name:"Old Church Slavonic",nativeName:"ѩзыкъ словѣньскъ"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"Dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"ދިވެހި"},dz:{name:"Dzongkha",nativeName:"རྫོང་ཁ"},ee:{name:"Ewe",nativeName:"Eʋegbe"},el:{name:"Greek",nativeName:"Ελληνικά"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Español"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"فارسی"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"vosa Vakaviti"},fo:{name:"Faroese",nativeName:"Føroyskt"},fr:{name:"French",nativeName:"Français"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"Gàidhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaraní",nativeName:"Avañe'ẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"هَوُسَ"},he:{name:"Hebrew",nativeName:"עברית"},hi:{name:"Hindi",nativeName:"हिन्दी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"Hrvatski"},ht:{name:"Haitian",nativeName:"Kreyòl ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"Հայերեն"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"ქართული"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"Gĩkũyũ"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"қазақ тілі"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"ខេមរភាសា"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},ko:{name:"Korean",nativeName:"한국어"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी"},ku:{name:"Kurdish",nativeName:"Kurdî"},kv:{name:"Komi",nativeName:"коми кыв"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"Кыргызча"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"Lëtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາລາວ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:"Kiluba"},lv:{name:"Latvian",nativeName:"latviešu valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mi:{name:"Māori",nativeName:"te reo Māori"},mk:{name:"Macedonian",nativeName:"македонски јазик"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mn:{name:"Mongolian",nativeName:"Монгол хэл"},mr:{name:"Marathi",nativeName:"मराठी"},ms:{name:"Malay",nativeName:"Bahasa Melayu"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"ဗမာစာ"},na:{name:"Nauru",nativeName:"Dorerin Naoero"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Diné bizaad"},ny:{name:"Chichewa",nativeName:"chiCheŵa"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian",nativeName:"ирон æвзаг"},pa:{name:"Panjabi",nativeName:"ਪੰਜਾਬੀ"},pi:{name:"Pāli",nativeName:"पाऴि"},pl:{name:"Polish",nativeName:"Polski"},ps:{name:"Pashto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Română"},ru:{name:"Russian",nativeName:"Русский"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},si:{name:"Sinhala",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"Slovenčina"},sl:{name:"Slovenian",nativeName:"slovenščina"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"српски језик"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"Svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},tk:{name:"Turkmen",nativeName:"Türkmençe"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татар теле"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"Українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"Ўзбек"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang",nativeName:"Saɯ cueŋƅ"},zh:{name:"Chinese",nativeName:"中文"},zu:{name:"Zulu",nativeName:"isiZulu"}}),qp}var Vp,R2;function tB(){if(R2)return Vp;R2=1;const n=eB(),e={},t={},i=[],r=[],s=[];for(const a in n){const{name:o,nativeName:l}=n[a];e[a]=t[o.toLowerCase()]=t[l.toLowerCase()]={code:a,name:o,nativeName:l},i.push(a),r.push(o),s.push(l)}return Vp=class Nh{static getLanguages(o=[]){return o.map(l=>Nh.validate(l)?Object.assign({},e[l]):{code:l,name:"",nativeName:""})}static getName(o){return Nh.validate(o)?n[o].name:""}static getAllNames(){return r.slice()}static getNativeName(o){return Nh.validate(o)?n[o].nativeName:""}static getAllNativeNames(){return s.slice()}static getCode(o){return o=o.toLowerCase(),t.hasOwnProperty(o)?t[o].code:""}static getAllCodes(){return i.slice()}static validate(o){return n.hasOwnProperty(o)}},Vp}var iB=tB();const Cs=ms(iB);class rB extends Mi{createMetadataObservable(e){return Jr(500).pipe(Ht(()=>this.tryGetPlayer()),Zt(t=>t!==void 0),Zt(t=>this.hasUsableCaptions(t)),Rn(1),vt(t=>Xt(this.buildMetadata(t,e))))}tryGetPlayer(){const e=window.jwplayer;if(typeof e=="function")try{const t=e(0);return!t||typeof t.getCaptionsList!="function"?void 0:t}catch(t){console.error("Failed to access jwplayer instance",t);return}}hasUsableCaptions(e){var i;const t=(i=e.getCaptionsList)==null?void 0:i.call(e);return Array.isArray(t)&&t.some(r=>r&&r.id!=="off")}async buildMetadata(e,t){const i=this.createMetadataFromPlayer(e,t);return this.transformMetadata(i,t.siteDubbingRules)}createMetadataFromPlayer(e,t){var u,h;const i=document.querySelector(t.siteDubbingRules.mediaSelector);if(!i)throw new Error("JW Player media element not found on page");const r=new si(i,t.tabTitle),s=this.normalizeCaptions(((u=e.getCaptionsList)==null?void 0:u.call(e))??[]),a=this.selectSubtitle(s),o=(h=e.getPlaylistItem)==null?void 0:h.call(e),l=a?this.toSubtitleMetadata(a):void 0;return{videoId:Yt.extractVideoId(t.siteDubbingRules.videoIdExtract,r),title:(o==null?void 0:o.title)??t.tabTitle,subtitleMetadata:l,subtitleLevel:Di.YELLOW,videoLanguage:(l==null?void 0:l.language)??hi.fromLanguage,isPrivate:!1,channelId:"",duration:Number.isFinite(i.duration)?i.duration:0,isLiveVideo:!1,supportLanguageCode:["SG"],subtitles:[],originSubtitles:[]}}normalizeCaptions(e){return e.filter(t=>t&&t.id!=="off").map(t=>({id:t.id,label:t.label??t.id}))}selectSubtitle(e){return e.length===0?void 0:e.find(i=>hi.matchFromLanguage(this.mapLanguageCode(i.label)))??e[0]}toSubtitleMetadata(e){const t=this.mapLanguageCode(e.label);return{url:e.id,language:t,isAsr:!1,hasPunctuation:!0}}mapLanguageCode(e){const t=e==null?void 0:e.trim();if(!t)return hi.fromLanguage;const i=this.sanitizeCaptionLabel(t),r=this.resolveLanguageCode(i);if(r)return r;const s=i.toLowerCase();return s.length>0?s:hi.fromLanguage}sanitizeCaptionLabel(e){return e.replace(/\([^)]*\)/g," ").replace(/\[[^\]]*]/g," ").replace(/\s+/g," ").trim()}resolveLanguageCode(e){const t=e.replace(/_/g,"-"),i=t.toLowerCase();if(Cs.validate(i))return i;const r=i.split("-")[0];if(Cs.validate(r))return r;const s=this.tryParseLanguageFromLocale(t);if(s&&Cs.validate(s))return s;const a=Cs.getCode(e);if(a)return a;const o=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(o!==e){const l=Cs.getCode(o);if(l)return l}for(const l of this.extractLabelFragments(t)){const u=l.toLowerCase();if(Cs.validate(u))return u;const h=Cs.getCode(l);if(h)return h;const d=u.split("-")[0];if(Cs.validate(d))return d}return s??void 0}tryParseLanguageFromLocale(e){var t;try{return((t=new Intl.Locale(e).language)==null?void 0:t.toLowerCase())??void 0}catch{return}}extractLabelFragments(e){return e.replace(/\([^)]*\)/g," ").replace(/\[[^\]]*]/g," ").split(/[\s,/]+/).map(t=>t.trim()).filter(t=>t.length>0)}}class nB extends Mi{constructor(){super(...arguments);X(this,"punctuationSubtitleService",new Vn)}createMetadataObservable(t){const i=t.siteDubbingRules.domAttrConfig;return Jr(500).pipe(Ht(()=>{const r=document.querySelector(i.attrSelector);return(r==null?void 0:r.getAttribute(i.attrName))||null}),Zt(r=>r!==null&&r!==""),W0(),vt(r=>Xt(fetch(r).then(s=>s.text()))),vt(r=>Xt(this.parserVtt(r))),vt(r=>{const s=document.querySelector(t.siteDubbingRules.mediaSelector),a=new si(s,t.tabTitle);return a.setParam("vttParsedResult",r),a.setParam("rules",t.siteDubbingRules),Vt(this.extractMediaMetadataFromVtt(i.parseConfig,a,!1))}))}async parserVtt(t){const i=await go(t);return It.convertVttEntriesToSubtitles(i.cues)}extractMediaMetadataFromVtt(t,i,r){var l;let s=i.getParam("vttParsedResult");const a=i.getParam("rules");return s=this.punctuationSubtitleService.postProcessParsedResult(s,a),{videoId:this.extractVideoId(t,i),title:i.tabTitle,subtitleMetadata:{url:void 0,language:"auto",isAsr:!1,hasPunctuation:s.hasPunctuation},subtitleLevel:Di.YELLOW,videoLanguage:hi.fromLanguage,isPrivate:!1,channelId:"",duration:((l=i.media)==null?void 0:l.duration)??0,isLiveVideo:r,supportLanguageCode:["SG"],subtitles:s.subtitles,originSubtitles:s.originSubtitles,mediaUrl:i.getParam("mediaUrl")}}extractVideoId(t,i){return t.videoIdExtract.type==="undefined"?"domattr_"+window.location.pathname.replace(/\//g,"_"):Yt.extractVideoId(t.videoIdExtract,i)}async transformMetadata(t,i){return t}}const la=class la{constructor(){X(this,"elementToBinding",new WeakMap);X(this,"urlToBinding",new Map);X(this,"listeners",[])}static getInstance(){return la.instance||(la.instance=new la),la.instance}register(e,t,i){const r=this.normalizeUrl(t),s={mediaElement:e,mediaUrl:r,playerType:i,timestamp:Date.now()};this.unregisterByElement(e),this.unregisterByUrl(r),this.elementToBinding.set(e,s),this.urlToBinding.set(r,s),this.notifyListeners(s)}getByElement(e){return this.elementToBinding.get(e)}getByUrl(e){const t=this.normalizeUrl(e);return this.urlToBinding.get(t)}getMediaUrl(e){var t;return(t=this.elementToBinding.get(e))==null?void 0:t.mediaUrl}getAllBindings(){return Array.from(this.urlToBinding.values())}hasElement(e){return this.elementToBinding.has(e)}hasUrl(e){const t=this.normalizeUrl(e);return this.urlToBinding.has(t)}unregisterByElement(e){const t=this.elementToBinding.get(e);t&&(this.elementToBinding.delete(e),this.urlToBinding.delete(t.mediaUrl))}unregisterByUrl(e){const t=this.normalizeUrl(e),i=this.urlToBinding.get(t);i&&(this.urlToBinding.delete(t),this.elementToBinding.delete(i.mediaElement))}addListener(e){this.listeners.push(e)}removeListener(e){const t=this.listeners.indexOf(e);t!==-1&&this.listeners.splice(t,1)}clear(){this.elementToBinding=new WeakMap,this.urlToBinding.clear()}normalizeUrl(e){try{return e.startsWith("blob:"),e}catch{return e}}notifyListeners(e){for(const t of this.listeners)try{t(e)}catch(i){console.error("[MediaElementRegistry] Listener error:",i)}}};X(la,"instance",null);let Hp=la;function $r(){return Hp.getInstance()}class Ll{constructor(){X(this,"installed",!1);X(this,"originalMethods",new Map)}uninstall(){this.installed&&(this.restoreOriginalMethods(),this.installed=!1)}isInstalled(){return this.installed}registerBinding(e,t){!e||!t||t.startsWith("blob:")||t.startsWith("data:")||$r().register(e,t,this.playerType)}hookMethod(e,t,i){const r=e[t];if(typeof r!="function"){console.warn(`[${this.playerType}Hook] ${t} is not a function`);return}const s=`${this.getTargetKey(e)}.${t}`;this.originalMethods.set(s,r),e[t]=function(...a){return i.call(this,r.bind(this),...a)}}hookPrototypeMethod(e,t,i){this.hookMethod(e,t,i)}restoreOriginalMethods(){this.originalMethods.clear()}getTargetKey(e){return e.constructor&&e.constructor.name?e.constructor.name:"unknown"}isHLSUrl(e){if(!e)return!1;const t=e.toLowerCase();return t.includes(".m3u8")||t.includes("application/vnd.apple.mpegurl")||t.includes("application/x-mpegurl")}isDASHUrl(e){return e?e.toLowerCase().includes(".mpd"):!1}isDirectMediaUrl(e){if(!e)return!1;const t=e.toLowerCase();return t.includes(".mp4")||t.includes(".mp3")||t.includes(".webm")||t.includes(".ogg")||t.includes(".wav")}getGlobal(e){try{return window[e]}catch{return}}waitForGlobal(e,t=1e4,i=100){return new Promise(r=>{const s=Date.now(),a=()=>{const o=this.getGlobal(e);if(o!==void 0){r(o);return}if(Date.now()-s>=t){r(void 0);return}setTimeout(a,i)};a()})}}class sB extends Ll{constructor(){super(...arguments);X(this,"playerType","hlsjs");X(this,"originalHls",null);X(this,"instanceBindings",new WeakMap);X(this,"deferredHookSetup",!1)}isAvailable(){return typeof this.getGlobal("Hls")=="function"}install(){if(this.installed||this.deferredHookSetup)return;const t=this.getGlobal("Hls");if(!t){this.setupDeferredHook();return}this.doInstall(t)}doInstall(t){this.originalHls=t;const i=t.prototype.attachMedia,r=this;t.prototype.attachMedia=function(a){let o=r.instanceBindings.get(this);return o||(o={},r.instanceBindings.set(this,o)),o.media=a,o.url&&r.registerBinding(a,o.url),i.call(this,a)};const s=t.prototype.loadSource;this.installed=!0,t.prototype.loadSource=function(a){let o=r.instanceBindings.get(this);return o||(o={},r.instanceBindings.set(this,o)),o.url=a,o.media&&r.registerBinding(o.media,a),s.call(this,a)}}setupDeferredHook(){const t=this;let i;Object.defineProperty(window,"Hls",{configurable:!0,get(){return i},set(r){r&&!t.installed&&t.doInstall(r),i=r}}),this.deferredHookSetup=!0}uninstall(){this.instanceBindings=new WeakMap,super.uninstall()}}class aB extends Ll{constructor(){super(...arguments);X(this,"playerType","shaka");X(this,"instanceBindings",new WeakMap);X(this,"deferredHookSetup",!1)}isAvailable(){const t=this.getGlobal("shaka");return t!==void 0&&typeof t.Player=="function"}install(){if(this.installed||this.deferredHookSetup)return;const t=this.getGlobal("shaka");if(!t||!t.Player){this.setupDeferredHook();return}this.doInstall(t)}doInstall(t){const i=this,r=t.Player,s=function(l){const u=new r(l);if(l){let h=i.instanceBindings.get(u);h||(h={},i.instanceBindings.set(u,h)),h.media=l}return u};Object.setPrototypeOf(s,r),s.prototype=r.prototype;const a=r.prototype.attach;r.prototype.attach=async function(l){let u=i.instanceBindings.get(this);return u||(u={},i.instanceBindings.set(this,u)),u.media=l,u.url&&i.registerBinding(l,u.url),a.call(this,l)};const o=r.prototype.load;r.prototype.load=async function(l,u,h){var g;let d=i.instanceBindings.get(this);d||(d={},i.instanceBindings.set(this,d)),d.url=l;const p=d.media||((g=this.getMediaElement)==null?void 0:g.call(this));return p&&i.registerBinding(p,l),o.call(this,l,u,h)},this.installed=!0,t.Player=s}setupDeferredHook(){const t=this;let i;Object.defineProperty(window,"shaka",{configurable:!0,get(){return i},set(r){r&&r.Player&&!t.installed&&t.doInstall(r),i=r}}),this.deferredHookSetup=!0}uninstall(){this.instanceBindings=new WeakMap,super.uninstall()}}class oB extends Ll{constructor(){super(...arguments);X(this,"playerType","videojs");X(this,"playerBindings",new WeakMap);X(this,"deferredHookSetup",!1)}isAvailable(){return typeof this.getGlobal("videojs")=="function"}install(){if(this.installed||this.deferredHookSetup)return;const t=this.getGlobal("videojs");if(!t){this.setupDeferredHook();return}this.doInstall(t)}doInstall(t){const i=this,r=function(s,a,o){var h;const l=t(s,a,o);let u;try{const d=(h=l.tech)==null?void 0:h.call(l,!0);if(d&&(u=d.el()),!u){const p=l.el();u=p==null?void 0:p.querySelector("video")}}catch(d){console.warn("[VideoJsHook] Failed to get media element:",d)}if(u){let d=i.playerBindings.get(l);d||(d={media:u},i.playerBindings.set(l,d)),d.media=u,d.url&&i.registerBinding(u,d.url)}return i.hookPlayerSrc(l),l};Object.assign(r,t),this.installed=!0,window.videojs=r}hookPlayerSrc(t){const i=this,r=t.src.bind(t);t.src=function(s){var o;if(s===void 0)return r();let a;if(typeof s=="string"?a=s:Array.isArray(s)&&s.length>0?a=s[0].src:typeof s=="object"&&s!==null&&(a=s.src),a){let l=i.playerBindings.get(t);l||(l={},i.playerBindings.set(t,l)),l.url=a;let u=l.media;if(!u)try{const h=(o=t.tech)==null?void 0:o.call(t,!0);if(h&&(u=h.el()),!u){const d=t.el();u=d==null?void 0:d.querySelector("video")}}catch{}u&&a&&i.registerBinding(u,a)}return r(s)}}setupDeferredHook(){const t=this;let i;Object.defineProperty(window,"videojs",{configurable:!0,get(){return i},set(r){r&&!t.installed&&t.doInstall(r),i=r}}),this.deferredHookSetup=!0}uninstall(){this.playerBindings=new WeakMap,super.uninstall()}}class lB extends Ll{constructor(){super(...arguments);X(this,"playerType","jwplayer");X(this,"playerBindings",new WeakMap);X(this,"deferredHookSetup",!1)}isAvailable(){return typeof this.getGlobal("jwplayer")=="function"}install(){if(this.installed||this.deferredHookSetup)return;const t=this.getGlobal("jwplayer");if(!t){this.setupDeferredHook();return}this.doInstall(t)}doInstall(t){const i=this,r=function(s){const a=t(s);let o=i.playerBindings.get(a);return o||(o={},i.playerBindings.set(a,o)),i.hookSetup(a),i.hookLoad(a),a};Object.assign(r,t),this.installed=!0,window.jwplayer=r}hookSetup(t){const i=this,r=t.setup.bind(t);t.setup=function(s){const a=i.extractUrl(s),o=r(s);return setTimeout(()=>{const l=i.findMediaElement(t);l&&a&&i.registerBinding(l,a);let u=i.playerBindings.get(t);u||(u={},i.playerBindings.set(t,u)),u.url=a},100),o}}hookLoad(t){const i=this,r=t.load.bind(t);t.load=function(s){let a;typeof s=="string"?a=s:Array.isArray(s)&&s.length>0?a=i.extractUrlFromItem(s[0]):typeof s=="object"&&s!==null&&(a=i.extractUrlFromItem(s)),r(s);const o=i.findMediaElement(t);o&&a&&i.registerBinding(o,a)}}extractUrl(t){if(t.file)return t.file;if(t.sources&&t.sources.length>0)return t.sources[0].file;if(t.playlist&&t.playlist.length>0)return this.extractUrlFromItem(t.playlist[0])}extractUrlFromItem(t){if(t.file)return t.file;if(t.sources&&t.sources.length>0)return t.sources[0].file}findMediaElement(t){try{const i=t.getContainer();if(i){const r=i.querySelector("video");if(r)return r}}catch(i){console.warn("[JwPlayerHook] Failed to get media element:",i)}}setupDeferredHook(){const t=this;let i;Object.defineProperty(window,"jwplayer",{configurable:!0,get(){return i},set(r){r&&!t.installed&&t.doInstall(r),i=r}}),this.deferredHookSetup=!0}uninstall(){this.playerBindings=new WeakMap,super.uninstall()}}class uB extends Ll{constructor(){super(...arguments);X(this,"playerType","dashjs");X(this,"playerBindings",new WeakMap);X(this,"deferredHookSetup",!1)}isAvailable(){const t=this.getGlobal("dashjs");return t!==void 0&&typeof t.MediaPlayer=="function"}install(){if(this.installed||this.deferredHookSetup)return;const t=this.getGlobal("dashjs");if(!t){this.setupDeferredHook();return}this.doInstall(t)}doInstall(t){const i=this,r=t.MediaPlayer;t.MediaPlayer=function(){const s=r(),a=s.create;return s.create=function(){const o=a();return i.hookInitialize(o),i.hookAttachView(o),i.hookAttachSource(o),o},s},Object.assign(t.MediaPlayer,r),this.installed=!0}hookInitialize(t){const i=this,r=t.initialize.bind(t);t.initialize=function(s,a,o){r(s,a,o),s&&a&&i.registerBinding(s,a);let l=i.playerBindings.get(t);l||(l={},i.playerBindings.set(t,l)),s&&(l.media=s),a&&(l.url=a)}}hookAttachView(t){const i=this,r=t.attachView.bind(t);t.attachView=function(s){r(s);let a=i.playerBindings.get(t);a||(a={},i.playerBindings.set(t,a)),a.media=s,a.url&&i.registerBinding(s,a.url)}}hookAttachSource(t){const i=this,r=t.attachSource.bind(t);t.attachSource=function(s){var l;r(s);let a=i.playerBindings.get(t);a||(a={},i.playerBindings.set(t,a)),a.url=s;const o=a.media||((l=t.getVideoElement)==null?void 0:l.call(t));o&&i.registerBinding(o,s)}}setupDeferredHook(){const t=this;let i;Object.defineProperty(window,"dashjs",{configurable:!0,get(){return i},set(r){r&&typeof r.MediaPlayer=="function"&&!t.installed&&t.doInstall(r),i=r}}),this.deferredHookSetup=!0}uninstall(){this.playerBindings=new WeakMap,super.uninstall()}}const cB=["youtube.com","www.youtube.com","youtu.be","bilibili.com","www.bilibili.com","b23.tv"],ua=class ua{constructor(){X(this,"hooks",[]);X(this,"initialized",!1);this.hooks=[new sB,new aB,new oB,new lB,new uB]}static getInstance(){return ua.instance||(ua.instance=new ua),ua.instance}shouldExclude(){try{const e=window.location.hostname.toLowerCase();return cB.some(t=>e===t||e.endsWith("."+t))}catch{return!1}}initialize(){if(!this.initialized){if(this.shouldExclude()){this.initialized=!0;return}for(const e of this.hooks)try{e.install()}catch(t){console.error(`[PlayerHookManager] Failed to install ${e.playerType} hook:`,t)}this.initialized=!0}}destroy(){if(this.initialized){for(const e of this.hooks)try{e.uninstall()}catch(t){console.error(`[PlayerHookManager] Failed to uninstall ${e.playerType} hook:`,t)}$r().clear(),this.initialized=!1}}getMediaUrl(e){return $r().getMediaUrl(e)}getBinding(e){return $r().getByElement(e)}getAllBindings(){return $r().getAllBindings()}hasBinding(e){return $r().hasElement(e)}addBindingListener(e){$r().addListener(e)}removeBindingListener(e){$r().removeListener(e)}isInitialized(){return this.initialized}getInstalledHooks(){return this.hooks.filter(e=>e.isInstalled())}hasAvailablePlayers(){return this.hooks.some(e=>e.isAvailable())}};X(ua,"instance",null);let Kp=ua;function hB(){return Kp.getInstance()}function dB(){hB().initialize()}function fB(){console.log("[debug-metadata] enter inject script",Ew);try{dB()}catch(e){console.error("[debug-metadata] Failed to initialize player hooks:",e)}$r().addListener(e=>{var t;(t=window.pageContentRpc)==null||t.sendMessage("onMediaBindingRegistered",{mediaUrl:e.mediaUrl,playerType:e.playerType}).catch(()=>{})}),window.pageContentRpc.onMessage("queryMediaBinding",async e=>{const t=e.data,i=document.querySelector(`[data-yd-element-id="${t.mediaElementId}"]`);if(!i)return{found:!1};const r=$r().getByElement(i);if(r)return{found:!0,mediaUrl:r.mediaUrl,playerType:r.playerType};const s=$r().getAllBindings(),a=document.querySelectorAll("video").length;if(s.length>0&&a===1){const o=s[s.length-1];return{found:!0,mediaUrl:o.mediaUrl,playerType:o.playerType}}return{found:!1}}),window.pageContentRpc.onMessage("sendRuleToInjectScript",e=>{if(e.data.className!=="InjectScriptParam")return;const t=e.data;hi.fromLanguage=t.fromLanguage,Bo(t.siteDubbingRules.subtitleFetchMethod).with("domTrack",()=>new y2().observeMediaMetadata(t)).with("apiIntercept",()=>new Bp().observeMediaMetadata(t)).with("windowVariable",()=>new v2().observeMediaMetadata(t)).with("hybrid",()=>new P3().observeMediaMetadata(t)).with("youtube",()=>new O3().observeMediaMetadata(t)).with("google_drive_youtube",()=>new F3().observeMediaMetadata(t)).with("mux",()=>new $3().observeMediaMetadata(t)).with("bili",()=>new G3().observeMediaMetadata(t)).with("videojs",()=>new q3().observeMediaMetadata(t)).with("dropbox",()=>new V3().observeMediaMetadata(t)).with("commonVtt",()=>new K3().observeMediaMetadata(t)).with("domAttr",()=>new nB().observeMediaMetadata(t)).with("commonM3u8",()=>new Y3().observeMediaMetadata(t)).with("udemy",()=>new z3().observeMediaMetadata(t)).with("edx",()=>new X3().observeMediaMetadata(t)).with("commonSrt",()=>new J3().observeMediaMetadata(t)).with("ixl",()=>new Z3().observeMediaMetadata(t)).with("jwplayer",()=>new rB().observeMediaMetadata(t)).with("twitter",()=>{var r;return(r=window.pageContentRpc)==null||r.onMessage("onUrlChange",()=>{}),jr}).with("universal",()=>{var r;return(r=window.pageContentRpc)==null||r.onMessage("onUrlChange",()=>{}),jr}).exhaustive().subscribe(r=>{Le(document.body).attr("youtube-dubbing-player-videoId",r.videoId),window.pageContentRpc.sendMessage("sendMetadataToContentScript",r)})}),window.pageContentRpc.onMessage("hideSubtitle",()=>{document.getElementById(Ki.getPlayerId()).setOption("captions","track",{})}),window.pageContentRpc.onMessage("extractQuotedTweetId",async e=>{const{posterUrl:t}=e.data;if(!t)return{tweetId:null};const i=Le("video").filter((a,o)=>o.poster===t).get(0);if(!i)return{tweetId:null};const r=i.closest('article[role="article"]')||i.closest('[data-testid="tweet"]');if(!r)return{tweetId:null};let s=i;for(;s&&s!==r;){if(s.tagName==="DIV"&&s.getAttribute("role")==="link"){const a=n(s);if(a)return{tweetId:a}}s=s.parentElement}return{tweetId:null}});function n(e){var t;try{const i=Object.keys(e).find(a=>a.startsWith("__reactFiber"));if(!i)return null;let s=e[i];for(let a=0;a<5&&s;a++){const o=s.memoizedProps||s.pendingProps;if((t=o==null?void 0:o.link)!=null&&t.pathname){const l=o.link.pathname.match(/\/status\/(\d+)/);if(l)return l[1]}s=s.return}}catch(i){console.warn("[injectScript] Failed to extract tweetId from React Fiber:",i)}return null}window.pageContentRpc.onMessage("extractTikTokVideoData",async()=>gB()),window.pageContentRpc.onMessage("getDouyinPlayerConfigUrl",async()=>pB()),window.pageContentRpc.onMessage("getDouyinPlayerVid",async()=>{var e;try{const t=window.player;return((e=t==null?void 0:t.curDefinition)==null?void 0:e.vid)||null}catch{return null}}),window.pageContentRpc.onMessage("getDouyinPlayerVideoSrc",async()=>{try{const e=window.player,t=e==null?void 0:e.video;return(t==null?void 0:t.src)||(t==null?void 0:t.currentSrc)||null}catch{return null}}),window.pageContentRpc.sendMessage("onload").then()}function gB(){var n,e,t,i,r;try{const s=document.querySelectorAll("video");let a=null;for(const b of s)if(!b.paused&&b.currentTime>0){a=b;break}if(!a){for(const b of s)if(b.src||b.currentSrc){a=b;break}}if(!a)return null;let o=a.parentElement,l=null;for(;o;){if((n=o.id)!=null&&n.startsWith("xgwrapper-")){l=o;break}o=o.parentElement}if(!l)return null;const u=l.id.split("-").pop();if(!u)return null;const h=Object.keys(l).find(b=>b.startsWith("__reactFiber"));if(!h)return null;const d=l[h],p=I2(d,0);if(!(p!=null&&p.length))return null;const g=new Set;p.forEach(b=>{var w;(((w=b.PlayAddr)==null?void 0:w.UrlList)||[]).forEach(x=>{try{const F=new URL(x).pathname.split("/").filter(C=>C),L=F[F.length-1];L&&L!=="play"&&g.add(L)}catch{}})});const m=((t=(e=p[0])==null?void 0:e.PlayAddr)==null?void 0:t.Uri)||"";let y;try{const b=window.__$UNIVERSAL_DATA$__,A=(i=b==null?void 0:b.__DEFAULT_SCOPE__)==null?void 0:i["webapp.updated-items"];if(A&&u){for(const w in A)if(A[w]&&A[w].id===u){y=(r=A[w].author)==null?void 0:r.uniqueId;break}}}catch(b){console.warn("[injectScript] Failed to extract uniqueId:",b)}return{itemId:u,videoID:m,pathIds:Array.from(g),bitrateInfo:p,uniqueId:y}}catch(s){return console.error("[injectScript] Failed to extract TikTok video data:",s),null}}function I2(n,e){var t;return e>15||!n?null:(t=n.memoizedProps)!=null&&t.bitrateInfo?n.memoizedProps.bitrateInfo:I2(n.return,e+1)}function pB(){var n,e,t,i;try{const r=window.player;if(!(r!=null&&r.curDefinition))return console.log("[Douyin Debug] window.player.curDefinition not found"),null;const s=r.curDefinition,a=s.vid;if(!a)return console.log("[Douyin Debug] curDefinition.vid not found"),null;const o=s.format,l=s.audioDefinition;if(o==="dash"&&l){if(l.main_url&&l.main_url.includes("douyinvod.com"))return console.log("[Douyin Debug] DASH format - Using audioDefinition.main_url for awemeId:",a),{awemeId:a,url:l.main_url};if((e=(n=l.url)==null?void 0:n[0])!=null&&e.src&&l.url[0].src.includes("douyinvod.com"))return console.log("[Douyin Debug] DASH format - Using audioDefinition.url[0].src for awemeId:",a),{awemeId:a,url:l.url[0].src};if(l.backup_url_1&&l.backup_url_1.includes("douyinvod.com"))return console.log("[Douyin Debug] DASH format - Using audioDefinition.backup_url_1 for awemeId:",a),{awemeId:a,url:l.backup_url_1};if(l.fallback_url)return console.log("[Douyin Debug] DASH format - Using audioDefinition.fallback_url for awemeId:",a),{awemeId:a,url:l.fallback_url}}if((i=(t=s.url)==null?void 0:t[0])!=null&&i.src){const u=s.url[0].src;if(u.includes("douyinvod.com"))return console.log("[Douyin Debug] MP4 format - Using url[0].src for awemeId:",a),{awemeId:a,url:u}}return console.log("[Douyin Debug] No valid URL found in curDefinition"),null}catch(r){return console.warn("[Douyin Debug] Failed to extract curDefinition:",r),null}}const mB=Vs(()=>{fB()});function H9(){}function _c(n,...e){}const yB={debug:(...n)=>_c(console.debug,...n),log:(...n)=>_c(console.log,...n),warn:(...n)=>_c(console.warn,...n),error:(...n)=>_c(console.error,...n)},vB=(async()=>{try{return await mB.main()}catch(n){throw yB.error('The unlisted script "injectScript" crashed on startup!',n),n}})(),bB=/,/g,EB="-->";class C2 extends Lp{parse(e,t){var i,r;if(e==="")this.a&&(this.j.push(this.a),(r=(i=this.f).onCue)==null||r.call(i,this.a),this.a=null),this.c=Rl.None;else if(this.c===Rl.Cue)this.a.text+=(this.a.text?`
`:"")+e;else if(e.includes(EB)){const s=this.o(e,t);s&&(this.a=new Np(s[0],s[1],s[2].join(" ")),this.a.id=this.l,this.c=Rl.Cue)}this.l=e}o(e,t){return super.o(e.replace(bB,"."),t)}}function AB(){return new C2}const SB=Object.freeze(Object.defineProperty({__proto__:null,SRTParser:C2,default:AB},Symbol.toStringTag,{value:"Module"})),Mc=/^Format:[\s\t]*/,N2=/^Style:[\s\t]*/,L2=/^Dialogue:[\s\t]*/,kc=/[\s\t]*,[\s\t]*/,_2=/\{[^}]+\}/g,M2=/\\N/g,k2=/^\[(.*)[\s\t]?Styles\]$/,Wp=/^\[(.*)[\s\t]?Events\]$/;class P2{constructor(){X(this,"f");X(this,"O",0);X(this,"a",null);X(this,"j",[]);X(this,"k",[]);X(this,"N",null);X(this,"d");X(this,"P",{})}async init(e){this.f=e,e.errors&&(this.d=(await Promise.resolve().then(()=>O2)).ParseErrorBuilder)}parse(e,t){var i,r;if(this.O)switch(this.O){case 1:if(e==="")this.O=0;else if(N2.test(e))if(this.N){const s=e.replace(N2,"").split(kc);this.S(s)}else this.e((i=this.d)==null?void 0:i.T("Style",t));else Mc.test(e)?this.N=e.replace(Mc,"").split(kc):Wp.test(e)&&(this.N=null,this.O=2);break;case 2:if(e==="")this.Q();else if(L2.test(e))if(this.Q(),this.N){const s=e.replace(L2,"").split(kc),a=this.U(s,t);a&&(this.a=a)}else this.e((r=this.d)==null?void 0:r.T("Dialogue",t));else this.a?this.a.text+=`
`+e.replace(_2,"").replace(M2,`
`):Mc.test(e)?this.N=e.replace(Mc,"").split(kc):k2.test(e)?(this.N=null,this.O=1):Wp.test(e)&&(this.N=null)}else e===""||(k2.test(e)?(this.N=null,this.O=1):Wp.test(e)&&(this.N=null,this.O=2))}done(){return{metadata:{},cues:this.j,regions:[],errors:this.k}}Q(){var e,t;this.a&&(this.j.push(this.a),(t=(e=this.f).onCue)==null||t.call(e,this.a),this.a=null)}S(e){let t="Default",i={},r,s="center",a="bottom",o,l=1.2,u,h,d=3,p=[];for(let g=0;g<this.N.length;g++){const m=this.N[g],y=e[g];switch(m){case"Name":t=y;break;case"Fontname":i["font-family"]=y;break;case"Fontsize":i["font-size"]=`calc(${y} / var(--overlay-height))`;break;case"PrimaryColour":const b=Yp(y);b&&(i["--cue-color"]=b);break;case"BorderStyle":d=parseInt(y,10);break;case"BackColour":h=Yp(y);break;case"OutlineColour":const A=Yp(y);A&&(u=A);break;case"Bold":parseInt(y)&&(i["font-weight"]="bold");break;case"Italic":parseInt(y)&&(i["font-style"]="italic");break;case"Underline":parseInt(y)&&(i["text-decoration"]="underline");break;case"StrikeOut":parseInt(y)&&(i["text-decoration"]="line-through");break;case"Spacing":i["letter-spacing"]=y+"px";break;case"AlphaLevel":i.opacity=parseFloat(y);break;case"ScaleX":p.push(`scaleX(${parseFloat(y)/100})`);break;case"ScaleY":p.push(`scaleY(${parseFloat(y)/100})`);break;case"Angle":p.push(`rotate(${y}deg)`);break;case"Shadow":l=parseInt(y,10)*1.2;break;case"MarginL":i["--cue-width"]="auto",i["--cue-left"]=parseFloat(y)+"px";break;case"MarginR":i["--cue-width"]="auto",i["--cue-right"]=parseFloat(y)+"px";break;case"MarginV":o=parseFloat(y);break;case"Outline":r=parseInt(y,10);break;case"Alignment":const w=parseInt(y,10);switch(w>=4&&(a=w>=7?"top":"center"),w%3){case 1:s="start";break;case 2:s="center";break;case 3:s="end";break}}}if(i.R=a,i["--cue-white-space"]="normal",i["--cue-line-height"]="normal",i["--cue-text-align"]=s,a==="center"?(i["--cue-top"]="50%",p.push("translateY(-50%)")):i[`--cue-${a}`]=(o||0)+"px",d===1&&(i["--cue-padding-y"]="0"),(d===1||h)&&(i["--cue-bg-color"]=d===1?"none":h),d===3&&u&&(i["--cue-outline"]=`${r}px solid ${u}`),d===1&&typeof r=="number"){const g=h??"#000";i["--cue-text-shadow"]=[u&&zp(r*1.2,l*1.2,u),u?zp(r*(r/2),l*(r/2),g):zp(r,l,g)].filter(Boolean).join(", ")}p.length&&(i["--cue-transform"]=p.join(" ")),this.P[t]=i}U(e,t){const i=this.V(e),r=this.o(i.Start,i.End,t);if(!r)return;const s=new Np(r[0],r[1],""),a={...this.P[i.Style]||{}},o=i.Name?`<v ${i.Name}>`:"",l=a.R,u=i.MarginL&&parseFloat(i.MarginL),h=i.MarginR&&parseFloat(i.MarginR),d=i.MarginV&&parseFloat(i.MarginV);return u&&(a["--cue-width"]="auto",a["--cue-left"]=u+"px"),h&&(a["--cue-width"]="auto",a["--cue-right"]=h+"px"),d&&l!=="center"&&(a[`--cue-${l}`]=d+"px"),s.text=o+e.slice(this.N.length-1).join(", ").replace(_2,"").replace(M2,`
`),delete a.R,Object.keys(a).length&&(s.style=a),s}V(e){const t={};for(let i=0;i<this.N.length;i++)t[this.N[i]]=e[i];return t}o(e,t,i){var a,o,l;const r=Il(e),s=Il(t);if(r!==null&&s!==null&&s>r)return[r,s];r===null&&this.e((a=this.d)==null?void 0:a.q(e,i)),s===null&&this.e((o=this.d)==null?void 0:o.r(t,i)),r!=null&&s!==null&&s>r&&this.e((l=this.d)==null?void 0:l.s(r,s,i))}e(e){var t,i;if(e){if(this.k.push(e),this.f.strict)throw this.f.cancel(),e;(i=(t=this.f).onError)==null||i.call(t,e)}}}function Yp(n){const e=parseInt(n.replace("&H",""),16);if(e>=0){const i=(e>>24&255^255)/255,r=e>>16&255,s=e>>8&255;return"rgba("+[e&255,s,r,i].join(",")+")"}return null}function zp(n,e,t){const i=Math.ceil(2*Math.PI*n);let r="";for(let s=0;s<i;s++){const a=2*Math.PI*s/i;r+=n*Math.cos(a)+"px "+e*Math.sin(a)+"px 0 "+t+(s==i-1?"":",")}return r}function xB(){return new P2}const TB=Object.freeze(Object.defineProperty({__proto__:null,SSAParser:P2,default:xB},Symbol.toStringTag,{value:"Module"})),O2=Object.freeze(Object.defineProperty({__proto__:null,ParseErrorBuilder:{p(){return new Kn({code:Hn.BadSignature,reason:"missing WEBVTT file header",line:1})},q(n,e){return new Kn({code:Hn.BadTimestamp,reason:`cue start timestamp \`${n}\` is invalid on line ${e}`,line:e})},r(n,e){return new Kn({code:Hn.BadTimestamp,reason:`cue end timestamp \`${n}\` is invalid on line ${e}`,line:e})},s(n,e,t){return new Kn({code:Hn.BadTimestamp,reason:`cue end timestamp \`${e}\` is greater than start \`${n}\` on line ${t}`,line:t})},w(n,e,t){return new Kn({code:Hn.BadSettingValue,reason:`invalid value for cue setting \`${n}\` on line ${t} (value: ${e})`,line:t})},v(n,e,t){return new Kn({code:Hn.UnknownSetting,reason:`unknown cue setting \`${n}\` on line ${t} (value: ${e})`,line:t})},u(n,e,t){return new Kn({code:Hn.BadSettingValue,reason:`invalid value for region setting \`${n}\` on line ${t} (value: ${e})`,line:t})},t(n,e,t){return new Kn({code:Hn.UnknownSetting,reason:`unknown region setting \`${n}\` on line ${t} (value: ${e})`,line:t})},T(n,e){return new Kn({code:Hn.BadFormat,reason:`format missing for \`${n}\` block on line ${e}`,line:e})}}},Symbol.toStringTag,{value:"Module"}));return vB}();
injectscript;</script><style>body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:hsl(0,0%,33%);font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):focus-visible{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):focus-visible{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):focus-visible{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus-visible{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:1em 1.6em .3em;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid hsl(0,0%,85%);border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:hsl(0,0%,94%);color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:rgb(249.95234375,205.965625,167.74765625);color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:rgb(156.7033492823,224.2822966507,246.2966507177);color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:rgb(200.8064516129,217.9677419355,225.1935483871);color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}</style><style type="text/css">  @-webkit-keyframes rotate {
    from  { -webkit-transform: rotate(0deg); }
    to   { -webkit-transform: rotate(360deg); }
  }

  @keyframes rotate {
    from  { transform: rotate(0deg); }
    to   { transform: rotate(360deg); }
  }

    .dropbox-dropin-btn, .dropbox-dropin-btn:link, .dropbox-dropin-btn:hover {
      display: inline-block;
      height: 14px;
      font-family: "Lucida Grande", "Segoe UI", "Tahoma", "Helvetica Neue", "Helvetica", sans-serif;
      font-size: 11px;
      font-weight: 600;
      color: #636363;
      text-decoration: none;
      padding: 1px 7px 5px 3px;
      border: 1px solid #ebebeb;
      border-radius: 2px;
      border-bottom-color: #d4d4d4;
        background: #fcfcfc;
  background: -moz-linear-gradient(top, #fcfcfc 0%, #f5f5f5 100%);
  background: -webkit-linear-gradient(top, #fcfcfc 0%, #f5f5f5 100%);
  background: linear-gradient(to bottom, #fcfcfc 0%, #f5f5f5 100%);
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fcfcfc', endColorstr='#f5f5f5',GradientType=0);  
    }

    .dropbox-dropin-default:hover, .dropbox-dropin-error:hover {
      border-color: #dedede;
      border-bottom-color: #cacaca;
        background: #fdfdfd;
  background: -moz-linear-gradient(top, #fdfdfd 0%, #f5f5f5 100%);
  background: -webkit-linear-gradient(top, #fdfdfd 0%, #f5f5f5 100%);
  background: linear-gradient(to bottom, #fdfdfd 0%, #f5f5f5 100%);
  filter: progid:DXImageTransform.Microsoft.gradient(startColorstr='#fdfdfd', endColorstr='#f5f5f5',GradientType=0);  
    }

    .dropbox-dropin-default:active, .dropbox-dropin-error:active {
      border-color: #d1d1d1;
      box-shadow: inset 0 1px 1px rgba(0,0,0,0.1);
    }

    .dropbox-dropin-btn .dropin-btn-status {
      display: inline-block;
      width: 15px;
      height: 14px;
      vertical-align: bottom;
      margin: 0 5px 0 2px;
      background: transparent url('https://www.dropbox.com/static/metaserver/static/images/widgets/dbx-saver-status.png') no-repeat;
      position: relative;
      top: 2px;
    }

    .dropbox-dropin-default .dropin-btn-status {
      background-position: 0px 0px;
    }

    .dropbox-dropin-progress .dropin-btn-status {
      width: 18px;
      margin: 0 4px 0 0;
      background: url('https://www.dropbox.com/static/metaserver/static/images/widgets/dbx-progress.png') no-repeat center center;
        -webkit-animation-name: rotate;
        -webkit-animation-duration: 1.7s;
        -webkit-animation-iteration-count: infinite;
        -webkit-animation-timing-function: linear;
      animation-name: rotate;
      animation-duration: 1.7s;
      animation-iteration-count: infinite;
      animation-timing-function: linear;
    }

    .dropbox-dropin-success .dropin-btn-status {
      background-position: -15px 0px;
    }

    .dropbox-dropin-disabled {
      background: #e0e0e0;
      border: 1px #dadada solid;
      border-bottom: 1px solid #ccc;
      box-shadow: none;
    }

    .dropbox-dropin-disabled .dropin-btn-status {
      background-position: -30px 0px;
    }

    .dropbox-dropin-error .dropin-btn-status {
      background-position: -45px 0px;
    }

  @media only screen and (-webkit-min-device-pixel-ratio: 1.4) {
      .dropbox-dropin-btn .dropin-btn-status {
        background-image: url('https://www.dropbox.com/static/metaserver/static/images/widgets/dbx-saver-status-2x.png');
        background-size: 60px 14px;
          -webkit-background-size: 60px 14px;
      }

      .dropbox-dropin-progress .dropin-btn-status {
        background: url('https://www.dropbox.com/static/metaserver/static/images/widgets/dbx-progress-2x.png') no-repeat center center;
        background-size: 20px 20px;
          -webkit-background-size: 20px 20px;
      }
  }

    .dropbox-saver:hover, .dropbox-chooser:hover {
      text-decoration: none;
      cursor: pointer;
    }

    .dropbox-chooser, .dropbox-dropin-btn {
      line-height: 11px !important;
      text-decoration: none !important;
      box-sizing: content-box !important;
        -webkit-box-sizing: content-box !important;
        -moz-box-sizing: content-box !important;
    }
    </style></head>

  <body id="" class="group/body download-page responsive responsive-nav" style=""><span data-radix-focus-guard="" tabindex="0" style="outline: none; opacity: 0; position: fixed; pointer-events: none;"></span>
    <div id="design-settings" data-settings="{&quot;font&quot;:{&quot;name&quot;:&quot;ABC Favorit&quot;,&quot;url&quot;:&quot;https://assets.gumroad.com/assets/ABCFavorit-Regular-26182c8c3addf6e4f8889817249c23b22c93233a8212e5e86574459e4dc926e2.woff2&quot;}}" style="display: none;"></div>
    <div id="user-agent-info" data-settings="{&quot;is_mobile&quot;:false}" style="display: none;"></div>
    <div class="react-entry-point" style="display:contents" id="Alert-react-component-52ae927b-f882-4335-ad98-568fa5532a0a"><div class="fixed top-4 left-1/2 z-100 w-max max-w-[calc(100vw-2rem)] rounded bg-background md:max-w-sm invisible" style="transform: translateX(-50%) translateY(calc(-100% - var(--spacer-4))); transition: 0.3s ease-out 0.5s;"><div role="alert" class="flex items-start gap-2 rounded border p-3 border-success bg-success/20"><span class="icon icon-solid-check-circle size-[1lh]! text-success" aria-hidden="true"></span><div class="flex-1"><div>Your purchase was successful! We sent a receipt to nguyplayer@gmail.com.</div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="Alert" data-dom-id="Alert-react-component-52ae927b-f882-4335-ad98-568fa5532a0a">{"initial":null}</script>
      


    <div class="flex flex-col lg:flex-row h-screen">
      <main class="flex-1 flex flex-col lg:h-screen overflow-y-auto">
        <div class="flex-1 flex flex-col">
          



<script type="application/json" id="js-react-on-rails-context">{"railsEnv":"production","inMailer":false,"i18nLocale":"en","i18nDefaultLocale":"en","rorVersion":"14.0.4","rorPro":false,"href":"https://gumroad.com/d/e8b432408f3f826a1d66d84b01b03e6e?receipt=true","location":"/d/e8b432408f3f826a1d66d84b01b03e6e?receipt=true","scheme":"https","host":"gumroad.com","port":null,"pathname":"/d/e8b432408f3f826a1d66d84b01b03e6e","search":"receipt=true","httpAcceptLanguage":"fr,fr-FR;q=0.9,en-US;q=0.8,en;q=0.7","design_settings":{"font":{"name":"ABC Favorit","url":"https://assets.gumroad.com/assets/ABCFavorit-Regular-26182c8c3addf6e4f8889817249c23b22c93233a8212e5e86574459e4dc926e2.woff2"}},"domain_settings":{"scheme":"https","app_domain":"gumroad.com","root_domain":"gumroad.com","short_domain":"gum.co","discover_domain":"gumroad.com","third_party_analytics_domain":"gumroad-analytics.com","api_domain":"api.gumroad.com"},"user_agent_info":{"is_mobile":false},"logged_in_user":null,"current_seller":null,"csp_nonce":"6FpdojR6b9Na+2DcWHF1b98PTjjTmyyZBxR0ArEJ4Yo=","locale":"fr","feature_flags":{"require_email_typo_acknowledgment":true,"disable_stripe_signup":true},"serverSide":false}</script>
<div class="react-entry-point" style="display:contents" id="DownloadPageWithContent-react-component-b68b1031-2bc5-4381-aeb2-5cef9a7885df"><div class="flex flex-1 flex-col"><header class="flex flex-col gap-4 border-b border-border p-4 md:p-8"><div class="flex items-center justify-between gap-2"><h1 class="line-clamp-2 text-2xl hidden! sm:block!">Hébergement N8N (PRO &amp; 100% GRATUIT)</h1><div class="grid flex-1 grid-cols-2 gap-2 has-[&gt;*:only-child]:grid-cols-1 sm:flex sm:flex-none md:-my-2"><div><button class="inline-flex items-center justify-center gap-2 border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent cursor-pointer outline-none all-unset focus-visible:outline-none" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Rsm:" data-state="closed">Open in app</button></div><div data-radix-popper-content-wrapper="" style="position: fixed; left: 0px; top: 0px; transform: translate(1458px, 76px); min-width: max-content; --radix-popper-transform-origin: 0% 0px; z-index: 30; --radix-popper-available-width: 1597px; --radix-popper-available-height: 804.6000061035156px; --radix-popper-anchor-width: 122.10000610351562px; --radix-popper-anchor-height: 48.399993896484375px;"><div data-side="bottom" data-align="start" data-state="closed" role="dialog" id="radix-:Rsm:" class="z-30 w-max max-w-[calc(100vw-2rem)] rounded-sm border border-border bg-background p-4 text-foreground shadow outline-none focus-visible:outline-none data-[state=closed]:hidden" style="--radix-popover-content-transform-origin: var(--radix-popper-transform-origin); --radix-popover-content-available-width: var(--radix-popper-available-width); --radix-popover-content-available-height: var(--radix-popper-available-height); --radix-popover-trigger-width: var(--radix-popper-anchor-width); --radix-popover-trigger-height: var(--radix-popper-anchor-height);" tabindex="-1"><div class="mx-auto grid w-72 gap-4 text-center"><h3>Gumroad Library</h3><div>Download from the App Store</div><div class="grid grid-flow-col justify-between gap-4"><a class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-black text-white" href="https://itunes.apple.com/app/id916819108" target="_blank" rel="noreferrer"><span class="brand-icon brand-icon-apple"></span>App Store</a><a class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-[#142f40] text-white" href="https://play.google.com/store/apps/details?id=com.gumroad.app" target="_blank" rel="noreferrer"><span class="brand-icon brand-icon-android"></span>Play Store</a></div></div><span style="position: absolute; top: 0px; transform-origin: center 0px 0px; transform: rotate(180deg); visibility: hidden; left: 1px;"><svg class="fill-black data-[state=closed]:hidden dark:fill-foreground/35" style="display:block" width="16" height="8" viewBox="0 0 30 10" preserveAspectRatio="none"><polygon points="0,0 30,0 15,10"></polygon></svg></span></div></div></div></div></header><div class="flex min-h-0 flex-col gap-6 bg-background p-4 [scrollbar-gutter:stable] md:p-8 lg:flex-row lg:gap-16 lg:overflow-y-auto flex-1"><div class="flex flex-col gap-4 lg:sticky lg:top-0 lg:w-80 lg:pb-8"><div class="grid divide-y divide-solid divide-border rounded border border-border bg-background"><form class="flex flex-col items-start! flex flex-wrap items-center justify-between gap-4 p-4"><div class="flex grow flex-wrap justify-between gap-2"><label for=":R1cq:">Liked it? Give it a rating:</label><div class="flex shrink-0 items-center gap-1" role="radiogroup" aria-label="Your rating:"><span class="icon icon-outline-star" aria-label="1 star" aria-checked="false" role="radio"></span><span class="icon icon-outline-star" aria-label="2 stars" aria-checked="false" role="radio"></span><span class="icon icon-outline-star" aria-label="3 stars" aria-checked="false" role="radio"></span><span class="icon icon-outline-star" aria-label="4 stars" aria-checked="false" role="radio"></span><span class="icon icon-outline-star" aria-label="5 stars" aria-checked="false" role="radio"></span></div></div><div role="radiogroup" class="radio-buttons grid-cols-2!"><button class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent" type="button" role="radio" aria-checked="true"><div class="w-full text-center">Text review</div></button><button class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent" type="button" role="radio" aria-checked="false"><div class="w-full text-center">Video review</div></button></div><textarea id=":R1cq:" placeholder="Want to leave a written review?"></textarea><button class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-primary text-primary-foreground hover:bg-accent hover:text-accent-foreground" disabled="disabled" type="submit">Post review</button></form></div><div class="grid divide-y divide-solid divide-border rounded border border-border bg-background"><span class="flex flex-wrap items-center justify-between gap-4 p-4">Create an account to access all of your purchases in one place</span><div class="flex flex-wrap items-center justify-between gap-4 p-4"><form autocomplete="off" class="grid grow gap-4"><fieldset><input type="password" placeholder="Your password" value=""><small>You agree to our <a href="https://gumroad.com/terms">Terms Of Use</a>.</small></fieldset><button class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-primary text-primary-foreground hover:bg-accent hover:text-accent-foreground" type="submit">Create</button></form></div></div><div class="grid divide-y divide-solid divide-border rounded border border-border bg-background"><details class="flex-wrap items-center justify-between gap-4 p-4 block"><summary class="grow grid-flow-col grid-cols-[1fr_auto] before:col-start-2">Receipt</summary><div class="flex flex-col gap-4"><a href="https://gumroad.com/purchases/qL-jspD2pO3OstXiyUSeTg==/receipt?email=nguyplayer%40gmail.com" class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent">View receipt</a><button class="inline-flex items-center justify-center gap-2 cursor-pointer border border-border rounded text-current font-[inherit] no-underline transition-transform hover:-translate-1 hover:shadow active:translate-0 active:shadow-none disabled:opacity-30 disabled:hover:translate-0 disabled:hover:shadow-none px-4 py-3 text-base leading-[1.4] bg-transparent" type="button">Resend receipt</button></div></details></div><div class="grid divide-y divide-solid divide-border rounded border border-border bg-background"><div class="flex flex-wrap items-center justify-between gap-4 p-4">Hébergement N8N (PRO &amp; 100% GRATUIT)</div><div class="flex flex-wrap items-center justify-between gap-4 p-4"><span style="display:flex;align-items:center;gap:var(--spacer-2)" class="grow"><img class="user-avatar" src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/lvcg72yemnz50q3bdyqx0rs3384c.webp"><span>By<!-- --> <a href="https://croissance.gumroad.com/?recommended_by=library" target="_blank" class="relative" rel="noreferrer">Naier Saidane</a></span></span></div></div></div><div class="h-0 flex-1"><div class="flex flex-col gap-4"><div class="rich-text grid h-full flex-1"><div contenteditable="false" aria-label="Product content" translate="no" class="tiptap ProseMirror"><h2><strong>Lien pour s'inscrire sur AWS</strong></h2><p>AWS Offre gratuite : <a href="https://aws.amazon.com/fr/free/" target="_blank" rel="noopener noreferrer nofollow">https://aws.amazon.com/fr/free/</a><br class="ProseMirror-trailingBreak"></p><p><br class="ProseMirror-trailingBreak"></p><h2><strong>Installer Putty <u>(Si vous êtes sous Windows)</u></strong></h2><p>Télécharger Putty et l'installer <a href="https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html" target="_blank" rel="noopener noreferrer nofollow">https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html</a><br class="ProseMirror-trailingBreak"></p><p><br class="ProseMirror-trailingBreak"></p><h2><strong>Se connecter sur votre EC2</strong></h2><p>Sur MacOS, lancer la commande suivante dans votre Terminal</p><div class="react-renderer node-codeBlock"><pre as="pre" class="codeblock-lowlight" data-node-view-wrapper="" style="white-space: normal;"><div style="width: fit-content; float: right;"><span class="group/tooltip relative inline-grid bottom"><span aria-describedby=":r2:" style="display: contents;"><span class="contents"><button class="link cursor-pointer all-unset" style="padding: 0 var(--spacer-1);" aria-label="Copy"><span class="icon icon-outline-duplicate"></span></button></span></span><span role="tooltip" id=":r2:" class="absolute z-30 hidden w-40 max-w-max rounded-md bg-primary p-3 text-primary-foreground group-focus-within/tooltip:block group-hover/tooltip:block left-1/2 -translate-x-1/2 top-full translate-y-2"><div class="absolute border-6 border-transparent left-1/2 -translate-x-1/2 bottom-full border-b-primary"></div>Copy to Clipboard</span></span></div><code as="code" data-node-view-content="" style="white-space: pre-wrap;"><div style="white-space: inherit;">ssh -i n8nAWSKey.pem ec2-user@&lt;adresse-ip&gt;</div></code></pre></div><p><em>Pensez à changer n8nAWSKey.pem par le nom de votre fichier.</em></p><p><br class="ProseMirror-trailingBreak"></p><p>Sur Windows, configurer Putty comme suit :</p><div class="react-renderer node-image"><div data-node-view-wrapper="" style="white-space: normal;"><figure><img src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/1.webp" data-drag-handle="true" contenteditable="false"></figure></div></div><div class="react-renderer node-image"><div data-node-view-wrapper="" style="white-space: normal;"><figure><img src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/Ajouter%20un%20sous-titre%20(1).webp" data-drag-handle="true" contenteditable="false"></figure></div></div><p>Une
 nouvelle fenêtre PuTTY s'ouvre et demande votre confirmation pour 
enregistrer la clé dans le cache de PuTTY. Cliquez sur Oui.</p><p>Elle vous demandera le nom d'utilisateur "login as:". Entrez "ec2-user"</p><p>Cliquez
 sur la touche Entrée de votre clavier et voilà ! Vous êtes connecté à 
la machine AWS EC2 sans avoir à saisir de mot de passe.</p><p><br class="ProseMirror-trailingBreak"></p><h2>Script d'installation</h2><div class="react-renderer node-codeBlock"><pre as="pre" class="codeblock-lowlight" data-node-view-wrapper="" style="white-space: normal;"><div style="width: fit-content; float: right;"><span class="group/tooltip relative inline-grid bottom"><span aria-describedby=":r4:" style="display: contents;"><span class="contents"><button class="link cursor-pointer all-unset" style="padding: 0 var(--spacer-1);" aria-label="Copy"><span class="icon icon-outline-duplicate"></span></button></span></span><span role="tooltip" id=":r4:" class="absolute z-30 hidden w-40 max-w-max rounded-md bg-primary p-3 text-primary-foreground group-focus-within/tooltip:block group-hover/tooltip:block left-1/2 -translate-x-1/2 top-full translate-y-2"><div class="absolute border-6 border-transparent left-1/2 -translate-x-1/2 bottom-full border-b-primary"></div>Copy to Clipboard</span></span></div><code as="code" data-node-view-content="" style="white-space: pre-wrap;"><div style="white-space: inherit;"><span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">Script complet d</span><span class="bash hljs-string">'installation N8N sur EC2 Amazon Linux</span>
<span class="hljs-meta prompt_"># </span><span class="bash hljs-string">Version finale - Production-ready - Testé et validé</span>
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Verifier si info dispo</span>
if [ -z "$1" ] || [ -z "$2" ] || [ -z "$3" ] || [ -z "$4" ] || [ -z "$5" ] || [ -z "$6" ] || [ -z "$7" ] || [ -z "$8" ]; then
  echo "======================================================================="
  echo "              SCRIPT COMPLET D'INSTALLATION N8N SUR EC2               "
  echo "======================================================================="
  echo ""
  echo "Usage: ./complete_n8n_setup.sh &lt;domaine&gt; &lt;rds_host&gt; &lt;db_user&gt; &lt;db_password&gt; &lt;db_name&gt; &lt;email_ssl&gt; &lt;n8n_username&gt; &lt;n8n_password&gt;"
  echo ""
  echo "PARAMETRES REQUIS (8 parametres):"
  echo "  1. DOMAINE        - Votre domaine (ex: n8n.mondomaine.com)"
  echo "  2. RDS_HOST       - Point de terminaison RDS (ex: mydb.cluster-abc123.eu-west-1.rds.amazonaws.com)"
  echo "  3. DB_USER        - Utilisateur de la base de donnees (ex: postgres)"
  echo "  4. DB_PASSWORD    - Mot de passe de la base de donnees (utiliser des guillemets simples)"
  echo "  5. DB_NAME        - Nom de la base de donnees (ex: n8n)"
  echo "  6. EMAIL_SSL      - Email pour le certificat SSL Let's Encrypt (ex: admin@mondomaine.com)"
  echo "  7. N8N_USERNAME   - Username pour l'authentification HTTP basique (ex: admin)"
  echo "  8. N8N_PASSWORD   - Password pour l'authentification HTTP basique"
  echo ""
  echo "EXEMPLE COMPLET:"
  echo "  ./complete_n8n_setup.sh \\"
  echo "    'n8n.croissanceconsulting.com' \\"
  echo "    'mydb.cluster-abc123.eu-west-1.rds.amazonaws.com' \\"
  echo "    'postgres' \\"
  echo "    'monMotDePasseDB\!123' \\"
  echo "    'n8n' \\"
  echo "    'admin@croissanceconsulting.com' \\"
  echo "    'admin' \\"
  echo "    'MonMotDePasseSecurise123'"
  echo ""
  echo "PREREQUIS:"
  echo "  - Instance EC2 Amazon Linux avec accès Internet"
  echo "  - Instance RDS PostgreSQL créée et accessible"
  echo "  - Domaine pointant vers l'IP publique de l'EC2"
  echo "  - Ports 80 et 443 ouverts dans le Security Group"
  echo ""
  echo "NOTES IMPORTANTES:"
  echo "  - Utilisez des guillemets simples pour les mots de passe avec caractères spéciaux"
  echo "  - Le script utilise sudo pour Docker - permissions configurées automatiquement"
  echo "  - Après installation, déconnectez/reconnectez-vous pour utiliser Docker sans sudo"
  echo ""
  echo "======================================================================="
  exit 1
fi

DOMAIN_OR_IP=$1
RDS_HOST=$2
POSTGRES_USER=$3
POSTGRES_PASSWORD=$4
POSTGRES_DB=$5
SSL_EMAIL=$6
N8N_AUTH_USER=$7
N8N_AUTH_PASSWORD=$8

echo "======================================================================="
echo "              DEMARRAGE DE L'INSTALLATION COMPLETE                    "
echo "======================================================================="
echo "Configuration detectee:"
echo "  - Domaine: $DOMAIN_OR_IP"
echo "  - RDS Host: $RDS_HOST"
echo "  - DB User: $POSTGRES_USER"
echo "  - DB Name: $POSTGRES_DB"
echo "  - Email SSL: $SSL_EMAIL"
echo "  - Auth HTTP: $N8N_AUTH_USER"
echo "======================================================================="
echo ""
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Eviter Conflit</span>
unset PGUSER
unset PGPASSWORD
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Generer cle d'</span><span class="bash">encryption aleatoire</span>
generate_encryption_key() {
  openssl rand -base64 32
}

echo "🔄 ETAPE 1/4: PREPARATION DU SYSTEME"
echo "======================================================================="
<span class="hljs-meta prompt_">
# </span><span class="bash">Maj systeme</span>
echo "📦 Mise à jour du système..."
sudo yum update -y
<span class="hljs-meta prompt_">
# </span><span class="bash">Installer, Demarrer et Activer Nginx</span>
echo "🌐 Installation et configuration de Nginx..."
sudo yum install -y nginx
sudo systemctl start nginx
sudo systemctl enable nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">Installer Certbot</span>
echo "🔒 Installation de Certbot pour SSL..."
sudo yum install -y epel-release 2&gt;/dev/null || true
sudo yum install -y certbot python3-certbot-nginx
<span class="hljs-meta prompt_">
# </span><span class="bash">Installer Crontab</span>
echo "⏰ Installation et configuration de Cron..."
sudo yum install -y cronie
sudo systemctl start crond
sudo systemctl enable crond
<span class="hljs-meta prompt_">
# </span><span class="bash">Installer Python, Pip, Git, Docker</span>
echo "🐍 Installation de Python, Git, Docker..."
sudo yum install -y python3 python3-pip git docker
<span class="hljs-meta prompt_">
# </span><span class="bash">Demarrer et Activer Docker</span>
echo "🐳 Configuration de Docker..."
sudo systemctl start docker
sudo systemctl enable docker
<span class="hljs-meta prompt_">
# </span><span class="bash">Ajouter l</span><span class="bash hljs-string">'utilisateur actuel au groupe Docker</span>
sudo usermod -aG docker $USER
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Installer Docker Compose</span>
echo "📦 Installation de Docker Compose..."
sudo curl -L "https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
sudo chmod +x /usr/local/bin/docker-compose
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Installer Postgres Client</span>
echo "🐘 Installation du client PostgreSQL..."
sudo yum install -y postgresql15
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Installer Node.js</span>
echo "⚡ Installation de Node.js..."
curl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -
sudo yum install -y nodejs
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Installer PM2</span>
echo "🚀 Installation de PM2..."
sudo npm install -g pm2

echo ""
echo "✅ PREPARATION DU SYSTEME TERMINEE"
echo ""

echo "🔄 ETAPE 2/4: PREPARATION DES FICHIERS N8N"
echo "======================================================================="
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Verifier Docker - toujours avec sudo dans le script</span>
sudo docker --version
sudo docker-compose --version
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Creer repertoire pour N8N</span>
mkdir -p ~/n8n-docker
cd ~/n8n-docker
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Telecharger certificat RDS SSL</span>
echo "📜 Téléchargement du certificat RDS..."
wget https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem -O rds-ca.pem
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Generer cle d'</span><span class="bash">encryption N8N</span>
N8N_ENCRYPTION_KEY=$(generate_encryption_key)

echo "📝 Création du fichier de configuration..."
<span class="hljs-meta prompt_"># </span><span class="bash">Creer le fichier .</span><span class="bash hljs-built_in">env</span><span class="bash"> avec syntaxe propre</span>
cat &gt; .env &lt;&lt; EOF
<span class="hljs-meta prompt_"># </span><span class="bash">AWS RDS Config</span>
RDS_HOST=$RDS_HOST
POSTGRES_USER=$POSTGRES_USER
POSTGRES_PASSWORD=$POSTGRES_PASSWORD
POSTGRES_DB=$POSTGRES_DB
<span class="hljs-meta prompt_">
# </span><span class="bash">Auth n8n (désactivée par défaut - N8N a son propre système d</span><span class="bash hljs-string">'auth)</span>
N8N_BASIC_AUTH_ACTIVE=false
N8N_BASIC_AUTH_USER=$N8N_AUTH_USER
N8N_BASIC_AUTH_PASSWORD=$N8N_AUTH_PASSWORD
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Domaine &amp; SSL Config</span>
DOMAIN_NAME=$DOMAIN_OR_IP
N8N_PATH=/
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Redis Config</span>
REDIS_HOST=redis
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">cle d'</span><span class="bash">encryption n8n</span>
N8N_ENCRYPTION_KEY=$N8N_ENCRYPTION_KEY
<span class="hljs-meta prompt_">
# </span><span class="bash">Optimisations recommandées par N8N</span>
N8N_RUNNERS_ENABLED=false
OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true
N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
<span class="hljs-meta prompt_">
# </span><span class="bash">Optimisations WebSocket et performance</span>
N8N_DISABLE_UI=false
N8N_METRICS=false
<span class="hljs-meta prompt_">
# </span><span class="bash">Support des nœuds communautaires comme outils AI Agents</span>
N8N_COMMUNITY_PACKAGES_ALLOW_TOOL_USAGE=true
<span class="hljs-meta prompt_">
# </span><span class="bash">Email pour certificat SSL</span>
SSL_EMAIL=$SSL_EMAIL
EOF

echo "🛠️ Création du script d'initialisation de la base..."
<span class="hljs-meta prompt_"># </span><span class="bash">Creer init-data.sh avec syntaxe bash propre</span>
cat &gt; init-data.sh &lt;&lt; 'SCRIPT_EOF'
<span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
set -e

RDS_HOST=$1
POSTGRES_USER=$2
POSTGRES_PASSWORD=$3
POSTGRES_DB=$4

export PGPASSWORD=$POSTGRES_PASSWORD

DB_EXISTS=$(psql -v ON_ERROR_STOP=1 --host="$RDS_HOST" --username="$POSTGRES_USER" --dbname="postgres" --tuples-only --command="SELECT 1 FROM pg_database WHERE datname='$POSTGRES_DB';")

if [[ -z $DB_EXISTS ]]; then
  echo "Database $POSTGRES_DB n existe pas. Je la cree..."
  psql -v ON_ERROR_STOP=1 --host="$RDS_HOST" --username="$POSTGRES_USER" --dbname="postgres" --command="CREATE DATABASE \"$POSTGRES_DB\";"
else
  echo "Database $POSTGRES_DB existe."
fi

psql -v ON_ERROR_STOP=1 --host="$RDS_HOST" --username="$POSTGRES_USER" --dbname="$POSTGRES_DB" &lt;&lt;EOSQL
GRANT ALL PRIVILEGES ON DATABASE "$POSTGRES_DB" TO $POSTGRES_USER;
GRANT CREATE ON SCHEMA public TO $POSTGRES_USER;
EOSQL

unset PGPASSWORD
SCRIPT_EOF
chmod +x init-data.sh

echo ""
echo "🔄 ETAPE 3/4: CONFIGURATION DE LA BASE DE DONNEES"
echo "======================================================================="
<span class="hljs-meta prompt_">
# </span><span class="bash">Verifier que PostgreSQL est accessible &amp; lancer script d</span><span class="bash hljs-string">'initialisation</span>
echo "🔍 Vérification de la connectivité PostgreSQL..."
until PGPASSWORD=$POSTGRES_PASSWORD psql --host="$RDS_HOST" --username="$POSTGRES_USER" --dbname="postgres" -c '\q' 2&gt;/dev/null; do
  echo "En attente de PostgreSQL..."
  sleep 5
done

echo "✅ PostgreSQL accessible - Initialisation de la base..."
./init-data.sh "$RDS_HOST" "$POSTGRES_USER" "$POSTGRES_PASSWORD" "$POSTGRES_DB"

echo "🐳 Création du fichier Docker Compose..."
<span class="hljs-meta prompt_"># </span><span class="bash hljs-string">Creer le Docker Compose file avec variables correctes</span>
cat &gt; docker-compose.yml &lt;&lt; EOF
version: '3.8'

volumes:
  n8n_storage:
  redis_storage:

services:
  redis:
    image: redis:6-alpine
    restart: always
    volumes:
      - redis_storage:/data
    healthcheck:
      test: ['CMD', 'redis-cli', 'ping']
      interval: 5s
      timeout: 5s
      retries: 10

  n8n:
    image: docker.n8n.io/n8nio/n8n
    restart: always
    environment:
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=$RDS_HOST
      - DB_POSTGRESDB_PORT=5432
      - DB_POSTGRESDB_DATABASE=$POSTGRES_DB
      - DB_POSTGRESDB_USER=$POSTGRES_USER
      - DB_POSTGRESDB_PASSWORD=$POSTGRES_PASSWORD
      - EXECUTIONS_MODE=queue
      - QUEUE_BULL_REDIS_HOST=redis
      - QUEUE_HEALTH_CHECK_ACTIVE=true
      - N8N_BASIC_AUTH_ACTIVE=false
      - DB_POSTGRESDB_SSL_CA=/rds-ca.pem
      - DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=false
      - N8N_HOST=$DOMAIN_OR_IP
      - N8N_PORT=5678
      - N8N_PROTOCOL=https
      - WEBHOOK_URL=https://$DOMAIN_OR_IP/
      - N8N_ENCRYPTION_KEY=\$N8N_ENCRYPTION_KEY
      - N8N_RUNNERS_ENABLED=false
      - OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true
      - N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
      - N8N_COMMUNITY_PACKAGES_ALLOW_TOOL_USAGE=true
    ports:
      - 5678:5678
    volumes:
      - n8n_storage:/home/node/.n8n
      - ./rds-ca.pem:/rds-ca.pem
    depends_on:
      - redis

  n8n-worker:
    image: docker.n8n.io/n8nio/n8n
    restart: always
    command: worker
    environment:
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=$RDS_HOST
      - DB_POSTGRESDB_PORT=5432
      - DB_POSTGRESDB_DATABASE=$POSTGRES_DB
      - DB_POSTGRESDB_USER=$POSTGRES_USER
      - DB_POSTGRESDB_PASSWORD=$POSTGRES_PASSWORD
      - DB_POSTGRESDB_SSL_CA=/rds-ca.pem
      - DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=false
      - EXECUTIONS_MODE=queue
      - QUEUE_BULL_REDIS_HOST=redis
      - QUEUE_HEALTH_CHECK_ACTIVE=true
      - N8N_ENCRYPTION_KEY=\$N8N_ENCRYPTION_KEY
      - N8N_RUNNERS_ENABLED=false
      - OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true
      - N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true
    volumes:
      - ./rds-ca.pem:/rds-ca.pem
    depends_on:
      - redis
      - n8n
EOF

echo ""
echo "🔄 ETAPE 4/4: DEMARRAGE ET CONFIGURATION WEB"
echo "======================================================================="
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Demarrer n8n - toujours avec sudo pour éviter les problèmes de permissions</span>
echo "🚀 Démarrage de N8N..."
sudo docker-compose up -d
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Attendre que n8n soit pret avec retry logic</span>
echo "⏳ Attente du démarrage de N8N..."
RETRY_COUNT=0
MAX_RETRIES=20
WAIT_TIME=30

while [ $RETRY_COUNT -lt $MAX_RETRIES ]; do
    sleep $WAIT_TIME
    if curl -f http://localhost:5678 &gt; /dev/null 2&gt;&amp;1; then
        echo "✅ N8N est accessible localement"
        break
    else
        RETRY_COUNT=$((RETRY_COUNT+1))
        echo "⏳ N8N démarre encore... ($RETRY_COUNT/$MAX_RETRIES) - Attente ${WAIT_TIME}s"
        
        # Après 5 tentatives, vérifier les logs
        if [ $RETRY_COUNT -eq 5 ]; then
            echo "🔍 Vérification des logs N8N..."
            sudo docker-compose logs --tail=10 n8n
        fi
    fi
done

if [ $RETRY_COUNT -eq $MAX_RETRIES ]; then
    echo "❌ Problème: N8N n'est pas accessible après $((MAX_RETRIES*WAIT_TIME)) secondes"
    echo "🔍 Logs détaillés:"
    sudo docker-compose logs n8n
    echo ""
    echo "⚠️  N8N peut prendre plus de temps au premier démarrage (migrations DB)"
    echo "   Vérifiez manuellement avec: curl -I http://localhost:5678"
    echo "   Ou consultez les logs: sudo docker-compose logs -f n8n"
    exit 1
fi
<span class="hljs-meta prompt_">
# </span><span class="bash hljs-string">Corriger l'</span><span class="bash">avertissement Redis</span>
echo "🔧 Optimisation système Redis..."
sudo sysctl vm.overcommit_memory=1 2&gt;/dev/null || true
echo 'vm.overcommit_memory = 1' | sudo tee -a /etc/sysctl.conf &gt; /dev/null

echo "🌐 Configuration de Nginx (HTTP temporaire)..."
<span class="hljs-meta prompt_"># </span><span class="bash">Creer config Nginx TEMPORAIRE (sans SSL)</span>
FINAL_NGINX_CONF="/etc/nginx/conf.d/n8n.conf"
sudo tee $FINAL_NGINX_CONF &gt; /dev/null &lt;&lt;EOF
server {
    listen 80;
    server_name $DOMAIN_OR_IP;

    # Configuration optimisée pour N8N et WebSockets
    location / {
        proxy_pass http://127.0.0.1:5678;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
        
        # Support WebSocket
        proxy_http_version 1.1;
        proxy_set_header Upgrade \$http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # Timeouts optimisés
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
        
        # Buffer settings
        proxy_buffering off;
        proxy_request_buffering off;
    }
}
EOF
<span class="hljs-meta prompt_">
# </span><span class="bash">Test &amp; reload Nginx</span>
sudo nginx -t &amp;&amp; sudo systemctl reload nginx

echo "🔒 Installation du certificat SSL..."
<span class="hljs-meta prompt_"># </span><span class="bash">Installer Certbot and obtain SSL certificate</span>
if sudo certbot certonly --nginx -d $DOMAIN_OR_IP --non-interactive --agree-tos --email $SSL_EMAIL; then
  echo "✅ Certificat SSL obtenu avec succès"
  
<span class="hljs-meta prompt_">  # </span><span class="bash">Mettre à jour la config Nginx pour HTTPS</span>
  sudo tee $FINAL_NGINX_CONF &gt; /dev/null &lt;&lt;EOF
server {
    listen 443 ssl;
    server_name $DOMAIN_OR_IP;

    ssl_certificate /etc/letsencrypt/live/$DOMAIN_OR_IP/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/$DOMAIN_OR_IP/privkey.pem;

    # Configuration optimisée pour N8N et WebSockets
    location / {
        proxy_pass http://127.0.0.1:5678;
        proxy_set_header Host \$host;
        proxy_set_header X-Real-IP \$remote_addr;
        proxy_set_header X-Forwarded-For \$proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto \$scheme;
        
        # Support WebSocket pour N8N
        proxy_http_version 1.1;
        proxy_set_header Upgrade \$http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # Timeouts optimisés pour éviter les déconnexions
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
        
        # Buffer settings pour temps réel
        proxy_buffering off;
        proxy_request_buffering off;
    }
}

server {
    listen 80;
    server_name $DOMAIN_OR_IP;
    return 301 https://\$host\$request_uri;
}
EOF
<span class="hljs-meta prompt_">
  # </span><span class="bash">Test &amp; reload Nginx</span>
  if sudo nginx -t; then
      sudo systemctl reload nginx
      echo "✅ Configuration HTTPS terminée avec succès"
      SSL_STATUS="HTTPS configuré"
      FINAL_URL="https://$DOMAIN_OR_IP"
  else
      echo "⚠️  Erreur dans la configuration Nginx SSL - reste en HTTP"
      SSL_STATUS="Erreur SSL - HTTP seulement"
      FINAL_URL="http://$DOMAIN_OR_IP"
  fi
else
  echo "⚠️  Le certificat SSL n'a pas pu être obtenu - N8N reste accessible en HTTP"
  SSL_STATUS="HTTP seulement"
  FINAL_URL="http://$DOMAIN_OR_IP"
fi

echo ""
echo "======================================================================="
echo "                    INSTALLATION COMPLETE TERMINEE                    "
echo "======================================================================="
echo ""
echo "🎉 N8N est maintenant installé et accessible !"
echo ""
echo "✅ STATUT DE L'INSTALLATION:"
echo "   🔗 URL: $FINAL_URL"
echo "   🔒 SSL: $SSL_STATUS"
echo "   📊 Version N8N: 1.102.3+ (dernière disponible)"
echo "   🗄️  Base de données: RDS PostgreSQL connectée"
echo "   👥 Worker: Opérationnel pour les tâches en arrière-plan"
echo ""
echo "🔑 PREMIERE CONNEXION:"
echo "   1. Allez sur $FINAL_URL"
echo "   2. N8N vous demandera de créer le compte administrateur principal"
echo "   3. Remplissez vos informations (email, nom, prénom, mot de passe)"
echo "   4. Commencez à créer vos workflows !"
echo ""
echo "💡 NOTES IMPORTANTES:"
echo "   - L'authentification HTTP basique est désactivée par défaut"
echo "   - N8N utilise son propre système d'authentification sécurisé"
echo "   - Les WebSockets sont configurés pour éviter les déconnexions"
echo "   - Le worker traite les tâches en arrière-plan automatiquement"
echo ""
echo "📊 COMMANDES UTILES:"
echo "   - Voir les logs: cd ~/n8n-docker &amp;&amp; sudo docker-compose logs n8n"
echo "   - Redémarrer: cd ~/n8n-docker &amp;&amp; sudo docker-compose restart"
echo "   - Arrêter: cd ~/n8n-docker &amp;&amp; sudo docker-compose down"
echo "   - Démarrer: cd ~/n8n-docker &amp;&amp; sudo docker-compose up -d"
echo "   - Status: cd ~/n8n-docker &amp;&amp; sudo docker-compose ps"
echo ""
echo "🔧 FICHIERS IMPORTANTS:"
echo "   - Configuration: ~/n8n-docker/.env"
echo "   - Docker Compose: ~/n8n-docker/docker-compose.yml"
echo "   - Nginx: /etc/nginx/conf.d/n8n.conf"
echo "   - Logs: sudo docker-compose logs -f n8n"
echo ""
echo "⚠️  PERMISSIONS DOCKER:"
echo "   - Le script utilise sudo pour Docker (évite les problèmes)"
echo "   - Pour utiliser Docker sans sudo à l'avenir:"
echo "     $ exit"
echo "     $ ssh ec2-user@votre-serveur"
echo "     $ docker ps  # devrait fonctionner sans sudo"
echo ""
echo "🔄 MISE A JOUR AUTOMATIQUE (optionnel):"
echo "   - Script de mise à jour: ~/update_n8n.sh (si disponible)"
echo "   - Cron automatique: (crontab -l 2&gt;/dev/null; echo \"0 2 * * * ~/update_n8n.sh --backup\") | crontab -"
echo ""
echo "======================================================================="
echo "🚀 Installation terminée avec succès !"
echo "📍 Votre N8N est accessible sur: $FINAL_URL"
echo "======================================================================="</div></code></pre></div><p><strong>Note :</strong>
 si votre mot de passe contient !, il est interprété par bash comme une 
commande d'historique. Entourez votre mot de passe de Guillemets 
simples.</p><p><br class="ProseMirror-trailingBreak"></p><h2>Script MAJ N8N</h2><div class="react-renderer node-codeBlock"><pre as="pre" class="codeblock-lowlight" data-node-view-wrapper="" style="white-space: normal;"><div style="width: fit-content; float: right;"><span class="group/tooltip relative inline-grid bottom"><span aria-describedby=":r1:" style="display: contents;"><span class="contents"><button class="link cursor-pointer all-unset" style="padding: 0 var(--spacer-1);" aria-label="Copy"><span class="icon icon-outline-duplicate"></span></button></span></span><span role="tooltip" id=":r1:" class="absolute z-30 hidden w-40 max-w-max rounded-md bg-primary p-3 text-primary-foreground group-focus-within/tooltip:block group-hover/tooltip:block left-1/2 -translate-x-1/2 top-full translate-y-2"><div class="absolute border-6 border-transparent left-1/2 -translate-x-1/2 bottom-full border-b-primary"></div>Copy to Clipboard</span></span></div><code as="code" data-node-view-content="" style="white-space: pre-wrap;"><div style="white-space: inherit;"><span class="hljs-meta prompt_">#</span><span class="bash">!/bin/bash</span>
<span class="hljs-meta prompt_">
# </span><span class="bash">Script de mise à jour N8N</span>
<span class="hljs-meta prompt_"># </span><span class="bash">Usage: ./update_n8n.sh [version] [--force] [--backup]</span>

echo "======================================================================="
echo "                        MISE A JOUR N8N                               "
echo "======================================================================="
echo ""
<span class="hljs-meta prompt_">
# </span><span class="bash">Configuration</span>
N8N_DIR="$HOME/n8n-docker"
BACKUP_DIR="$HOME/n8n-backups"
COMPOSE_FILE="$N8N_DIR/docker-compose.yml"
<span class="hljs-meta prompt_">
# </span><span class="bash">Options par défaut</span>
FORCE_UPDATE=false
CREATE_BACKUP=false
TARGET_VERSION=""
<span class="hljs-meta prompt_">
# </span><span class="bash">Traitement des arguments</span>
while [[ $# -gt 0 ]]; do
  case $1 in
    --force)
      FORCE_UPDATE=true
      shift
      ;;
    --backup)
      CREATE_BACKUP=true
      shift
      ;;
    --help|-h)
      echo "Usage: $0 [version] [--force] [--backup]"
      echo ""
      echo "Options:"
      echo "  version     Version spécifique à installer (ex: 1.15.2)"
      echo "              Si omis, utilise la dernière version"
      echo "  --force     Force la mise à jour même si la version est identique"
      echo "  --backup    Crée une sauvegarde avant la mise à jour"
      echo "  --help      Affiche cette aide"
      echo ""
      echo "Exemples:"
      echo "  $0                          # Met à jour vers la dernière version"
      echo "  $0 1.15.2                  # Met à jour vers la version 1.15.2"
      echo "  $0 --backup                # Met à jour avec sauvegarde"
      echo "  $0 1.15.2 --force --backup # Force la mise à jour vers 1.15.2 avec sauvegarde"
      exit 0
      ;;
    *)
      if [[ $1 =~ ^[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
        TARGET_VERSION=$1
      else
        echo "❌ Version invalide: $1"
        echo "Format attendu: X.Y.Z (ex: 1.15.2)"
        exit 1
      fi
      shift
      ;;
  esac
done
<span class="hljs-meta prompt_">
# </span><span class="bash">Vérification des </span><span class="bash hljs-built_in">pr</span><span class="bash">érequis</span>
if [ ! -d "$N8N_DIR" ]; then
    echo "❌ Erreur: Répertoire N8N non trouvé ($N8N_DIR)"
    echo "   Assurez-vous que N8N est installé avec le script d'installation."
    exit 1
fi

if [ ! -f "$COMPOSE_FILE" ]; then
    echo "❌ Erreur: Fichier docker-compose.yml non trouvé"
    exit 1
fi

cd "$N8N_DIR"
<span class="hljs-meta prompt_">
# </span><span class="bash">Fonction pour obtenir la version actuelle</span>
get_current_version() {
    local version=$(docker-compose exec -T n8n n8n --version 2&gt;/dev/null | grep -oE '[0-9]+\.[0-9]+\.[0-9]+' | head -1)
    if [ -z "$version" ]; then
        echo "unknown"
    else
        echo "$version"
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">Fonction pour obtenir la dernière version disponible</span>
get_latest_version() {
    local latest=$(curl -s https://api.github.com/repos/n8n-io/n8n/releases/latest | grep '"tag_name"' | cut -d'"' -f4 | sed 's/^n8n@//')
    if [ -z "$latest" ]; then
        echo "❌ Impossible de récupérer la dernière version depuis GitHub"
        exit 1
    fi
    echo "$latest"
}
<span class="hljs-meta prompt_">
# </span><span class="bash">Fonction de sauvegarde</span>
create_backup() {
    echo "💾 Création de la sauvegarde..."
    
    local timestamp=$(date +%Y%m%d_%H%M%S)
    local backup_path="$BACKUP_DIR/n8n_backup_$timestamp"
    
    mkdir -p "$backup_path"
    
    # Sauvegarde de la configuration
    cp -r "$N8N_DIR" "$backup_path/config"
    
    # Sauvegarde des volumes Docker
    echo "   - Sauvegarde des volumes Docker..."
    docker run --rm -v n8n-docker_n8n_storage:/data -v "$backup_path":/backup alpine tar czf /backup/n8n_data.tar.gz -C /data .
    
    # Export des workflows
    echo "   - Export des workflows..."
    docker-compose exec -T n8n n8n export:workflow --all --output=/tmp/workflows.json 2&gt;/dev/null
    docker cp $(docker-compose ps -q n8n):/tmp/workflows.json "$backup_path/workflows.json" 2&gt;/dev/null || echo "   ⚠️  Aucun workflow à exporter"
    
    # Export des credentials
    echo "   - Export des credentials..."
    docker-compose exec -T n8n n8n export:credentials --all --output=/tmp/credentials.json 2&gt;/dev/null
    docker cp $(docker-compose ps -q n8n):/tmp/credentials.json "$backup_path/credentials.json" 2&gt;/dev/null || echo "   ⚠️  Aucun credential à exporter"
    
    echo "✅ Sauvegarde créée: $backup_path"
    echo "$backup_path" &gt; /tmp/n8n_last_backup
}
<span class="hljs-meta prompt_">
# </span><span class="bash">Fonction de mise à jour</span>
update_n8n() {
    local version=$1
    local image_tag=""
    
    if [ -n "$version" ]; then
        image_tag=":$version"
        echo "🎯 Version cible: $version"
    else
        image_tag=":latest"
        echo "🎯 Version cible: latest"
    fi
    
    echo ""
    echo "🔄 Début de la mise à jour..."
    
    # Arrêt des services
    echo "   - Arrêt des services N8N..."
    docker-compose down
    
    # Mise à jour du docker-compose.yml
    echo "   - Mise à jour de la configuration..."
    sed -i "s|image: docker.n8n.io/n8nio/n8n.*|image: docker.n8n.io/n8nio/n8n$image_tag|g" "$COMPOSE_FILE"
    
    # Pull de la nouvelle image
    echo "   - Téléchargement de la nouvelle image..."
    docker-compose pull n8n
    
    # Redémarrage des services
    echo "   - Redémarrage des services..."
    docker-compose up -d
    
    # Attente du démarrage
    echo "   - Attente du démarrage..."
    sleep 30
    
    # Vérification
    if curl -f http://localhost:5678 &gt; /dev/null 2&gt;&amp;1; then
        echo "✅ N8N redémarré avec succès"
    else
        echo "❌ Erreur: N8N ne répond pas"
        echo "Tentative de restauration..."
        docker-compose logs n8n
        return 1
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">Fonction de rollback</span>
rollback() {
    echo ""
    echo "🔄 Tentative de rollback..."
    
    if [ -f /tmp/n8n_last_backup ]; then
        local backup_path=$(cat /tmp/n8n_last_backup)
        if [ -d "$backup_path" ]; then
            echo "   - Restauration de la configuration..."
            docker-compose down
            cp -r "$backup_path/config/"* "$N8N_DIR/"
            docker-compose up -d
            echo "✅ Rollback effectué"
        else
            echo "❌ Sauvegarde introuvable: $backup_path"
        fi
    else
        echo "❌ Aucune sauvegarde récente trouvée"
    fi
}
<span class="hljs-meta prompt_">
# </span><span class="bash">Programme principal</span>
echo "🔍 Vérification de l'état actuel..."
<span class="hljs-meta prompt_">
# </span><span class="bash">Vérifier que N8N fonctionne</span>
if ! docker-compose ps | grep -q "Up"; then
    echo "❌ N8N ne semble pas fonctionner"
    echo "   Démarrage des services..."
    docker-compose up -d
    sleep 30
fi
<span class="hljs-meta prompt_">
# </span><span class="bash">Obtenir les versions</span>
CURRENT_VERSION=$(get_current_version)
echo "📌 Version actuelle: $CURRENT_VERSION"

if [ -n "$TARGET_VERSION" ]; then
    LATEST_VERSION="$TARGET_VERSION"
else
    echo "🔍 Recherche de la dernière version..."
    LATEST_VERSION=$(get_latest_version)
fi

echo "🆕 Version cible: $LATEST_VERSION"
<span class="hljs-meta prompt_">
# </span><span class="bash">Vérifier si une mise à jour est nécessaire</span>
if [ "$CURRENT_VERSION" = "$LATEST_VERSION" ] &amp;&amp; [ "$FORCE_UPDATE" = false ]; then
    echo ""
    echo "✅ N8N est déjà à jour (version $CURRENT_VERSION)"
    echo "   Utilisez --force pour forcer la mise à jour"
    exit 0
fi

echo ""
echo "📋 RESUME DE LA MISE A JOUR:"
echo "   - Version actuelle: $CURRENT_VERSION"
echo "   - Version cible: $LATEST_VERSION"
echo "   - Sauvegarde: $([ "$CREATE_BACKUP" = true ] &amp;&amp; echo "OUI" || echo "NON")"
echo "   - Force: $([ "$FORCE_UPDATE" = true ] &amp;&amp; echo "OUI" || echo "NON")"
echo ""

read -p "Continuer la mise à jour? (oui/non): " confirm
if [ "$confirm" != "oui" ]; then
    echo "Mise à jour annulée."
    exit 0
fi
<span class="hljs-meta prompt_">
# </span><span class="bash">Créer une sauvegarde si demandé</span>
if [ "$CREATE_BACKUP" = true ]; then
    create_backup
fi
<span class="hljs-meta prompt_">
# </span><span class="bash">Effectuer la mise à jour</span>
if update_n8n "$TARGET_VERSION"; then
    NEW_VERSION=$(get_current_version)
    echo ""
    echo "======================================================================="
    echo "                      MISE A JOUR TERMINEE                            "
    echo "======================================================================="
    echo ""
    echo "✅ N8N mis à jour avec succès!"
    echo "   - Ancienne version: $CURRENT_VERSION"
    echo "   - Nouvelle version: $NEW_VERSION"
    echo ""
    echo "🌐 N8N est accessible à:"
    echo "   - URL: https://$(grep 'server_name' /etc/nginx/conf.d/n8n.conf | head -1 | awk '{print $2}' | sed 's/;//')"
    echo ""
    echo "📊 Commandes utiles:"
    echo "   - Logs: docker-compose logs n8n"
    echo "   - Status: docker-compose ps"
    echo "   - Redémarrer: docker-compose restart"
    echo ""
    if [ "$CREATE_BACKUP" = true ]; then
        echo "💾 Sauvegarde disponible: $(cat /tmp/n8n_last_backup 2&gt;/dev/null || echo "Non trouvée")"
    fi
    echo "======================================================================="
else
    echo ""
    echo "❌ Échec de la mise à jour"
    if [ "$CREATE_BACKUP" = true ]; then
        rollback
    fi
    exit 1
fi</div></code></pre></div><p>Pour automatiser le lancement, lancez ces 2 commandes à la suite (changez n8n_maj.sh par le nom de votre fichier de MAJ) :</p><div class="react-renderer node-codeBlock"><pre as="pre" class="codeblock-lowlight" data-node-view-wrapper="" style="white-space: normal;"><div style="width: fit-content; float: right;"><span class="group/tooltip relative inline-grid bottom"><span aria-describedby=":r3:" style="display: contents;"><span class="contents"><button class="link cursor-pointer all-unset" style="padding: 0 var(--spacer-1);" aria-label="Copy"><span class="icon icon-outline-duplicate"></span></button></span></span><span role="tooltip" id=":r3:" class="absolute z-30 hidden w-40 max-w-max rounded-md bg-primary p-3 text-primary-foreground group-focus-within/tooltip:block group-hover/tooltip:block left-1/2 -translate-x-1/2 top-full translate-y-2"><div class="absolute border-6 border-transparent left-1/2 -translate-x-1/2 bottom-full border-b-primary"></div>Copy to Clipboard</span></span></div><code as="code" data-node-view-content="" style="white-space: pre-wrap;"><div style="white-space: inherit;"><span class="hljs-built_in">chmod</span> +x ~/n8n_maj.sh</div></code></pre></div><div class="react-renderer node-codeBlock"><pre as="pre" class="codeblock-lowlight" data-node-view-wrapper="" style="white-space: normal;"><div style="width: fit-content; float: right;"><span class="group/tooltip relative inline-grid bottom"><span aria-describedby=":r0:" style="display: contents;"><span class="contents"><button class="link cursor-pointer all-unset" style="padding: 0 var(--spacer-1);" aria-label="Copy"><span class="icon icon-outline-duplicate"></span></button></span></span><span role="tooltip" id=":r0:" class="absolute z-30 hidden w-40 max-w-max rounded-md bg-primary p-3 text-primary-foreground group-focus-within/tooltip:block group-hover/tooltip:block left-1/2 -translate-x-1/2 top-full translate-y-2"><div class="absolute border-6 border-transparent left-1/2 -translate-x-1/2 bottom-full border-b-primary"></div>Copy to Clipboard</span></span></div><code as="code" data-node-view-content="" style="white-space: pre-wrap;"><div style="white-space: inherit;">(crontab -l 2&gt;/dev/null; <span class="hljs-built_in">echo</span> <span class="hljs-string">"0 2 * * 0 </span><span class="hljs-string hljs-variable">$HOME</span><span class="hljs-string">/n8n_maj.sh --backup &gt;&gt; </span><span class="hljs-string hljs-variable">$HOME</span><span class="hljs-string">/n8n_auto_update.log 2&gt;&amp;1"</span>) | crontab -</div></code></pre></div></div></div></div></div></div></div></div>
      <script type="application/json" class="js-react-on-rails-component" data-component-name="DownloadPageWithContent" data-dom-id="DownloadPageWithContent-react-component-b68b1031-2bc5-4381-aeb2-5cef9a7885df">{"content":{"license":null,"content_items":[],"rich_content_pages":[{"id":"xeZFL1-kPZWC_0bhbRj0fw==","page_id":"xeZFL1-kPZWC_0bhbRj0fw==","title":null,"variant_id":null,"description":{"type":"doc","content":[{"type":"heading","attrs":{"level":2},"content":[{"text":"Lien pour s'inscrire sur AWS","type":"text","marks":[{"type":"bold"}]}]},{"type":"paragraph","content":[{"text":"AWS Offre gratuite : ","type":"text"},{"type":"tiptap-link","attrs":{"href":"https://aws.amazon.com/fr/free/"},"content":[{"text":"https://aws.amazon.com/fr/free/","type":"text"}]}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2},"content":[{"text":"Installer Putty ","type":"text","marks":[{"type":"bold"}]},{"text":"(Si vous êtes sous Windows)","type":"text","marks":[{"type":"bold"},{"type":"underline"}]}]},{"type":"paragraph","content":[{"text":"Télécharger Putty et l'installer ","type":"text"},{"type":"tiptap-link","attrs":{"href":"https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html"},"content":[{"text":"https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html","type":"text"}]}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2},"content":[{"text":"Se connecter sur votre EC2","type":"text","marks":[{"type":"bold"}]}]},{"type":"paragraph","content":[{"text":"Sur MacOS, lancer la commande suivante dans votre Terminal","type":"text"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"text":"ssh -i n8nAWSKey.pem ec2-user@\u003cadresse-ip\u003e","type":"text"}]},{"type":"paragraph","content":[{"text":"Pensez à changer n8nAWSKey.pem par le nom de votre fichier.","type":"text","marks":[{"type":"italic"}]}]},{"type":"paragraph"},{"type":"paragraph","content":[{"text":"Sur Windows, configurer Putty comme suit :","type":"text"}]},{"type":"image","attrs":{"src":"https://public-files.gumroad.com/q8zpg42bd1423t32qqsqyqk810vc","link":null}},{"type":"image","attrs":{"src":"https://public-files.gumroad.com/kajzdipy0lwgk8c7bdnn6f2tr5dn","link":null}},{"type":"paragraph","content":[{"text":"Une nouvelle fenêtre PuTTY s'ouvre et demande votre confirmation pour enregistrer la clé dans le cache de PuTTY. Cliquez sur Oui.","type":"text"}]},{"type":"paragraph","content":[{"text":"Elle vous demandera le nom d'utilisateur \"login as:\". Entrez \"ec2-user\"","type":"text"}]},{"type":"paragraph","content":[{"text":"Cliquez sur la touche Entrée de votre clavier et voilà ! Vous êtes connecté à la machine AWS EC2 sans avoir à saisir de mot de passe.","type":"text"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2},"content":[{"text":"Script d'installation","type":"text"}]},{"type":"codeBlock","attrs":{"language":"shell"},"content":[{"text":"#!/bin/bash\n\n# Script complet d'installation N8N sur EC2 Amazon Linux\n# Version finale - Production-ready - Testé et validé\n\n# Verifier si info dispo\nif [ -z \"$1\" ] || [ -z \"$2\" ] || [ -z \"$3\" ] || [ -z \"$4\" ] || [ -z \"$5\" ] || [ -z \"$6\" ] || [ -z \"$7\" ] || [ -z \"$8\" ]; then\n  echo \"=======================================================================\"\n  echo \"              SCRIPT COMPLET D'INSTALLATION N8N SUR EC2               \"\n  echo \"=======================================================================\"\n  echo \"\"\n  echo \"Usage: ./complete_n8n_setup.sh \u003cdomaine\u003e \u003crds_host\u003e \u003cdb_user\u003e \u003cdb_password\u003e \u003cdb_name\u003e \u003cemail_ssl\u003e \u003cn8n_username\u003e \u003cn8n_password\u003e\"\n  echo \"\"\n  echo \"PARAMETRES REQUIS (8 parametres):\"\n  echo \"  1. DOMAINE        - Votre domaine (ex: n8n.mondomaine.com)\"\n  echo \"  2. RDS_HOST       - Point de terminaison RDS (ex: mydb.cluster-abc123.eu-west-1.rds.amazonaws.com)\"\n  echo \"  3. DB_USER        - Utilisateur de la base de donnees (ex: postgres)\"\n  echo \"  4. DB_PASSWORD    - Mot de passe de la base de donnees (utiliser des guillemets simples)\"\n  echo \"  5. DB_NAME        - Nom de la base de donnees (ex: n8n)\"\n  echo \"  6. EMAIL_SSL      - Email pour le certificat SSL Let's Encrypt (ex: admin@mondomaine.com)\"\n  echo \"  7. N8N_USERNAME   - Username pour l'authentification HTTP basique (ex: admin)\"\n  echo \"  8. N8N_PASSWORD   - Password pour l'authentification HTTP basique\"\n  echo \"\"\n  echo \"EXEMPLE COMPLET:\"\n  echo \"  ./complete_n8n_setup.sh \\\\\"\n  echo \"    'n8n.croissanceconsulting.com' \\\\\"\n  echo \"    'mydb.cluster-abc123.eu-west-1.rds.amazonaws.com' \\\\\"\n  echo \"    'postgres' \\\\\"\n  echo \"    'monMotDePasseDB\\!123' \\\\\"\n  echo \"    'n8n' \\\\\"\n  echo \"    'admin@croissanceconsulting.com' \\\\\"\n  echo \"    'admin' \\\\\"\n  echo \"    'MonMotDePasseSecurise123'\"\n  echo \"\"\n  echo \"PREREQUIS:\"\n  echo \"  - Instance EC2 Amazon Linux avec accès Internet\"\n  echo \"  - Instance RDS PostgreSQL créée et accessible\"\n  echo \"  - Domaine pointant vers l'IP publique de l'EC2\"\n  echo \"  - Ports 80 et 443 ouverts dans le Security Group\"\n  echo \"\"\n  echo \"NOTES IMPORTANTES:\"\n  echo \"  - Utilisez des guillemets simples pour les mots de passe avec caractères spéciaux\"\n  echo \"  - Le script utilise sudo pour Docker - permissions configurées automatiquement\"\n  echo \"  - Après installation, déconnectez/reconnectez-vous pour utiliser Docker sans sudo\"\n  echo \"\"\n  echo \"=======================================================================\"\n  exit 1\nfi\n\nDOMAIN_OR_IP=$1\nRDS_HOST=$2\nPOSTGRES_USER=$3\nPOSTGRES_PASSWORD=$4\nPOSTGRES_DB=$5\nSSL_EMAIL=$6\nN8N_AUTH_USER=$7\nN8N_AUTH_PASSWORD=$8\n\necho \"=======================================================================\"\necho \"              DEMARRAGE DE L'INSTALLATION COMPLETE                    \"\necho \"=======================================================================\"\necho \"Configuration detectee:\"\necho \"  - Domaine: $DOMAIN_OR_IP\"\necho \"  - RDS Host: $RDS_HOST\"\necho \"  - DB User: $POSTGRES_USER\"\necho \"  - DB Name: $POSTGRES_DB\"\necho \"  - Email SSL: $SSL_EMAIL\"\necho \"  - Auth HTTP: $N8N_AUTH_USER\"\necho \"=======================================================================\"\necho \"\"\n\n# Eviter Conflit\nunset PGUSER\nunset PGPASSWORD\n\n# Generer cle d'encryption aleatoire\ngenerate_encryption_key() {\n  openssl rand -base64 32\n}\n\necho \"🔄 ETAPE 1/4: PREPARATION DU SYSTEME\"\necho \"=======================================================================\"\n\n# Maj systeme\necho \"📦 Mise à jour du système...\"\nsudo yum update -y\n\n# Installer, Demarrer et Activer Nginx\necho \"🌐 Installation et configuration de Nginx...\"\nsudo yum install -y nginx\nsudo systemctl start nginx\nsudo systemctl enable nginx\n\n# Installer Certbot\necho \"🔒 Installation de Certbot pour SSL...\"\nsudo yum install -y epel-release 2\u003e/dev/null || true\nsudo yum install -y certbot python3-certbot-nginx\n\n# Installer Crontab\necho \"⏰ Installation et configuration de Cron...\"\nsudo yum install -y cronie\nsudo systemctl start crond\nsudo systemctl enable crond\n\n# Installer Python, Pip, Git, Docker\necho \"🐍 Installation de Python, Git, Docker...\"\nsudo yum install -y python3 python3-pip git docker\n\n# Demarrer et Activer Docker\necho \"🐳 Configuration de Docker...\"\nsudo systemctl start docker\nsudo systemctl enable docker\n\n# Ajouter l'utilisateur actuel au groupe Docker\nsudo usermod -aG docker $USER\n\n# Installer Docker Compose\necho \"📦 Installation de Docker Compose...\"\nsudo curl -L \"https://github.com/docker/compose/releases/download/1.29.2/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\n\n# Installer Postgres Client\necho \"🐘 Installation du client PostgreSQL...\"\nsudo yum install -y postgresql15\n\n# Installer Node.js\necho \"⚡ Installation de Node.js...\"\ncurl -fsSL https://rpm.nodesource.com/setup_18.x | sudo bash -\nsudo yum install -y nodejs\n\n# Installer PM2\necho \"🚀 Installation de PM2...\"\nsudo npm install -g pm2\n\necho \"\"\necho \"✅ PREPARATION DU SYSTEME TERMINEE\"\necho \"\"\n\necho \"🔄 ETAPE 2/4: PREPARATION DES FICHIERS N8N\"\necho \"=======================================================================\"\n\n# Verifier Docker - toujours avec sudo dans le script\nsudo docker --version\nsudo docker-compose --version\n\n# Creer repertoire pour N8N\nmkdir -p ~/n8n-docker\ncd ~/n8n-docker\n\n# Telecharger certificat RDS SSL\necho \"📜 Téléchargement du certificat RDS...\"\nwget https://s3.amazonaws.com/rds-downloads/rds-combined-ca-bundle.pem -O rds-ca.pem\n\n# Generer cle d'encryption N8N\nN8N_ENCRYPTION_KEY=$(generate_encryption_key)\n\necho \"📝 Création du fichier de configuration...\"\n# Creer le fichier .env avec syntaxe propre\ncat \u003e .env \u003c\u003c EOF\n# AWS RDS Config\nRDS_HOST=$RDS_HOST\nPOSTGRES_USER=$POSTGRES_USER\nPOSTGRES_PASSWORD=$POSTGRES_PASSWORD\nPOSTGRES_DB=$POSTGRES_DB\n\n# Auth n8n (désactivée par défaut - N8N a son propre système d'auth)\nN8N_BASIC_AUTH_ACTIVE=false\nN8N_BASIC_AUTH_USER=$N8N_AUTH_USER\nN8N_BASIC_AUTH_PASSWORD=$N8N_AUTH_PASSWORD\n\n# Domaine \u0026 SSL Config\nDOMAIN_NAME=$DOMAIN_OR_IP\nN8N_PATH=/\n\n# Redis Config\nREDIS_HOST=redis\n\n# cle d'encryption n8n\nN8N_ENCRYPTION_KEY=$N8N_ENCRYPTION_KEY\n\n# Optimisations recommandées par N8N\nN8N_RUNNERS_ENABLED=false\nOFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true\nN8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true\n\n# Optimisations WebSocket et performance\nN8N_DISABLE_UI=false\nN8N_METRICS=false\n\n# Support des nœuds communautaires comme outils AI Agents\nN8N_COMMUNITY_PACKAGES_ALLOW_TOOL_USAGE=true\n\n# Email pour certificat SSL\nSSL_EMAIL=$SSL_EMAIL\nEOF\n\necho \"🛠️ Création du script d'initialisation de la base...\"\n# Creer init-data.sh avec syntaxe bash propre\ncat \u003e init-data.sh \u003c\u003c 'SCRIPT_EOF'\n#!/bin/bash\nset -e\n\nRDS_HOST=$1\nPOSTGRES_USER=$2\nPOSTGRES_PASSWORD=$3\nPOSTGRES_DB=$4\n\nexport PGPASSWORD=$POSTGRES_PASSWORD\n\nDB_EXISTS=$(psql -v ON_ERROR_STOP=1 --host=\"$RDS_HOST\" --username=\"$POSTGRES_USER\" --dbname=\"postgres\" --tuples-only --command=\"SELECT 1 FROM pg_database WHERE datname='$POSTGRES_DB';\")\n\nif [[ -z $DB_EXISTS ]]; then\n  echo \"Database $POSTGRES_DB n existe pas. Je la cree...\"\n  psql -v ON_ERROR_STOP=1 --host=\"$RDS_HOST\" --username=\"$POSTGRES_USER\" --dbname=\"postgres\" --command=\"CREATE DATABASE \\\"$POSTGRES_DB\\\";\"\nelse\n  echo \"Database $POSTGRES_DB existe.\"\nfi\n\npsql -v ON_ERROR_STOP=1 --host=\"$RDS_HOST\" --username=\"$POSTGRES_USER\" --dbname=\"$POSTGRES_DB\" \u003c\u003cEOSQL\nGRANT ALL PRIVILEGES ON DATABASE \"$POSTGRES_DB\" TO $POSTGRES_USER;\nGRANT CREATE ON SCHEMA public TO $POSTGRES_USER;\nEOSQL\n\nunset PGPASSWORD\nSCRIPT_EOF\nchmod +x init-data.sh\n\necho \"\"\necho \"🔄 ETAPE 3/4: CONFIGURATION DE LA BASE DE DONNEES\"\necho \"=======================================================================\"\n\n# Verifier que PostgreSQL est accessible \u0026 lancer script d'initialisation\necho \"🔍 Vérification de la connectivité PostgreSQL...\"\nuntil PGPASSWORD=$POSTGRES_PASSWORD psql --host=\"$RDS_HOST\" --username=\"$POSTGRES_USER\" --dbname=\"postgres\" -c '\\q' 2\u003e/dev/null; do\n  echo \"En attente de PostgreSQL...\"\n  sleep 5\ndone\n\necho \"✅ PostgreSQL accessible - Initialisation de la base...\"\n./init-data.sh \"$RDS_HOST\" \"$POSTGRES_USER\" \"$POSTGRES_PASSWORD\" \"$POSTGRES_DB\"\n\necho \"🐳 Création du fichier Docker Compose...\"\n# Creer le Docker Compose file avec variables correctes\ncat \u003e docker-compose.yml \u003c\u003c EOF\nversion: '3.8'\n\nvolumes:\n  n8n_storage:\n  redis_storage:\n\nservices:\n  redis:\n    image: redis:6-alpine\n    restart: always\n    volumes:\n      - redis_storage:/data\n    healthcheck:\n      test: ['CMD', 'redis-cli', 'ping']\n      interval: 5s\n      timeout: 5s\n      retries: 10\n\n  n8n:\n    image: docker.n8n.io/n8nio/n8n\n    restart: always\n    environment:\n      - DB_TYPE=postgresdb\n      - DB_POSTGRESDB_HOST=$RDS_HOST\n      - DB_POSTGRESDB_PORT=5432\n      - DB_POSTGRESDB_DATABASE=$POSTGRES_DB\n      - DB_POSTGRESDB_USER=$POSTGRES_USER\n      - DB_POSTGRESDB_PASSWORD=$POSTGRES_PASSWORD\n      - EXECUTIONS_MODE=queue\n      - QUEUE_BULL_REDIS_HOST=redis\n      - QUEUE_HEALTH_CHECK_ACTIVE=true\n      - N8N_BASIC_AUTH_ACTIVE=false\n      - DB_POSTGRESDB_SSL_CA=/rds-ca.pem\n      - DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=false\n      - N8N_HOST=$DOMAIN_OR_IP\n      - N8N_PORT=5678\n      - N8N_PROTOCOL=https\n      - WEBHOOK_URL=https://$DOMAIN_OR_IP/\n      - N8N_ENCRYPTION_KEY=\\$N8N_ENCRYPTION_KEY\n      - N8N_RUNNERS_ENABLED=false\n      - OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true\n      - N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true\n      - N8N_COMMUNITY_PACKAGES_ALLOW_TOOL_USAGE=true\n    ports:\n      - 5678:5678\n    volumes:\n      - n8n_storage:/home/node/.n8n\n      - ./rds-ca.pem:/rds-ca.pem\n    depends_on:\n      - redis\n\n  n8n-worker:\n    image: docker.n8n.io/n8nio/n8n\n    restart: always\n    command: worker\n    environment:\n      - DB_TYPE=postgresdb\n      - DB_POSTGRESDB_HOST=$RDS_HOST\n      - DB_POSTGRESDB_PORT=5432\n      - DB_POSTGRESDB_DATABASE=$POSTGRES_DB\n      - DB_POSTGRESDB_USER=$POSTGRES_USER\n      - DB_POSTGRESDB_PASSWORD=$POSTGRES_PASSWORD\n      - DB_POSTGRESDB_SSL_CA=/rds-ca.pem\n      - DB_POSTGRESDB_SSL_REJECT_UNAUTHORIZED=false\n      - EXECUTIONS_MODE=queue\n      - QUEUE_BULL_REDIS_HOST=redis\n      - QUEUE_HEALTH_CHECK_ACTIVE=true\n      - N8N_ENCRYPTION_KEY=\\$N8N_ENCRYPTION_KEY\n      - N8N_RUNNERS_ENABLED=false\n      - OFFLOAD_MANUAL_EXECUTIONS_TO_WORKERS=true\n      - N8N_ENFORCE_SETTINGS_FILE_PERMISSIONS=true\n    volumes:\n      - ./rds-ca.pem:/rds-ca.pem\n    depends_on:\n      - redis\n      - n8n\nEOF\n\necho \"\"\necho \"🔄 ETAPE 4/4: DEMARRAGE ET CONFIGURATION WEB\"\necho \"=======================================================================\"\n\n# Demarrer n8n - toujours avec sudo pour éviter les problèmes de permissions\necho \"🚀 Démarrage de N8N...\"\nsudo docker-compose up -d\n\n# Attendre que n8n soit pret avec retry logic\necho \"⏳ Attente du démarrage de N8N...\"\nRETRY_COUNT=0\nMAX_RETRIES=20\nWAIT_TIME=30\n\nwhile [ $RETRY_COUNT -lt $MAX_RETRIES ]; do\n    sleep $WAIT_TIME\n    if curl -f http://localhost:5678 \u003e /dev/null 2\u003e\u00261; then\n        echo \"✅ N8N est accessible localement\"\n        break\n    else\n        RETRY_COUNT=$((RETRY_COUNT+1))\n        echo \"⏳ N8N démarre encore... ($RETRY_COUNT/$MAX_RETRIES) - Attente ${WAIT_TIME}s\"\n        \n        # Après 5 tentatives, vérifier les logs\n        if [ $RETRY_COUNT -eq 5 ]; then\n            echo \"🔍 Vérification des logs N8N...\"\n            sudo docker-compose logs --tail=10 n8n\n        fi\n    fi\ndone\n\nif [ $RETRY_COUNT -eq $MAX_RETRIES ]; then\n    echo \"❌ Problème: N8N n'est pas accessible après $((MAX_RETRIES*WAIT_TIME)) secondes\"\n    echo \"🔍 Logs détaillés:\"\n    sudo docker-compose logs n8n\n    echo \"\"\n    echo \"⚠️  N8N peut prendre plus de temps au premier démarrage (migrations DB)\"\n    echo \"   Vérifiez manuellement avec: curl -I http://localhost:5678\"\n    echo \"   Ou consultez les logs: sudo docker-compose logs -f n8n\"\n    exit 1\nfi\n\n# Corriger l'avertissement Redis\necho \"🔧 Optimisation système Redis...\"\nsudo sysctl vm.overcommit_memory=1 2\u003e/dev/null || true\necho 'vm.overcommit_memory = 1' | sudo tee -a /etc/sysctl.conf \u003e /dev/null\n\necho \"🌐 Configuration de Nginx (HTTP temporaire)...\"\n# Creer config Nginx TEMPORAIRE (sans SSL)\nFINAL_NGINX_CONF=\"/etc/nginx/conf.d/n8n.conf\"\nsudo tee $FINAL_NGINX_CONF \u003e /dev/null \u003c\u003cEOF\nserver {\n    listen 80;\n    server_name $DOMAIN_OR_IP;\n\n    # Configuration optimisée pour N8N et WebSockets\n    location / {\n        proxy_pass http://127.0.0.1:5678;\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n        proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \\$scheme;\n        \n        # Support WebSocket\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade \\$http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        \n        # Timeouts optimisés\n        proxy_connect_timeout 300s;\n        proxy_send_timeout 300s;\n        proxy_read_timeout 300s;\n        \n        # Buffer settings\n        proxy_buffering off;\n        proxy_request_buffering off;\n    }\n}\nEOF\n\n# Test \u0026 reload Nginx\nsudo nginx -t \u0026\u0026 sudo systemctl reload nginx\n\necho \"🔒 Installation du certificat SSL...\"\n# Installer Certbot and obtain SSL certificate\nif sudo certbot certonly --nginx -d $DOMAIN_OR_IP --non-interactive --agree-tos --email $SSL_EMAIL; then\n  echo \"✅ Certificat SSL obtenu avec succès\"\n  \n  # Mettre à jour la config Nginx pour HTTPS\n  sudo tee $FINAL_NGINX_CONF \u003e /dev/null \u003c\u003cEOF\nserver {\n    listen 443 ssl;\n    server_name $DOMAIN_OR_IP;\n\n    ssl_certificate /etc/letsencrypt/live/$DOMAIN_OR_IP/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/$DOMAIN_OR_IP/privkey.pem;\n\n    # Configuration optimisée pour N8N et WebSockets\n    location / {\n        proxy_pass http://127.0.0.1:5678;\n        proxy_set_header Host \\$host;\n        proxy_set_header X-Real-IP \\$remote_addr;\n        proxy_set_header X-Forwarded-For \\$proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto \\$scheme;\n        \n        # Support WebSocket pour N8N\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade \\$http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        \n        # Timeouts optimisés pour éviter les déconnexions\n        proxy_connect_timeout 300s;\n        proxy_send_timeout 300s;\n        proxy_read_timeout 300s;\n        \n        # Buffer settings pour temps réel\n        proxy_buffering off;\n        proxy_request_buffering off;\n    }\n}\n\nserver {\n    listen 80;\n    server_name $DOMAIN_OR_IP;\n    return 301 https://\\$host\\$request_uri;\n}\nEOF\n\n  # Test \u0026 reload Nginx\n  if sudo nginx -t; then\n      sudo systemctl reload nginx\n      echo \"✅ Configuration HTTPS terminée avec succès\"\n      SSL_STATUS=\"HTTPS configuré\"\n      FINAL_URL=\"https://$DOMAIN_OR_IP\"\n  else\n      echo \"⚠️  Erreur dans la configuration Nginx SSL - reste en HTTP\"\n      SSL_STATUS=\"Erreur SSL - HTTP seulement\"\n      FINAL_URL=\"http://$DOMAIN_OR_IP\"\n  fi\nelse\n  echo \"⚠️  Le certificat SSL n'a pas pu être obtenu - N8N reste accessible en HTTP\"\n  SSL_STATUS=\"HTTP seulement\"\n  FINAL_URL=\"http://$DOMAIN_OR_IP\"\nfi\n\necho \"\"\necho \"=======================================================================\"\necho \"                    INSTALLATION COMPLETE TERMINEE                    \"\necho \"=======================================================================\"\necho \"\"\necho \"🎉 N8N est maintenant installé et accessible !\"\necho \"\"\necho \"✅ STATUT DE L'INSTALLATION:\"\necho \"   🔗 URL: $FINAL_URL\"\necho \"   🔒 SSL: $SSL_STATUS\"\necho \"   📊 Version N8N: 1.102.3+ (dernière disponible)\"\necho \"   🗄️  Base de données: RDS PostgreSQL connectée\"\necho \"   👥 Worker: Opérationnel pour les tâches en arrière-plan\"\necho \"\"\necho \"🔑 PREMIERE CONNEXION:\"\necho \"   1. Allez sur $FINAL_URL\"\necho \"   2. N8N vous demandera de créer le compte administrateur principal\"\necho \"   3. Remplissez vos informations (email, nom, prénom, mot de passe)\"\necho \"   4. Commencez à créer vos workflows !\"\necho \"\"\necho \"💡 NOTES IMPORTANTES:\"\necho \"   - L'authentification HTTP basique est désactivée par défaut\"\necho \"   - N8N utilise son propre système d'authentification sécurisé\"\necho \"   - Les WebSockets sont configurés pour éviter les déconnexions\"\necho \"   - Le worker traite les tâches en arrière-plan automatiquement\"\necho \"\"\necho \"📊 COMMANDES UTILES:\"\necho \"   - Voir les logs: cd ~/n8n-docker \u0026\u0026 sudo docker-compose logs n8n\"\necho \"   - Redémarrer: cd ~/n8n-docker \u0026\u0026 sudo docker-compose restart\"\necho \"   - Arrêter: cd ~/n8n-docker \u0026\u0026 sudo docker-compose down\"\necho \"   - Démarrer: cd ~/n8n-docker \u0026\u0026 sudo docker-compose up -d\"\necho \"   - Status: cd ~/n8n-docker \u0026\u0026 sudo docker-compose ps\"\necho \"\"\necho \"🔧 FICHIERS IMPORTANTS:\"\necho \"   - Configuration: ~/n8n-docker/.env\"\necho \"   - Docker Compose: ~/n8n-docker/docker-compose.yml\"\necho \"   - Nginx: /etc/nginx/conf.d/n8n.conf\"\necho \"   - Logs: sudo docker-compose logs -f n8n\"\necho \"\"\necho \"⚠️  PERMISSIONS DOCKER:\"\necho \"   - Le script utilise sudo pour Docker (évite les problèmes)\"\necho \"   - Pour utiliser Docker sans sudo à l'avenir:\"\necho \"     $ exit\"\necho \"     $ ssh ec2-user@votre-serveur\"\necho \"     $ docker ps  # devrait fonctionner sans sudo\"\necho \"\"\necho \"🔄 MISE A JOUR AUTOMATIQUE (optionnel):\"\necho \"   - Script de mise à jour: ~/update_n8n.sh (si disponible)\"\necho \"   - Cron automatique: (crontab -l 2\u003e/dev/null; echo \\\"0 2 * * * ~/update_n8n.sh --backup\\\") | crontab -\"\necho \"\"\necho \"=======================================================================\"\necho \"🚀 Installation terminée avec succès !\"\necho \"📍 Votre N8N est accessible sur: $FINAL_URL\"\necho \"=======================================================================\"","type":"text"}]},{"type":"paragraph","content":[{"text":"Note :","type":"text","marks":[{"type":"bold"}]},{"text":" si votre mot de passe contient !, il est interprété par bash comme une commande d'historique. Entourez votre mot de passe de Guillemets simples.","type":"text"}]},{"type":"paragraph"},{"type":"heading","attrs":{"level":2},"content":[{"text":"Script MAJ N8N","type":"text"}]},{"type":"codeBlock","attrs":{"language":"shell"},"content":[{"text":"#!/bin/bash\n\n# Script de mise à jour N8N\n# Usage: ./update_n8n.sh [version] [--force] [--backup]\n\necho \"=======================================================================\"\necho \"                        MISE A JOUR N8N                               \"\necho \"=======================================================================\"\necho \"\"\n\n# Configuration\nN8N_DIR=\"$HOME/n8n-docker\"\nBACKUP_DIR=\"$HOME/n8n-backups\"\nCOMPOSE_FILE=\"$N8N_DIR/docker-compose.yml\"\n\n# Options par défaut\nFORCE_UPDATE=false\nCREATE_BACKUP=false\nTARGET_VERSION=\"\"\n\n# Traitement des arguments\nwhile [[ $# -gt 0 ]]; do\n  case $1 in\n    --force)\n      FORCE_UPDATE=true\n      shift\n      ;;\n    --backup)\n      CREATE_BACKUP=true\n      shift\n      ;;\n    --help|-h)\n      echo \"Usage: $0 [version] [--force] [--backup]\"\n      echo \"\"\n      echo \"Options:\"\n      echo \"  version     Version spécifique à installer (ex: 1.15.2)\"\n      echo \"              Si omis, utilise la dernière version\"\n      echo \"  --force     Force la mise à jour même si la version est identique\"\n      echo \"  --backup    Crée une sauvegarde avant la mise à jour\"\n      echo \"  --help      Affiche cette aide\"\n      echo \"\"\n      echo \"Exemples:\"\n      echo \"  $0                          # Met à jour vers la dernière version\"\n      echo \"  $0 1.15.2                  # Met à jour vers la version 1.15.2\"\n      echo \"  $0 --backup                # Met à jour avec sauvegarde\"\n      echo \"  $0 1.15.2 --force --backup # Force la mise à jour vers 1.15.2 avec sauvegarde\"\n      exit 0\n      ;;\n    *)\n      if [[ $1 =~ ^[0-9]+\\.[0-9]+\\.[0-9]+$ ]]; then\n        TARGET_VERSION=$1\n      else\n        echo \"❌ Version invalide: $1\"\n        echo \"Format attendu: X.Y.Z (ex: 1.15.2)\"\n        exit 1\n      fi\n      shift\n      ;;\n  esac\ndone\n\n# Vérification des prérequis\nif [ ! -d \"$N8N_DIR\" ]; then\n    echo \"❌ Erreur: Répertoire N8N non trouvé ($N8N_DIR)\"\n    echo \"   Assurez-vous que N8N est installé avec le script d'installation.\"\n    exit 1\nfi\n\nif [ ! -f \"$COMPOSE_FILE\" ]; then\n    echo \"❌ Erreur: Fichier docker-compose.yml non trouvé\"\n    exit 1\nfi\n\ncd \"$N8N_DIR\"\n\n# Fonction pour obtenir la version actuelle\nget_current_version() {\n    local version=$(docker-compose exec -T n8n n8n --version 2\u003e/dev/null | grep -oE '[0-9]+\\.[0-9]+\\.[0-9]+' | head -1)\n    if [ -z \"$version\" ]; then\n        echo \"unknown\"\n    else\n        echo \"$version\"\n    fi\n}\n\n# Fonction pour obtenir la dernière version disponible\nget_latest_version() {\n    local latest=$(curl -s https://api.github.com/repos/n8n-io/n8n/releases/latest | grep '\"tag_name\"' | cut -d'\"' -f4 | sed 's/^n8n@//')\n    if [ -z \"$latest\" ]; then\n        echo \"❌ Impossible de récupérer la dernière version depuis GitHub\"\n        exit 1\n    fi\n    echo \"$latest\"\n}\n\n# Fonction de sauvegarde\ncreate_backup() {\n    echo \"💾 Création de la sauvegarde...\"\n    \n    local timestamp=$(date +%Y%m%d_%H%M%S)\n    local backup_path=\"$BACKUP_DIR/n8n_backup_$timestamp\"\n    \n    mkdir -p \"$backup_path\"\n    \n    # Sauvegarde de la configuration\n    cp -r \"$N8N_DIR\" \"$backup_path/config\"\n    \n    # Sauvegarde des volumes Docker\n    echo \"   - Sauvegarde des volumes Docker...\"\n    docker run --rm -v n8n-docker_n8n_storage:/data -v \"$backup_path\":/backup alpine tar czf /backup/n8n_data.tar.gz -C /data .\n    \n    # Export des workflows\n    echo \"   - Export des workflows...\"\n    docker-compose exec -T n8n n8n export:workflow --all --output=/tmp/workflows.json 2\u003e/dev/null\n    docker cp $(docker-compose ps -q n8n):/tmp/workflows.json \"$backup_path/workflows.json\" 2\u003e/dev/null || echo \"   ⚠️  Aucun workflow à exporter\"\n    \n    # Export des credentials\n    echo \"   - Export des credentials...\"\n    docker-compose exec -T n8n n8n export:credentials --all --output=/tmp/credentials.json 2\u003e/dev/null\n    docker cp $(docker-compose ps -q n8n):/tmp/credentials.json \"$backup_path/credentials.json\" 2\u003e/dev/null || echo \"   ⚠️  Aucun credential à exporter\"\n    \n    echo \"✅ Sauvegarde créée: $backup_path\"\n    echo \"$backup_path\" \u003e /tmp/n8n_last_backup\n}\n\n# Fonction de mise à jour\nupdate_n8n() {\n    local version=$1\n    local image_tag=\"\"\n    \n    if [ -n \"$version\" ]; then\n        image_tag=\":$version\"\n        echo \"🎯 Version cible: $version\"\n    else\n        image_tag=\":latest\"\n        echo \"🎯 Version cible: latest\"\n    fi\n    \n    echo \"\"\n    echo \"🔄 Début de la mise à jour...\"\n    \n    # Arrêt des services\n    echo \"   - Arrêt des services N8N...\"\n    docker-compose down\n    \n    # Mise à jour du docker-compose.yml\n    echo \"   - Mise à jour de la configuration...\"\n    sed -i \"s|image: docker.n8n.io/n8nio/n8n.*|image: docker.n8n.io/n8nio/n8n$image_tag|g\" \"$COMPOSE_FILE\"\n    \n    # Pull de la nouvelle image\n    echo \"   - Téléchargement de la nouvelle image...\"\n    docker-compose pull n8n\n    \n    # Redémarrage des services\n    echo \"   - Redémarrage des services...\"\n    docker-compose up -d\n    \n    # Attente du démarrage\n    echo \"   - Attente du démarrage...\"\n    sleep 30\n    \n    # Vérification\n    if curl -f http://localhost:5678 \u003e /dev/null 2\u003e\u00261; then\n        echo \"✅ N8N redémarré avec succès\"\n    else\n        echo \"❌ Erreur: N8N ne répond pas\"\n        echo \"Tentative de restauration...\"\n        docker-compose logs n8n\n        return 1\n    fi\n}\n\n# Fonction de rollback\nrollback() {\n    echo \"\"\n    echo \"🔄 Tentative de rollback...\"\n    \n    if [ -f /tmp/n8n_last_backup ]; then\n        local backup_path=$(cat /tmp/n8n_last_backup)\n        if [ -d \"$backup_path\" ]; then\n            echo \"   - Restauration de la configuration...\"\n            docker-compose down\n            cp -r \"$backup_path/config/\"* \"$N8N_DIR/\"\n            docker-compose up -d\n            echo \"✅ Rollback effectué\"\n        else\n            echo \"❌ Sauvegarde introuvable: $backup_path\"\n        fi\n    else\n        echo \"❌ Aucune sauvegarde récente trouvée\"\n    fi\n}\n\n# Programme principal\necho \"🔍 Vérification de l'état actuel...\"\n\n# Vérifier que N8N fonctionne\nif ! docker-compose ps | grep -q \"Up\"; then\n    echo \"❌ N8N ne semble pas fonctionner\"\n    echo \"   Démarrage des services...\"\n    docker-compose up -d\n    sleep 30\nfi\n\n# Obtenir les versions\nCURRENT_VERSION=$(get_current_version)\necho \"📌 Version actuelle: $CURRENT_VERSION\"\n\nif [ -n \"$TARGET_VERSION\" ]; then\n    LATEST_VERSION=\"$TARGET_VERSION\"\nelse\n    echo \"🔍 Recherche de la dernière version...\"\n    LATEST_VERSION=$(get_latest_version)\nfi\n\necho \"🆕 Version cible: $LATEST_VERSION\"\n\n# Vérifier si une mise à jour est nécessaire\nif [ \"$CURRENT_VERSION\" = \"$LATEST_VERSION\" ] \u0026\u0026 [ \"$FORCE_UPDATE\" = false ]; then\n    echo \"\"\n    echo \"✅ N8N est déjà à jour (version $CURRENT_VERSION)\"\n    echo \"   Utilisez --force pour forcer la mise à jour\"\n    exit 0\nfi\n\necho \"\"\necho \"📋 RESUME DE LA MISE A JOUR:\"\necho \"   - Version actuelle: $CURRENT_VERSION\"\necho \"   - Version cible: $LATEST_VERSION\"\necho \"   - Sauvegarde: $([ \"$CREATE_BACKUP\" = true ] \u0026\u0026 echo \"OUI\" || echo \"NON\")\"\necho \"   - Force: $([ \"$FORCE_UPDATE\" = true ] \u0026\u0026 echo \"OUI\" || echo \"NON\")\"\necho \"\"\n\nread -p \"Continuer la mise à jour? (oui/non): \" confirm\nif [ \"$confirm\" != \"oui\" ]; then\n    echo \"Mise à jour annulée.\"\n    exit 0\nfi\n\n# Créer une sauvegarde si demandé\nif [ \"$CREATE_BACKUP\" = true ]; then\n    create_backup\nfi\n\n# Effectuer la mise à jour\nif update_n8n \"$TARGET_VERSION\"; then\n    NEW_VERSION=$(get_current_version)\n    echo \"\"\n    echo \"=======================================================================\"\n    echo \"                      MISE A JOUR TERMINEE                            \"\n    echo \"=======================================================================\"\n    echo \"\"\n    echo \"✅ N8N mis à jour avec succès!\"\n    echo \"   - Ancienne version: $CURRENT_VERSION\"\n    echo \"   - Nouvelle version: $NEW_VERSION\"\n    echo \"\"\n    echo \"🌐 N8N est accessible à:\"\n    echo \"   - URL: https://$(grep 'server_name' /etc/nginx/conf.d/n8n.conf | head -1 | awk '{print $2}' | sed 's/;//')\"\n    echo \"\"\n    echo \"📊 Commandes utiles:\"\n    echo \"   - Logs: docker-compose logs n8n\"\n    echo \"   - Status: docker-compose ps\"\n    echo \"   - Redémarrer: docker-compose restart\"\n    echo \"\"\n    if [ \"$CREATE_BACKUP\" = true ]; then\n        echo \"💾 Sauvegarde disponible: $(cat /tmp/n8n_last_backup 2\u003e/dev/null || echo \"Non trouvée\")\"\n    fi\n    echo \"=======================================================================\"\nelse\n    echo \"\"\n    echo \"❌ Échec de la mise à jour\"\n    if [ \"$CREATE_BACKUP\" = true ]; then\n        rollback\n    fi\n    exit 1\nfi","type":"text"}]},{"type":"paragraph","content":[{"text":"Pour automatiser le lancement, lancez ces 2 commandes à la suite (changez n8n_maj.sh par le nom de votre fichier de MAJ) :","type":"text"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"text":"chmod +x ~/n8n_maj.sh","type":"text"}]},{"type":"codeBlock","attrs":{"language":"bash"},"content":[{"text":"(crontab -l 2\u003e/dev/null; echo \"0 2 * * 0 $HOME/n8n_maj.sh --backup \u003e\u003e $HOME/n8n_auto_update.log 2\u003e\u00261\") | crontab -","type":"text"}]}]},"updated_at":"2025-07-14T17:27:22Z"}],"last_content_page_id":null,"posts":[],"video_transcoding_info":null,"custom_receipt":null,"discord":null,"community_chat_url":null,"ios_app_url":"https://itunes.apple.com/app/id916819108","android_app_url":"https://play.google.com/store/apps/details?id=com.gumroad.app","download_all_button":null},"product_has_third_party_analytics":false,"terms_page_url":"https://gumroad.com/terms","token":"e8b432408f3f826a1d66d84b01b03e6e","redirect_id":"1A59D_Md9JwCRFM-PaFc4Q==","creator":{"name":"Naier Saidane","profile_url":"https://croissance.gumroad.com?recommended_by=library","avatar_url":"https://public-files.gumroad.com/lvcg72yemnz50q3bdyqx0rs3384c"},"installment":null,"purchase":{"id":"qL-jspD2pO3OstXiyUSeTg==","bundle_purchase_id":null,"email":"nguyplayer@gmail.com","email_digest":"SRU1KqR_qedG_ZF9hbw9rKC5Dfhkph0dxcTvYO6nt0Q=","created_at":"2026-02-03T00:06:22Z","is_archived":false,"product_permalink":"fxwwm","product_id":"jB609brUGw4et1qp7RQXlQ==","product_name":"Hébergement N8N (PRO \u0026 100% GRATUIT)","variant_id":null,"variant_name":null,"product_long_url":"https://croissance.gumroad.com/l/hebergement-n8n","allows_review":true,"disable_reviews_after_year":false,"review":null,"membership":null,"purchase_custom_fields":[],"call":null},"is_mobile_app_web_view":false,"content_unavailability_reason_code":null,"add_to_library_option":"signup_form"}</script>
      


        </div>
      </main>
    </div>
    <script src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/application-cbf244e9109e70d7b04497041636f00173a1e588f9b879b3a.js" type="text/javascript"></script>
    
      <script async="false" id="dropboxjs" src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/dropins.js" data-app-key="am14aevc931p5hg" type="text/javascript"></script>
    <script src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/webpack-runtime-f16142b20fe261615c38.js" defer="defer" type="text/javascript"></script>
<script src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/webpack-commons-4a5a7c9c28f5d5ad3935.js" defer="defer" type="text/javascript"></script>
<script src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/url_redirect_download-cb83d0abd19dfde535ec.js" defer="defer" type="text/javascript"></script>

  <script defer="defer" src="H%C3%A9bergement%20N8N%20(PRO%20&amp;%20100_%20GRATUIT)_fichiers/vcd15cbe7772f49c399c6a5babf22c1241717689176015" integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ==" nonce="" data-cf-beacon="{&quot;rayId&quot;:&quot;9c7daed81dda9bc3&quot;,&quot;serverTiming&quot;:{&quot;name&quot;:{&quot;cfExtPri&quot;:true,&quot;cfEdge&quot;:true,&quot;cfOrigin&quot;:true,&quot;cfL4&quot;:true,&quot;cfSpeedBrain&quot;:true,&quot;cfCacheStatus&quot;:true}},&quot;version&quot;:&quot;2025.9.1&quot;,&quot;token&quot;:&quot;5070e21320304a1ba2b0a42ce9682840&quot;}" crossorigin="anonymous"></script>


<span data-radix-focus-guard="" tabindex="0" style="outline: none; opacity: 0; position: fixed; pointer-events: none;"></span></body></html>